Set CUDA current device to: 1 (should be 1)
/workspace/compute-aware-arch-search/distill_videet.py:34: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `DistillationTrainer.__init__`. Use `processing_class` instead.
  super().__init__(*args, **kwargs)
After Trainer init: Student model on cuda:1, expected cuda:1
Final check - Student model device: cuda:1
Final check - Trainer args.device: cuda:0 (read-only property)
Final check - CUDA current device: 1
The tokenizer has new PAD/BOS/EOS tokens that differ from the model config and generation config. The model config and generation config were aligned accordingly, being updated with the tokenizer's values. Updated tokens: {'bos_token_id': None, 'pad_token_id': 151643}.
  0%|                                                                                                    | 0/10000 [00:00<?, ?it/s]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None

[Step 1] ========== MEMORY DEBUG ==========
[Step 1] Model device: cuda:1
[Step 1] Input device: cuda:1
[Step 1] Teacher model device: cuda:0
[Step 1] GPU 0 memory: 16.38 GB (reserved: 16.54 GB)
[Step 1] GPU 1 memory: 8.44 GB (reserved: 8.55 GB)
  warnings.warn(
[Step 1] Student logits device: cuda:1, shape: torch.Size([2, 463, 151936]), dtype: torch.float32
[Step 1] Student model device: cuda:1
[Step 1] GPU 0 memory before teacher forward: 16.38 GB
[Step 1] GPU 0 memory after moving inputs: 16.38 GB
[Step 1] GPU 0 memory after teacher forward: 16.67 GB
[Step 1] Teacher logits shape: torch.Size([2, 463, 151936]), dtype: torch.float16
[Step 1] Teacher logits device before move: cuda:0
[Step 1] Target device (student_logits.device): cuda:1
[Step 1] GPU 0 memory after moving logits to GPU 1: 16.67 GB
[Step 1] Teacher logits device after move: cuda:1, shape: torch.Size([2, 463, 151936])
[Step 1] GPU 0 memory after del: 16.39 GB
[Step 1] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 1] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 10.71 GB
[Step 1] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 1] Sequence length: 463, Batch size: 2
[Step 1] After KL computation - GPU 1: 11.83 GB
[Step 1] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 11] ========== MEMORY DEBUG ==========
[Step 11] Model device: cuda:1
[Step 11] Input device: cuda:1
[Step 11] Teacher model device: cuda:0
[Step 11] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 11] GPU 1 memory: 16.89 GB (reserved: 28.79 GB)
[Step 11] Student logits device: cuda:1, shape: torch.Size([2, 382, 151936]), dtype: torch.float32
[Step 11] Student model device: cuda:1
[Step 11] GPU 0 memory before teacher forward: 16.39 GB
[Step 11] GPU 0 memory after moving inputs: 16.39 GB
[Step 11] GPU 0 memory after teacher forward: 16.62 GB
[Step 11] Teacher logits shape: torch.Size([2, 382, 151936]), dtype: torch.float16
[Step 11] Teacher logits device before move: cuda:0
[Step 11] Target device (student_logits.device): cuda:1
[Step 11] GPU 0 memory after moving logits to GPU 1: 16.62 GB
[Step 11] Teacher logits device after move: cuda:1, shape: torch.Size([2, 382, 151936])
[Step 11] GPU 0 memory after del: 16.39 GB
[Step 11] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 11] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 18.87 GB
[Step 11] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 11] Sequence length: 382, Batch size: 2
[Step 11] After KL computation - GPU 1: 19.80 GB
[Step 11] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  0%|                                                                                         | 1/10000 [00:22<63:35:04, 22.89s/it]

[Step 21] ========== MEMORY DEBUG ==========
[Step 21] Model device: cuda:1
[Step 21] Input device: cuda:1
[Step 21] Teacher model device: cuda:0
[Step 21] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 21] GPU 1 memory: 33.76 GB (reserved: 47.64 GB)
[Step 21] Student logits device: cuda:1, shape: torch.Size([2, 965, 151936]), dtype: torch.float32
[Step 21] Student model device: cuda:1
[Step 21] GPU 0 memory before teacher forward: 16.39 GB
[Step 21] GPU 0 memory after moving inputs: 16.39 GB
[Step 21] GPU 0 memory after teacher forward: 16.98 GB
[Step 21] Teacher logits shape: torch.Size([2, 965, 151936]), dtype: torch.float16
[Step 21] Teacher logits device before move: cuda:0
[Step 21] Target device (student_logits.device): cuda:1
[Step 21] GPU 0 memory after moving logits to GPU 1: 16.98 GB
[Step 21] Teacher logits device after move: cuda:1, shape: torch.Size([2, 965, 151936])
[Step 21] GPU 0 memory after del: 16.39 GB
[Step 21] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 21] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 37.81 GB
[Step 21] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 21] Sequence length: 965, Batch size: 2
[Step 21] After KL computation - GPU 1: 40.15 GB
[Step 21] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 31] ========== MEMORY DEBUG ==========
[Step 31] Model device: cuda:1
[Step 31] Input device: cuda:1
[Step 31] Teacher model device: cuda:0
[Step 31] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 31] GPU 1 memory: 33.76 GB (reserved: 47.71 GB)
[Step 31] Student logits device: cuda:1, shape: torch.Size([2, 693, 151936]), dtype: torch.float32
[Step 31] Student model device: cuda:1
[Step 31] GPU 0 memory before teacher forward: 16.39 GB
[Step 31] GPU 0 memory after moving inputs: 16.39 GB
[Step 31] GPU 0 memory after teacher forward: 16.81 GB
[Step 31] Teacher logits shape: torch.Size([2, 693, 151936]), dtype: torch.float16
[Step 31] Teacher logits device before move: cuda:0
[Step 31] Target device (student_logits.device): cuda:1
[Step 31] GPU 0 memory after moving logits to GPU 1: 16.81 GB
[Step 31] Teacher logits device after move: cuda:1, shape: torch.Size([2, 693, 151936])
[Step 31] GPU 0 memory after del: 16.39 GB
[Step 31] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 31] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 36.84 GB
[Step 31] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 31] Sequence length: 693, Batch size: 2
[Step 31] After KL computation - GPU 1: 38.52 GB
[Step 31] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 41] ========== MEMORY DEBUG ==========
[Step 41] Model device: cuda:1
[Step 41] Input device: cuda:1
[Step 41] Teacher model device: cuda:0
[Step 41] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 41] GPU 1 memory: 33.76 GB (reserved: 47.19 GB)
[Step 41] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 41] Student model device: cuda:1
[Step 41] GPU 0 memory before teacher forward: 16.39 GB
[Step 41] GPU 0 memory after moving inputs: 16.39 GB
[Step 41] GPU 0 memory after teacher forward: 17.01 GB
[Step 41] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 41] Teacher logits device before move: cuda:0
[Step 41] Target device (student_logits.device): cuda:1
[Step 41] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 41] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 41] GPU 0 memory after del: 16.39 GB
[Step 41] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 41] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 41] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 41] Sequence length: 1024, Batch size: 2
[Step 41] After KL computation - GPU 1: 40.50 GB
[Step 41] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 51] ========== MEMORY DEBUG ==========
[Step 51] Model device: cuda:1
[Step 51] Input device: cuda:1
[Step 51] Teacher model device: cuda:0
[Step 51] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 51] GPU 1 memory: 33.78 GB (reserved: 46.70 GB)
[Step 51] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 51] Student model device: cuda:1
[Step 51] GPU 0 memory before teacher forward: 16.39 GB
[Step 51] GPU 0 memory after moving inputs: 16.39 GB
[Step 51] GPU 0 memory after teacher forward: 17.01 GB
[Step 51] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 51] Teacher logits device before move: cuda:0
[Step 51] Target device (student_logits.device): cuda:1
[Step 51] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 51] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 51] GPU 0 memory after del: 16.39 GB
[Step 51] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 51] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.03 GB
[Step 51] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 51] Sequence length: 1024, Batch size: 2
[Step 51] After KL computation - GPU 1: 40.52 GB
[Step 51] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 61] ========== MEMORY DEBUG ==========
[Step 61] Model device: cuda:1
[Step 61] Input device: cuda:1
[Step 61] Teacher model device: cuda:0
[Step 61] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 61] GPU 1 memory: 33.78 GB (reserved: 47.73 GB)
[Step 61] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 61] Student model device: cuda:1
[Step 61] GPU 0 memory before teacher forward: 16.39 GB
[Step 61] GPU 0 memory after moving inputs: 16.39 GB
[Step 61] GPU 0 memory after teacher forward: 17.01 GB
[Step 61] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 61] Teacher logits device before move: cuda:0
[Step 61] Target device (student_logits.device): cuda:1
[Step 61] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 61] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 61] GPU 0 memory after del: 16.39 GB
[Step 61] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 61] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.03 GB
[Step 61] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 61] Sequence length: 1024, Batch size: 2
[Step 61] After KL computation - GPU 1: 40.52 GB
[Step 61] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 71] ========== MEMORY DEBUG ==========
[Step 71] Model device: cuda:1
[Step 71] Input device: cuda:1
[Step 71] Teacher model device: cuda:0
[Step 71] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 71] GPU 1 memory: 33.76 GB (reserved: 46.51 GB)
[Step 71] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 71] Student model device: cuda:1
[Step 71] GPU 0 memory before teacher forward: 16.39 GB
[Step 71] GPU 0 memory after moving inputs: 16.39 GB
[Step 71] GPU 0 memory after teacher forward: 17.01 GB
[Step 71] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 71] Teacher logits device before move: cuda:0
[Step 71] Target device (student_logits.device): cuda:1
[Step 71] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 71] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 71] GPU 0 memory after del: 16.39 GB
[Step 71] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 71] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 71] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 71] Sequence length: 1024, Batch size: 2
[Step 71] After KL computation - GPU 1: 40.50 GB
[Step 71] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 81] ========== MEMORY DEBUG ==========
[Step 81] Model device: cuda:1
[Step 81] Input device: cuda:1
[Step 81] Teacher model device: cuda:0
[Step 81] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 81] GPU 1 memory: 25.33 GB (reserved: 43.80 GB)
[Step 81] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 81] Student model device: cuda:1
[Step 81] GPU 0 memory before teacher forward: 16.39 GB
[Step 81] GPU 0 memory after moving inputs: 16.39 GB
[Step 81] GPU 0 memory after teacher forward: 17.01 GB
[Step 81] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 81] Teacher logits device before move: cuda:0
[Step 81] Target device (student_logits.device): cuda:1
[Step 81] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 81] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 81] GPU 0 memory after del: 16.39 GB
[Step 81] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 81] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 29.58 GB
[Step 81] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 81] Sequence length: 1024, Batch size: 2
[Step 81] After KL computation - GPU 1: 32.07 GB
[Step 81] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 91] ========== MEMORY DEBUG ==========
[Step 91] Model device: cuda:1
[Step 91] Input device: cuda:1
[Step 91] Teacher model device: cuda:0
[Step 91] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 91] GPU 1 memory: 33.76 GB (reserved: 43.54 GB)
[Step 91] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 91] Student model device: cuda:1
[Step 91] GPU 0 memory before teacher forward: 16.39 GB
[Step 91] GPU 0 memory after moving inputs: 16.39 GB
[Step 91] GPU 0 memory after teacher forward: 17.01 GB
[Step 91] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 91] Teacher logits device before move: cuda:0
[Step 91] Target device (student_logits.device): cuda:1
[Step 91] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 91] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 91] GPU 0 memory after del: 16.39 GB
[Step 91] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 91] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 91] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 91] Sequence length: 1024, Batch size: 2
[Step 91] After KL computation - GPU 1: 40.50 GB
[Step 91] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 101] ========== MEMORY DEBUG ==========
[Step 101] Model device: cuda:1
[Step 101] Input device: cuda:1
[Step 101] Teacher model device: cuda:0
[Step 101] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 101] GPU 1 memory: 33.76 GB (reserved: 47.50 GB)
[Step 101] Student logits device: cuda:1, shape: torch.Size([2, 271, 151936]), dtype: torch.float32
[Step 101] Student model device: cuda:1
[Step 101] GPU 0 memory before teacher forward: 16.39 GB
[Step 101] GPU 0 memory after moving inputs: 16.39 GB
[Step 101] GPU 0 memory after teacher forward: 16.56 GB
[Step 101] Teacher logits shape: torch.Size([2, 271, 151936]), dtype: torch.float16
[Step 101] Teacher logits device before move: cuda:0
[Step 101] Target device (student_logits.device): cuda:1
[Step 101] GPU 0 memory after moving logits to GPU 1: 16.56 GB
[Step 101] Teacher logits device after move: cuda:1, shape: torch.Size([2, 271, 151936])
[Step 101] GPU 0 memory after del: 16.39 GB
[Step 101] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 101] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 35.35 GB
[Step 101] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 101] Sequence length: 271, Batch size: 2
[Step 101] After KL computation - GPU 1: 36.00 GB
[Step 101] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 111] ========== MEMORY DEBUG ==========
[Step 111] Model device: cuda:1
[Step 111] Input device: cuda:1
[Step 111] Teacher model device: cuda:0
[Step 111] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 111] GPU 1 memory: 33.76 GB (reserved: 45.00 GB)
[Step 111] Student logits device: cuda:1, shape: torch.Size([2, 925, 151936]), dtype: torch.float32
[Step 111] Student model device: cuda:1
[Step 111] GPU 0 memory before teacher forward: 16.39 GB
[Step 111] GPU 0 memory after moving inputs: 16.39 GB
[Step 111] GPU 0 memory after teacher forward: 16.95 GB
[Step 111] Teacher logits shape: torch.Size([2, 925, 151936]), dtype: torch.float16
[Step 111] Teacher logits device before move: cuda:0
[Step 111] Target device (student_logits.device): cuda:1
[Step 111] GPU 0 memory after moving logits to GPU 1: 16.95 GB
[Step 111] Teacher logits device after move: cuda:1, shape: torch.Size([2, 925, 151936])
[Step 111] GPU 0 memory after del: 16.39 GB
[Step 111] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 111] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 37.66 GB
[Step 111] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 111] Sequence length: 925, Batch size: 2
[Step 111] After KL computation - GPU 1: 39.91 GB
[Step 111] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 121] ========== MEMORY DEBUG ==========
[Step 121] Model device: cuda:1
[Step 121] Input device: cuda:1
[Step 121] Teacher model device: cuda:0
[Step 121] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 121] GPU 1 memory: 33.76 GB (reserved: 47.48 GB)
[Step 121] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 121] Student model device: cuda:1
[Step 121] GPU 0 memory before teacher forward: 16.39 GB
[Step 121] GPU 0 memory after moving inputs: 16.39 GB
[Step 121] GPU 0 memory after teacher forward: 17.01 GB
[Step 121] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 121] Teacher logits device before move: cuda:0
[Step 121] Target device (student_logits.device): cuda:1
[Step 121] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 121] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 121] GPU 0 memory after del: 16.39 GB
[Step 121] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 121] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 121] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 121] Sequence length: 1024, Batch size: 2
[Step 121] After KL computation - GPU 1: 40.50 GB
[Step 121] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 131] ========== MEMORY DEBUG ==========
[Step 131] Model device: cuda:1
[Step 131] Input device: cuda:1
[Step 131] Teacher model device: cuda:0
[Step 131] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 131] GPU 1 memory: 33.76 GB (reserved: 47.22 GB)
[Step 131] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 131] Student model device: cuda:1
[Step 131] GPU 0 memory before teacher forward: 16.39 GB
[Step 131] GPU 0 memory after moving inputs: 16.39 GB
[Step 131] GPU 0 memory after teacher forward: 17.01 GB
[Step 131] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 131] Teacher logits device before move: cuda:0
[Step 131] Target device (student_logits.device): cuda:1
[Step 131] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 131] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 131] GPU 0 memory after del: 16.39 GB
[Step 131] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 131] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 131] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 131] Sequence length: 1024, Batch size: 2
[Step 131] After KL computation - GPU 1: 40.50 GB
[Step 131] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 141] ========== MEMORY DEBUG ==========
[Step 141] Model device: cuda:1
[Step 141] Input device: cuda:1
[Step 141] Teacher model device: cuda:0
[Step 141] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 141] GPU 1 memory: 33.76 GB (reserved: 39.33 GB)
[Step 141] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 141] Student model device: cuda:1
[Step 141] GPU 0 memory before teacher forward: 16.39 GB
[Step 141] GPU 0 memory after moving inputs: 16.39 GB
[Step 141] GPU 0 memory after teacher forward: 17.01 GB
[Step 141] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 141] Teacher logits device before move: cuda:0
[Step 141] Target device (student_logits.device): cuda:1
[Step 141] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 141] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 141] GPU 0 memory after del: 16.39 GB
[Step 141] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 141] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 141] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 141] Sequence length: 1024, Batch size: 2
[Step 141] After KL computation - GPU 1: 40.50 GB
[Step 141] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 151] ========== MEMORY DEBUG ==========
[Step 151] Model device: cuda:1
[Step 151] Input device: cuda:1
[Step 151] Teacher model device: cuda:0
[Step 151] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 151] GPU 1 memory: 33.77 GB (reserved: 47.73 GB)
[Step 151] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 151] Student model device: cuda:1
[Step 151] GPU 0 memory before teacher forward: 16.39 GB
[Step 151] GPU 0 memory after moving inputs: 16.39 GB
[Step 151] GPU 0 memory after teacher forward: 17.01 GB
[Step 151] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 151] Teacher logits device before move: cuda:0
[Step 151] Target device (student_logits.device): cuda:1
[Step 151] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 151] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 151] GPU 0 memory after del: 16.39 GB
[Step 151] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 151] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.02 GB
[Step 151] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 151] Sequence length: 1024, Batch size: 2
[Step 151] After KL computation - GPU 1: 40.51 GB
[Step 151] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
{'loss': 1077258.3, 'grad_norm': nan, 'learning_rate': 4.5e-06, 'epoch': 0.0}

[Step 161] ========== MEMORY DEBUG ==========
[Step 161] Model device: cuda:1
[Step 161] Input device: cuda:1
[Step 161] Teacher model device: cuda:0
[Step 161] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 161] GPU 1 memory: 25.33 GB (reserved: 45.45 GB)
[Step 161] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 161] Student model device: cuda:1
[Step 161] GPU 0 memory before teacher forward: 16.39 GB
[Step 161] GPU 0 memory after moving inputs: 16.39 GB
[Step 161] GPU 0 memory after teacher forward: 17.01 GB
[Step 161] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 161] Teacher logits device before move: cuda:0
[Step 161] Target device (student_logits.device): cuda:1
[Step 161] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 161] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 161] GPU 0 memory after del: 16.39 GB
[Step 161] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 161] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 29.58 GB
[Step 161] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 161] Sequence length: 1024, Batch size: 2
[Step 161] After KL computation - GPU 1: 32.07 GB
[Step 161] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 171] ========== MEMORY DEBUG ==========
[Step 171] Model device: cuda:1
[Step 171] Input device: cuda:1
[Step 171] Teacher model device: cuda:0
[Step 171] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 171] GPU 1 memory: 33.76 GB (reserved: 44.87 GB)
[Step 171] Student logits device: cuda:1, shape: torch.Size([2, 810, 151936]), dtype: torch.float32
[Step 171] Student model device: cuda:1
[Step 171] GPU 0 memory before teacher forward: 16.39 GB
[Step 171] GPU 0 memory after moving inputs: 16.39 GB
[Step 171] GPU 0 memory after teacher forward: 16.88 GB
[Step 171] Teacher logits shape: torch.Size([2, 810, 151936]), dtype: torch.float16
[Step 171] Teacher logits device before move: cuda:0
[Step 171] Target device (student_logits.device): cuda:1
[Step 171] GPU 0 memory after moving logits to GPU 1: 16.88 GB
[Step 171] Teacher logits device after move: cuda:1, shape: torch.Size([2, 810, 151936])
[Step 171] GPU 0 memory after del: 16.39 GB
[Step 171] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 171] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 37.25 GB
[Step 171] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 171] Sequence length: 810, Batch size: 2
[Step 171] After KL computation - GPU 1: 39.22 GB
[Step 171] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 181] ========== MEMORY DEBUG ==========
[Step 181] Model device: cuda:1
[Step 181] Input device: cuda:1
[Step 181] Teacher model device: cuda:0
[Step 181] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 181] GPU 1 memory: 33.76 GB (reserved: 47.59 GB)
[Step 181] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 181] Student model device: cuda:1
[Step 181] GPU 0 memory before teacher forward: 16.39 GB
[Step 181] GPU 0 memory after moving inputs: 16.39 GB
[Step 181] GPU 0 memory after teacher forward: 17.01 GB
[Step 181] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 181] Teacher logits device before move: cuda:0
[Step 181] Target device (student_logits.device): cuda:1
[Step 181] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 181] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 181] GPU 0 memory after del: 16.39 GB
[Step 181] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 181] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.02 GB
[Step 181] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 181] Sequence length: 1024, Batch size: 2
[Step 181] After KL computation - GPU 1: 40.50 GB
[Step 181] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 191] ========== MEMORY DEBUG ==========
[Step 191] Model device: cuda:1
[Step 191] Input device: cuda:1
[Step 191] Teacher model device: cuda:0
[Step 191] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 191] GPU 1 memory: 33.76 GB (reserved: 42.99 GB)
[Step 191] Student logits device: cuda:1, shape: torch.Size([2, 985, 151936]), dtype: torch.float32
[Step 191] Student model device: cuda:1
[Step 191] GPU 0 memory before teacher forward: 16.39 GB
[Step 191] GPU 0 memory after moving inputs: 16.39 GB
[Step 191] GPU 0 memory after teacher forward: 16.99 GB
[Step 191] Teacher logits shape: torch.Size([2, 985, 151936]), dtype: torch.float16
[Step 191] Teacher logits device before move: cuda:0
[Step 191] Target device (student_logits.device): cuda:1
[Step 191] GPU 0 memory after moving logits to GPU 1: 16.99 GB
[Step 191] Teacher logits device after move: cuda:1, shape: torch.Size([2, 985, 151936])
[Step 191] GPU 0 memory after del: 16.39 GB
[Step 191] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 191] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 37.88 GB
[Step 191] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 191] Sequence length: 985, Batch size: 2
[Step 191] After KL computation - GPU 1: 40.27 GB
[Step 191] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 201] ========== MEMORY DEBUG ==========
[Step 201] Model device: cuda:1
[Step 201] Input device: cuda:1
[Step 201] Teacher model device: cuda:0
[Step 201] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 201] GPU 1 memory: 33.76 GB (reserved: 47.67 GB)
[Step 201] Student logits device: cuda:1, shape: torch.Size([2, 598, 151936]), dtype: torch.float32
[Step 201] Student model device: cuda:1
[Step 201] GPU 0 memory before teacher forward: 16.39 GB
[Step 201] GPU 0 memory after moving inputs: 16.39 GB
[Step 201] GPU 0 memory after teacher forward: 16.76 GB
[Step 201] Teacher logits shape: torch.Size([2, 598, 151936]), dtype: torch.float16
[Step 201] Teacher logits device before move: cuda:0
[Step 201] Target device (student_logits.device): cuda:1
[Step 201] GPU 0 memory after moving logits to GPU 1: 16.76 GB
[Step 201] Teacher logits device after move: cuda:1, shape: torch.Size([2, 598, 151936])
[Step 201] GPU 0 memory after del: 16.39 GB
[Step 201] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 201] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 36.51 GB
[Step 201] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 201] Sequence length: 598, Batch size: 2
[Step 201] After KL computation - GPU 1: 37.96 GB
[Step 201] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 211] ========== MEMORY DEBUG ==========
[Step 211] Model device: cuda:1
[Step 211] Input device: cuda:1
[Step 211] Teacher model device: cuda:0
[Step 211] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 211] GPU 1 memory: 33.76 GB (reserved: 47.44 GB)
[Step 211] Student logits device: cuda:1, shape: torch.Size([2, 484, 151936]), dtype: torch.float32
[Step 211] Student model device: cuda:1
[Step 211] GPU 0 memory before teacher forward: 16.39 GB
[Step 211] GPU 0 memory after moving inputs: 16.39 GB
[Step 211] GPU 0 memory after teacher forward: 16.69 GB
[Step 211] Teacher logits shape: torch.Size([2, 484, 151936]), dtype: torch.float16
[Step 211] Teacher logits device before move: cuda:0
[Step 211] Target device (student_logits.device): cuda:1
[Step 211] GPU 0 memory after moving logits to GPU 1: 16.69 GB
[Step 211] Teacher logits device after move: cuda:1, shape: torch.Size([2, 484, 151936])
[Step 211] GPU 0 memory after del: 16.39 GB
[Step 211] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 211] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 36.10 GB
[Step 211] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 211] Sequence length: 484, Batch size: 2
[Step 211] After KL computation - GPU 1: 37.28 GB
[Step 211] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 221] ========== MEMORY DEBUG ==========
[Step 221] Model device: cuda:1
[Step 221] Input device: cuda:1
[Step 221] Teacher model device: cuda:0
[Step 221] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 221] GPU 1 memory: 33.76 GB (reserved: 48.01 GB)
[Step 221] Student logits device: cuda:1, shape: torch.Size([2, 559, 151936]), dtype: torch.float32
[Step 221] Student model device: cuda:1
[Step 221] GPU 0 memory before teacher forward: 16.39 GB
[Step 221] GPU 0 memory after moving inputs: 16.39 GB
[Step 221] GPU 0 memory after teacher forward: 16.73 GB
[Step 221] Teacher logits shape: torch.Size([2, 559, 151936]), dtype: torch.float16
[Step 221] Teacher logits device before move: cuda:0
[Step 221] Target device (student_logits.device): cuda:1
[Step 221] GPU 0 memory after moving logits to GPU 1: 16.73 GB
[Step 221] Teacher logits device after move: cuda:1, shape: torch.Size([2, 559, 151936])
[Step 221] GPU 0 memory after del: 16.39 GB
[Step 221] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 221] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 36.37 GB
[Step 221] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 221] Sequence length: 559, Batch size: 2
[Step 221] After KL computation - GPU 1: 37.72 GB
[Step 221] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 231] ========== MEMORY DEBUG ==========
[Step 231] Model device: cuda:1
[Step 231] Input device: cuda:1
[Step 231] Teacher model device: cuda:0
[Step 231] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 231] GPU 1 memory: 33.77 GB (reserved: 44.78 GB)
[Step 231] Student logits device: cuda:1, shape: torch.Size([2, 1020, 151936]), dtype: torch.float32
[Step 231] Student model device: cuda:1
[Step 231] GPU 0 memory before teacher forward: 16.39 GB
[Step 231] GPU 0 memory after moving inputs: 16.39 GB
[Step 231] GPU 0 memory after teacher forward: 17.01 GB
[Step 231] Teacher logits shape: torch.Size([2, 1020, 151936]), dtype: torch.float16
[Step 231] Teacher logits device before move: cuda:0
[Step 231] Target device (student_logits.device): cuda:1
[Step 231] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 231] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1020, 151936])
[Step 231] GPU 0 memory after del: 16.39 GB
[Step 231] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 231] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 231] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 231] Sequence length: 1020, Batch size: 2
[Step 231] After KL computation - GPU 1: 40.49 GB
[Step 231] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 241] ========== MEMORY DEBUG ==========
[Step 241] Model device: cuda:1
[Step 241] Input device: cuda:1
[Step 241] Teacher model device: cuda:0
[Step 241] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 241] GPU 1 memory: 25.33 GB (reserved: 48.00 GB)
[Step 241] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 241] Student model device: cuda:1
[Step 241] GPU 0 memory before teacher forward: 16.39 GB
[Step 241] GPU 0 memory after moving inputs: 16.39 GB
[Step 241] GPU 0 memory after teacher forward: 17.01 GB
[Step 241] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 241] Teacher logits device before move: cuda:0
[Step 241] Target device (student_logits.device): cuda:1
[Step 241] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 241] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 241] GPU 0 memory after del: 16.39 GB
[Step 241] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 241] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 29.58 GB
[Step 241] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 241] Sequence length: 1024, Batch size: 2
[Step 241] After KL computation - GPU 1: 32.06 GB
[Step 241] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 251] ========== MEMORY DEBUG ==========
[Step 251] Model device: cuda:1
[Step 251] Input device: cuda:1
[Step 251] Teacher model device: cuda:0
[Step 251] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 251] GPU 1 memory: 33.76 GB (reserved: 47.54 GB)
[Step 251] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 251] Student model device: cuda:1
[Step 251] GPU 0 memory before teacher forward: 16.39 GB
[Step 251] GPU 0 memory after moving inputs: 16.39 GB
[Step 251] GPU 0 memory after teacher forward: 17.01 GB
[Step 251] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 251] Teacher logits device before move: cuda:0
[Step 251] Target device (student_logits.device): cuda:1
[Step 251] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 251] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 251] GPU 0 memory after del: 16.39 GB
[Step 251] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 251] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 251] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 251] Sequence length: 1024, Batch size: 2
[Step 251] After KL computation - GPU 1: 40.50 GB
[Step 251] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 261] ========== MEMORY DEBUG ==========
[Step 261] Model device: cuda:1
[Step 261] Input device: cuda:1
[Step 261] Teacher model device: cuda:0
[Step 261] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 261] GPU 1 memory: 33.76 GB (reserved: 47.79 GB)
[Step 261] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 261] Student model device: cuda:1
[Step 261] GPU 0 memory before teacher forward: 16.39 GB
[Step 261] GPU 0 memory after moving inputs: 16.39 GB
[Step 261] GPU 0 memory after teacher forward: 17.01 GB
[Step 261] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 261] Teacher logits device before move: cuda:0
[Step 261] Target device (student_logits.device): cuda:1
[Step 261] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 261] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 261] GPU 0 memory after del: 16.39 GB
[Step 261] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 261] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 261] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 261] Sequence length: 1024, Batch size: 2
[Step 261] After KL computation - GPU 1: 40.50 GB
[Step 261] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 271] ========== MEMORY DEBUG ==========
[Step 271] Model device: cuda:1
[Step 271] Input device: cuda:1
[Step 271] Teacher model device: cuda:0
[Step 271] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 271] GPU 1 memory: 33.76 GB (reserved: 47.68 GB)
[Step 271] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 271] Student model device: cuda:1
[Step 271] GPU 0 memory before teacher forward: 16.39 GB
[Step 271] GPU 0 memory after moving inputs: 16.39 GB
[Step 271] GPU 0 memory after teacher forward: 17.01 GB
[Step 271] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 271] Teacher logits device before move: cuda:0
[Step 271] Target device (student_logits.device): cuda:1
[Step 271] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 271] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 271] GPU 0 memory after del: 16.39 GB
[Step 271] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 271] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 271] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 271] Sequence length: 1024, Batch size: 2
[Step 271] After KL computation - GPU 1: 40.50 GB
[Step 271] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 281] ========== MEMORY DEBUG ==========
[Step 281] Model device: cuda:1
[Step 281] Input device: cuda:1
[Step 281] Teacher model device: cuda:0
[Step 281] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 281] GPU 1 memory: 33.76 GB (reserved: 47.54 GB)
[Step 281] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 281] Student model device: cuda:1
[Step 281] GPU 0 memory before teacher forward: 16.39 GB
[Step 281] GPU 0 memory after moving inputs: 16.39 GB
[Step 281] GPU 0 memory after teacher forward: 17.01 GB
[Step 281] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 281] Teacher logits device before move: cuda:0
[Step 281] Target device (student_logits.device): cuda:1
[Step 281] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 281] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 281] GPU 0 memory after del: 16.39 GB
[Step 281] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 281] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 281] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 281] Sequence length: 1024, Batch size: 2
[Step 281] After KL computation - GPU 1: 40.50 GB
[Step 281] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 291] ========== MEMORY DEBUG ==========
[Step 291] Model device: cuda:1
[Step 291] Input device: cuda:1
[Step 291] Teacher model device: cuda:0
[Step 291] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 291] GPU 1 memory: 33.76 GB (reserved: 41.03 GB)
[Step 291] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 291] Student model device: cuda:1
[Step 291] GPU 0 memory before teacher forward: 16.39 GB
[Step 291] GPU 0 memory after moving inputs: 16.39 GB
[Step 291] GPU 0 memory after teacher forward: 17.01 GB
[Step 291] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 291] Teacher logits device before move: cuda:0
[Step 291] Target device (student_logits.device): cuda:1
[Step 291] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 291] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 291] GPU 0 memory after del: 16.39 GB
[Step 291] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 291] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 291] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 291] Sequence length: 1024, Batch size: 2
[Step 291] After KL computation - GPU 1: 40.50 GB
[Step 291] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 301] ========== MEMORY DEBUG ==========
[Step 301] Model device: cuda:1
[Step 301] Input device: cuda:1
[Step 301] Teacher model device: cuda:0
[Step 301] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 301] GPU 1 memory: 33.76 GB (reserved: 47.58 GB)
[Step 301] Student logits device: cuda:1, shape: torch.Size([2, 929, 151936]), dtype: torch.float32
[Step 301] Student model device: cuda:1
[Step 301] GPU 0 memory before teacher forward: 16.39 GB
[Step 301] GPU 0 memory after moving inputs: 16.39 GB
[Step 301] GPU 0 memory after teacher forward: 16.96 GB
[Step 301] Teacher logits shape: torch.Size([2, 929, 151936]), dtype: torch.float16
[Step 301] Teacher logits device before move: cuda:0
[Step 301] Target device (student_logits.device): cuda:1
[Step 301] GPU 0 memory after moving logits to GPU 1: 16.96 GB
[Step 301] Teacher logits device after move: cuda:1, shape: torch.Size([2, 929, 151936])
[Step 301] GPU 0 memory after del: 16.39 GB
[Step 301] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 301] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 37.68 GB
[Step 301] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 301] Sequence length: 929, Batch size: 2
[Step 301] After KL computation - GPU 1: 39.93 GB
[Step 301] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 311] ========== MEMORY DEBUG ==========
[Step 311] Model device: cuda:1
[Step 311] Input device: cuda:1
[Step 311] Teacher model device: cuda:0
[Step 311] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 311] GPU 1 memory: 33.77 GB (reserved: 47.80 GB)
[Step 311] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 311] Student model device: cuda:1
[Step 311] GPU 0 memory before teacher forward: 16.39 GB
[Step 311] GPU 0 memory after moving inputs: 16.39 GB
[Step 311] GPU 0 memory after teacher forward: 17.01 GB
[Step 311] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 311] Teacher logits device before move: cuda:0
[Step 311] Target device (student_logits.device): cuda:1
[Step 311] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 311] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 311] GPU 0 memory after del: 16.39 GB
[Step 311] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 311] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.02 GB
[Step 311] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 311] Sequence length: 1024, Batch size: 2
[Step 311] After KL computation - GPU 1: 40.51 GB
[Step 311] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 9.5e-06, 'epoch': 0.0}

[Step 321] ========== MEMORY DEBUG ==========
[Step 321] Model device: cuda:1
[Step 321] Input device: cuda:1
[Step 321] Teacher model device: cuda:0
[Step 321] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 321] GPU 1 memory: 25.33 GB (reserved: 47.71 GB)
[Step 321] Student logits device: cuda:1, shape: torch.Size([2, 468, 151936]), dtype: torch.float32
[Step 321] Student model device: cuda:1
[Step 321] GPU 0 memory before teacher forward: 16.39 GB
[Step 321] GPU 0 memory after moving inputs: 16.39 GB
[Step 321] GPU 0 memory after teacher forward: 16.68 GB
[Step 321] Teacher logits shape: torch.Size([2, 468, 151936]), dtype: torch.float16
[Step 321] Teacher logits device before move: cuda:0
[Step 321] Target device (student_logits.device): cuda:1
[Step 321] GPU 0 memory after moving logits to GPU 1: 16.68 GB
[Step 321] Teacher logits device after move: cuda:1, shape: torch.Size([2, 468, 151936])
[Step 321] GPU 0 memory after del: 16.39 GB
[Step 321] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 321] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 27.61 GB
[Step 321] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 321] Sequence length: 468, Batch size: 2
[Step 321] After KL computation - GPU 1: 28.75 GB
[Step 321] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 331] ========== MEMORY DEBUG ==========
[Step 331] Model device: cuda:1
[Step 331] Input device: cuda:1
[Step 331] Teacher model device: cuda:0
[Step 331] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 331] GPU 1 memory: 33.77 GB (reserved: 47.80 GB)
[Step 331] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 331] Student model device: cuda:1
[Step 331] GPU 0 memory before teacher forward: 16.39 GB
[Step 331] GPU 0 memory after moving inputs: 16.39 GB
[Step 331] GPU 0 memory after teacher forward: 17.01 GB
[Step 331] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 331] Teacher logits device before move: cuda:0
[Step 331] Target device (student_logits.device): cuda:1
[Step 331] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 331] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 331] GPU 0 memory after del: 16.39 GB
[Step 331] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 331] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.02 GB
[Step 331] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 331] Sequence length: 1024, Batch size: 2
[Step 331] After KL computation - GPU 1: 40.51 GB
[Step 331] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 341] ========== MEMORY DEBUG ==========
[Step 341] Model device: cuda:1
[Step 341] Input device: cuda:1
[Step 341] Teacher model device: cuda:0
[Step 341] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 341] GPU 1 memory: 33.77 GB (reserved: 48.10 GB)
[Step 341] Student logits device: cuda:1, shape: torch.Size([2, 719, 151936]), dtype: torch.float32
[Step 341] Student model device: cuda:1
[Step 341] GPU 0 memory before teacher forward: 16.39 GB
[Step 341] GPU 0 memory after moving inputs: 16.39 GB
[Step 341] GPU 0 memory after teacher forward: 16.83 GB
[Step 341] Teacher logits shape: torch.Size([2, 719, 151936]), dtype: torch.float16
[Step 341] Teacher logits device before move: cuda:0
[Step 341] Target device (student_logits.device): cuda:1
[Step 341] GPU 0 memory after moving logits to GPU 1: 16.83 GB
[Step 341] Teacher logits device after move: cuda:1, shape: torch.Size([2, 719, 151936])
[Step 341] GPU 0 memory after del: 16.39 GB
[Step 341] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 341] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 36.93 GB
[Step 341] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 341] Sequence length: 719, Batch size: 2
[Step 341] After KL computation - GPU 1: 38.68 GB
[Step 341] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 351] ========== MEMORY DEBUG ==========
[Step 351] Model device: cuda:1
[Step 351] Input device: cuda:1
[Step 351] Teacher model device: cuda:0
[Step 351] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 351] GPU 1 memory: 33.77 GB (reserved: 47.95 GB)
[Step 351] Student logits device: cuda:1, shape: torch.Size([2, 258, 151936]), dtype: torch.float32
[Step 351] Student model device: cuda:1
[Step 351] GPU 0 memory before teacher forward: 16.39 GB
[Step 351] GPU 0 memory after moving inputs: 16.39 GB
[Step 351] GPU 0 memory after teacher forward: 16.55 GB
[Step 351] Teacher logits shape: torch.Size([2, 258, 151936]), dtype: torch.float16
[Step 351] Teacher logits device before move: cuda:0
[Step 351] Target device (student_logits.device): cuda:1
[Step 351] GPU 0 memory after moving logits to GPU 1: 16.55 GB
[Step 351] Teacher logits device after move: cuda:1, shape: torch.Size([2, 258, 151936])
[Step 351] GPU 0 memory after del: 16.39 GB
[Step 351] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 351] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 35.31 GB
[Step 351] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 351] Sequence length: 258, Batch size: 2
[Step 351] After KL computation - GPU 1: 35.93 GB
[Step 351] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 361] ========== MEMORY DEBUG ==========
[Step 361] Model device: cuda:1
[Step 361] Input device: cuda:1
[Step 361] Teacher model device: cuda:0
[Step 361] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 361] GPU 1 memory: 33.76 GB (reserved: 47.54 GB)
[Step 361] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 361] Student model device: cuda:1
[Step 361] GPU 0 memory before teacher forward: 16.39 GB
[Step 361] GPU 0 memory after moving inputs: 16.39 GB
[Step 361] GPU 0 memory after teacher forward: 17.01 GB
[Step 361] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 361] Teacher logits device before move: cuda:0
[Step 361] Target device (student_logits.device): cuda:1
[Step 361] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 361] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 361] GPU 0 memory after del: 16.39 GB
[Step 361] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 361] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.02 GB
[Step 361] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 361] Sequence length: 1024, Batch size: 2
[Step 361] After KL computation - GPU 1: 40.51 GB
[Step 361] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 371] ========== MEMORY DEBUG ==========
[Step 371] Model device: cuda:1
[Step 371] Input device: cuda:1
[Step 371] Teacher model device: cuda:0
[Step 371] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 371] GPU 1 memory: 33.76 GB (reserved: 47.73 GB)
[Step 371] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 371] Student model device: cuda:1
[Step 371] GPU 0 memory before teacher forward: 16.39 GB
[Step 371] GPU 0 memory after moving inputs: 16.39 GB
[Step 371] GPU 0 memory after teacher forward: 17.01 GB
[Step 371] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 371] Teacher logits device before move: cuda:0
[Step 371] Target device (student_logits.device): cuda:1
[Step 371] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 371] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 371] GPU 0 memory after del: 16.39 GB
[Step 371] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 371] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.02 GB
[Step 371] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 371] Sequence length: 1024, Batch size: 2
[Step 371] After KL computation - GPU 1: 40.51 GB
[Step 371] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 381] ========== MEMORY DEBUG ==========
[Step 381] Model device: cuda:1
[Step 381] Input device: cuda:1
[Step 381] Teacher model device: cuda:0
[Step 381] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 381] GPU 1 memory: 33.76 GB (reserved: 47.67 GB)
[Step 381] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 381] Student model device: cuda:1
[Step 381] GPU 0 memory before teacher forward: 16.39 GB
[Step 381] GPU 0 memory after moving inputs: 16.39 GB
[Step 381] GPU 0 memory after teacher forward: 17.01 GB
[Step 381] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 381] Teacher logits device before move: cuda:0
[Step 381] Target device (student_logits.device): cuda:1
[Step 381] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 381] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 381] GPU 0 memory after del: 16.39 GB
[Step 381] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 381] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.02 GB
[Step 381] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 381] Sequence length: 1024, Batch size: 2
[Step 381] After KL computation - GPU 1: 40.51 GB
[Step 381] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(

[Step 391] ========== MEMORY DEBUG ==========
[Step 391] Model device: cuda:1
[Step 391] Input device: cuda:1
[Step 391] Teacher model device: cuda:0
[Step 391] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 391] GPU 1 memory: 33.76 GB (reserved: 47.54 GB)
[Step 391] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 391] Student model device: cuda:1
[Step 391] GPU 0 memory before teacher forward: 16.39 GB
[Step 391] GPU 0 memory after moving inputs: 16.39 GB
[Step 391] GPU 0 memory after teacher forward: 17.01 GB
[Step 391] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 391] Teacher logits device before move: cuda:0
[Step 391] Target device (student_logits.device): cuda:1
[Step 391] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 391] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 391] GPU 0 memory after del: 16.39 GB
[Step 391] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 391] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 391] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 391] Sequence length: 1024, Batch size: 2
[Step 391] After KL computation - GPU 1: 40.50 GB
[Step 391] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  0%|                                                                                       | 25/10000 [08:06<54:45:15, 19.76s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None

[Step 401] ========== MEMORY DEBUG ==========
[Step 401] Model device: cuda:1
[Step 401] Input device: cuda:1
[Step 401] Teacher model device: cuda:0
[Step 401] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 401] GPU 1 memory: 25.33 GB (reserved: 42.66 GB)
  warnings.warn(
[Step 401] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 401] Student model device: cuda:1
[Step 401] GPU 0 memory before teacher forward: 16.39 GB
[Step 401] GPU 0 memory after moving inputs: 16.39 GB
[Step 401] GPU 0 memory after teacher forward: 17.01 GB
[Step 401] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 401] Teacher logits device before move: cuda:0
[Step 401] Target device (student_logits.device): cuda:1
[Step 401] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 401] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 401] GPU 0 memory after del: 16.39 GB
[Step 401] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 401] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 29.58 GB
[Step 401] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 401] Sequence length: 1024, Batch size: 2
[Step 401] After KL computation - GPU 1: 32.07 GB
[Step 401] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 411] ========== MEMORY DEBUG ==========
[Step 411] Model device: cuda:1
[Step 411] Input device: cuda:1
[Step 411] Teacher model device: cuda:0
[Step 411] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 411] GPU 1 memory: 33.76 GB (reserved: 47.64 GB)
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
[Step 411] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 411] Student model device: cuda:1
[Step 411] GPU 0 memory before teacher forward: 16.39 GB
[Step 411] GPU 0 memory after moving inputs: 16.39 GB
[Step 411] GPU 0 memory after teacher forward: 17.01 GB
[Step 411] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 411] Teacher logits device before move: cuda:0
[Step 411] Target device (student_logits.device): cuda:1
[Step 411] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 411] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 411] GPU 0 memory after del: 16.39 GB
[Step 411] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 411] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.02 GB
[Step 411] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 411] Sequence length: 1024, Batch size: 2
[Step 411] After KL computation - GPU 1: 40.50 GB
[Step 411] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  0%|                                                                                       | 26/10000 [08:28<56:42:09, 20.47s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 421] ========== MEMORY DEBUG ==========
[Step 421] Model device: cuda:1
[Step 421] Input device: cuda:1
[Step 421] Teacher model device: cuda:0
[Step 421] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 421] GPU 1 memory: 33.76 GB (reserved: 47.47 GB)
[Step 421] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 421] Student model device: cuda:1
[Step 421] GPU 0 memory before teacher forward: 16.39 GB
[Step 421] GPU 0 memory after moving inputs: 16.39 GB
[Step 421] GPU 0 memory after teacher forward: 17.01 GB
[Step 421] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 421] Teacher logits device before move: cuda:0
[Step 421] Target device (student_logits.device): cuda:1
[Step 421] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 421] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 421] GPU 0 memory after del: 16.39 GB
[Step 421] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 421] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 421] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 421] Sequence length: 1024, Batch size: 2
[Step 421] After KL computation - GPU 1: 40.50 GB
[Step 421] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 431] ========== MEMORY DEBUG ==========
[Step 431] Model device: cuda:1
[Step 431] Input device: cuda:1
[Step 431] Teacher model device: cuda:0
[Step 431] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 431] GPU 1 memory: 33.76 GB (reserved: 47.93 GB)
[Step 431] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 431] Student model device: cuda:1
[Step 431] GPU 0 memory before teacher forward: 16.39 GB
[Step 431] GPU 0 memory after moving inputs: 16.39 GB
[Step 431] GPU 0 memory after teacher forward: 17.01 GB
[Step 431] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 431] Teacher logits device before move: cuda:0
[Step 431] Target device (student_logits.device): cuda:1
[Step 431] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 431] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 431] GPU 0 memory after del: 16.39 GB
[Step 431] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 431] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.02 GB
[Step 431] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 431] Sequence length: 1024, Batch size: 2
[Step 431] After KL computation - GPU 1: 40.51 GB
[Step 431] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  0%|                                                                                       | 27/10000 [08:50<58:04:56, 20.97s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 441] ========== MEMORY DEBUG ==========
[Step 441] Model device: cuda:1
[Step 441] Input device: cuda:1
[Step 441] Teacher model device: cuda:0
[Step 441] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 441] GPU 1 memory: 33.76 GB (reserved: 41.60 GB)
[Step 441] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 441] Student model device: cuda:1
[Step 441] GPU 0 memory before teacher forward: 16.39 GB
[Step 441] GPU 0 memory after moving inputs: 16.39 GB
[Step 441] GPU 0 memory after teacher forward: 17.01 GB
[Step 441] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 441] Teacher logits device before move: cuda:0
[Step 441] Target device (student_logits.device): cuda:1
[Step 441] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 441] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 441] GPU 0 memory after del: 16.39 GB
[Step 441] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 441] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 441] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 441] Sequence length: 1024, Batch size: 2
[Step 441] After KL computation - GPU 1: 40.50 GB
[Step 441] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  0%|                                                                                       | 28/10000 [09:13<59:25:08, 21.45s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 451] ========== MEMORY DEBUG ==========
[Step 451] Model device: cuda:1
[Step 451] Input device: cuda:1
[Step 451] Teacher model device: cuda:0
[Step 451] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 451] GPU 1 memory: 33.77 GB (reserved: 48.28 GB)
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
[Step 451] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 451] Student model device: cuda:1
[Step 451] GPU 0 memory before teacher forward: 16.39 GB
[Step 451] GPU 0 memory after moving inputs: 16.39 GB
[Step 451] GPU 0 memory after teacher forward: 17.01 GB
[Step 451] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 451] Teacher logits device before move: cuda:0
[Step 451] Target device (student_logits.device): cuda:1
[Step 451] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 451] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 451] GPU 0 memory after del: 16.39 GB
[Step 451] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 451] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.02 GB
[Step 451] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 451] Sequence length: 1024, Batch size: 2
[Step 451] After KL computation - GPU 1: 40.51 GB
[Step 451] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 461] ========== MEMORY DEBUG ==========
[Step 461] Model device: cuda:1
[Step 461] Input device: cuda:1
[Step 461] Teacher model device: cuda:0
[Step 461] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 461] GPU 1 memory: 33.77 GB (reserved: 48.24 GB)
[Step 461] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 461] Student model device: cuda:1
[Step 461] GPU 0 memory before teacher forward: 16.39 GB
[Step 461] GPU 0 memory after moving inputs: 16.39 GB
[Step 461] GPU 0 memory after teacher forward: 17.01 GB
[Step 461] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 461] Teacher logits device before move: cuda:0
[Step 461] Target device (student_logits.device): cuda:1
[Step 461] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 461] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 461] GPU 0 memory after del: 16.39 GB
[Step 461] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 461] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.02 GB
[Step 461] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 461] Sequence length: 1024, Batch size: 2
[Step 461] After KL computation - GPU 1: 40.50 GB
[Step 461] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  0%|                                                                                       | 29/10000 [09:38<62:09:16, 22.44s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 471] ========== MEMORY DEBUG ==========
[Step 471] Model device: cuda:1
[Step 471] Input device: cuda:1
[Step 471] Teacher model device: cuda:0
[Step 471] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 471] GPU 1 memory: 33.78 GB (reserved: 47.70 GB)
[Step 471] Student logits device: cuda:1, shape: torch.Size([2, 779, 151936]), dtype: torch.float32
[Step 471] Student model device: cuda:1
[Step 471] GPU 0 memory before teacher forward: 16.39 GB
[Step 471] GPU 0 memory after moving inputs: 16.39 GB
[Step 471] GPU 0 memory after teacher forward: 16.87 GB
[Step 471] Teacher logits shape: torch.Size([2, 779, 151936]), dtype: torch.float16
[Step 471] Teacher logits device before move: cuda:0
[Step 471] Target device (student_logits.device): cuda:1
[Step 471] GPU 0 memory after moving logits to GPU 1: 16.87 GB
[Step 471] Teacher logits device after move: cuda:1, shape: torch.Size([2, 779, 151936])
[Step 471] GPU 0 memory after del: 16.39 GB
[Step 471] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 471] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 37.17 GB
[Step 471] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 471] Sequence length: 779, Batch size: 2
[Step 471] After KL computation - GPU 1: 39.06 GB
[Step 471] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  0%|                                                                                       | 30/10000 [09:59<61:16:12, 22.12s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 1.45e-05, 'epoch': 0.0}

[Step 481] ========== MEMORY DEBUG ==========
[Step 481] Model device: cuda:1
[Step 481] Input device: cuda:1
[Step 481] Teacher model device: cuda:0
[Step 481] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 481] GPU 1 memory: 25.33 GB (reserved: 47.41 GB)
[Step 481] Student logits device: cuda:1, shape: torch.Size([2, 321, 151936]), dtype: torch.float32
[Step 481] Student model device: cuda:1
[Step 481] GPU 0 memory before teacher forward: 16.39 GB
[Step 481] GPU 0 memory after moving inputs: 16.39 GB
[Step 481] GPU 0 memory after teacher forward: 16.59 GB
[Step 481] Teacher logits shape: torch.Size([2, 321, 151936]), dtype: torch.float16
[Step 481] Teacher logits device before move: cuda:0
[Step 481] Target device (student_logits.device): cuda:1
[Step 481] GPU 0 memory after moving logits to GPU 1: 16.59 GB
[Step 481] Teacher logits device after move: cuda:1, shape: torch.Size([2, 321, 151936])
[Step 481] GPU 0 memory after del: 16.39 GB
[Step 481] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 481] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 27.09 GB
[Step 481] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 481] Sequence length: 321, Batch size: 2
[Step 481] After KL computation - GPU 1: 27.87 GB
[Step 481] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 491] ========== MEMORY DEBUG ==========
[Step 491] Model device: cuda:1
[Step 491] Input device: cuda:1
[Step 491] Teacher model device: cuda:0
[Step 491] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 491] GPU 1 memory: 33.76 GB (reserved: 47.82 GB)
[Step 491] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 491] Student model device: cuda:1
[Step 491] GPU 0 memory before teacher forward: 16.39 GB
[Step 491] GPU 0 memory after moving inputs: 16.39 GB
[Step 491] GPU 0 memory after teacher forward: 17.01 GB
[Step 491] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 491] Teacher logits device before move: cuda:0
[Step 491] Target device (student_logits.device): cuda:1
[Step 491] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 491] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 491] GPU 0 memory after del: 16.39 GB
[Step 491] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 491] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 491] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 491] Sequence length: 1024, Batch size: 2
[Step 491] After KL computation - GPU 1: 40.50 GB
[Step 491] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  0%|                                                                                       | 31/10000 [10:22<62:17:18, 22.49s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 501] ========== MEMORY DEBUG ==========
[Step 501] Model device: cuda:1
[Step 501] Input device: cuda:1
[Step 501] Teacher model device: cuda:0
[Step 501] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 501] GPU 1 memory: 33.76 GB (reserved: 47.50 GB)
[Step 501] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 501] Student model device: cuda:1
[Step 501] GPU 0 memory before teacher forward: 16.39 GB
[Step 501] GPU 0 memory after moving inputs: 16.39 GB
[Step 501] GPU 0 memory after teacher forward: 17.01 GB
[Step 501] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 501] Teacher logits device before move: cuda:0
[Step 501] Target device (student_logits.device): cuda:1
[Step 501] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 501] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 501] GPU 0 memory after del: 16.39 GB
[Step 501] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 501] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 501] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 501] Sequence length: 1024, Batch size: 2
[Step 501] After KL computation - GPU 1: 40.50 GB
[Step 501] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 511] ========== MEMORY DEBUG ==========
[Step 511] Model device: cuda:1
[Step 511] Input device: cuda:1
[Step 511] Teacher model device: cuda:0
[Step 511] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 511] GPU 1 memory: 33.76 GB (reserved: 46.36 GB)
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
[Step 511] Student logits device: cuda:1, shape: torch.Size([2, 529, 151936]), dtype: torch.float32
[Step 511] Student model device: cuda:1
[Step 511] GPU 0 memory before teacher forward: 16.39 GB
[Step 511] GPU 0 memory after moving inputs: 16.39 GB
[Step 511] GPU 0 memory after teacher forward: 16.71 GB
[Step 511] Teacher logits shape: torch.Size([2, 529, 151936]), dtype: torch.float16
[Step 511] Teacher logits device before move: cuda:0
[Step 511] Target device (student_logits.device): cuda:1
[Step 511] GPU 0 memory after moving logits to GPU 1: 16.71 GB
[Step 511] Teacher logits device after move: cuda:1, shape: torch.Size([2, 529, 151936])
[Step 511] GPU 0 memory after del: 16.39 GB
[Step 511] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 511] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 36.26 GB
[Step 511] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 511] Sequence length: 529, Batch size: 2
[Step 511] After KL computation - GPU 1: 37.55 GB
[Step 511] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  0%|                                                                                       | 32/10000 [10:47<63:54:55, 23.08s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 521] ========== MEMORY DEBUG ==========
[Step 521] Model device: cuda:1
[Step 521] Input device: cuda:1
[Step 521] Teacher model device: cuda:0
[Step 521] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 521] GPU 1 memory: 33.76 GB (reserved: 42.71 GB)
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
[Step 521] Student logits device: cuda:1, shape: torch.Size([2, 740, 151936]), dtype: torch.float32
[Step 521] Student model device: cuda:1
[Step 521] GPU 0 memory before teacher forward: 16.39 GB
[Step 521] GPU 0 memory after moving inputs: 16.39 GB
[Step 521] GPU 0 memory after teacher forward: 16.84 GB
[Step 521] Teacher logits shape: torch.Size([2, 740, 151936]), dtype: torch.float16
[Step 521] Teacher logits device before move: cuda:0
[Step 521] Target device (student_logits.device): cuda:1
[Step 521] GPU 0 memory after moving logits to GPU 1: 16.84 GB
[Step 521] Teacher logits device after move: cuda:1, shape: torch.Size([2, 740, 151936])
[Step 521] GPU 0 memory after del: 16.39 GB
[Step 521] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 521] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 37.01 GB
[Step 521] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 521] Sequence length: 740, Batch size: 2
[Step 521] After KL computation - GPU 1: 38.80 GB
[Step 521] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  0%|                                                                                       | 33/10000 [11:09<63:29:43, 22.93s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None

[Step 531] ========== MEMORY DEBUG ==========
[Step 531] Model device: cuda:1
[Step 531] Input device: cuda:1
[Step 531] Teacher model device: cuda:0
[Step 531] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 531] GPU 1 memory: 33.77 GB (reserved: 46.22 GB)
[Step 531] Student logits device: cuda:1, shape: torch.Size([2, 236, 151936]), dtype: torch.float32
[Step 531] Student model device: cuda:1
[Step 531] GPU 0 memory before teacher forward: 16.39 GB
[Step 531] GPU 0 memory after moving inputs: 16.39 GB
[Step 531] GPU 0 memory after teacher forward: 16.54 GB
[Step 531] Teacher logits shape: torch.Size([2, 236, 151936]), dtype: torch.float16
[Step 531] Teacher logits device before move: cuda:0
[Step 531] Target device (student_logits.device): cuda:1
[Step 531] GPU 0 memory after moving logits to GPU 1: 16.54 GB
[Step 531] Teacher logits device after move: cuda:1, shape: torch.Size([2, 236, 151936])
[Step 531] GPU 0 memory after del: 16.39 GB
[Step 531] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 531] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 35.24 GB
[Step 531] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 531] Sequence length: 236, Batch size: 2
[Step 531] After KL computation - GPU 1: 35.82 GB
[Step 531] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 541] ========== MEMORY DEBUG ==========
[Step 541] Model device: cuda:1
[Step 541] Input device: cuda:1
[Step 541] Teacher model device: cuda:0
[Step 541] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 541] GPU 1 memory: 33.77 GB (reserved: 47.80 GB)
[Step 541] Student logits device: cuda:1, shape: torch.Size([2, 882, 151936]), dtype: torch.float32
[Step 541] Student model device: cuda:1
[Step 541] GPU 0 memory before teacher forward: 16.39 GB
[Step 541] GPU 0 memory after moving inputs: 16.39 GB
[Step 541] GPU 0 memory after teacher forward: 16.93 GB
[Step 541] Teacher logits shape: torch.Size([2, 882, 151936]), dtype: torch.float16
[Step 541] Teacher logits device before move: cuda:0
[Step 541] Target device (student_logits.device): cuda:1
[Step 541] GPU 0 memory after moving logits to GPU 1: 16.93 GB
[Step 541] Teacher logits device after move: cuda:1, shape: torch.Size([2, 882, 151936])
[Step 541] GPU 0 memory after del: 16.39 GB
[Step 541] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 541] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 37.52 GB
[Step 541] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 541] Sequence length: 882, Batch size: 2
[Step 541] After KL computation - GPU 1: 39.67 GB
[Step 541] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  0%|                                                                                       | 34/10000 [11:33<64:09:54, 23.18s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 551] ========== MEMORY DEBUG ==========
[Step 551] Model device: cuda:1
[Step 551] Input device: cuda:1
[Step 551] Teacher model device: cuda:0
[Step 551] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 551] GPU 1 memory: 33.76 GB (reserved: 47.63 GB)
[Step 551] Student logits device: cuda:1, shape: torch.Size([2, 475, 151936]), dtype: torch.float32
[Step 551] Student model device: cuda:1
[Step 551] GPU 0 memory before teacher forward: 16.39 GB
[Step 551] GPU 0 memory after moving inputs: 16.39 GB
[Step 551] GPU 0 memory after teacher forward: 16.68 GB
[Step 551] Teacher logits shape: torch.Size([2, 475, 151936]), dtype: torch.float16
[Step 551] Teacher logits device before move: cuda:0
[Step 551] Target device (student_logits.device): cuda:1
[Step 551] GPU 0 memory after moving logits to GPU 1: 16.68 GB
[Step 551] Teacher logits device after move: cuda:1, shape: torch.Size([2, 475, 151936])
[Step 551] GPU 0 memory after del: 16.39 GB
[Step 551] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 551] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 36.07 GB
[Step 551] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 551] Sequence length: 475, Batch size: 2
[Step 551] After KL computation - GPU 1: 37.22 GB
[Step 551] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  0%|                                                                                       | 35/10000 [11:56<63:43:05, 23.02s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None

[Step 561] ========== MEMORY DEBUG ==========
[Step 561] Model device: cuda:1
[Step 561] Input device: cuda:1
[Step 561] Teacher model device: cuda:0
[Step 561] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 561] GPU 1 memory: 25.33 GB (reserved: 43.85 GB)
  warnings.warn(
[Step 561] Student logits device: cuda:1, shape: torch.Size([2, 497, 151936]), dtype: torch.float32
[Step 561] Student model device: cuda:1
[Step 561] GPU 0 memory before teacher forward: 16.39 GB
[Step 561] GPU 0 memory after moving inputs: 16.39 GB
[Step 561] GPU 0 memory after teacher forward: 16.69 GB
[Step 561] Teacher logits shape: torch.Size([2, 497, 151936]), dtype: torch.float16
[Step 561] Teacher logits device before move: cuda:0
[Step 561] Target device (student_logits.device): cuda:1
[Step 561] GPU 0 memory after moving logits to GPU 1: 16.69 GB
[Step 561] Teacher logits device after move: cuda:1, shape: torch.Size([2, 497, 151936])
[Step 561] GPU 0 memory after del: 16.39 GB
[Step 561] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 561] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 27.71 GB
[Step 561] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 561] Sequence length: 497, Batch size: 2
[Step 561] After KL computation - GPU 1: 28.92 GB
[Step 561] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 571] ========== MEMORY DEBUG ==========
[Step 571] Model device: cuda:1
[Step 571] Input device: cuda:1
[Step 571] Teacher model device: cuda:0
[Step 571] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 571] GPU 1 memory: 33.77 GB (reserved: 48.08 GB)
[Step 571] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 571] Student model device: cuda:1
[Step 571] GPU 0 memory before teacher forward: 16.39 GB
[Step 571] GPU 0 memory after moving inputs: 16.39 GB
[Step 571] GPU 0 memory after teacher forward: 17.01 GB
[Step 571] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 571] Teacher logits device before move: cuda:0
[Step 571] Target device (student_logits.device): cuda:1
[Step 571] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 571] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 571] GPU 0 memory after del: 16.39 GB
[Step 571] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 571] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.02 GB
[Step 571] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 571] Sequence length: 1024, Batch size: 2
[Step 571] After KL computation - GPU 1: 40.51 GB
[Step 571] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  0%|                                                                                       | 36/10000 [12:18<63:12:43, 22.84s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None

[Step 581] ========== MEMORY DEBUG ==========
[Step 581] Model device: cuda:1
[Step 581] Input device: cuda:1
[Step 581] Teacher model device: cuda:0
[Step 581] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 581] GPU 1 memory: 33.76 GB (reserved: 43.06 GB)
[Step 581] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 581] Student model device: cuda:1
[Step 581] GPU 0 memory before teacher forward: 16.39 GB
[Step 581] GPU 0 memory after moving inputs: 16.39 GB
[Step 581] GPU 0 memory after teacher forward: 17.01 GB
[Step 581] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 581] Teacher logits device before move: cuda:0
[Step 581] Target device (student_logits.device): cuda:1
[Step 581] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 581] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 581] GPU 0 memory after del: 16.39 GB
[Step 581] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 581] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 581] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 581] Sequence length: 1024, Batch size: 2
[Step 581] After KL computation - GPU 1: 40.50 GB
[Step 581] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(

[Step 591] ========== MEMORY DEBUG ==========
[Step 591] Model device: cuda:1
[Step 591] Input device: cuda:1
[Step 591] Teacher model device: cuda:0
[Step 591] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 591] GPU 1 memory: 33.76 GB (reserved: 47.06 GB)
[Step 591] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 591] Student model device: cuda:1
[Step 591] GPU 0 memory before teacher forward: 16.39 GB
[Step 591] GPU 0 memory after moving inputs: 16.39 GB
[Step 591] GPU 0 memory after teacher forward: 17.01 GB
[Step 591] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 591] Teacher logits device before move: cuda:0
[Step 591] Target device (student_logits.device): cuda:1
[Step 591] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 591] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 591] GPU 0 memory after del: 16.39 GB
[Step 591] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 591] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 591] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 591] Sequence length: 1024, Batch size: 2
[Step 591] After KL computation - GPU 1: 40.50 GB
[Step 591] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  0%|                                                                                       | 37/10000 [12:40<62:07:32, 22.45s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 601] ========== MEMORY DEBUG ==========
[Step 601] Model device: cuda:1
[Step 601] Input device: cuda:1
[Step 601] Teacher model device: cuda:0
[Step 601] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 601] GPU 1 memory: 33.77 GB (reserved: 40.86 GB)
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
[Step 601] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 601] Student model device: cuda:1
[Step 601] GPU 0 memory before teacher forward: 16.39 GB
[Step 601] GPU 0 memory after moving inputs: 16.39 GB
[Step 601] GPU 0 memory after teacher forward: 17.01 GB
[Step 601] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 601] Teacher logits device before move: cuda:0
[Step 601] Target device (student_logits.device): cuda:1
[Step 601] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 601] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 601] GPU 0 memory after del: 16.39 GB
[Step 601] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 601] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.02 GB
[Step 601] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 601] Sequence length: 1024, Batch size: 2
[Step 601] After KL computation - GPU 1: 40.51 GB
[Step 601] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  0%|                                                                                       | 38/10000 [13:01<60:56:25, 22.02s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 611] ========== MEMORY DEBUG ==========
[Step 611] Model device: cuda:1
[Step 611] Input device: cuda:1
[Step 611] Teacher model device: cuda:0
[Step 611] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 611] GPU 1 memory: 33.76 GB (reserved: 47.69 GB)
[Step 611] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 611] Student model device: cuda:1
[Step 611] GPU 0 memory before teacher forward: 16.39 GB
[Step 611] GPU 0 memory after moving inputs: 16.39 GB
[Step 611] GPU 0 memory after teacher forward: 17.01 GB
[Step 611] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 611] Teacher logits device before move: cuda:0
[Step 611] Target device (student_logits.device): cuda:1
[Step 611] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 611] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 611] GPU 0 memory after del: 16.39 GB
[Step 611] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 611] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 611] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 611] Sequence length: 1024, Batch size: 2
[Step 611] After KL computation - GPU 1: 40.50 GB
[Step 611] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 621] ========== MEMORY DEBUG ==========
[Step 621] Model device: cuda:1
[Step 621] Input device: cuda:1
[Step 621] Teacher model device: cuda:0
[Step 621] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 621] GPU 1 memory: 33.76 GB (reserved: 43.97 GB)
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
[Step 621] Student logits device: cuda:1, shape: torch.Size([2, 973, 151936]), dtype: torch.float32
[Step 621] Student model device: cuda:1
[Step 621] GPU 0 memory before teacher forward: 16.39 GB
[Step 621] GPU 0 memory after moving inputs: 16.39 GB
[Step 621] GPU 0 memory after teacher forward: 16.98 GB
[Step 621] Teacher logits shape: torch.Size([2, 973, 151936]), dtype: torch.float16
[Step 621] Teacher logits device before move: cuda:0
[Step 621] Target device (student_logits.device): cuda:1
[Step 621] GPU 0 memory after moving logits to GPU 1: 16.98 GB
[Step 621] Teacher logits device after move: cuda:1, shape: torch.Size([2, 973, 151936])
[Step 621] GPU 0 memory after del: 16.39 GB
[Step 621] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 621] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 37.84 GB
[Step 621] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 621] Sequence length: 973, Batch size: 2
[Step 621] After KL computation - GPU 1: 40.20 GB
[Step 621] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  0%|                                                                                       | 39/10000 [13:23<61:27:43, 22.21s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 631] ========== MEMORY DEBUG ==========
[Step 631] Model device: cuda:1
[Step 631] Input device: cuda:1
[Step 631] Teacher model device: cuda:0
[Step 631] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 631] GPU 1 memory: 33.76 GB (reserved: 47.91 GB)
[Step 631] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 631] Student model device: cuda:1
[Step 631] GPU 0 memory before teacher forward: 16.39 GB
[Step 631] GPU 0 memory after moving inputs: 16.39 GB
[Step 631] GPU 0 memory after teacher forward: 17.01 GB
[Step 631] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 631] Teacher logits device before move: cuda:0
[Step 631] Target device (student_logits.device): cuda:1
[Step 631] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 631] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 631] GPU 0 memory after del: 16.39 GB
[Step 631] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 631] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 631] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 631] Sequence length: 1024, Batch size: 2
[Step 631] After KL computation - GPU 1: 40.50 GB
[Step 631] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  0%|                                                                                       | 40/10000 [13:45<61:10:55, 22.11s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 1.9500000000000003e-05, 'epoch': 0.0}

[Step 641] ========== MEMORY DEBUG ==========
[Step 641] Model device: cuda:1
[Step 641] Input device: cuda:1
[Step 641] Teacher model device: cuda:0
[Step 641] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 641] GPU 1 memory: 25.33 GB (reserved: 47.83 GB)
[Step 641] Student logits device: cuda:1, shape: torch.Size([2, 748, 151936]), dtype: torch.float32
[Step 641] Student model device: cuda:1
[Step 641] GPU 0 memory before teacher forward: 16.39 GB
[Step 641] GPU 0 memory after moving inputs: 16.39 GB
[Step 641] GPU 0 memory after teacher forward: 16.85 GB
[Step 641] Teacher logits shape: torch.Size([2, 748, 151936]), dtype: torch.float16
[Step 641] Teacher logits device before move: cuda:0
[Step 641] Target device (student_logits.device): cuda:1
[Step 641] GPU 0 memory after moving logits to GPU 1: 16.85 GB
[Step 641] Teacher logits device after move: cuda:1, shape: torch.Size([2, 748, 151936])
[Step 641] GPU 0 memory after del: 16.39 GB
[Step 641] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 641] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 28.60 GB
[Step 641] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 641] Sequence length: 748, Batch size: 2
[Step 641] After KL computation - GPU 1: 30.42 GB
[Step 641] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 651] ========== MEMORY DEBUG ==========
[Step 651] Model device: cuda:1
[Step 651] Input device: cuda:1
[Step 651] Teacher model device: cuda:0
[Step 651] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 651] GPU 1 memory: 33.77 GB (reserved: 47.88 GB)
[Step 651] Student logits device: cuda:1, shape: torch.Size([2, 722, 151936]), dtype: torch.float32
[Step 651] Student model device: cuda:1
[Step 651] GPU 0 memory before teacher forward: 16.39 GB
[Step 651] GPU 0 memory after moving inputs: 16.39 GB
[Step 651] GPU 0 memory after teacher forward: 16.83 GB
[Step 651] Teacher logits shape: torch.Size([2, 722, 151936]), dtype: torch.float16
[Step 651] Teacher logits device before move: cuda:0
[Step 651] Target device (student_logits.device): cuda:1
[Step 651] GPU 0 memory after moving logits to GPU 1: 16.83 GB
[Step 651] Teacher logits device after move: cuda:1, shape: torch.Size([2, 722, 151936])
[Step 651] GPU 0 memory after del: 16.39 GB
[Step 651] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 651] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 36.95 GB
[Step 651] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 651] Sequence length: 722, Batch size: 2
[Step 651] After KL computation - GPU 1: 38.70 GB
[Step 651] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  0%|                                                                                       | 41/10000 [14:09<62:07:11, 22.46s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 661] ========== MEMORY DEBUG ==========
[Step 661] Model device: cuda:1
[Step 661] Input device: cuda:1
[Step 661] Teacher model device: cuda:0
[Step 661] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 661] GPU 1 memory: 33.77 GB (reserved: 47.64 GB)
[Step 661] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 661] Student model device: cuda:1
[Step 661] GPU 0 memory before teacher forward: 16.39 GB
[Step 661] GPU 0 memory after moving inputs: 16.39 GB
[Step 661] GPU 0 memory after teacher forward: 17.01 GB
[Step 661] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 661] Teacher logits device before move: cuda:0
[Step 661] Target device (student_logits.device): cuda:1
[Step 661] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 661] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 661] GPU 0 memory after del: 16.39 GB
[Step 661] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 661] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.02 GB
[Step 661] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 661] Sequence length: 1024, Batch size: 2
[Step 661] After KL computation - GPU 1: 40.51 GB
[Step 661] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 671] ========== MEMORY DEBUG ==========
[Step 671] Model device: cuda:1
[Step 671] Input device: cuda:1
[Step 671] Teacher model device: cuda:0
[Step 671] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 671] GPU 1 memory: 33.77 GB (reserved: 41.42 GB)
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
[Step 671] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 671] Student model device: cuda:1
[Step 671] GPU 0 memory before teacher forward: 16.39 GB
[Step 671] GPU 0 memory after moving inputs: 16.39 GB
[Step 671] GPU 0 memory after teacher forward: 17.01 GB
[Step 671] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 671] Teacher logits device before move: cuda:0
[Step 671] Target device (student_logits.device): cuda:1
[Step 671] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 671] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 671] GPU 0 memory after del: 16.39 GB
[Step 671] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 671] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.02 GB
[Step 671] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 671] Sequence length: 1024, Batch size: 2
[Step 671] After KL computation - GPU 1: 40.51 GB
[Step 671] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  0%|                                                                                       | 42/10000 [14:31<61:53:50, 22.38s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 681] ========== MEMORY DEBUG ==========
[Step 681] Model device: cuda:1
[Step 681] Input device: cuda:1
[Step 681] Teacher model device: cuda:0
[Step 681] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 681] GPU 1 memory: 33.76 GB (reserved: 47.35 GB)
[Step 681] Student logits device: cuda:1, shape: torch.Size([2, 876, 151936]), dtype: torch.float32
[Step 681] Student model device: cuda:1
[Step 681] GPU 0 memory before teacher forward: 16.39 GB
[Step 681] GPU 0 memory after moving inputs: 16.39 GB
[Step 681] GPU 0 memory after teacher forward: 16.92 GB
[Step 681] Teacher logits shape: torch.Size([2, 876, 151936]), dtype: torch.float16
[Step 681] Teacher logits device before move: cuda:0
[Step 681] Target device (student_logits.device): cuda:1
[Step 681] GPU 0 memory after moving logits to GPU 1: 16.92 GB
[Step 681] Teacher logits device after move: cuda:1, shape: torch.Size([2, 876, 151936])
[Step 681] GPU 0 memory after del: 16.39 GB
[Step 681] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 681] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 37.49 GB
[Step 681] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 681] Sequence length: 876, Batch size: 2
[Step 681] After KL computation - GPU 1: 39.62 GB
[Step 681] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  0%|                                                                                       | 43/10000 [14:54<63:01:29, 22.79s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None

[Step 691] ========== MEMORY DEBUG ==========
[Step 691] Model device: cuda:1
[Step 691] Input device: cuda:1
[Step 691] Teacher model device: cuda:0
[Step 691] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 691] GPU 1 memory: 33.76 GB (reserved: 47.47 GB)
[Step 691] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 691] Student model device: cuda:1
[Step 691] GPU 0 memory before teacher forward: 16.39 GB
[Step 691] GPU 0 memory after moving inputs: 16.39 GB
[Step 691] GPU 0 memory after teacher forward: 17.01 GB
[Step 691] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 691] Teacher logits device before move: cuda:0
[Step 691] Target device (student_logits.device): cuda:1
[Step 691] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 691] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 691] GPU 0 memory after del: 16.39 GB
[Step 691] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 691] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 691] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 691] Sequence length: 1024, Batch size: 2
[Step 691] After KL computation - GPU 1: 40.50 GB
[Step 691] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(

[Step 701] ========== MEMORY DEBUG ==========
[Step 701] Model device: cuda:1
[Step 701] Input device: cuda:1
[Step 701] Teacher model device: cuda:0
[Step 701] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 701] GPU 1 memory: 33.76 GB (reserved: 44.02 GB)
[Step 701] Student logits device: cuda:1, shape: torch.Size([2, 580, 151936]), dtype: torch.float32
[Step 701] Student model device: cuda:1
[Step 701] GPU 0 memory before teacher forward: 16.39 GB
[Step 701] GPU 0 memory after moving inputs: 16.39 GB
[Step 701] GPU 0 memory after teacher forward: 16.74 GB
[Step 701] Teacher logits shape: torch.Size([2, 580, 151936]), dtype: torch.float16
[Step 701] Teacher logits device before move: cuda:0
[Step 701] Target device (student_logits.device): cuda:1
[Step 701] GPU 0 memory after moving logits to GPU 1: 16.74 GB
[Step 701] Teacher logits device after move: cuda:1, shape: torch.Size([2, 580, 151936])
[Step 701] GPU 0 memory after del: 16.39 GB
[Step 701] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 701] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 36.44 GB
[Step 701] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 701] Sequence length: 580, Batch size: 2
[Step 701] After KL computation - GPU 1: 37.85 GB
[Step 701] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  0%|                                                                                       | 44/10000 [15:17<62:39:38, 22.66s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 711] ========== MEMORY DEBUG ==========
[Step 711] Model device: cuda:1
[Step 711] Input device: cuda:1
[Step 711] Teacher model device: cuda:0
[Step 711] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 711] GPU 1 memory: 33.76 GB (reserved: 47.72 GB)
[Step 711] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 711] Student model device: cuda:1
[Step 711] GPU 0 memory before teacher forward: 16.39 GB
[Step 711] GPU 0 memory after moving inputs: 16.39 GB
[Step 711] GPU 0 memory after teacher forward: 17.01 GB
[Step 711] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 711] Teacher logits device before move: cuda:0
[Step 711] Target device (student_logits.device): cuda:1
[Step 711] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 711] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 711] GPU 0 memory after del: 16.39 GB
[Step 711] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 711] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 711] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 711] Sequence length: 1024, Batch size: 2
[Step 711] After KL computation - GPU 1: 40.50 GB
[Step 711] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  0%|                                                                                       | 45/10000 [15:37<60:58:53, 22.05s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None

[Step 721] ========== MEMORY DEBUG ==========
[Step 721] Model device: cuda:1
[Step 721] Input device: cuda:1
[Step 721] Teacher model device: cuda:0
[Step 721] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 721] GPU 1 memory: 25.33 GB (reserved: 47.66 GB)
[Step 721] Student logits device: cuda:1, shape: torch.Size([2, 400, 151936]), dtype: torch.float32
[Step 721] Student model device: cuda:1
[Step 721] GPU 0 memory before teacher forward: 16.39 GB
[Step 721] GPU 0 memory after moving inputs: 16.39 GB
[Step 721] GPU 0 memory after teacher forward: 16.64 GB
[Step 721] Teacher logits shape: torch.Size([2, 400, 151936]), dtype: torch.float16
[Step 721] Teacher logits device before move: cuda:0
[Step 721] Target device (student_logits.device): cuda:1
[Step 721] GPU 0 memory after moving logits to GPU 1: 16.64 GB
[Step 721] Teacher logits device after move: cuda:1, shape: torch.Size([2, 400, 151936])
[Step 721] GPU 0 memory after del: 16.39 GB
[Step 721] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 721] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 27.37 GB
[Step 721] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 721] Sequence length: 400, Batch size: 2
[Step 721] After KL computation - GPU 1: 28.34 GB
[Step 721] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 731] ========== MEMORY DEBUG ==========
[Step 731] Model device: cuda:1
[Step 731] Input device: cuda:1
[Step 731] Teacher model device: cuda:0
[Step 731] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 731] GPU 1 memory: 33.77 GB (reserved: 47.92 GB)
[Step 731] Student logits device: cuda:1, shape: torch.Size([2, 604, 151936]), dtype: torch.float32
[Step 731] Student model device: cuda:1
[Step 731] GPU 0 memory before teacher forward: 16.39 GB
[Step 731] GPU 0 memory after moving inputs: 16.39 GB
[Step 731] GPU 0 memory after teacher forward: 16.76 GB
[Step 731] Teacher logits shape: torch.Size([2, 604, 151936]), dtype: torch.float16
[Step 731] Teacher logits device before move: cuda:0
[Step 731] Target device (student_logits.device): cuda:1
[Step 731] GPU 0 memory after moving logits to GPU 1: 16.76 GB
[Step 731] Teacher logits device after move: cuda:1, shape: torch.Size([2, 604, 151936])
[Step 731] GPU 0 memory after del: 16.39 GB
[Step 731] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 731] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 36.53 GB
[Step 731] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 731] Sequence length: 604, Batch size: 2
[Step 731] After KL computation - GPU 1: 38.00 GB
[Step 731] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  0%|                                                                                       | 46/10000 [16:03<63:31:00, 22.97s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 741] ========== MEMORY DEBUG ==========
[Step 741] Model device: cuda:1
[Step 741] Input device: cuda:1
[Step 741] Teacher model device: cuda:0
[Step 741] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 741] GPU 1 memory: 33.77 GB (reserved: 47.86 GB)
[Step 741] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 741] Student model device: cuda:1
[Step 741] GPU 0 memory before teacher forward: 16.39 GB
[Step 741] GPU 0 memory after moving inputs: 16.39 GB
[Step 741] GPU 0 memory after teacher forward: 17.01 GB
[Step 741] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 741] Teacher logits device before move: cuda:0
[Step 741] Target device (student_logits.device): cuda:1
[Step 741] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 741] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 741] GPU 0 memory after del: 16.39 GB
[Step 741] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 741] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.02 GB
[Step 741] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 741] Sequence length: 1024, Batch size: 2
[Step 741] After KL computation - GPU 1: 40.51 GB
[Step 741] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 751] ========== MEMORY DEBUG ==========
[Step 751] Model device: cuda:1
[Step 751] Input device: cuda:1
[Step 751] Teacher model device: cuda:0
[Step 751] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 751] GPU 1 memory: 33.77 GB (reserved: 47.84 GB)
[Step 751] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 751] Student model device: cuda:1
[Step 751] GPU 0 memory before teacher forward: 16.39 GB
[Step 751] GPU 0 memory after moving inputs: 16.39 GB
[Step 751] GPU 0 memory after teacher forward: 17.01 GB
[Step 751] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 751] Teacher logits device before move: cuda:0
[Step 751] Target device (student_logits.device): cuda:1
[Step 751] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 751] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 751] GPU 0 memory after del: 16.39 GB
[Step 751] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 751] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.02 GB
[Step 751] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 751] Sequence length: 1024, Batch size: 2
[Step 751] After KL computation - GPU 1: 40.51 GB
[Step 751] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  0%|                                                                                       | 47/10000 [16:24<62:35:44, 22.64s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 761] ========== MEMORY DEBUG ==========
[Step 761] Model device: cuda:1
[Step 761] Input device: cuda:1
[Step 761] Teacher model device: cuda:0
[Step 761] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 761] GPU 1 memory: 33.76 GB (reserved: 47.75 GB)
[Step 761] Student logits device: cuda:1, shape: torch.Size([2, 476, 151936]), dtype: torch.float32
[Step 761] Student model device: cuda:1
[Step 761] GPU 0 memory before teacher forward: 16.39 GB
[Step 761] GPU 0 memory after moving inputs: 16.39 GB
[Step 761] GPU 0 memory after teacher forward: 16.68 GB
[Step 761] Teacher logits shape: torch.Size([2, 476, 151936]), dtype: torch.float16
[Step 761] Teacher logits device before move: cuda:0
[Step 761] Target device (student_logits.device): cuda:1
[Step 761] GPU 0 memory after moving logits to GPU 1: 16.68 GB
[Step 761] Teacher logits device after move: cuda:1, shape: torch.Size([2, 476, 151936])
[Step 761] GPU 0 memory after del: 16.39 GB
[Step 761] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 761] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 36.07 GB
[Step 761] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 761] Sequence length: 476, Batch size: 2
[Step 761] After KL computation - GPU 1: 37.23 GB
[Step 761] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  0%|                                                                                       | 48/10000 [16:46<61:59:54, 22.43s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 771] ========== MEMORY DEBUG ==========
[Step 771] Model device: cuda:1
[Step 771] Input device: cuda:1
[Step 771] Teacher model device: cuda:0
[Step 771] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 771] GPU 1 memory: 33.76 GB (reserved: 46.24 GB)
[Step 771] Student logits device: cuda:1, shape: torch.Size([2, 408, 151936]), dtype: torch.float32
[Step 771] Student model device: cuda:1
[Step 771] GPU 0 memory before teacher forward: 16.39 GB
[Step 771] GPU 0 memory after moving inputs: 16.39 GB
[Step 771] GPU 0 memory after teacher forward: 16.64 GB
[Step 771] Teacher logits shape: torch.Size([2, 408, 151936]), dtype: torch.float16
[Step 771] Teacher logits device before move: cuda:0
[Step 771] Target device (student_logits.device): cuda:1
[Step 771] GPU 0 memory after moving logits to GPU 1: 16.64 GB
[Step 771] Teacher logits device after move: cuda:1, shape: torch.Size([2, 408, 151936])
[Step 771] GPU 0 memory after del: 16.39 GB
[Step 771] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 771] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 35.83 GB
[Step 771] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 771] Sequence length: 408, Batch size: 2
[Step 771] After KL computation - GPU 1: 36.82 GB
[Step 771] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 781] ========== MEMORY DEBUG ==========
[Step 781] Model device: cuda:1
[Step 781] Input device: cuda:1
[Step 781] Teacher model device: cuda:0
[Step 781] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 781] GPU 1 memory: 33.76 GB (reserved: 45.75 GB)
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
[Step 781] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 781] Student model device: cuda:1
[Step 781] GPU 0 memory before teacher forward: 16.39 GB
[Step 781] GPU 0 memory after moving inputs: 16.39 GB
[Step 781] GPU 0 memory after teacher forward: 17.01 GB
[Step 781] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 781] Teacher logits device before move: cuda:0
[Step 781] Target device (student_logits.device): cuda:1
[Step 781] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 781] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 781] GPU 0 memory after del: 16.39 GB
[Step 781] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 781] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 781] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 781] Sequence length: 1024, Batch size: 2
[Step 781] After KL computation - GPU 1: 40.50 GB
[Step 781] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  0%|                                                                                       | 49/10000 [17:06<60:03:47, 21.73s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 791] ========== MEMORY DEBUG ==========
[Step 791] Model device: cuda:1
[Step 791] Input device: cuda:1
[Step 791] Teacher model device: cuda:0
[Step 791] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 791] GPU 1 memory: 33.77 GB (reserved: 44.18 GB)
[Step 791] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 791] Student model device: cuda:1
[Step 791] GPU 0 memory before teacher forward: 16.39 GB
[Step 791] GPU 0 memory after moving inputs: 16.39 GB
[Step 791] GPU 0 memory after teacher forward: 17.01 GB
[Step 791] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 791] Teacher logits device before move: cuda:0
[Step 791] Target device (student_logits.device): cuda:1
[Step 791] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 791] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 791] GPU 0 memory after del: 16.39 GB
[Step 791] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 791] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.02 GB
[Step 791] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 791] Sequence length: 1024, Batch size: 2
[Step 791] After KL computation - GPU 1: 40.51 GB
[Step 791] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  0%|                                                                                       | 50/10000 [17:28<59:46:32, 21.63s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 2.45e-05, 'epoch': 0.01}

[Step 801] ========== MEMORY DEBUG ==========
[Step 801] Model device: cuda:1
[Step 801] Input device: cuda:1
[Step 801] Teacher model device: cuda:0
[Step 801] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 801] GPU 1 memory: 25.33 GB (reserved: 44.24 GB)
  warnings.warn(
[Step 801] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 801] Student model device: cuda:1
[Step 801] GPU 0 memory before teacher forward: 16.39 GB
[Step 801] GPU 0 memory after moving inputs: 16.39 GB
[Step 801] GPU 0 memory after teacher forward: 17.01 GB
[Step 801] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 801] Teacher logits device before move: cuda:0
[Step 801] Target device (student_logits.device): cuda:1
[Step 801] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 801] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 801] GPU 0 memory after del: 16.39 GB
[Step 801] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 801] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 29.58 GB
[Step 801] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 801] Sequence length: 1024, Batch size: 2
[Step 801] After KL computation - GPU 1: 32.07 GB
[Step 801] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 811] ========== MEMORY DEBUG ==========
[Step 811] Model device: cuda:1
[Step 811] Input device: cuda:1
[Step 811] Teacher model device: cuda:0
[Step 811] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 811] GPU 1 memory: 33.76 GB (reserved: 47.41 GB)
[Step 811] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 811] Student model device: cuda:1
[Step 811] GPU 0 memory before teacher forward: 16.39 GB
[Step 811] GPU 0 memory after moving inputs: 16.39 GB
[Step 811] GPU 0 memory after teacher forward: 17.01 GB
[Step 811] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 811] Teacher logits device before move: cuda:0
[Step 811] Target device (student_logits.device): cuda:1
[Step 811] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 811] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 811] GPU 0 memory after del: 16.39 GB
[Step 811] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 811] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 811] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 811] Sequence length: 1024, Batch size: 2
[Step 811] After KL computation - GPU 1: 40.50 GB
[Step 811] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  1%|                                                                                       | 51/10000 [17:49<59:44:12, 21.62s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None

[Step 821] ========== MEMORY DEBUG ==========
[Step 821] Model device: cuda:1
[Step 821] Input device: cuda:1
[Step 821] Teacher model device: cuda:0
[Step 821] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 821] GPU 1 memory: 33.76 GB (reserved: 47.45 GB)
[Step 821] Student logits device: cuda:1, shape: torch.Size([2, 568, 151936]), dtype: torch.float32
[Step 821] Student model device: cuda:1
[Step 821] GPU 0 memory before teacher forward: 16.39 GB
[Step 821] GPU 0 memory after moving inputs: 16.39 GB
[Step 821] GPU 0 memory after teacher forward: 16.74 GB
[Step 821] Teacher logits shape: torch.Size([2, 568, 151936]), dtype: torch.float16
[Step 821] Teacher logits device before move: cuda:0
[Step 821] Target device (student_logits.device): cuda:1
[Step 821] GPU 0 memory after moving logits to GPU 1: 16.74 GB
[Step 821] Teacher logits device after move: cuda:1, shape: torch.Size([2, 568, 151936])
[Step 821] GPU 0 memory after del: 16.39 GB
[Step 821] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 821] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 36.40 GB
[Step 821] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 821] Sequence length: 568, Batch size: 2
[Step 821] After KL computation - GPU 1: 37.78 GB
[Step 821] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 831] ========== MEMORY DEBUG ==========
[Step 831] Model device: cuda:1
[Step 831] Input device: cuda:1
[Step 831] Teacher model device: cuda:0
[Step 831] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 831] GPU 1 memory: 33.76 GB (reserved: 47.46 GB)
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
[Step 831] Student logits device: cuda:1, shape: torch.Size([2, 679, 151936]), dtype: torch.float32
[Step 831] Student model device: cuda:1
[Step 831] GPU 0 memory before teacher forward: 16.39 GB
[Step 831] GPU 0 memory after moving inputs: 16.39 GB
[Step 831] GPU 0 memory after teacher forward: 16.81 GB
[Step 831] Teacher logits shape: torch.Size([2, 679, 151936]), dtype: torch.float16
[Step 831] Teacher logits device before move: cuda:0
[Step 831] Target device (student_logits.device): cuda:1
[Step 831] GPU 0 memory after moving logits to GPU 1: 16.81 GB
[Step 831] Teacher logits device after move: cuda:1, shape: torch.Size([2, 679, 151936])
[Step 831] GPU 0 memory after del: 16.39 GB
[Step 831] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 831] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 36.79 GB
[Step 831] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 831] Sequence length: 679, Batch size: 2
[Step 831] After KL computation - GPU 1: 38.44 GB
[Step 831] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  1%|                                                                                       | 52/10000 [18:12<60:23:04, 21.85s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 841] ========== MEMORY DEBUG ==========
[Step 841] Model device: cuda:1
[Step 841] Input device: cuda:1
[Step 841] Teacher model device: cuda:0
[Step 841] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 841] GPU 1 memory: 33.77 GB (reserved: 47.72 GB)
[Step 841] Student logits device: cuda:1, shape: torch.Size([2, 136, 151936]), dtype: torch.float32
[Step 841] Student model device: cuda:1
[Step 841] GPU 0 memory before teacher forward: 16.39 GB
[Step 841] GPU 0 memory after moving inputs: 16.39 GB
[Step 841] GPU 0 memory after teacher forward: 16.47 GB
[Step 841] Teacher logits shape: torch.Size([2, 136, 151936]), dtype: torch.float16
[Step 841] Teacher logits device before move: cuda:0
[Step 841] Target device (student_logits.device): cuda:1
[Step 841] GPU 0 memory after moving logits to GPU 1: 16.47 GB
[Step 841] Teacher logits device after move: cuda:1, shape: torch.Size([2, 136, 151936])
[Step 841] GPU 0 memory after del: 16.39 GB
[Step 841] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 841] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 34.88 GB
[Step 841] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 841] Sequence length: 136, Batch size: 2
[Step 841] After KL computation - GPU 1: 35.21 GB
[Step 841] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  1%|                                                                                       | 53/10000 [18:34<60:23:34, 21.86s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None

[Step 851] ========== MEMORY DEBUG ==========
[Step 851] Model device: cuda:1
[Step 851] Input device: cuda:1
[Step 851] Teacher model device: cuda:0
[Step 851] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 851] GPU 1 memory: 33.76 GB (reserved: 47.39 GB)
[Step 851] Student logits device: cuda:1, shape: torch.Size([2, 508, 151936]), dtype: torch.float32
[Step 851] Student model device: cuda:1
[Step 851] GPU 0 memory before teacher forward: 16.39 GB
[Step 851] GPU 0 memory after moving inputs: 16.39 GB
[Step 851] GPU 0 memory after teacher forward: 16.70 GB
[Step 851] Teacher logits shape: torch.Size([2, 508, 151936]), dtype: torch.float16
[Step 851] Teacher logits device before move: cuda:0
[Step 851] Target device (student_logits.device): cuda:1
[Step 851] GPU 0 memory after moving logits to GPU 1: 16.70 GB
[Step 851] Teacher logits device after move: cuda:1, shape: torch.Size([2, 508, 151936])
[Step 851] GPU 0 memory after del: 16.39 GB
[Step 851] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 851] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 36.18 GB
[Step 851] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 851] Sequence length: 508, Batch size: 2
[Step 851] After KL computation - GPU 1: 37.42 GB
[Step 851] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 861] ========== MEMORY DEBUG ==========
[Step 861] Model device: cuda:1
[Step 861] Input device: cuda:1
[Step 861] Teacher model device: cuda:0
[Step 861] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 861] GPU 1 memory: 33.76 GB (reserved: 47.51 GB)
[Step 861] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 861] Student model device: cuda:1
[Step 861] GPU 0 memory before teacher forward: 16.39 GB
[Step 861] GPU 0 memory after moving inputs: 16.39 GB
[Step 861] GPU 0 memory after teacher forward: 17.01 GB
[Step 861] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 861] Teacher logits device before move: cuda:0
[Step 861] Target device (student_logits.device): cuda:1
[Step 861] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 861] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 861] GPU 0 memory after del: 16.39 GB
[Step 861] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 861] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 861] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 861] Sequence length: 1024, Batch size: 2
[Step 861] After KL computation - GPU 1: 40.50 GB
[Step 861] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  1%|                                                                                       | 54/10000 [18:56<60:47:24, 22.00s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 871] ========== MEMORY DEBUG ==========
[Step 871] Model device: cuda:1
[Step 871] Input device: cuda:1
[Step 871] Teacher model device: cuda:0
[Step 871] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 871] GPU 1 memory: 33.76 GB (reserved: 47.60 GB)
[Step 871] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 871] Student model device: cuda:1
[Step 871] GPU 0 memory before teacher forward: 16.39 GB
[Step 871] GPU 0 memory after moving inputs: 16.39 GB
[Step 871] GPU 0 memory after teacher forward: 17.01 GB
[Step 871] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 871] Teacher logits device before move: cuda:0
[Step 871] Target device (student_logits.device): cuda:1
[Step 871] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 871] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 871] GPU 0 memory after del: 16.39 GB
[Step 871] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 871] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 871] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 871] Sequence length: 1024, Batch size: 2
[Step 871] After KL computation - GPU 1: 40.50 GB
[Step 871] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  1%|                                                                                       | 55/10000 [19:18<60:46:45, 22.00s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None

[Step 881] ========== MEMORY DEBUG ==========
[Step 881] Model device: cuda:1
[Step 881] Input device: cuda:1
[Step 881] Teacher model device: cuda:0
[Step 881] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 881] GPU 1 memory: 25.33 GB (reserved: 47.35 GB)
[Step 881] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 881] Student model device: cuda:1
[Step 881] GPU 0 memory before teacher forward: 16.39 GB
[Step 881] GPU 0 memory after moving inputs: 16.39 GB
[Step 881] GPU 0 memory after teacher forward: 17.01 GB
[Step 881] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 881] Teacher logits device before move: cuda:0
[Step 881] Target device (student_logits.device): cuda:1
[Step 881] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 881] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 881] GPU 0 memory after del: 16.39 GB
[Step 881] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 881] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 29.58 GB
[Step 881] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 881] Sequence length: 1024, Batch size: 2
[Step 881] After KL computation - GPU 1: 32.07 GB
[Step 881] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 891] ========== MEMORY DEBUG ==========
[Step 891] Model device: cuda:1
[Step 891] Input device: cuda:1
[Step 891] Teacher model device: cuda:0
[Step 891] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 891] GPU 1 memory: 33.76 GB (reserved: 47.58 GB)
[Step 891] Student logits device: cuda:1, shape: torch.Size([2, 755, 151936]), dtype: torch.float32
[Step 891] Student model device: cuda:1
[Step 891] GPU 0 memory before teacher forward: 16.39 GB
[Step 891] GPU 0 memory after moving inputs: 16.39 GB
[Step 891] GPU 0 memory after teacher forward: 16.85 GB
[Step 891] Teacher logits shape: torch.Size([2, 755, 151936]), dtype: torch.float16
[Step 891] Teacher logits device before move: cuda:0
[Step 891] Target device (student_logits.device): cuda:1
[Step 891] GPU 0 memory after moving logits to GPU 1: 16.85 GB
[Step 891] Teacher logits device after move: cuda:1, shape: torch.Size([2, 755, 151936])
[Step 891] GPU 0 memory after del: 16.39 GB
[Step 891] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 891] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 37.06 GB
[Step 891] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 891] Sequence length: 755, Batch size: 2
[Step 891] After KL computation - GPU 1: 38.89 GB
[Step 891] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  1%|                                                                                       | 56/10000 [19:40<60:34:12, 21.93s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None

[Step 901] ========== MEMORY DEBUG ==========
[Step 901] Model device: cuda:1
[Step 901] Input device: cuda:1
[Step 901] Teacher model device: cuda:0
[Step 901] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 901] GPU 1 memory: 33.76 GB (reserved: 47.69 GB)
[Step 901] Student logits device: cuda:1, shape: torch.Size([2, 544, 151936]), dtype: torch.float32
[Step 901] Student model device: cuda:1
[Step 901] GPU 0 memory before teacher forward: 16.39 GB
[Step 901] GPU 0 memory after moving inputs: 16.39 GB
[Step 901] GPU 0 memory after teacher forward: 16.72 GB
[Step 901] Teacher logits shape: torch.Size([2, 544, 151936]), dtype: torch.float16
[Step 901] Teacher logits device before move: cuda:0
[Step 901] Target device (student_logits.device): cuda:1
[Step 901] GPU 0 memory after moving logits to GPU 1: 16.72 GB
[Step 901] Teacher logits device after move: cuda:1, shape: torch.Size([2, 544, 151936])
[Step 901] GPU 0 memory after del: 16.39 GB
[Step 901] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 901] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 36.31 GB
[Step 901] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 901] Sequence length: 544, Batch size: 2
[Step 901] After KL computation - GPU 1: 37.63 GB
[Step 901] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 911] ========== MEMORY DEBUG ==========
[Step 911] Model device: cuda:1
[Step 911] Input device: cuda:1
[Step 911] Teacher model device: cuda:0
[Step 911] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 911] GPU 1 memory: 33.76 GB (reserved: 47.68 GB)
[Step 911] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 911] Student model device: cuda:1
[Step 911] GPU 0 memory before teacher forward: 16.39 GB
[Step 911] GPU 0 memory after moving inputs: 16.39 GB
[Step 911] GPU 0 memory after teacher forward: 17.01 GB
[Step 911] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 911] Teacher logits device before move: cuda:0
[Step 911] Target device (student_logits.device): cuda:1
[Step 911] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 911] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 911] GPU 0 memory after del: 16.39 GB
[Step 911] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 911] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 911] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 911] Sequence length: 1024, Batch size: 2
[Step 911] After KL computation - GPU 1: 40.50 GB
[Step 911] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  1%|                                                                                       | 57/10000 [20:02<60:25:47, 21.88s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 921] ========== MEMORY DEBUG ==========
[Step 921] Model device: cuda:1
[Step 921] Input device: cuda:1
[Step 921] Teacher model device: cuda:0
[Step 921] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 921] GPU 1 memory: 33.78 GB (reserved: 44.39 GB)
[Step 921] Student logits device: cuda:1, shape: torch.Size([2, 242, 151936]), dtype: torch.float32
[Step 921] Student model device: cuda:1
[Step 921] GPU 0 memory before teacher forward: 16.39 GB
[Step 921] GPU 0 memory after moving inputs: 16.39 GB
[Step 921] GPU 0 memory after teacher forward: 16.54 GB
[Step 921] Teacher logits shape: torch.Size([2, 242, 151936]), dtype: torch.float16
[Step 921] Teacher logits device before move: cuda:0
[Step 921] Target device (student_logits.device): cuda:1
[Step 921] GPU 0 memory after moving logits to GPU 1: 16.54 GB
[Step 921] Teacher logits device after move: cuda:1, shape: torch.Size([2, 242, 151936])
[Step 921] GPU 0 memory after del: 16.39 GB
[Step 921] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 921] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 35.26 GB
[Step 921] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 921] Sequence length: 242, Batch size: 2
[Step 921] After KL computation - GPU 1: 35.85 GB
[Step 921] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  1%|                                                                                       | 58/10000 [20:23<59:38:01, 21.59s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None

[Step 931] ========== MEMORY DEBUG ==========
[Step 931] Model device: cuda:1
[Step 931] Input device: cuda:1
[Step 931] Teacher model device: cuda:0
[Step 931] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 931] GPU 1 memory: 33.77 GB (reserved: 46.31 GB)
[Step 931] Student logits device: cuda:1, shape: torch.Size([2, 635, 151936]), dtype: torch.float32
[Step 931] Student model device: cuda:1
[Step 931] GPU 0 memory before teacher forward: 16.39 GB
[Step 931] GPU 0 memory after moving inputs: 16.39 GB
[Step 931] GPU 0 memory after teacher forward: 16.78 GB
[Step 931] Teacher logits shape: torch.Size([2, 635, 151936]), dtype: torch.float16
[Step 931] Teacher logits device before move: cuda:0
[Step 931] Target device (student_logits.device): cuda:1
[Step 931] GPU 0 memory after moving logits to GPU 1: 16.78 GB
[Step 931] Teacher logits device after move: cuda:1, shape: torch.Size([2, 635, 151936])
[Step 931] GPU 0 memory after del: 16.39 GB
[Step 931] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 931] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 36.64 GB
[Step 931] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 931] Sequence length: 635, Batch size: 2
[Step 931] After KL computation - GPU 1: 38.18 GB
[Step 931] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 941] ========== MEMORY DEBUG ==========
[Step 941] Model device: cuda:1
[Step 941] Input device: cuda:1
[Step 941] Teacher model device: cuda:0
[Step 941] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 941] GPU 1 memory: 33.77 GB (reserved: 47.91 GB)
[Step 941] Student logits device: cuda:1, shape: torch.Size([2, 906, 151936]), dtype: torch.float32
[Step 941] Student model device: cuda:1
[Step 941] GPU 0 memory before teacher forward: 16.39 GB
[Step 941] GPU 0 memory after moving inputs: 16.39 GB
[Step 941] GPU 0 memory after teacher forward: 16.94 GB
[Step 941] Teacher logits shape: torch.Size([2, 906, 151936]), dtype: torch.float16
[Step 941] Teacher logits device before move: cuda:0
[Step 941] Target device (student_logits.device): cuda:1
[Step 941] GPU 0 memory after moving logits to GPU 1: 16.94 GB
[Step 941] Teacher logits device after move: cuda:1, shape: torch.Size([2, 906, 151936])
[Step 941] GPU 0 memory after del: 16.39 GB
[Step 941] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 941] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 37.60 GB
[Step 941] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 941] Sequence length: 906, Batch size: 2
[Step 941] After KL computation - GPU 1: 39.80 GB
[Step 941] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  1%|                                                                                       | 59/10000 [20:46<60:53:10, 22.05s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 951] ========== MEMORY DEBUG ==========
[Step 951] Model device: cuda:1
[Step 951] Input device: cuda:1
[Step 951] Teacher model device: cuda:0
[Step 951] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 951] GPU 1 memory: 33.77 GB (reserved: 47.83 GB)
[Step 951] Student logits device: cuda:1, shape: torch.Size([2, 900, 151936]), dtype: torch.float32
[Step 951] Student model device: cuda:1
[Step 951] GPU 0 memory before teacher forward: 16.39 GB
[Step 951] GPU 0 memory after moving inputs: 16.39 GB
[Step 951] GPU 0 memory after teacher forward: 16.94 GB
[Step 951] Teacher logits shape: torch.Size([2, 900, 151936]), dtype: torch.float16
[Step 951] Teacher logits device before move: cuda:0
[Step 951] Target device (student_logits.device): cuda:1
[Step 951] GPU 0 memory after moving logits to GPU 1: 16.94 GB
[Step 951] Teacher logits device after move: cuda:1, shape: torch.Size([2, 900, 151936])
[Step 951] GPU 0 memory after del: 16.39 GB
[Step 951] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 951] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 37.58 GB
[Step 951] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 951] Sequence length: 900, Batch size: 2
[Step 951] After KL computation - GPU 1: 39.77 GB
[Step 951] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  1%|                                                                                       | 60/10000 [21:07<60:25:15, 21.88s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 2.95e-05, 'epoch': 0.01}

[Step 961] ========== MEMORY DEBUG ==========
[Step 961] Model device: cuda:1
[Step 961] Input device: cuda:1
[Step 961] Teacher model device: cuda:0
[Step 961] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 961] GPU 1 memory: 25.33 GB (reserved: 47.74 GB)
[Step 961] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 961] Student model device: cuda:1
[Step 961] GPU 0 memory before teacher forward: 16.39 GB
[Step 961] GPU 0 memory after moving inputs: 16.39 GB
[Step 961] GPU 0 memory after teacher forward: 17.01 GB
[Step 961] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 961] Teacher logits device before move: cuda:0
[Step 961] Target device (student_logits.device): cuda:1
[Step 961] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 961] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 961] GPU 0 memory after del: 16.39 GB
[Step 961] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 961] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 29.58 GB
[Step 961] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 961] Sequence length: 1024, Batch size: 2
[Step 961] After KL computation - GPU 1: 32.07 GB
[Step 961] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 971] ========== MEMORY DEBUG ==========
[Step 971] Model device: cuda:1
[Step 971] Input device: cuda:1
[Step 971] Teacher model device: cuda:0
[Step 971] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 971] GPU 1 memory: 33.76 GB (reserved: 42.09 GB)
[Step 971] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 971] Student model device: cuda:1
[Step 971] GPU 0 memory before teacher forward: 16.39 GB
[Step 971] GPU 0 memory after moving inputs: 16.39 GB
[Step 971] GPU 0 memory after teacher forward: 17.01 GB
[Step 971] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 971] Teacher logits device before move: cuda:0
[Step 971] Target device (student_logits.device): cuda:1
[Step 971] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 971] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 971] GPU 0 memory after del: 16.39 GB
[Step 971] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 971] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 971] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 971] Sequence length: 1024, Batch size: 2
[Step 971] After KL computation - GPU 1: 40.50 GB
[Step 971] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  1%|                                                                                       | 61/10000 [21:28<59:35:26, 21.58s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 981] ========== MEMORY DEBUG ==========
[Step 981] Model device: cuda:1
[Step 981] Input device: cuda:1
[Step 981] Teacher model device: cuda:0
[Step 981] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 981] GPU 1 memory: 33.76 GB (reserved: 45.91 GB)
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
[Step 981] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 981] Student model device: cuda:1
[Step 981] GPU 0 memory before teacher forward: 16.39 GB
[Step 981] GPU 0 memory after moving inputs: 16.39 GB
[Step 981] GPU 0 memory after teacher forward: 17.01 GB
[Step 981] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 981] Teacher logits device before move: cuda:0
[Step 981] Target device (student_logits.device): cuda:1
[Step 981] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 981] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 981] GPU 0 memory after del: 16.39 GB
[Step 981] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 981] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 981] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 981] Sequence length: 1024, Batch size: 2
[Step 981] After KL computation - GPU 1: 40.50 GB
[Step 981] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 991] ========== MEMORY DEBUG ==========
[Step 991] Model device: cuda:1
[Step 991] Input device: cuda:1
[Step 991] Teacher model device: cuda:0
[Step 991] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 991] GPU 1 memory: 33.76 GB (reserved: 47.92 GB)
[Step 991] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 991] Student model device: cuda:1
[Step 991] GPU 0 memory before teacher forward: 16.39 GB
[Step 991] GPU 0 memory after moving inputs: 16.39 GB
[Step 991] GPU 0 memory after teacher forward: 17.01 GB
[Step 991] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 991] Teacher logits device before move: cuda:0
[Step 991] Target device (student_logits.device): cuda:1
[Step 991] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 991] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 991] GPU 0 memory after del: 16.39 GB
[Step 991] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 991] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 991] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 991] Sequence length: 1024, Batch size: 2
[Step 991] After KL computation - GPU 1: 40.50 GB
[Step 991] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  1%|                                                                                       | 62/10000 [21:50<59:34:23, 21.58s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 1001] ========== MEMORY DEBUG ==========
[Step 1001] Model device: cuda:1
[Step 1001] Input device: cuda:1
[Step 1001] Teacher model device: cuda:0
[Step 1001] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 1001] GPU 1 memory: 33.76 GB (reserved: 40.15 GB)
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
[Step 1001] Student logits device: cuda:1, shape: torch.Size([2, 671, 151936]), dtype: torch.float32
[Step 1001] Student model device: cuda:1
[Step 1001] GPU 0 memory before teacher forward: 16.39 GB
[Step 1001] GPU 0 memory after moving inputs: 16.39 GB
[Step 1001] GPU 0 memory after teacher forward: 16.80 GB
[Step 1001] Teacher logits shape: torch.Size([2, 671, 151936]), dtype: torch.float16
[Step 1001] Teacher logits device before move: cuda:0
[Step 1001] Target device (student_logits.device): cuda:1
[Step 1001] GPU 0 memory after moving logits to GPU 1: 16.80 GB
[Step 1001] Teacher logits device after move: cuda:1, shape: torch.Size([2, 671, 151936])
[Step 1001] GPU 0 memory after del: 16.39 GB
[Step 1001] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 1001] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 36.76 GB
[Step 1001] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 1001] Sequence length: 671, Batch size: 2
[Step 1001] After KL computation - GPU 1: 38.39 GB
[Step 1001] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  1%|                                                                                       | 63/10000 [22:13<60:53:39, 22.06s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None

[Step 1011] ========== MEMORY DEBUG ==========
[Step 1011] Model device: cuda:1
[Step 1011] Input device: cuda:1
[Step 1011] Teacher model device: cuda:0
[Step 1011] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 1011] GPU 1 memory: 33.76 GB (reserved: 47.49 GB)
[Step 1011] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 1011] Student model device: cuda:1
[Step 1011] GPU 0 memory before teacher forward: 16.39 GB
[Step 1011] GPU 0 memory after moving inputs: 16.39 GB
[Step 1011] GPU 0 memory after teacher forward: 17.01 GB
[Step 1011] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 1011] Teacher logits device before move: cuda:0
[Step 1011] Target device (student_logits.device): cuda:1
[Step 1011] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 1011] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 1011] GPU 0 memory after del: 16.39 GB
[Step 1011] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 1011] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 1011] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 1011] Sequence length: 1024, Batch size: 2
[Step 1011] After KL computation - GPU 1: 40.50 GB
[Step 1011] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 1021] ========== MEMORY DEBUG ==========
[Step 1021] Model device: cuda:1
[Step 1021] Input device: cuda:1
[Step 1021] Teacher model device: cuda:0
[Step 1021] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 1021] GPU 1 memory: 33.76 GB (reserved: 47.70 GB)
[Step 1021] Student logits device: cuda:1, shape: torch.Size([2, 673, 151936]), dtype: torch.float32
[Step 1021] Student model device: cuda:1
[Step 1021] GPU 0 memory before teacher forward: 16.39 GB
[Step 1021] GPU 0 memory after moving inputs: 16.39 GB
[Step 1021] GPU 0 memory after teacher forward: 16.80 GB
[Step 1021] Teacher logits shape: torch.Size([2, 673, 151936]), dtype: torch.float16
[Step 1021] Teacher logits device before move: cuda:0
[Step 1021] Target device (student_logits.device): cuda:1
[Step 1021] GPU 0 memory after moving logits to GPU 1: 16.80 GB
[Step 1021] Teacher logits device after move: cuda:1, shape: torch.Size([2, 673, 151936])
[Step 1021] GPU 0 memory after del: 16.39 GB
[Step 1021] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 1021] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 36.77 GB
[Step 1021] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 1021] Sequence length: 673, Batch size: 2
[Step 1021] After KL computation - GPU 1: 38.40 GB
[Step 1021] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  1%|                                                                                       | 64/10000 [22:37<62:20:38, 22.59s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None

[Step 1031] ========== MEMORY DEBUG ==========
[Step 1031] Model device: cuda:1
[Step 1031] Input device: cuda:1
[Step 1031] Teacher model device: cuda:0
[Step 1031] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 1031] GPU 1 memory: 33.76 GB (reserved: 47.83 GB)
[Step 1031] Student logits device: cuda:1, shape: torch.Size([2, 711, 151936]), dtype: torch.float32
[Step 1031] Student model device: cuda:1
[Step 1031] GPU 0 memory before teacher forward: 16.39 GB
[Step 1031] GPU 0 memory after moving inputs: 16.39 GB
[Step 1031] GPU 0 memory after teacher forward: 16.82 GB
[Step 1031] Teacher logits shape: torch.Size([2, 711, 151936]), dtype: torch.float16
[Step 1031] Teacher logits device before move: cuda:0
[Step 1031] Target device (student_logits.device): cuda:1
[Step 1031] GPU 0 memory after moving logits to GPU 1: 16.82 GB
[Step 1031] Teacher logits device after move: cuda:1, shape: torch.Size([2, 711, 151936])
[Step 1031] GPU 0 memory after del: 16.39 GB
[Step 1031] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 1031] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 36.90 GB
[Step 1031] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 1031] Sequence length: 711, Batch size: 2
[Step 1031] After KL computation - GPU 1: 38.63 GB
[Step 1031] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(
  1%|                                                                                       | 65/10000 [22:58<61:09:16, 22.16s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None

[Step 1041] ========== MEMORY DEBUG ==========
[Step 1041] Model device: cuda:1
[Step 1041] Input device: cuda:1
[Step 1041] Teacher model device: cuda:0
[Step 1041] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 1041] GPU 1 memory: 25.33 GB (reserved: 47.64 GB)
[Step 1041] Student logits device: cuda:1, shape: torch.Size([2, 449, 151936]), dtype: torch.float32
[Step 1041] Student model device: cuda:1
[Step 1041] GPU 0 memory before teacher forward: 16.39 GB
[Step 1041] GPU 0 memory after moving inputs: 16.39 GB
[Step 1041] GPU 0 memory after teacher forward: 16.67 GB
[Step 1041] Teacher logits shape: torch.Size([2, 449, 151936]), dtype: torch.float16
[Step 1041] Teacher logits device before move: cuda:0
[Step 1041] Target device (student_logits.device): cuda:1
[Step 1041] GPU 0 memory after moving logits to GPU 1: 16.67 GB
[Step 1041] Teacher logits device after move: cuda:1, shape: torch.Size([2, 449, 151936])
[Step 1041] GPU 0 memory after del: 16.39 GB
[Step 1041] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 1041] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 27.54 GB
[Step 1041] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 1041] Sequence length: 449, Batch size: 2
[Step 1041] After KL computation - GPU 1: 28.63 GB
[Step 1041] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 1051] ========== MEMORY DEBUG ==========
[Step 1051] Model device: cuda:1
[Step 1051] Input device: cuda:1
[Step 1051] Teacher model device: cuda:0
[Step 1051] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 1051] GPU 1 memory: 33.77 GB (reserved: 46.90 GB)
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
[Step 1051] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 1051] Student model device: cuda:1
[Step 1051] GPU 0 memory before teacher forward: 16.39 GB
[Step 1051] GPU 0 memory after moving inputs: 16.39 GB
[Step 1051] GPU 0 memory after teacher forward: 17.01 GB
[Step 1051] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 1051] Teacher logits device before move: cuda:0
[Step 1051] Target device (student_logits.device): cuda:1
[Step 1051] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 1051] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 1051] GPU 0 memory after del: 16.39 GB
[Step 1051] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 1051] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.02 GB
[Step 1051] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 1051] Sequence length: 1024, Batch size: 2
[Step 1051] After KL computation - GPU 1: 40.51 GB
[Step 1051] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  1%|                                                                                       | 66/10000 [23:20<61:04:29, 22.13s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None

[Step 1061] ========== MEMORY DEBUG ==========
[Step 1061] Model device: cuda:1
[Step 1061] Input device: cuda:1
[Step 1061] Teacher model device: cuda:0
[Step 1061] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 1061] GPU 1 memory: 33.76 GB (reserved: 47.42 GB)
[Step 1061] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 1061] Student model device: cuda:1
[Step 1061] GPU 0 memory before teacher forward: 16.39 GB
[Step 1061] GPU 0 memory after moving inputs: 16.39 GB
[Step 1061] GPU 0 memory after teacher forward: 17.01 GB
[Step 1061] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 1061] Teacher logits device before move: cuda:0
[Step 1061] Target device (student_logits.device): cuda:1
[Step 1061] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 1061] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 1061] GPU 0 memory after del: 16.39 GB
[Step 1061] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 1061] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 1061] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 1061] Sequence length: 1024, Batch size: 2
[Step 1061] After KL computation - GPU 1: 40.50 GB
[Step 1061] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(

[Step 1071] ========== MEMORY DEBUG ==========
[Step 1071] Model device: cuda:1
[Step 1071] Input device: cuda:1
[Step 1071] Teacher model device: cuda:0
[Step 1071] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 1071] GPU 1 memory: 33.76 GB (reserved: 44.18 GB)
[Step 1071] Student logits device: cuda:1, shape: torch.Size([2, 424, 151936]), dtype: torch.float32
[Step 1071] Student model device: cuda:1
[Step 1071] GPU 0 memory before teacher forward: 16.39 GB
[Step 1071] GPU 0 memory after moving inputs: 16.39 GB
[Step 1071] GPU 0 memory after teacher forward: 16.65 GB
[Step 1071] Teacher logits shape: torch.Size([2, 424, 151936]), dtype: torch.float16
[Step 1071] Teacher logits device before move: cuda:0
[Step 1071] Target device (student_logits.device): cuda:1
[Step 1071] GPU 0 memory after moving logits to GPU 1: 16.65 GB
[Step 1071] Teacher logits device after move: cuda:1, shape: torch.Size([2, 424, 151936])
[Step 1071] GPU 0 memory after del: 16.39 GB
[Step 1071] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 1071] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 35.89 GB
[Step 1071] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 1071] Sequence length: 424, Batch size: 2
[Step 1071] After KL computation - GPU 1: 36.92 GB
[Step 1071] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  1%|                                                                                       | 67/10000 [23:40<59:42:35, 21.64s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 1081] ========== MEMORY DEBUG ==========
[Step 1081] Model device: cuda:1
[Step 1081] Input device: cuda:1
[Step 1081] Teacher model device: cuda:0
[Step 1081] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 1081] GPU 1 memory: 33.76 GB (reserved: 47.59 GB)
[Step 1081] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 1081] Student model device: cuda:1
[Step 1081] GPU 0 memory before teacher forward: 16.39 GB
[Step 1081] GPU 0 memory after moving inputs: 16.39 GB
[Step 1081] GPU 0 memory after teacher forward: 17.01 GB
[Step 1081] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 1081] Teacher logits device before move: cuda:0
[Step 1081] Target device (student_logits.device): cuda:1
[Step 1081] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 1081] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 1081] GPU 0 memory after del: 16.39 GB
[Step 1081] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 1081] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 1081] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 1081] Sequence length: 1024, Batch size: 2
[Step 1081] After KL computation - GPU 1: 40.50 GB
[Step 1081] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  1%|                                                                                       | 68/10000 [24:01<59:10:42, 21.45s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 1091] ========== MEMORY DEBUG ==========
[Step 1091] Model device: cuda:1
[Step 1091] Input device: cuda:1
[Step 1091] Teacher model device: cuda:0
[Step 1091] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 1091] GPU 1 memory: 33.76 GB (reserved: 43.29 GB)
[Step 1091] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 1091] Student model device: cuda:1
[Step 1091] GPU 0 memory before teacher forward: 16.39 GB
[Step 1091] GPU 0 memory after moving inputs: 16.39 GB
[Step 1091] GPU 0 memory after teacher forward: 17.01 GB
[Step 1091] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 1091] Teacher logits device before move: cuda:0
[Step 1091] Target device (student_logits.device): cuda:1
[Step 1091] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 1091] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 1091] GPU 0 memory after del: 16.39 GB
[Step 1091] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 1091] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 1091] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 1091] Sequence length: 1024, Batch size: 2
[Step 1091] After KL computation - GPU 1: 40.50 GB
[Step 1091] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 1101] ========== MEMORY DEBUG ==========
[Step 1101] Model device: cuda:1
[Step 1101] Input device: cuda:1
[Step 1101] Teacher model device: cuda:0
[Step 1101] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 1101] GPU 1 memory: 33.76 GB (reserved: 42.52 GB)
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
[Step 1101] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 1101] Student model device: cuda:1
[Step 1101] GPU 0 memory before teacher forward: 16.39 GB
[Step 1101] GPU 0 memory after moving inputs: 16.39 GB
[Step 1101] GPU 0 memory after teacher forward: 17.01 GB
[Step 1101] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 1101] Teacher logits device before move: cuda:0
[Step 1101] Target device (student_logits.device): cuda:1
[Step 1101] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 1101] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 1101] GPU 0 memory after del: 16.39 GB
[Step 1101] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 1101] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.02 GB
[Step 1101] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 1101] Sequence length: 1024, Batch size: 2
[Step 1101] After KL computation - GPU 1: 40.50 GB
[Step 1101] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  1%|                                                                                       | 69/10000 [24:22<58:45:31, 21.30s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 1111] ========== MEMORY DEBUG ==========
[Step 1111] Model device: cuda:1
[Step 1111] Input device: cuda:1
[Step 1111] Teacher model device: cuda:0
[Step 1111] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 1111] GPU 1 memory: 33.77 GB (reserved: 47.62 GB)
[Step 1111] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 1111] Student model device: cuda:1
[Step 1111] GPU 0 memory before teacher forward: 16.39 GB
[Step 1111] GPU 0 memory after moving inputs: 16.39 GB
[Step 1111] GPU 0 memory after teacher forward: 17.01 GB
[Step 1111] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 1111] Teacher logits device before move: cuda:0
[Step 1111] Target device (student_logits.device): cuda:1
[Step 1111] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 1111] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 1111] GPU 0 memory after del: 16.39 GB
[Step 1111] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 1111] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.02 GB
[Step 1111] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 1111] Sequence length: 1024, Batch size: 2
[Step 1111] After KL computation - GPU 1: 40.50 GB
[Step 1111] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  1%|                                                                                       | 70/10000 [24:44<59:26:07, 21.55s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
{'loss': 3895497169305.6, 'grad_norm': nan, 'learning_rate': 3.45e-05, 'epoch': 0.01}

[Step 1121] ========== MEMORY DEBUG ==========
[Step 1121] Model device: cuda:1
[Step 1121] Input device: cuda:1
[Step 1121] Teacher model device: cuda:0
[Step 1121] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 1121] GPU 1 memory: 25.33 GB (reserved: 46.55 GB)
  warnings.warn(
[Step 1121] Student logits device: cuda:1, shape: torch.Size([2, 1006, 151936]), dtype: torch.float32
[Step 1121] Student model device: cuda:1
[Step 1121] GPU 0 memory before teacher forward: 16.39 GB
[Step 1121] GPU 0 memory after moving inputs: 16.39 GB
[Step 1121] GPU 0 memory after teacher forward: 17.00 GB
[Step 1121] Teacher logits shape: torch.Size([2, 1006, 151936]), dtype: torch.float16
[Step 1121] Teacher logits device before move: cuda:0
[Step 1121] Target device (student_logits.device): cuda:1
[Step 1121] GPU 0 memory after moving logits to GPU 1: 17.00 GB
[Step 1121] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1006, 151936])
[Step 1121] GPU 0 memory after del: 16.39 GB
[Step 1121] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 1121] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 29.51 GB
[Step 1121] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 1121] Sequence length: 1006, Batch size: 2
[Step 1121] After KL computation - GPU 1: 31.96 GB
[Step 1121] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 1131] ========== MEMORY DEBUG ==========
[Step 1131] Model device: cuda:1
[Step 1131] Input device: cuda:1
[Step 1131] Teacher model device: cuda:0
[Step 1131] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 1131] GPU 1 memory: 33.77 GB (reserved: 48.17 GB)
[Step 1131] Student logits device: cuda:1, shape: torch.Size([2, 326, 151936]), dtype: torch.float32
[Step 1131] Student model device: cuda:1
[Step 1131] GPU 0 memory before teacher forward: 16.39 GB
[Step 1131] GPU 0 memory after moving inputs: 16.39 GB
[Step 1131] GPU 0 memory after teacher forward: 16.59 GB
[Step 1131] Teacher logits shape: torch.Size([2, 326, 151936]), dtype: torch.float16
[Step 1131] Teacher logits device before move: cuda:0
[Step 1131] Target device (student_logits.device): cuda:1
[Step 1131] GPU 0 memory after moving logits to GPU 1: 16.59 GB
[Step 1131] Teacher logits device after move: cuda:1, shape: torch.Size([2, 326, 151936])
[Step 1131] GPU 0 memory after del: 16.39 GB
[Step 1131] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 1131] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 35.55 GB
[Step 1131] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 1131] Sequence length: 326, Batch size: 2
[Step 1131] After KL computation - GPU 1: 36.34 GB
[Step 1131] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  1%|                                                                                       | 71/10000 [25:06<59:26:40, 21.55s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 1141] ========== MEMORY DEBUG ==========
[Step 1141] Model device: cuda:1
[Step 1141] Input device: cuda:1
[Step 1141] Teacher model device: cuda:0
[Step 1141] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 1141] GPU 1 memory: 33.76 GB (reserved: 46.27 GB)
[Step 1141] Student logits device: cuda:1, shape: torch.Size([2, 568, 151936]), dtype: torch.float32
[Step 1141] Student model device: cuda:1
[Step 1141] GPU 0 memory before teacher forward: 16.39 GB
[Step 1141] GPU 0 memory after moving inputs: 16.39 GB
[Step 1141] GPU 0 memory after teacher forward: 16.74 GB
[Step 1141] Teacher logits shape: torch.Size([2, 568, 151936]), dtype: torch.float16
[Step 1141] Teacher logits device before move: cuda:0
[Step 1141] Target device (student_logits.device): cuda:1
[Step 1141] GPU 0 memory after moving logits to GPU 1: 16.74 GB
[Step 1141] Teacher logits device after move: cuda:1, shape: torch.Size([2, 568, 151936])
[Step 1141] GPU 0 memory after del: 16.39 GB
[Step 1141] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 1141] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 36.40 GB
[Step 1141] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 1141] Sequence length: 568, Batch size: 2
[Step 1141] After KL computation - GPU 1: 37.78 GB
[Step 1141] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 1151] ========== MEMORY DEBUG ==========
[Step 1151] Model device: cuda:1
[Step 1151] Input device: cuda:1
[Step 1151] Teacher model device: cuda:0
[Step 1151] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 1151] GPU 1 memory: 33.76 GB (reserved: 42.60 GB)
[Step 1151] Student logits device: cuda:1, shape: torch.Size([2, 364, 151936]), dtype: torch.float32
[Step 1151] Student model device: cuda:1
[Step 1151] GPU 0 memory before teacher forward: 16.39 GB
[Step 1151] GPU 0 memory after moving inputs: 16.39 GB
[Step 1151] GPU 0 memory after teacher forward: 16.61 GB
[Step 1151] Teacher logits shape: torch.Size([2, 364, 151936]), dtype: torch.float16
[Step 1151] Teacher logits device before move: cuda:0
[Step 1151] Target device (student_logits.device): cuda:1
[Step 1151] GPU 0 memory after moving logits to GPU 1: 16.61 GB
[Step 1151] Teacher logits device after move: cuda:1, shape: torch.Size([2, 364, 151936])
[Step 1151] GPU 0 memory after del: 16.39 GB
[Step 1151] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 1151] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 35.67 GB
[Step 1151] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 1151] Sequence length: 364, Batch size: 2
[Step 1151] After KL computation - GPU 1: 36.56 GB
[Step 1151] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  1%|                                                                                       | 72/10000 [25:25<57:35:10, 20.88s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 1161] ========== MEMORY DEBUG ==========
[Step 1161] Model device: cuda:1
[Step 1161] Input device: cuda:1
[Step 1161] Teacher model device: cuda:0
[Step 1161] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 1161] GPU 1 memory: 33.76 GB (reserved: 47.63 GB)
[Step 1161] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 1161] Student model device: cuda:1
[Step 1161] GPU 0 memory before teacher forward: 16.39 GB
[Step 1161] GPU 0 memory after moving inputs: 16.39 GB
[Step 1161] GPU 0 memory after teacher forward: 17.01 GB
[Step 1161] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 1161] Teacher logits device before move: cuda:0
[Step 1161] Target device (student_logits.device): cuda:1
[Step 1161] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 1161] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 1161] GPU 0 memory after del: 16.39 GB
[Step 1161] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 1161] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 1161] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 1161] Sequence length: 1024, Batch size: 2
[Step 1161] After KL computation - GPU 1: 40.50 GB
[Step 1161] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  1%|                                                                                       | 73/10000 [25:48<59:24:09, 21.54s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 1171] ========== MEMORY DEBUG ==========
[Step 1171] Model device: cuda:1
[Step 1171] Input device: cuda:1
[Step 1171] Teacher model device: cuda:0
[Step 1171] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 1171] GPU 1 memory: 33.76 GB (reserved: 47.66 GB)
[Step 1171] Student logits device: cuda:1, shape: torch.Size([2, 445, 151936]), dtype: torch.float32
[Step 1171] Student model device: cuda:1
[Step 1171] GPU 0 memory before teacher forward: 16.39 GB
[Step 1171] GPU 0 memory after moving inputs: 16.39 GB
[Step 1171] GPU 0 memory after teacher forward: 16.66 GB
[Step 1171] Teacher logits shape: torch.Size([2, 445, 151936]), dtype: torch.float16
[Step 1171] Teacher logits device before move: cuda:0
[Step 1171] Target device (student_logits.device): cuda:1
[Step 1171] GPU 0 memory after moving logits to GPU 1: 16.66 GB
[Step 1171] Teacher logits device after move: cuda:1, shape: torch.Size([2, 445, 151936])
[Step 1171] GPU 0 memory after del: 16.39 GB
[Step 1171] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 1171] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 35.96 GB
[Step 1171] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 1171] Sequence length: 445, Batch size: 2
[Step 1171] After KL computation - GPU 1: 37.04 GB
[Step 1171] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 1181] ========== MEMORY DEBUG ==========
[Step 1181] Model device: cuda:1
[Step 1181] Input device: cuda:1
[Step 1181] Teacher model device: cuda:0
[Step 1181] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 1181] GPU 1 memory: 33.76 GB (reserved: 44.83 GB)
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
[Step 1181] Student logits device: cuda:1, shape: torch.Size([2, 764, 151936]), dtype: torch.float32
[Step 1181] Student model device: cuda:1
[Step 1181] GPU 0 memory before teacher forward: 16.39 GB
[Step 1181] GPU 0 memory after moving inputs: 16.39 GB
[Step 1181] GPU 0 memory after teacher forward: 16.86 GB
[Step 1181] Teacher logits shape: torch.Size([2, 764, 151936]), dtype: torch.float16
[Step 1181] Teacher logits device before move: cuda:0
[Step 1181] Target device (student_logits.device): cuda:1
[Step 1181] GPU 0 memory after moving logits to GPU 1: 16.86 GB
[Step 1181] Teacher logits device after move: cuda:1, shape: torch.Size([2, 764, 151936])
[Step 1181] GPU 0 memory after del: 16.39 GB
[Step 1181] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 1181] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 37.09 GB
[Step 1181] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 1181] Sequence length: 764, Batch size: 2
[Step 1181] After KL computation - GPU 1: 38.95 GB
[Step 1181] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  1%|                                                                                       | 74/10000 [26:09<58:41:19, 21.29s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None

[Step 1191] ========== MEMORY DEBUG ==========
[Step 1191] Model device: cuda:1
[Step 1191] Input device: cuda:1
[Step 1191] Teacher model device: cuda:0
[Step 1191] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 1191] GPU 1 memory: 33.76 GB (reserved: 43.95 GB)
  warnings.warn(
[Step 1191] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 1191] Student model device: cuda:1
[Step 1191] GPU 0 memory before teacher forward: 16.39 GB
[Step 1191] GPU 0 memory after moving inputs: 16.39 GB
[Step 1191] GPU 0 memory after teacher forward: 17.01 GB
[Step 1191] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 1191] Teacher logits device before move: cuda:0
[Step 1191] Target device (student_logits.device): cuda:1
[Step 1191] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 1191] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 1191] GPU 0 memory after del: 16.39 GB
[Step 1191] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 1191] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 1191] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 1191] Sequence length: 1024, Batch size: 2
[Step 1191] After KL computation - GPU 1: 40.50 GB
[Step 1191] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  1%|                                                                                       | 75/10000 [26:30<58:40:13, 21.28s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None

[Step 1201] ========== MEMORY DEBUG ==========
[Step 1201] Model device: cuda:1
[Step 1201] Input device: cuda:1
[Step 1201] Teacher model device: cuda:0
[Step 1201] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 1201] GPU 1 memory: 25.33 GB (reserved: 47.45 GB)
[Step 1201] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 1201] Student model device: cuda:1
[Step 1201] GPU 0 memory before teacher forward: 16.39 GB
[Step 1201] GPU 0 memory after moving inputs: 16.39 GB
[Step 1201] GPU 0 memory after teacher forward: 17.01 GB
[Step 1201] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 1201] Teacher logits device before move: cuda:0
[Step 1201] Target device (student_logits.device): cuda:1
[Step 1201] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 1201] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 1201] GPU 0 memory after del: 16.39 GB
[Step 1201] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 1201] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 29.58 GB
[Step 1201] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 1201] Sequence length: 1024, Batch size: 2
[Step 1201] After KL computation - GPU 1: 32.07 GB
[Step 1201] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 1211] ========== MEMORY DEBUG ==========
[Step 1211] Model device: cuda:1
[Step 1211] Input device: cuda:1
[Step 1211] Teacher model device: cuda:0
[Step 1211] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 1211] GPU 1 memory: 33.76 GB (reserved: 47.87 GB)
[Step 1211] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 1211] Student model device: cuda:1
[Step 1211] GPU 0 memory before teacher forward: 16.39 GB
[Step 1211] GPU 0 memory after moving inputs: 16.39 GB
[Step 1211] GPU 0 memory after teacher forward: 17.01 GB
[Step 1211] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 1211] Teacher logits device before move: cuda:0
[Step 1211] Target device (student_logits.device): cuda:1
[Step 1211] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 1211] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 1211] GPU 0 memory after del: 16.39 GB
[Step 1211] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 1211] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 1211] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 1211] Sequence length: 1024, Batch size: 2
[Step 1211] After KL computation - GPU 1: 40.50 GB
[Step 1211] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  1%|                                                                                       | 76/10000 [26:52<59:16:53, 21.50s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 1221] ========== MEMORY DEBUG ==========
[Step 1221] Model device: cuda:1
[Step 1221] Input device: cuda:1
[Step 1221] Teacher model device: cuda:0
[Step 1221] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 1221] GPU 1 memory: 33.76 GB (reserved: 44.97 GB)
[Step 1221] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 1221] Student model device: cuda:1
[Step 1221] GPU 0 memory before teacher forward: 16.39 GB
[Step 1221] GPU 0 memory after moving inputs: 16.39 GB
[Step 1221] GPU 0 memory after teacher forward: 17.01 GB
[Step 1221] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 1221] Teacher logits device before move: cuda:0
[Step 1221] Target device (student_logits.device): cuda:1
[Step 1221] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 1221] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 1221] GPU 0 memory after del: 16.39 GB
[Step 1221] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 1221] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 1221] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 1221] Sequence length: 1024, Batch size: 2
[Step 1221] After KL computation - GPU 1: 40.50 GB
[Step 1221] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 1231] ========== MEMORY DEBUG ==========
[Step 1231] Model device: cuda:1
[Step 1231] Input device: cuda:1
[Step 1231] Teacher model device: cuda:0
[Step 1231] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 1231] GPU 1 memory: 33.76 GB (reserved: 47.43 GB)
[Step 1231] Student logits device: cuda:1, shape: torch.Size([2, 417, 151936]), dtype: torch.float32
[Step 1231] Student model device: cuda:1
[Step 1231] GPU 0 memory before teacher forward: 16.39 GB
[Step 1231] GPU 0 memory after moving inputs: 16.39 GB
[Step 1231] GPU 0 memory after teacher forward: 16.65 GB
[Step 1231] Teacher logits shape: torch.Size([2, 417, 151936]), dtype: torch.float16
[Step 1231] Teacher logits device before move: cuda:0
[Step 1231] Target device (student_logits.device): cuda:1
[Step 1231] GPU 0 memory after moving logits to GPU 1: 16.65 GB
[Step 1231] Teacher logits device after move: cuda:1, shape: torch.Size([2, 417, 151936])
[Step 1231] GPU 0 memory after del: 16.39 GB
[Step 1231] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 1231] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 35.86 GB
[Step 1231] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 1231] Sequence length: 417, Batch size: 2
[Step 1231] After KL computation - GPU 1: 36.88 GB
[Step 1231] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  1%|                                                                                       | 77/10000 [27:13<58:31:49, 21.23s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 1241] ========== MEMORY DEBUG ==========
[Step 1241] Model device: cuda:1
[Step 1241] Input device: cuda:1
[Step 1241] Teacher model device: cuda:0
[Step 1241] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 1241] GPU 1 memory: 33.77 GB (reserved: 40.93 GB)
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
[Step 1241] Student logits device: cuda:1, shape: torch.Size([2, 316, 151936]), dtype: torch.float32
[Step 1241] Student model device: cuda:1
[Step 1241] GPU 0 memory before teacher forward: 16.39 GB
[Step 1241] GPU 0 memory after moving inputs: 16.39 GB
[Step 1241] GPU 0 memory after teacher forward: 16.59 GB
[Step 1241] Teacher logits shape: torch.Size([2, 316, 151936]), dtype: torch.float16
[Step 1241] Teacher logits device before move: cuda:0
[Step 1241] Target device (student_logits.device): cuda:1
[Step 1241] GPU 0 memory after moving logits to GPU 1: 16.59 GB
[Step 1241] Teacher logits device after move: cuda:1, shape: torch.Size([2, 316, 151936])
[Step 1241] GPU 0 memory after del: 16.39 GB
[Step 1241] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 1241] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 35.52 GB
[Step 1241] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 1241] Sequence length: 316, Batch size: 2
[Step 1241] After KL computation - GPU 1: 36.28 GB
[Step 1241] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  1%|                                                                                       | 78/10000 [27:34<58:31:31, 21.23s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None

[Step 1251] ========== MEMORY DEBUG ==========
[Step 1251] Model device: cuda:1
[Step 1251] Input device: cuda:1
[Step 1251] Teacher model device: cuda:0
[Step 1251] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 1251] GPU 1 memory: 33.76 GB (reserved: 42.13 GB)
  warnings.warn(
[Step 1251] Student logits device: cuda:1, shape: torch.Size([2, 210, 151936]), dtype: torch.float32
[Step 1251] Student model device: cuda:1
[Step 1251] GPU 0 memory before teacher forward: 16.39 GB
[Step 1251] GPU 0 memory after moving inputs: 16.39 GB
[Step 1251] GPU 0 memory after teacher forward: 16.52 GB
[Step 1251] Teacher logits shape: torch.Size([2, 210, 151936]), dtype: torch.float16
[Step 1251] Teacher logits device before move: cuda:0
[Step 1251] Target device (student_logits.device): cuda:1
[Step 1251] GPU 0 memory after moving logits to GPU 1: 16.52 GB
[Step 1251] Teacher logits device after move: cuda:1, shape: torch.Size([2, 210, 151936])
[Step 1251] GPU 0 memory after del: 16.39 GB
[Step 1251] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 1251] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 35.15 GB
[Step 1251] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 1251] Sequence length: 210, Batch size: 2
[Step 1251] After KL computation - GPU 1: 35.66 GB
[Step 1251] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 1261] ========== MEMORY DEBUG ==========
[Step 1261] Model device: cuda:1
[Step 1261] Input device: cuda:1
[Step 1261] Teacher model device: cuda:0
[Step 1261] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 1261] GPU 1 memory: 33.76 GB (reserved: 47.52 GB)
[Step 1261] Student logits device: cuda:1, shape: torch.Size([2, 878, 151936]), dtype: torch.float32
[Step 1261] Student model device: cuda:1
[Step 1261] GPU 0 memory before teacher forward: 16.39 GB
[Step 1261] GPU 0 memory after moving inputs: 16.39 GB
[Step 1261] GPU 0 memory after teacher forward: 16.93 GB
[Step 1261] Teacher logits shape: torch.Size([2, 878, 151936]), dtype: torch.float16
[Step 1261] Teacher logits device before move: cuda:0
[Step 1261] Target device (student_logits.device): cuda:1
[Step 1261] GPU 0 memory after moving logits to GPU 1: 16.93 GB
[Step 1261] Teacher logits device after move: cuda:1, shape: torch.Size([2, 878, 151936])
[Step 1261] GPU 0 memory after del: 16.39 GB
[Step 1261] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 1261] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 37.49 GB
[Step 1261] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 1261] Sequence length: 878, Batch size: 2
[Step 1261] After KL computation - GPU 1: 39.63 GB
[Step 1261] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  1%|                                                                                       | 79/10000 [27:55<58:17:33, 21.15s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 1271] ========== MEMORY DEBUG ==========
[Step 1271] Model device: cuda:1
[Step 1271] Input device: cuda:1
[Step 1271] Teacher model device: cuda:0
[Step 1271] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 1271] GPU 1 memory: 33.77 GB (reserved: 47.81 GB)
[Step 1271] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 1271] Student model device: cuda:1
[Step 1271] GPU 0 memory before teacher forward: 16.39 GB
[Step 1271] GPU 0 memory after moving inputs: 16.39 GB
[Step 1271] GPU 0 memory after teacher forward: 17.01 GB
[Step 1271] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 1271] Teacher logits device before move: cuda:0
[Step 1271] Target device (student_logits.device): cuda:1
[Step 1271] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 1271] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 1271] GPU 0 memory after del: 16.39 GB
[Step 1271] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 1271] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.02 GB
[Step 1271] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 1271] Sequence length: 1024, Batch size: 2
[Step 1271] After KL computation - GPU 1: 40.51 GB
[Step 1271] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  1%|                                                                                       | 80/10000 [28:16<58:17:57, 21.16s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 3.9500000000000005e-05, 'epoch': 0.01}

[Step 1281] ========== MEMORY DEBUG ==========
[Step 1281] Model device: cuda:1
[Step 1281] Input device: cuda:1
[Step 1281] Teacher model device: cuda:0
[Step 1281] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 1281] GPU 1 memory: 25.33 GB (reserved: 47.25 GB)
[Step 1281] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 1281] Student model device: cuda:1
[Step 1281] GPU 0 memory before teacher forward: 16.39 GB
[Step 1281] GPU 0 memory after moving inputs: 16.39 GB
[Step 1281] GPU 0 memory after teacher forward: 17.01 GB
[Step 1281] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 1281] Teacher logits device before move: cuda:0
[Step 1281] Target device (student_logits.device): cuda:1
[Step 1281] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 1281] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 1281] GPU 0 memory after del: 16.39 GB
[Step 1281] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 1281] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 29.58 GB
[Step 1281] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 1281] Sequence length: 1024, Batch size: 2
[Step 1281] After KL computation - GPU 1: 32.07 GB
[Step 1281] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 1291] ========== MEMORY DEBUG ==========
[Step 1291] Model device: cuda:1
[Step 1291] Input device: cuda:1
[Step 1291] Teacher model device: cuda:0
[Step 1291] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 1291] GPU 1 memory: 33.76 GB (reserved: 44.46 GB)
[Step 1291] Student logits device: cuda:1, shape: torch.Size([2, 166, 151936]), dtype: torch.float32
[Step 1291] Student model device: cuda:1
[Step 1291] GPU 0 memory before teacher forward: 16.39 GB
[Step 1291] GPU 0 memory after moving inputs: 16.39 GB
[Step 1291] GPU 0 memory after teacher forward: 16.49 GB
[Step 1291] Teacher logits shape: torch.Size([2, 166, 151936]), dtype: torch.float16
[Step 1291] Teacher logits device before move: cuda:0
[Step 1291] Target device (student_logits.device): cuda:1
[Step 1291] GPU 0 memory after moving logits to GPU 1: 16.49 GB
[Step 1291] Teacher logits device after move: cuda:1, shape: torch.Size([2, 166, 151936])
[Step 1291] GPU 0 memory after del: 16.39 GB
[Step 1291] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 1291] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 34.98 GB
[Step 1291] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 1291] Sequence length: 166, Batch size: 2
[Step 1291] After KL computation - GPU 1: 35.38 GB
[Step 1291] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  1%|                                                                                       | 81/10000 [28:38<59:07:06, 21.46s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 1301] ========== MEMORY DEBUG ==========
[Step 1301] Model device: cuda:1
[Step 1301] Input device: cuda:1
[Step 1301] Teacher model device: cuda:0
[Step 1301] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 1301] GPU 1 memory: 33.76 GB (reserved: 43.27 GB)
[Step 1301] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 1301] Student model device: cuda:1
[Step 1301] GPU 0 memory before teacher forward: 16.39 GB
[Step 1301] GPU 0 memory after moving inputs: 16.39 GB
[Step 1301] GPU 0 memory after teacher forward: 17.01 GB
[Step 1301] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 1301] Teacher logits device before move: cuda:0
[Step 1301] Target device (student_logits.device): cuda:1
[Step 1301] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 1301] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 1301] GPU 0 memory after del: 16.39 GB
[Step 1301] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 1301] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 1301] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 1301] Sequence length: 1024, Batch size: 2
[Step 1301] After KL computation - GPU 1: 40.50 GB
[Step 1301] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 1311] ========== MEMORY DEBUG ==========
[Step 1311] Model device: cuda:1
[Step 1311] Input device: cuda:1
[Step 1311] Teacher model device: cuda:0
[Step 1311] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 1311] GPU 1 memory: 33.76 GB (reserved: 47.36 GB)
[Step 1311] Student logits device: cuda:1, shape: torch.Size([2, 342, 151936]), dtype: torch.float32
[Step 1311] Student model device: cuda:1
[Step 1311] GPU 0 memory before teacher forward: 16.39 GB
[Step 1311] GPU 0 memory after moving inputs: 16.39 GB
[Step 1311] GPU 0 memory after teacher forward: 16.60 GB
[Step 1311] Teacher logits shape: torch.Size([2, 342, 151936]), dtype: torch.float16
[Step 1311] Teacher logits device before move: cuda:0
[Step 1311] Target device (student_logits.device): cuda:1
[Step 1311] GPU 0 memory after moving logits to GPU 1: 16.60 GB
[Step 1311] Teacher logits device after move: cuda:1, shape: torch.Size([2, 342, 151936])
[Step 1311] GPU 0 memory after del: 16.39 GB
[Step 1311] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 1311] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 35.60 GB
[Step 1311] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 1311] Sequence length: 342, Batch size: 2
[Step 1311] After KL computation - GPU 1: 36.43 GB
[Step 1311] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  1%|                                                                                       | 82/10000 [28:59<58:42:09, 21.31s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 1321] ========== MEMORY DEBUG ==========
[Step 1321] Model device: cuda:1
[Step 1321] Input device: cuda:1
[Step 1321] Teacher model device: cuda:0
[Step 1321] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 1321] GPU 1 memory: 33.76 GB (reserved: 44.78 GB)
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
[Step 1321] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 1321] Student model device: cuda:1
[Step 1321] GPU 0 memory before teacher forward: 16.39 GB
[Step 1321] GPU 0 memory after moving inputs: 16.39 GB
[Step 1321] GPU 0 memory after teacher forward: 17.01 GB
[Step 1321] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 1321] Teacher logits device before move: cuda:0
[Step 1321] Target device (student_logits.device): cuda:1
[Step 1321] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 1321] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 1321] GPU 0 memory after del: 16.39 GB
[Step 1321] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 1321] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 1321] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 1321] Sequence length: 1024, Batch size: 2
[Step 1321] After KL computation - GPU 1: 40.50 GB
[Step 1321] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  1%|                                                                                       | 83/10000 [29:23<60:29:31, 21.96s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None

[Step 1331] ========== MEMORY DEBUG ==========
[Step 1331] Model device: cuda:1
[Step 1331] Input device: cuda:1
[Step 1331] Teacher model device: cuda:0
[Step 1331] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 1331] GPU 1 memory: 33.76 GB (reserved: 43.56 GB)
[Step 1331] Student logits device: cuda:1, shape: torch.Size([2, 405, 151936]), dtype: torch.float32
[Step 1331] Student model device: cuda:1
[Step 1331] GPU 0 memory before teacher forward: 16.39 GB
[Step 1331] GPU 0 memory after moving inputs: 16.39 GB
[Step 1331] GPU 0 memory after teacher forward: 16.64 GB
[Step 1331] Teacher logits shape: torch.Size([2, 405, 151936]), dtype: torch.float16
[Step 1331] Teacher logits device before move: cuda:0
[Step 1331] Target device (student_logits.device): cuda:1
[Step 1331] GPU 0 memory after moving logits to GPU 1: 16.64 GB
[Step 1331] Teacher logits device after move: cuda:1, shape: torch.Size([2, 405, 151936])
[Step 1331] GPU 0 memory after del: 16.39 GB
[Step 1331] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 1331] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 35.82 GB
[Step 1331] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 1331] Sequence length: 405, Batch size: 2
[Step 1331] After KL computation - GPU 1: 36.81 GB
[Step 1331] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 1341] ========== MEMORY DEBUG ==========
[Step 1341] Model device: cuda:1
[Step 1341] Input device: cuda:1
[Step 1341] Teacher model device: cuda:0
[Step 1341] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 1341] GPU 1 memory: 33.76 GB (reserved: 44.26 GB)
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
[Step 1341] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 1341] Student model device: cuda:1
[Step 1341] GPU 0 memory before teacher forward: 16.39 GB
[Step 1341] GPU 0 memory after moving inputs: 16.39 GB
[Step 1341] GPU 0 memory after teacher forward: 17.01 GB
[Step 1341] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 1341] Teacher logits device before move: cuda:0
[Step 1341] Target device (student_logits.device): cuda:1
[Step 1341] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 1341] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 1341] GPU 0 memory after del: 16.39 GB
[Step 1341] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 1341] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 1341] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 1341] Sequence length: 1024, Batch size: 2
[Step 1341] After KL computation - GPU 1: 40.50 GB
[Step 1341] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  1%|                                                                                       | 84/10000 [29:45<60:34:52, 21.99s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 1351] ========== MEMORY DEBUG ==========
[Step 1351] Model device: cuda:1
[Step 1351] Input device: cuda:1
[Step 1351] Teacher model device: cuda:0
[Step 1351] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 1351] GPU 1 memory: 33.77 GB (reserved: 47.98 GB)
[Step 1351] Student logits device: cuda:1, shape: torch.Size([2, 487, 151936]), dtype: torch.float32
[Step 1351] Student model device: cuda:1
[Step 1351] GPU 0 memory before teacher forward: 16.39 GB
[Step 1351] GPU 0 memory after moving inputs: 16.39 GB
[Step 1351] GPU 0 memory after teacher forward: 16.69 GB
[Step 1351] Teacher logits shape: torch.Size([2, 487, 151936]), dtype: torch.float16
[Step 1351] Teacher logits device before move: cuda:0
[Step 1351] Target device (student_logits.device): cuda:1
[Step 1351] GPU 0 memory after moving logits to GPU 1: 16.69 GB
[Step 1351] Teacher logits device after move: cuda:1, shape: torch.Size([2, 487, 151936])
[Step 1351] GPU 0 memory after del: 16.39 GB
[Step 1351] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 1351] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 36.12 GB
[Step 1351] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 1351] Sequence length: 487, Batch size: 2
[Step 1351] After KL computation - GPU 1: 37.30 GB
[Step 1351] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  1%|                                                                                       | 85/10000 [30:05<58:58:00, 21.41s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None

[Step 1361] ========== MEMORY DEBUG ==========
[Step 1361] Model device: cuda:1
[Step 1361] Input device: cuda:1
[Step 1361] Teacher model device: cuda:0
[Step 1361] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 1361] GPU 1 memory: 25.33 GB (reserved: 43.18 GB)
[Step 1361] Student logits device: cuda:1, shape: torch.Size([2, 665, 151936]), dtype: torch.float32
[Step 1361] Student model device: cuda:1
[Step 1361] GPU 0 memory before teacher forward: 16.39 GB
[Step 1361] GPU 0 memory after moving inputs: 16.39 GB
[Step 1361] GPU 0 memory after teacher forward: 16.80 GB
[Step 1361] Teacher logits shape: torch.Size([2, 665, 151936]), dtype: torch.float16
[Step 1361] Teacher logits device before move: cuda:0
[Step 1361] Target device (student_logits.device): cuda:1
[Step 1361] GPU 0 memory after moving logits to GPU 1: 16.80 GB
[Step 1361] Teacher logits device after move: cuda:1, shape: torch.Size([2, 665, 151936])
[Step 1361] GPU 0 memory after del: 16.39 GB
[Step 1361] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 1361] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 28.30 GB
[Step 1361] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 1361] Sequence length: 665, Batch size: 2
[Step 1361] After KL computation - GPU 1: 29.92 GB
[Step 1361] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 1371] ========== MEMORY DEBUG ==========
[Step 1371] Model device: cuda:1
[Step 1371] Input device: cuda:1
[Step 1371] Teacher model device: cuda:0
[Step 1371] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 1371] GPU 1 memory: 33.77 GB (reserved: 48.02 GB)
[Step 1371] Student logits device: cuda:1, shape: torch.Size([2, 558, 151936]), dtype: torch.float32
[Step 1371] Student model device: cuda:1
[Step 1371] GPU 0 memory before teacher forward: 16.39 GB
[Step 1371] GPU 0 memory after moving inputs: 16.39 GB
[Step 1371] GPU 0 memory after teacher forward: 16.73 GB
[Step 1371] Teacher logits shape: torch.Size([2, 558, 151936]), dtype: torch.float16
[Step 1371] Teacher logits device before move: cuda:0
[Step 1371] Target device (student_logits.device): cuda:1
[Step 1371] GPU 0 memory after moving logits to GPU 1: 16.73 GB
[Step 1371] Teacher logits device after move: cuda:1, shape: torch.Size([2, 558, 151936])
[Step 1371] GPU 0 memory after del: 16.39 GB
[Step 1371] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 1371] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 36.36 GB
[Step 1371] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 1371] Sequence length: 558, Batch size: 2
[Step 1371] After KL computation - GPU 1: 37.72 GB
[Step 1371] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  1%|                                                                                       | 86/10000 [30:28<59:57:08, 21.77s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None

[Step 1381] ========== MEMORY DEBUG ==========
[Step 1381] Model device: cuda:1
[Step 1381] Input device: cuda:1
[Step 1381] Teacher model device: cuda:0
[Step 1381] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 1381] GPU 1 memory: 33.76 GB (reserved: 47.57 GB)
[Step 1381] Student logits device: cuda:1, shape: torch.Size([2, 645, 151936]), dtype: torch.float32
[Step 1381] Student model device: cuda:1
[Step 1381] GPU 0 memory before teacher forward: 16.39 GB
[Step 1381] GPU 0 memory after moving inputs: 16.39 GB
[Step 1381] GPU 0 memory after teacher forward: 16.78 GB
[Step 1381] Teacher logits shape: torch.Size([2, 645, 151936]), dtype: torch.float16
[Step 1381] Teacher logits device before move: cuda:0
[Step 1381] Target device (student_logits.device): cuda:1
[Step 1381] GPU 0 memory after moving logits to GPU 1: 16.78 GB
[Step 1381] Teacher logits device after move: cuda:1, shape: torch.Size([2, 645, 151936])
[Step 1381] GPU 0 memory after del: 16.39 GB
[Step 1381] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 1381] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 36.67 GB
[Step 1381] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 1381] Sequence length: 645, Batch size: 2
[Step 1381] After KL computation - GPU 1: 38.24 GB
[Step 1381] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(

[Step 1391] ========== MEMORY DEBUG ==========
[Step 1391] Model device: cuda:1
[Step 1391] Input device: cuda:1
[Step 1391] Teacher model device: cuda:0
[Step 1391] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 1391] GPU 1 memory: 33.76 GB (reserved: 39.73 GB)
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
[Step 1391] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 1391] Student model device: cuda:1
[Step 1391] GPU 0 memory before teacher forward: 16.39 GB
[Step 1391] GPU 0 memory after moving inputs: 16.39 GB
[Step 1391] GPU 0 memory after teacher forward: 17.01 GB
[Step 1391] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 1391] Teacher logits device before move: cuda:0
[Step 1391] Target device (student_logits.device): cuda:1
[Step 1391] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 1391] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 1391] GPU 0 memory after del: 16.39 GB
[Step 1391] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 1391] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 1391] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 1391] Sequence length: 1024, Batch size: 2
[Step 1391] After KL computation - GPU 1: 40.50 GB
[Step 1391] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  1%|                                                                                       | 87/10000 [30:49<59:46:35, 21.71s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 1401] ========== MEMORY DEBUG ==========
[Step 1401] Model device: cuda:1
[Step 1401] Input device: cuda:1
[Step 1401] Teacher model device: cuda:0
[Step 1401] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 1401] GPU 1 memory: 33.76 GB (reserved: 47.78 GB)
[Step 1401] Student logits device: cuda:1, shape: torch.Size([2, 994, 151936]), dtype: torch.float32
[Step 1401] Student model device: cuda:1
[Step 1401] GPU 0 memory before teacher forward: 16.39 GB
[Step 1401] GPU 0 memory after moving inputs: 16.39 GB
[Step 1401] GPU 0 memory after teacher forward: 17.00 GB
[Step 1401] Teacher logits shape: torch.Size([2, 994, 151936]), dtype: torch.float16
[Step 1401] Teacher logits device before move: cuda:0
[Step 1401] Target device (student_logits.device): cuda:1
[Step 1401] GPU 0 memory after moving logits to GPU 1: 17.00 GB
[Step 1401] Teacher logits device after move: cuda:1, shape: torch.Size([2, 994, 151936])
[Step 1401] GPU 0 memory after del: 16.39 GB
[Step 1401] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 1401] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 37.91 GB
[Step 1401] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 1401] Sequence length: 994, Batch size: 2
[Step 1401] After KL computation - GPU 1: 40.32 GB
[Step 1401] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  1%|                                                                                       | 88/10000 [31:12<60:29:48, 21.97s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None

[Step 1411] ========== MEMORY DEBUG ==========
[Step 1411] Model device: cuda:1
[Step 1411] Input device: cuda:1
[Step 1411] Teacher model device: cuda:0
[Step 1411] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 1411] GPU 1 memory: 33.76 GB (reserved: 39.63 GB)
  warnings.warn(
[Step 1411] Student logits device: cuda:1, shape: torch.Size([2, 470, 151936]), dtype: torch.float32
[Step 1411] Student model device: cuda:1
[Step 1411] GPU 0 memory before teacher forward: 16.39 GB
[Step 1411] GPU 0 memory after moving inputs: 16.39 GB
[Step 1411] GPU 0 memory after teacher forward: 16.68 GB
[Step 1411] Teacher logits shape: torch.Size([2, 470, 151936]), dtype: torch.float16
[Step 1411] Teacher logits device before move: cuda:0
[Step 1411] Target device (student_logits.device): cuda:1
[Step 1411] GPU 0 memory after moving logits to GPU 1: 16.68 GB
[Step 1411] Teacher logits device after move: cuda:1, shape: torch.Size([2, 470, 151936])
[Step 1411] GPU 0 memory after del: 16.39 GB
[Step 1411] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 1411] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 36.05 GB
[Step 1411] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 1411] Sequence length: 470, Batch size: 2
[Step 1411] After KL computation - GPU 1: 37.19 GB
[Step 1411] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 1421] ========== MEMORY DEBUG ==========
[Step 1421] Model device: cuda:1
[Step 1421] Input device: cuda:1
[Step 1421] Teacher model device: cuda:0
[Step 1421] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 1421] GPU 1 memory: 33.76 GB (reserved: 47.78 GB)
[Step 1421] Student logits device: cuda:1, shape: torch.Size([2, 784, 151936]), dtype: torch.float32
[Step 1421] Student model device: cuda:1
[Step 1421] GPU 0 memory before teacher forward: 16.39 GB
[Step 1421] GPU 0 memory after moving inputs: 16.39 GB
[Step 1421] GPU 0 memory after teacher forward: 16.87 GB
[Step 1421] Teacher logits shape: torch.Size([2, 784, 151936]), dtype: torch.float16
[Step 1421] Teacher logits device before move: cuda:0
[Step 1421] Target device (student_logits.device): cuda:1
[Step 1421] GPU 0 memory after moving logits to GPU 1: 16.87 GB
[Step 1421] Teacher logits device after move: cuda:1, shape: torch.Size([2, 784, 151936])
[Step 1421] GPU 0 memory after del: 16.39 GB
[Step 1421] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 1421] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 37.16 GB
[Step 1421] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 1421] Sequence length: 784, Batch size: 2
[Step 1421] After KL computation - GPU 1: 39.07 GB
[Step 1421] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  1%|                                                                                       | 89/10000 [31:33<59:38:21, 21.66s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None

[Step 1431] ========== MEMORY DEBUG ==========
[Step 1431] Model device: cuda:1
[Step 1431] Input device: cuda:1
[Step 1431] Teacher model device: cuda:0
[Step 1431] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 1431] GPU 1 memory: 33.76 GB (reserved: 47.26 GB)
[Step 1431] Student logits device: cuda:1, shape: torch.Size([2, 895, 151936]), dtype: torch.float32
[Step 1431] Student model device: cuda:1
[Step 1431] GPU 0 memory before teacher forward: 16.39 GB
[Step 1431] GPU 0 memory after moving inputs: 16.39 GB
[Step 1431] GPU 0 memory after teacher forward: 16.94 GB
[Step 1431] Teacher logits shape: torch.Size([2, 895, 151936]), dtype: torch.float16
[Step 1431] Teacher logits device before move: cuda:0
[Step 1431] Target device (student_logits.device): cuda:1
[Step 1431] GPU 0 memory after moving logits to GPU 1: 16.94 GB
[Step 1431] Teacher logits device after move: cuda:1, shape: torch.Size([2, 895, 151936])
[Step 1431] GPU 0 memory after del: 16.39 GB
[Step 1431] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 1431] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 37.55 GB
[Step 1431] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 1431] Sequence length: 895, Batch size: 2
[Step 1431] After KL computation - GPU 1: 39.73 GB
[Step 1431] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  1%|                                                                                       | 90/10000 [31:56<60:36:22, 22.02s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
{'loss': 189454.025, 'grad_norm': nan, 'learning_rate': 4.4500000000000004e-05, 'epoch': 0.01}

[Step 1441] ========== MEMORY DEBUG ==========
[Step 1441] Model device: cuda:1
[Step 1441] Input device: cuda:1
[Step 1441] Teacher model device: cuda:0
[Step 1441] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 1441] GPU 1 memory: 25.33 GB (reserved: 44.75 GB)
  warnings.warn(
[Step 1441] Student logits device: cuda:1, shape: torch.Size([2, 816, 151936]), dtype: torch.float32
[Step 1441] Student model device: cuda:1
[Step 1441] GPU 0 memory before teacher forward: 16.39 GB
[Step 1441] GPU 0 memory after moving inputs: 16.39 GB
[Step 1441] GPU 0 memory after teacher forward: 16.89 GB
[Step 1441] Teacher logits shape: torch.Size([2, 816, 151936]), dtype: torch.float16
[Step 1441] Teacher logits device before move: cuda:0
[Step 1441] Target device (student_logits.device): cuda:1
[Step 1441] GPU 0 memory after moving logits to GPU 1: 16.89 GB
[Step 1441] Teacher logits device after move: cuda:1, shape: torch.Size([2, 816, 151936])
[Step 1441] GPU 0 memory after del: 16.39 GB
[Step 1441] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 1441] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 28.84 GB
[Step 1441] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 1441] Sequence length: 816, Batch size: 2
[Step 1441] After KL computation - GPU 1: 30.82 GB
[Step 1441] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 1451] ========== MEMORY DEBUG ==========
[Step 1451] Model device: cuda:1
[Step 1451] Input device: cuda:1
[Step 1451] Teacher model device: cuda:0
[Step 1451] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 1451] GPU 1 memory: 33.77 GB (reserved: 45.45 GB)
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
[Step 1451] Student logits device: cuda:1, shape: torch.Size([2, 483, 151936]), dtype: torch.float32
[Step 1451] Student model device: cuda:1
[Step 1451] GPU 0 memory before teacher forward: 16.39 GB
[Step 1451] GPU 0 memory after moving inputs: 16.39 GB
[Step 1451] GPU 0 memory after teacher forward: 16.69 GB
[Step 1451] Teacher logits shape: torch.Size([2, 483, 151936]), dtype: torch.float16
[Step 1451] Teacher logits device before move: cuda:0
[Step 1451] Target device (student_logits.device): cuda:1
[Step 1451] GPU 0 memory after moving logits to GPU 1: 16.69 GB
[Step 1451] Teacher logits device after move: cuda:1, shape: torch.Size([2, 483, 151936])
[Step 1451] GPU 0 memory after del: 16.39 GB
[Step 1451] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 1451] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 36.10 GB
[Step 1451] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 1451] Sequence length: 483, Batch size: 2
[Step 1451] After KL computation - GPU 1: 37.27 GB
[Step 1451] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  1%|                                                                                       | 91/10000 [32:17<60:27:19, 21.96s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 1461] ========== MEMORY DEBUG ==========
[Step 1461] Model device: cuda:1
[Step 1461] Input device: cuda:1
[Step 1461] Teacher model device: cuda:0
[Step 1461] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 1461] GPU 1 memory: 33.76 GB (reserved: 47.56 GB)
[Step 1461] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 1461] Student model device: cuda:1
[Step 1461] GPU 0 memory before teacher forward: 16.39 GB
[Step 1461] GPU 0 memory after moving inputs: 16.39 GB
[Step 1461] GPU 0 memory after teacher forward: 17.01 GB
[Step 1461] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 1461] Teacher logits device before move: cuda:0
[Step 1461] Target device (student_logits.device): cuda:1
[Step 1461] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 1461] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 1461] GPU 0 memory after del: 16.39 GB
[Step 1461] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 1461] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 1461] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 1461] Sequence length: 1024, Batch size: 2
[Step 1461] After KL computation - GPU 1: 40.50 GB
[Step 1461] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 1471] ========== MEMORY DEBUG ==========
[Step 1471] Model device: cuda:1
[Step 1471] Input device: cuda:1
[Step 1471] Teacher model device: cuda:0
[Step 1471] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 1471] GPU 1 memory: 33.76 GB (reserved: 47.44 GB)
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
[Step 1471] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 1471] Student model device: cuda:1
[Step 1471] GPU 0 memory before teacher forward: 16.39 GB
[Step 1471] GPU 0 memory after moving inputs: 16.39 GB
[Step 1471] GPU 0 memory after teacher forward: 17.01 GB
[Step 1471] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 1471] Teacher logits device before move: cuda:0
[Step 1471] Target device (student_logits.device): cuda:1
[Step 1471] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 1471] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 1471] GPU 0 memory after del: 16.39 GB
[Step 1471] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 1471] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 1471] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 1471] Sequence length: 1024, Batch size: 2
[Step 1471] After KL computation - GPU 1: 40.50 GB
[Step 1471] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  1%|                                                                                       | 92/10000 [32:39<59:49:22, 21.74s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 1481] ========== MEMORY DEBUG ==========
[Step 1481] Model device: cuda:1
[Step 1481] Input device: cuda:1
[Step 1481] Teacher model device: cuda:0
[Step 1481] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 1481] GPU 1 memory: 33.76 GB (reserved: 47.74 GB)
[Step 1481] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 1481] Student model device: cuda:1
[Step 1481] GPU 0 memory before teacher forward: 16.39 GB
[Step 1481] GPU 0 memory after moving inputs: 16.39 GB
[Step 1481] GPU 0 memory after teacher forward: 17.01 GB
[Step 1481] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 1481] Teacher logits device before move: cuda:0
[Step 1481] Target device (student_logits.device): cuda:1
[Step 1481] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 1481] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 1481] GPU 0 memory after del: 16.39 GB
[Step 1481] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 1481] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 1481] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 1481] Sequence length: 1024, Batch size: 2
[Step 1481] After KL computation - GPU 1: 40.50 GB
[Step 1481] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  1%|                                                                                       | 93/10000 [32:59<58:54:53, 21.41s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None

[Step 1491] ========== MEMORY DEBUG ==========
[Step 1491] Model device: cuda:1
[Step 1491] Input device: cuda:1
[Step 1491] Teacher model device: cuda:0
[Step 1491] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 1491] GPU 1 memory: 33.76 GB (reserved: 47.31 GB)
[Step 1491] Student logits device: cuda:1, shape: torch.Size([2, 841, 151936]), dtype: torch.float32
[Step 1491] Student model device: cuda:1
[Step 1491] GPU 0 memory before teacher forward: 16.39 GB
[Step 1491] GPU 0 memory after moving inputs: 16.39 GB
[Step 1491] GPU 0 memory after teacher forward: 16.90 GB
[Step 1491] Teacher logits shape: torch.Size([2, 841, 151936]), dtype: torch.float16
[Step 1491] Teacher logits device before move: cuda:0
[Step 1491] Target device (student_logits.device): cuda:1
[Step 1491] GPU 0 memory after moving logits to GPU 1: 16.90 GB
[Step 1491] Teacher logits device after move: cuda:1, shape: torch.Size([2, 841, 151936])
[Step 1491] GPU 0 memory after del: 16.39 GB
[Step 1491] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 1491] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 37.37 GB
[Step 1491] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 1491] Sequence length: 841, Batch size: 2
[Step 1491] After KL computation - GPU 1: 39.41 GB
[Step 1491] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(

[Step 1501] ========== MEMORY DEBUG ==========
[Step 1501] Model device: cuda:1
[Step 1501] Input device: cuda:1
[Step 1501] Teacher model device: cuda:0
[Step 1501] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 1501] GPU 1 memory: 33.76 GB (reserved: 47.78 GB)
[Step 1501] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 1501] Student model device: cuda:1
[Step 1501] GPU 0 memory before teacher forward: 16.39 GB
[Step 1501] GPU 0 memory after moving inputs: 16.39 GB
[Step 1501] GPU 0 memory after teacher forward: 17.01 GB
[Step 1501] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 1501] Teacher logits device before move: cuda:0
[Step 1501] Target device (student_logits.device): cuda:1
[Step 1501] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 1501] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 1501] GPU 0 memory after del: 16.39 GB
[Step 1501] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 1501] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 1501] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 1501] Sequence length: 1024, Batch size: 2
[Step 1501] After KL computation - GPU 1: 40.50 GB
[Step 1501] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  1%|                                                                                       | 94/10000 [33:22<60:12:33, 21.88s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 1511] ========== MEMORY DEBUG ==========
[Step 1511] Model device: cuda:1
[Step 1511] Input device: cuda:1
[Step 1511] Teacher model device: cuda:0
[Step 1511] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 1511] GPU 1 memory: 33.76 GB (reserved: 47.61 GB)
[Step 1511] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 1511] Student model device: cuda:1
[Step 1511] GPU 0 memory before teacher forward: 16.39 GB
[Step 1511] GPU 0 memory after moving inputs: 16.39 GB
[Step 1511] GPU 0 memory after teacher forward: 17.01 GB
[Step 1511] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 1511] Teacher logits device before move: cuda:0
[Step 1511] Target device (student_logits.device): cuda:1
[Step 1511] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 1511] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 1511] GPU 0 memory after del: 16.39 GB
[Step 1511] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 1511] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 1511] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 1511] Sequence length: 1024, Batch size: 2
[Step 1511] After KL computation - GPU 1: 40.50 GB
[Step 1511] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  1%|                                                                                       | 95/10000 [33:44<60:24:38, 21.96s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None

[Step 1521] ========== MEMORY DEBUG ==========
[Step 1521] Model device: cuda:1
[Step 1521] Input device: cuda:1
[Step 1521] Teacher model device: cuda:0
[Step 1521] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 1521] GPU 1 memory: 25.33 GB (reserved: 47.58 GB)
[Step 1521] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 1521] Student model device: cuda:1
[Step 1521] GPU 0 memory before teacher forward: 16.39 GB
[Step 1521] GPU 0 memory after moving inputs: 16.39 GB
[Step 1521] GPU 0 memory after teacher forward: 17.01 GB
[Step 1521] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 1521] Teacher logits device before move: cuda:0
[Step 1521] Target device (student_logits.device): cuda:1
[Step 1521] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 1521] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 1521] GPU 0 memory after del: 16.39 GB
[Step 1521] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 1521] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 29.58 GB
[Step 1521] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 1521] Sequence length: 1024, Batch size: 2
[Step 1521] After KL computation - GPU 1: 32.07 GB
[Step 1521] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 1531] ========== MEMORY DEBUG ==========
[Step 1531] Model device: cuda:1
[Step 1531] Input device: cuda:1
[Step 1531] Teacher model device: cuda:0
[Step 1531] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 1531] GPU 1 memory: 33.76 GB (reserved: 47.45 GB)
[Step 1531] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 1531] Student model device: cuda:1
[Step 1531] GPU 0 memory before teacher forward: 16.39 GB
[Step 1531] GPU 0 memory after moving inputs: 16.39 GB
[Step 1531] GPU 0 memory after teacher forward: 17.01 GB
[Step 1531] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 1531] Teacher logits device before move: cuda:0
[Step 1531] Target device (student_logits.device): cuda:1
[Step 1531] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 1531] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 1531] GPU 0 memory after del: 16.39 GB
[Step 1531] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 1531] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 1531] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 1531] Sequence length: 1024, Batch size: 2
[Step 1531] After KL computation - GPU 1: 40.50 GB
[Step 1531] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  1%|                                                                                       | 96/10000 [34:09<62:45:26, 22.81s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None

[Step 1541] ========== MEMORY DEBUG ==========
[Step 1541] Model device: cuda:1
[Step 1541] Input device: cuda:1
[Step 1541] Teacher model device: cuda:0
[Step 1541] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 1541] GPU 1 memory: 33.76 GB (reserved: 47.65 GB)
[Step 1541] Student logits device: cuda:1, shape: torch.Size([2, 1004, 151936]), dtype: torch.float32
[Step 1541] Student model device: cuda:1
[Step 1541] GPU 0 memory before teacher forward: 16.39 GB
[Step 1541] GPU 0 memory after moving inputs: 16.39 GB
[Step 1541] GPU 0 memory after teacher forward: 17.00 GB
[Step 1541] Teacher logits shape: torch.Size([2, 1004, 151936]), dtype: torch.float16
[Step 1541] Teacher logits device before move: cuda:0
[Step 1541] Target device (student_logits.device): cuda:1
[Step 1541] GPU 0 memory after moving logits to GPU 1: 17.00 GB
[Step 1541] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1004, 151936])
[Step 1541] GPU 0 memory after del: 16.39 GB
[Step 1541] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 1541] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 37.94 GB
[Step 1541] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 1541] Sequence length: 1004, Batch size: 2
[Step 1541] After KL computation - GPU 1: 40.38 GB
[Step 1541] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 1551] ========== MEMORY DEBUG ==========
[Step 1551] Model device: cuda:1
[Step 1551] Input device: cuda:1
[Step 1551] Teacher model device: cuda:0
[Step 1551] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 1551] GPU 1 memory: 33.76 GB (reserved: 42.79 GB)
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
[Step 1551] Student logits device: cuda:1, shape: torch.Size([2, 203, 151936]), dtype: torch.float32
[Step 1551] Student model device: cuda:1
[Step 1551] GPU 0 memory before teacher forward: 16.39 GB
[Step 1551] GPU 0 memory after moving inputs: 16.39 GB
[Step 1551] GPU 0 memory after teacher forward: 16.52 GB
[Step 1551] Teacher logits shape: torch.Size([2, 203, 151936]), dtype: torch.float16
[Step 1551] Teacher logits device before move: cuda:0
[Step 1551] Target device (student_logits.device): cuda:1
[Step 1551] GPU 0 memory after moving logits to GPU 1: 16.52 GB
[Step 1551] Teacher logits device after move: cuda:1, shape: torch.Size([2, 203, 151936])
[Step 1551] GPU 0 memory after del: 16.39 GB
[Step 1551] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 1551] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 35.12 GB
[Step 1551] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 1551] Sequence length: 203, Batch size: 2
[Step 1551] After KL computation - GPU 1: 35.62 GB
[Step 1551] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  1%|                                                                                       | 97/10000 [34:32<62:53:40, 22.86s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None

[Step 1561] ========== MEMORY DEBUG ==========
[Step 1561] Model device: cuda:1
[Step 1561] Input device: cuda:1
[Step 1561] Teacher model device: cuda:0
[Step 1561] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 1561] GPU 1 memory: 33.76 GB (reserved: 45.59 GB)
[Step 1561] Student logits device: cuda:1, shape: torch.Size([2, 981, 151936]), dtype: torch.float32
[Step 1561] Student model device: cuda:1
[Step 1561] GPU 0 memory before teacher forward: 16.39 GB
[Step 1561] GPU 0 memory after moving inputs: 16.39 GB
[Step 1561] GPU 0 memory after teacher forward: 16.99 GB
[Step 1561] Teacher logits shape: torch.Size([2, 981, 151936]), dtype: torch.float16
[Step 1561] Teacher logits device before move: cuda:0
[Step 1561] Target device (student_logits.device): cuda:1
[Step 1561] GPU 0 memory after moving logits to GPU 1: 16.99 GB
[Step 1561] Teacher logits device after move: cuda:1, shape: torch.Size([2, 981, 151936])
[Step 1561] GPU 0 memory after del: 16.39 GB
[Step 1561] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 1561] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 37.86 GB
[Step 1561] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 1561] Sequence length: 981, Batch size: 2
[Step 1561] After KL computation - GPU 1: 40.25 GB
[Step 1561] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(
  1%|                                                                                       | 98/10000 [34:53<61:30:10, 22.36s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None

[Step 1571] ========== MEMORY DEBUG ==========
[Step 1571] Model device: cuda:1
[Step 1571] Input device: cuda:1
[Step 1571] Teacher model device: cuda:0
[Step 1571] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 1571] GPU 1 memory: 33.76 GB (reserved: 47.47 GB)
[Step 1571] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 1571] Student model device: cuda:1
[Step 1571] GPU 0 memory before teacher forward: 16.39 GB
[Step 1571] GPU 0 memory after moving inputs: 16.39 GB
[Step 1571] GPU 0 memory after teacher forward: 17.01 GB
[Step 1571] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 1571] Teacher logits device before move: cuda:0
[Step 1571] Target device (student_logits.device): cuda:1
[Step 1571] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 1571] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 1571] GPU 0 memory after del: 16.39 GB
[Step 1571] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 1571] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 1571] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 1571] Sequence length: 1024, Batch size: 2
[Step 1571] After KL computation - GPU 1: 40.50 GB
[Step 1571] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(

[Step 1581] ========== MEMORY DEBUG ==========
[Step 1581] Model device: cuda:1
[Step 1581] Input device: cuda:1
[Step 1581] Teacher model device: cuda:0
[Step 1581] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 1581] GPU 1 memory: 33.76 GB (reserved: 47.59 GB)
[Step 1581] Student logits device: cuda:1, shape: torch.Size([2, 764, 151936]), dtype: torch.float32
[Step 1581] Student model device: cuda:1
[Step 1581] GPU 0 memory before teacher forward: 16.39 GB
[Step 1581] GPU 0 memory after moving inputs: 16.39 GB
[Step 1581] GPU 0 memory after teacher forward: 16.86 GB
[Step 1581] Teacher logits shape: torch.Size([2, 764, 151936]), dtype: torch.float16
[Step 1581] Teacher logits device before move: cuda:0
[Step 1581] Target device (student_logits.device): cuda:1
[Step 1581] GPU 0 memory after moving logits to GPU 1: 16.86 GB
[Step 1581] Teacher logits device after move: cuda:1, shape: torch.Size([2, 764, 151936])
[Step 1581] GPU 0 memory after del: 16.39 GB
[Step 1581] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 1581] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 37.09 GB
[Step 1581] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 1581] Sequence length: 764, Batch size: 2
[Step 1581] After KL computation - GPU 1: 38.95 GB
[Step 1581] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  1%|                                                                                       | 99/10000 [35:14<59:58:00, 21.80s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 1591] ========== MEMORY DEBUG ==========
[Step 1591] Model device: cuda:1
[Step 1591] Input device: cuda:1
[Step 1591] Teacher model device: cuda:0
[Step 1591] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 1591] GPU 1 memory: 33.77 GB (reserved: 47.99 GB)
[Step 1591] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 1591] Student model device: cuda:1
[Step 1591] GPU 0 memory before teacher forward: 16.39 GB
[Step 1591] GPU 0 memory after moving inputs: 16.39 GB
[Step 1591] GPU 0 memory after teacher forward: 17.01 GB
[Step 1591] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 1591] Teacher logits device before move: cuda:0
[Step 1591] Target device (student_logits.device): cuda:1
[Step 1591] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 1591] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 1591] GPU 0 memory after del: 16.39 GB
[Step 1591] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 1591] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.02 GB
[Step 1591] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 1591] Sequence length: 1024, Batch size: 2
[Step 1591] After KL computation - GPU 1: 40.51 GB
[Step 1591] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  1%|                                                                                      | 100/10000 [35:35<59:09:10, 21.51s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 4.9500000000000004e-05, 'epoch': 0.01}

[Step 1601] ========== MEMORY DEBUG ==========
[Step 1601] Model device: cuda:1
[Step 1601] Input device: cuda:1
[Step 1601] Teacher model device: cuda:0
[Step 1601] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 1601] GPU 1 memory: 25.33 GB (reserved: 45.88 GB)
[Step 1601] Student logits device: cuda:1, shape: torch.Size([2, 771, 151936]), dtype: torch.float32
[Step 1601] Student model device: cuda:1
[Step 1601] GPU 0 memory before teacher forward: 16.39 GB
[Step 1601] GPU 0 memory after moving inputs: 16.39 GB
[Step 1601] GPU 0 memory after teacher forward: 16.86 GB
[Step 1601] Teacher logits shape: torch.Size([2, 771, 151936]), dtype: torch.float16
[Step 1601] Teacher logits device before move: cuda:0
[Step 1601] Target device (student_logits.device): cuda:1
[Step 1601] GPU 0 memory after moving logits to GPU 1: 16.86 GB
[Step 1601] Teacher logits device after move: cuda:1, shape: torch.Size([2, 771, 151936])
[Step 1601] GPU 0 memory after del: 16.39 GB
[Step 1601] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 1601] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 28.68 GB
[Step 1601] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 1601] Sequence length: 771, Batch size: 2
[Step 1601] After KL computation - GPU 1: 30.56 GB
[Step 1601] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 1611] ========== MEMORY DEBUG ==========
[Step 1611] Model device: cuda:1
[Step 1611] Input device: cuda:1
[Step 1611] Teacher model device: cuda:0
[Step 1611] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 1611] GPU 1 memory: 33.76 GB (reserved: 47.89 GB)
[Step 1611] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 1611] Student model device: cuda:1
[Step 1611] GPU 0 memory before teacher forward: 16.39 GB
[Step 1611] GPU 0 memory after moving inputs: 16.39 GB
[Step 1611] GPU 0 memory after teacher forward: 17.01 GB
[Step 1611] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 1611] Teacher logits device before move: cuda:0
[Step 1611] Target device (student_logits.device): cuda:1
[Step 1611] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 1611] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 1611] GPU 0 memory after del: 16.39 GB
[Step 1611] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 1611] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 1611] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 1611] Sequence length: 1024, Batch size: 2
[Step 1611] After KL computation - GPU 1: 40.50 GB
[Step 1611] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  1%|                                                                                      | 101/10000 [35:58<60:46:52, 22.10s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None

[Step 1621] ========== MEMORY DEBUG ==========
[Step 1621] Model device: cuda:1
[Step 1621] Input device: cuda:1
[Step 1621] Teacher model device: cuda:0
[Step 1621] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 1621] GPU 1 memory: 33.77 GB (reserved: 40.69 GB)
[Step 1621] Student logits device: cuda:1, shape: torch.Size([2, 237, 151936]), dtype: torch.float32
[Step 1621] Student model device: cuda:1
[Step 1621] GPU 0 memory before teacher forward: 16.39 GB
[Step 1621] GPU 0 memory after moving inputs: 16.39 GB
[Step 1621] GPU 0 memory after teacher forward: 16.54 GB
[Step 1621] Teacher logits shape: torch.Size([2, 237, 151936]), dtype: torch.float16
[Step 1621] Teacher logits device before move: cuda:0
[Step 1621] Target device (student_logits.device): cuda:1
[Step 1621] GPU 0 memory after moving logits to GPU 1: 16.54 GB
[Step 1621] Teacher logits device after move: cuda:1, shape: torch.Size([2, 237, 151936])
[Step 1621] GPU 0 memory after del: 16.39 GB
[Step 1621] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 1621] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 35.23 GB
[Step 1621] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 1621] Sequence length: 237, Batch size: 2
[Step 1621] After KL computation - GPU 1: 35.81 GB
[Step 1621] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(

[Step 1631] ========== MEMORY DEBUG ==========
[Step 1631] Model device: cuda:1
[Step 1631] Input device: cuda:1
[Step 1631] Teacher model device: cuda:0
[Step 1631] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 1631] GPU 1 memory: 33.77 GB (reserved: 48.03 GB)
[Step 1631] Student logits device: cuda:1, shape: torch.Size([2, 399, 151936]), dtype: torch.float32
[Step 1631] Student model device: cuda:1
[Step 1631] GPU 0 memory before teacher forward: 16.39 GB
[Step 1631] GPU 0 memory after moving inputs: 16.39 GB
[Step 1631] GPU 0 memory after teacher forward: 16.64 GB
[Step 1631] Teacher logits shape: torch.Size([2, 399, 151936]), dtype: torch.float16
[Step 1631] Teacher logits device before move: cuda:0
[Step 1631] Target device (student_logits.device): cuda:1
[Step 1631] GPU 0 memory after moving logits to GPU 1: 16.64 GB
[Step 1631] Teacher logits device after move: cuda:1, shape: torch.Size([2, 399, 151936])
[Step 1631] GPU 0 memory after del: 16.39 GB
[Step 1631] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 1631] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 35.81 GB
[Step 1631] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 1631] Sequence length: 399, Batch size: 2
[Step 1631] After KL computation - GPU 1: 36.78 GB
[Step 1631] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  1%|                                                                                      | 102/10000 [36:19<59:45:35, 21.74s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 1641] ========== MEMORY DEBUG ==========
[Step 1641] Model device: cuda:1
[Step 1641] Input device: cuda:1
[Step 1641] Teacher model device: cuda:0
[Step 1641] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 1641] GPU 1 memory: 33.76 GB (reserved: 47.52 GB)
[Step 1641] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 1641] Student model device: cuda:1
[Step 1641] GPU 0 memory before teacher forward: 16.39 GB
[Step 1641] GPU 0 memory after moving inputs: 16.39 GB
[Step 1641] GPU 0 memory after teacher forward: 17.01 GB
[Step 1641] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 1641] Teacher logits device before move: cuda:0
[Step 1641] Target device (student_logits.device): cuda:1
[Step 1641] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 1641] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 1641] GPU 0 memory after del: 16.39 GB
[Step 1641] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 1641] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 1641] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 1641] Sequence length: 1024, Batch size: 2
[Step 1641] After KL computation - GPU 1: 40.50 GB
[Step 1641] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  1%|                                                                                      | 103/10000 [36:40<59:12:04, 21.53s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None

[Step 1651] ========== MEMORY DEBUG ==========
[Step 1651] Model device: cuda:1
[Step 1651] Input device: cuda:1
[Step 1651] Teacher model device: cuda:0
[Step 1651] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 1651] GPU 1 memory: 33.77 GB (reserved: 47.44 GB)
[Step 1651] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 1651] Student model device: cuda:1
[Step 1651] GPU 0 memory before teacher forward: 16.39 GB
[Step 1651] GPU 0 memory after moving inputs: 16.39 GB
[Step 1651] GPU 0 memory after teacher forward: 17.01 GB
[Step 1651] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 1651] Teacher logits device before move: cuda:0
[Step 1651] Target device (student_logits.device): cuda:1
[Step 1651] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 1651] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 1651] GPU 0 memory after del: 16.39 GB
[Step 1651] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 1651] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.02 GB
[Step 1651] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 1651] Sequence length: 1024, Batch size: 2
[Step 1651] After KL computation - GPU 1: 40.51 GB
[Step 1651] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(

[Step 1661] ========== MEMORY DEBUG ==========
[Step 1661] Model device: cuda:1
[Step 1661] Input device: cuda:1
[Step 1661] Teacher model device: cuda:0
[Step 1661] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 1661] GPU 1 memory: 33.77 GB (reserved: 48.00 GB)
[Step 1661] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 1661] Student model device: cuda:1
[Step 1661] GPU 0 memory before teacher forward: 16.39 GB
[Step 1661] GPU 0 memory after moving inputs: 16.39 GB
[Step 1661] GPU 0 memory after teacher forward: 17.01 GB
[Step 1661] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 1661] Teacher logits device before move: cuda:0
[Step 1661] Target device (student_logits.device): cuda:1
[Step 1661] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 1661] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 1661] GPU 0 memory after del: 16.39 GB
[Step 1661] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 1661] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.02 GB
[Step 1661] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 1661] Sequence length: 1024, Batch size: 2
[Step 1661] After KL computation - GPU 1: 40.51 GB
[Step 1661] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  1%|                                                                                      | 104/10000 [37:02<59:47:38, 21.75s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None

[Step 1671] ========== MEMORY DEBUG ==========
[Step 1671] Model device: cuda:1
[Step 1671] Input device: cuda:1
[Step 1671] Teacher model device: cuda:0
[Step 1671] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 1671] GPU 1 memory: 33.76 GB (reserved: 41.94 GB)
[Step 1671] Student logits device: cuda:1, shape: torch.Size([2, 246, 151936]), dtype: torch.float32
[Step 1671] Student model device: cuda:1
[Step 1671] GPU 0 memory before teacher forward: 16.39 GB
[Step 1671] GPU 0 memory after moving inputs: 16.39 GB
[Step 1671] GPU 0 memory after teacher forward: 16.54 GB
[Step 1671] Teacher logits shape: torch.Size([2, 246, 151936]), dtype: torch.float16
[Step 1671] Teacher logits device before move: cuda:0
[Step 1671] Target device (student_logits.device): cuda:1
[Step 1671] GPU 0 memory after moving logits to GPU 1: 16.54 GB
[Step 1671] Teacher logits device after move: cuda:1, shape: torch.Size([2, 246, 151936])
[Step 1671] GPU 0 memory after del: 16.39 GB
[Step 1671] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 1671] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 35.26 GB
[Step 1671] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 1671] Sequence length: 246, Batch size: 2
[Step 1671] After KL computation - GPU 1: 35.86 GB
[Step 1671] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(
  1%|                                                                                      | 105/10000 [37:23<59:02:08, 21.48s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None

[Step 1681] ========== MEMORY DEBUG ==========
[Step 1681] Model device: cuda:1
[Step 1681] Input device: cuda:1
[Step 1681] Teacher model device: cuda:0
[Step 1681] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 1681] GPU 1 memory: 25.33 GB (reserved: 47.72 GB)
[Step 1681] Student logits device: cuda:1, shape: torch.Size([2, 623, 151936]), dtype: torch.float32
[Step 1681] Student model device: cuda:1
[Step 1681] GPU 0 memory before teacher forward: 16.39 GB
[Step 1681] GPU 0 memory after moving inputs: 16.39 GB
[Step 1681] GPU 0 memory after teacher forward: 16.77 GB
[Step 1681] Teacher logits shape: torch.Size([2, 623, 151936]), dtype: torch.float16
[Step 1681] Teacher logits device before move: cuda:0
[Step 1681] Target device (student_logits.device): cuda:1
[Step 1681] GPU 0 memory after moving logits to GPU 1: 16.77 GB
[Step 1681] Teacher logits device after move: cuda:1, shape: torch.Size([2, 623, 151936])
[Step 1681] GPU 0 memory after del: 16.39 GB
[Step 1681] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 1681] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 28.15 GB
[Step 1681] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 1681] Sequence length: 623, Batch size: 2
[Step 1681] After KL computation - GPU 1: 29.67 GB
[Step 1681] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 1691] ========== MEMORY DEBUG ==========
[Step 1691] Model device: cuda:1
[Step 1691] Input device: cuda:1
[Step 1691] Teacher model device: cuda:0
[Step 1691] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 1691] GPU 1 memory: 33.77 GB (reserved: 46.13 GB)
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
[Step 1691] Student logits device: cuda:1, shape: torch.Size([2, 779, 151936]), dtype: torch.float32
[Step 1691] Student model device: cuda:1
[Step 1691] GPU 0 memory before teacher forward: 16.39 GB
[Step 1691] GPU 0 memory after moving inputs: 16.39 GB
[Step 1691] GPU 0 memory after teacher forward: 16.87 GB
[Step 1691] Teacher logits shape: torch.Size([2, 779, 151936]), dtype: torch.float16
[Step 1691] Teacher logits device before move: cuda:0
[Step 1691] Target device (student_logits.device): cuda:1
[Step 1691] GPU 0 memory after moving logits to GPU 1: 16.87 GB
[Step 1691] Teacher logits device after move: cuda:1, shape: torch.Size([2, 779, 151936])
[Step 1691] GPU 0 memory after del: 16.39 GB
[Step 1691] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 1691] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 37.15 GB
[Step 1691] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 1691] Sequence length: 779, Batch size: 2
[Step 1691] After KL computation - GPU 1: 39.04 GB
[Step 1691] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  1%|                                                                                      | 106/10000 [37:44<58:25:31, 21.26s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 1701] ========== MEMORY DEBUG ==========
[Step 1701] Model device: cuda:1
[Step 1701] Input device: cuda:1
[Step 1701] Teacher model device: cuda:0
[Step 1701] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 1701] GPU 1 memory: 33.76 GB (reserved: 47.71 GB)
[Step 1701] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 1701] Student model device: cuda:1
[Step 1701] GPU 0 memory before teacher forward: 16.39 GB
[Step 1701] GPU 0 memory after moving inputs: 16.39 GB
[Step 1701] GPU 0 memory after teacher forward: 17.01 GB
[Step 1701] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 1701] Teacher logits device before move: cuda:0
[Step 1701] Target device (student_logits.device): cuda:1
[Step 1701] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 1701] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 1701] GPU 0 memory after del: 16.39 GB
[Step 1701] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 1701] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 1701] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 1701] Sequence length: 1024, Batch size: 2
[Step 1701] After KL computation - GPU 1: 40.50 GB
[Step 1701] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 1711] ========== MEMORY DEBUG ==========
[Step 1711] Model device: cuda:1
[Step 1711] Input device: cuda:1
[Step 1711] Teacher model device: cuda:0
[Step 1711] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 1711] GPU 1 memory: 33.76 GB (reserved: 47.59 GB)
[Step 1711] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 1711] Student model device: cuda:1
[Step 1711] GPU 0 memory before teacher forward: 16.39 GB
[Step 1711] GPU 0 memory after moving inputs: 16.39 GB
[Step 1711] GPU 0 memory after teacher forward: 17.01 GB
[Step 1711] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 1711] Teacher logits device before move: cuda:0
[Step 1711] Target device (student_logits.device): cuda:1
[Step 1711] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 1711] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 1711] GPU 0 memory after del: 16.39 GB
[Step 1711] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 1711] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 1711] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 1711] Sequence length: 1024, Batch size: 2
[Step 1711] After KL computation - GPU 1: 40.50 GB
[Step 1711] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  1%|                                                                                      | 107/10000 [38:07<59:37:18, 21.70s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 1721] ========== MEMORY DEBUG ==========
[Step 1721] Model device: cuda:1
[Step 1721] Input device: cuda:1
[Step 1721] Teacher model device: cuda:0
[Step 1721] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 1721] GPU 1 memory: 33.77 GB (reserved: 47.40 GB)
[Step 1721] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 1721] Student model device: cuda:1
[Step 1721] GPU 0 memory before teacher forward: 16.39 GB
[Step 1721] GPU 0 memory after moving inputs: 16.39 GB
[Step 1721] GPU 0 memory after teacher forward: 17.01 GB
[Step 1721] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 1721] Teacher logits device before move: cuda:0
[Step 1721] Target device (student_logits.device): cuda:1
[Step 1721] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 1721] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 1721] GPU 0 memory after del: 16.39 GB
[Step 1721] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 1721] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.02 GB
[Step 1721] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 1721] Sequence length: 1024, Batch size: 2
[Step 1721] After KL computation - GPU 1: 40.51 GB
[Step 1721] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  1%|                                                                                      | 108/10000 [38:28<58:57:24, 21.46s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 1731] ========== MEMORY DEBUG ==========
[Step 1731] Model device: cuda:1
[Step 1731] Input device: cuda:1
[Step 1731] Teacher model device: cuda:0
[Step 1731] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 1731] GPU 1 memory: 33.76 GB (reserved: 47.60 GB)
[Step 1731] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 1731] Student model device: cuda:1
[Step 1731] GPU 0 memory before teacher forward: 16.39 GB
[Step 1731] GPU 0 memory after moving inputs: 16.39 GB
[Step 1731] GPU 0 memory after teacher forward: 17.01 GB
[Step 1731] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 1731] Teacher logits device before move: cuda:0
[Step 1731] Target device (student_logits.device): cuda:1
[Step 1731] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 1731] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 1731] GPU 0 memory after del: 16.39 GB
[Step 1731] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 1731] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 1731] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 1731] Sequence length: 1024, Batch size: 2
[Step 1731] After KL computation - GPU 1: 40.50 GB
[Step 1731] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 1741] ========== MEMORY DEBUG ==========
[Step 1741] Model device: cuda:1
[Step 1741] Input device: cuda:1
[Step 1741] Teacher model device: cuda:0
[Step 1741] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 1741] GPU 1 memory: 33.76 GB (reserved: 40.51 GB)
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
[Step 1741] Student logits device: cuda:1, shape: torch.Size([2, 682, 151936]), dtype: torch.float32
[Step 1741] Student model device: cuda:1
[Step 1741] GPU 0 memory before teacher forward: 16.39 GB
[Step 1741] GPU 0 memory after moving inputs: 16.39 GB
[Step 1741] GPU 0 memory after teacher forward: 16.81 GB
[Step 1741] Teacher logits shape: torch.Size([2, 682, 151936]), dtype: torch.float16
[Step 1741] Teacher logits device before move: cuda:0
[Step 1741] Target device (student_logits.device): cuda:1
[Step 1741] GPU 0 memory after moving logits to GPU 1: 16.81 GB
[Step 1741] Teacher logits device after move: cuda:1, shape: torch.Size([2, 682, 151936])
[Step 1741] GPU 0 memory after del: 16.39 GB
[Step 1741] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 1741] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 36.80 GB
[Step 1741] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 1741] Sequence length: 682, Batch size: 2
[Step 1741] After KL computation - GPU 1: 38.46 GB
[Step 1741] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  1%|                                                                                      | 109/10000 [38:50<59:22:08, 21.61s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 1751] ========== MEMORY DEBUG ==========
[Step 1751] Model device: cuda:1
[Step 1751] Input device: cuda:1
[Step 1751] Teacher model device: cuda:0
[Step 1751] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 1751] GPU 1 memory: 33.77 GB (reserved: 47.69 GB)
[Step 1751] Student logits device: cuda:1, shape: torch.Size([2, 331, 151936]), dtype: torch.float32
[Step 1751] Student model device: cuda:1
[Step 1751] GPU 0 memory before teacher forward: 16.39 GB
[Step 1751] GPU 0 memory after moving inputs: 16.39 GB
[Step 1751] GPU 0 memory after teacher forward: 16.59 GB
[Step 1751] Teacher logits shape: torch.Size([2, 331, 151936]), dtype: torch.float16
[Step 1751] Teacher logits device before move: cuda:0
[Step 1751] Target device (student_logits.device): cuda:1
[Step 1751] GPU 0 memory after moving logits to GPU 1: 16.59 GB
[Step 1751] Teacher logits device after move: cuda:1, shape: torch.Size([2, 331, 151936])
[Step 1751] GPU 0 memory after del: 16.39 GB
[Step 1751] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 1751] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 35.57 GB
[Step 1751] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 1751] Sequence length: 331, Batch size: 2
[Step 1751] After KL computation - GPU 1: 36.37 GB
[Step 1751] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  1%|                                                                                      | 110/10000 [39:12<59:49:41, 21.78s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 4.995454545454546e-05, 'epoch': 0.01}

[Step 1761] ========== MEMORY DEBUG ==========
[Step 1761] Model device: cuda:1
[Step 1761] Input device: cuda:1
[Step 1761] Teacher model device: cuda:0
[Step 1761] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 1761] GPU 1 memory: 25.33 GB (reserved: 47.47 GB)
[Step 1761] Student logits device: cuda:1, shape: torch.Size([2, 664, 151936]), dtype: torch.float32
[Step 1761] Student model device: cuda:1
[Step 1761] GPU 0 memory before teacher forward: 16.39 GB
[Step 1761] GPU 0 memory after moving inputs: 16.39 GB
[Step 1761] GPU 0 memory after teacher forward: 16.80 GB
[Step 1761] Teacher logits shape: torch.Size([2, 664, 151936]), dtype: torch.float16
[Step 1761] Teacher logits device before move: cuda:0
[Step 1761] Target device (student_logits.device): cuda:1
[Step 1761] GPU 0 memory after moving logits to GPU 1: 16.80 GB
[Step 1761] Teacher logits device after move: cuda:1, shape: torch.Size([2, 664, 151936])
[Step 1761] GPU 0 memory after del: 16.39 GB
[Step 1761] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 1761] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 28.30 GB
[Step 1761] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 1761] Sequence length: 664, Batch size: 2
[Step 1761] After KL computation - GPU 1: 29.92 GB
[Step 1761] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(

[Step 1771] ========== MEMORY DEBUG ==========
[Step 1771] Model device: cuda:1
[Step 1771] Input device: cuda:1
[Step 1771] Teacher model device: cuda:0
[Step 1771] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 1771] GPU 1 memory: 33.77 GB (reserved: 41.97 GB)
[Step 1771] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 1771] Student model device: cuda:1
[Step 1771] GPU 0 memory before teacher forward: 16.39 GB
[Step 1771] GPU 0 memory after moving inputs: 16.39 GB
[Step 1771] GPU 0 memory after teacher forward: 17.01 GB
[Step 1771] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 1771] Teacher logits device before move: cuda:0
[Step 1771] Target device (student_logits.device): cuda:1
[Step 1771] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 1771] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 1771] GPU 0 memory after del: 16.39 GB
[Step 1771] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 1771] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.02 GB
[Step 1771] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 1771] Sequence length: 1024, Batch size: 2
[Step 1771] After KL computation - GPU 1: 40.51 GB
[Step 1771] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  1%|                                                                                      | 111/10000 [39:32<58:58:06, 21.47s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None

[Step 1781] ========== MEMORY DEBUG ==========
[Step 1781] Model device: cuda:1
[Step 1781] Input device: cuda:1
[Step 1781] Teacher model device: cuda:0
[Step 1781] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 1781] GPU 1 memory: 33.76 GB (reserved: 47.65 GB)
[Step 1781] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 1781] Student model device: cuda:1
[Step 1781] GPU 0 memory before teacher forward: 16.39 GB
[Step 1781] GPU 0 memory after moving inputs: 16.39 GB
[Step 1781] GPU 0 memory after teacher forward: 17.01 GB
[Step 1781] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 1781] Teacher logits device before move: cuda:0
[Step 1781] Target device (student_logits.device): cuda:1
[Step 1781] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 1781] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 1781] GPU 0 memory after del: 16.39 GB
[Step 1781] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 1781] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 1781] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 1781] Sequence length: 1024, Batch size: 2
[Step 1781] After KL computation - GPU 1: 40.50 GB
[Step 1781] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 1791] ========== MEMORY DEBUG ==========
[Step 1791] Model device: cuda:1
[Step 1791] Input device: cuda:1
[Step 1791] Teacher model device: cuda:0
[Step 1791] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 1791] GPU 1 memory: 33.76 GB (reserved: 44.49 GB)
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
[Step 1791] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 1791] Student model device: cuda:1
[Step 1791] GPU 0 memory before teacher forward: 16.39 GB
[Step 1791] GPU 0 memory after moving inputs: 16.39 GB
[Step 1791] GPU 0 memory after teacher forward: 17.01 GB
[Step 1791] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 1791] Teacher logits device before move: cuda:0
[Step 1791] Target device (student_logits.device): cuda:1
[Step 1791] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 1791] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 1791] GPU 0 memory after del: 16.39 GB
[Step 1791] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 1791] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 1791] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 1791] Sequence length: 1024, Batch size: 2
[Step 1791] After KL computation - GPU 1: 40.50 GB
[Step 1791] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  1%|                                                                                      | 112/10000 [39:53<58:09:32, 21.17s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 1801] ========== MEMORY DEBUG ==========
[Step 1801] Model device: cuda:1
[Step 1801] Input device: cuda:1
[Step 1801] Teacher model device: cuda:0
[Step 1801] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 1801] GPU 1 memory: 33.77 GB (reserved: 42.63 GB)
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
[Step 1801] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 1801] Student model device: cuda:1
[Step 1801] GPU 0 memory before teacher forward: 16.39 GB
[Step 1801] GPU 0 memory after moving inputs: 16.39 GB
[Step 1801] GPU 0 memory after teacher forward: 17.01 GB
[Step 1801] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 1801] Teacher logits device before move: cuda:0
[Step 1801] Target device (student_logits.device): cuda:1
[Step 1801] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 1801] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 1801] GPU 0 memory after del: 16.39 GB
[Step 1801] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 1801] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.02 GB
[Step 1801] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 1801] Sequence length: 1024, Batch size: 2
[Step 1801] After KL computation - GPU 1: 40.51 GB
[Step 1801] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  1%|                                                                                      | 113/10000 [40:14<57:47:09, 21.04s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None

[Step 1811] ========== MEMORY DEBUG ==========
[Step 1811] Model device: cuda:1
[Step 1811] Input device: cuda:1
[Step 1811] Teacher model device: cuda:0
[Step 1811] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 1811] GPU 1 memory: 33.76 GB (reserved: 45.23 GB)
  warnings.warn(
[Step 1811] Student logits device: cuda:1, shape: torch.Size([2, 919, 151936]), dtype: torch.float32
[Step 1811] Student model device: cuda:1
[Step 1811] GPU 0 memory before teacher forward: 16.39 GB
[Step 1811] GPU 0 memory after moving inputs: 16.39 GB
[Step 1811] GPU 0 memory after teacher forward: 16.95 GB
[Step 1811] Teacher logits shape: torch.Size([2, 919, 151936]), dtype: torch.float16
[Step 1811] Teacher logits device before move: cuda:0
[Step 1811] Target device (student_logits.device): cuda:1
[Step 1811] GPU 0 memory after moving logits to GPU 1: 16.95 GB
[Step 1811] Teacher logits device after move: cuda:1, shape: torch.Size([2, 919, 151936])
[Step 1811] GPU 0 memory after del: 16.39 GB
[Step 1811] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 1811] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 37.64 GB
[Step 1811] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 1811] Sequence length: 919, Batch size: 2
[Step 1811] After KL computation - GPU 1: 39.88 GB
[Step 1811] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 1821] ========== MEMORY DEBUG ==========
[Step 1821] Model device: cuda:1
[Step 1821] Input device: cuda:1
[Step 1821] Teacher model device: cuda:0
[Step 1821] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 1821] GPU 1 memory: 33.76 GB (reserved: 47.44 GB)
[Step 1821] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 1821] Student model device: cuda:1
[Step 1821] GPU 0 memory before teacher forward: 16.39 GB
[Step 1821] GPU 0 memory after moving inputs: 16.39 GB
[Step 1821] GPU 0 memory after teacher forward: 17.01 GB
[Step 1821] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 1821] Teacher logits device before move: cuda:0
[Step 1821] Target device (student_logits.device): cuda:1
[Step 1821] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 1821] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 1821] GPU 0 memory after del: 16.39 GB
[Step 1821] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 1821] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 1821] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 1821] Sequence length: 1024, Batch size: 2
[Step 1821] After KL computation - GPU 1: 40.50 GB
[Step 1821] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  1%|                                                                                      | 114/10000 [40:36<58:39:22, 21.36s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None

[Step 1831] ========== MEMORY DEBUG ==========
[Step 1831] Model device: cuda:1
[Step 1831] Input device: cuda:1
[Step 1831] Teacher model device: cuda:0
[Step 1831] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 1831] GPU 1 memory: 33.76 GB (reserved: 43.52 GB)
[Step 1831] Student logits device: cuda:1, shape: torch.Size([2, 385, 151936]), dtype: torch.float32
[Step 1831] Student model device: cuda:1
[Step 1831] GPU 0 memory before teacher forward: 16.39 GB
[Step 1831] GPU 0 memory after moving inputs: 16.39 GB
[Step 1831] GPU 0 memory after teacher forward: 16.63 GB
[Step 1831] Teacher logits shape: torch.Size([2, 385, 151936]), dtype: torch.float16
[Step 1831] Teacher logits device before move: cuda:0
[Step 1831] Target device (student_logits.device): cuda:1
[Step 1831] GPU 0 memory after moving logits to GPU 1: 16.63 GB
[Step 1831] Teacher logits device after move: cuda:1, shape: torch.Size([2, 385, 151936])
[Step 1831] GPU 0 memory after del: 16.39 GB
[Step 1831] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 1831] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 35.75 GB
[Step 1831] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 1831] Sequence length: 385, Batch size: 2
[Step 1831] After KL computation - GPU 1: 36.69 GB
[Step 1831] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  1%|                                                                                      | 115/10000 [40:56<57:25:04, 20.91s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None

[Step 1841] ========== MEMORY DEBUG ==========
[Step 1841] Model device: cuda:1
[Step 1841] Input device: cuda:1
[Step 1841] Teacher model device: cuda:0
[Step 1841] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 1841] GPU 1 memory: 25.33 GB (reserved: 47.72 GB)
[Step 1841] Student logits device: cuda:1, shape: torch.Size([2, 753, 151936]), dtype: torch.float32
[Step 1841] Student model device: cuda:1
[Step 1841] GPU 0 memory before teacher forward: 16.39 GB
[Step 1841] GPU 0 memory after moving inputs: 16.39 GB
[Step 1841] GPU 0 memory after teacher forward: 16.85 GB
[Step 1841] Teacher logits shape: torch.Size([2, 753, 151936]), dtype: torch.float16
[Step 1841] Teacher logits device before move: cuda:0
[Step 1841] Target device (student_logits.device): cuda:1
[Step 1841] GPU 0 memory after moving logits to GPU 1: 16.85 GB
[Step 1841] Teacher logits device after move: cuda:1, shape: torch.Size([2, 753, 151936])
[Step 1841] GPU 0 memory after del: 16.39 GB
[Step 1841] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 1841] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 28.62 GB
[Step 1841] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 1841] Sequence length: 753, Batch size: 2
[Step 1841] After KL computation - GPU 1: 30.45 GB
[Step 1841] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 1851] ========== MEMORY DEBUG ==========
[Step 1851] Model device: cuda:1
[Step 1851] Input device: cuda:1
[Step 1851] Teacher model device: cuda:0
[Step 1851] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 1851] GPU 1 memory: 33.77 GB (reserved: 42.40 GB)
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
[Step 1851] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 1851] Student model device: cuda:1
[Step 1851] GPU 0 memory before teacher forward: 16.39 GB
[Step 1851] GPU 0 memory after moving inputs: 16.39 GB
[Step 1851] GPU 0 memory after teacher forward: 17.01 GB
[Step 1851] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 1851] Teacher logits device before move: cuda:0
[Step 1851] Target device (student_logits.device): cuda:1
[Step 1851] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 1851] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 1851] GPU 0 memory after del: 16.39 GB
[Step 1851] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 1851] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.02 GB
[Step 1851] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 1851] Sequence length: 1024, Batch size: 2
[Step 1851] After KL computation - GPU 1: 40.51 GB
[Step 1851] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  1%|                                                                                      | 116/10000 [41:17<57:53:01, 21.08s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 1861] ========== MEMORY DEBUG ==========
[Step 1861] Model device: cuda:1
[Step 1861] Input device: cuda:1
[Step 1861] Teacher model device: cuda:0
[Step 1861] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 1861] GPU 1 memory: 33.77 GB (reserved: 47.83 GB)
[Step 1861] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 1861] Student model device: cuda:1
[Step 1861] GPU 0 memory before teacher forward: 16.39 GB
[Step 1861] GPU 0 memory after moving inputs: 16.39 GB
[Step 1861] GPU 0 memory after teacher forward: 17.01 GB
[Step 1861] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 1861] Teacher logits device before move: cuda:0
[Step 1861] Target device (student_logits.device): cuda:1
[Step 1861] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 1861] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 1861] GPU 0 memory after del: 16.39 GB
[Step 1861] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 1861] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.02 GB
[Step 1861] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 1861] Sequence length: 1024, Batch size: 2
[Step 1861] After KL computation - GPU 1: 40.51 GB
[Step 1861] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 1871] ========== MEMORY DEBUG ==========
[Step 1871] Model device: cuda:1
[Step 1871] Input device: cuda:1
[Step 1871] Teacher model device: cuda:0
[Step 1871] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 1871] GPU 1 memory: 33.77 GB (reserved: 47.86 GB)
[Step 1871] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 1871] Student model device: cuda:1
[Step 1871] GPU 0 memory before teacher forward: 16.39 GB
[Step 1871] GPU 0 memory after moving inputs: 16.39 GB
[Step 1871] GPU 0 memory after teacher forward: 17.01 GB
[Step 1871] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 1871] Teacher logits device before move: cuda:0
[Step 1871] Target device (student_logits.device): cuda:1
[Step 1871] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 1871] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 1871] GPU 0 memory after del: 16.39 GB
[Step 1871] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 1871] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.02 GB
[Step 1871] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 1871] Sequence length: 1024, Batch size: 2
[Step 1871] After KL computation - GPU 1: 40.50 GB
[Step 1871] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  1%|                                                                                      | 117/10000 [41:39<58:22:44, 21.27s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 1881] ========== MEMORY DEBUG ==========
[Step 1881] Model device: cuda:1
[Step 1881] Input device: cuda:1
[Step 1881] Teacher model device: cuda:0
[Step 1881] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 1881] GPU 1 memory: 33.77 GB (reserved: 47.75 GB)
[Step 1881] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 1881] Student model device: cuda:1
[Step 1881] GPU 0 memory before teacher forward: 16.39 GB
[Step 1881] GPU 0 memory after moving inputs: 16.39 GB
[Step 1881] GPU 0 memory after teacher forward: 17.01 GB
[Step 1881] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 1881] Teacher logits device before move: cuda:0
[Step 1881] Target device (student_logits.device): cuda:1
[Step 1881] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 1881] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 1881] GPU 0 memory after del: 16.39 GB
[Step 1881] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 1881] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.02 GB
[Step 1881] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 1881] Sequence length: 1024, Batch size: 2
[Step 1881] After KL computation - GPU 1: 40.51 GB
[Step 1881] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  1%|                                                                                      | 118/10000 [42:00<58:19:19, 21.25s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None

[Step 1891] ========== MEMORY DEBUG ==========
[Step 1891] Model device: cuda:1
[Step 1891] Input device: cuda:1
[Step 1891] Teacher model device: cuda:0
[Step 1891] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 1891] GPU 1 memory: 33.76 GB (reserved: 46.71 GB)
[Step 1891] Student logits device: cuda:1, shape: torch.Size([2, 145, 151936]), dtype: torch.float32
[Step 1891] Student model device: cuda:1
[Step 1891] GPU 0 memory before teacher forward: 16.39 GB
[Step 1891] GPU 0 memory after moving inputs: 16.39 GB
[Step 1891] GPU 0 memory after teacher forward: 16.48 GB
[Step 1891] Teacher logits shape: torch.Size([2, 145, 151936]), dtype: torch.float16
[Step 1891] Teacher logits device before move: cuda:0
[Step 1891] Target device (student_logits.device): cuda:1
[Step 1891] GPU 0 memory after moving logits to GPU 1: 16.48 GB
[Step 1891] Teacher logits device after move: cuda:1, shape: torch.Size([2, 145, 151936])
[Step 1891] GPU 0 memory after del: 16.39 GB
[Step 1891] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 1891] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 34.90 GB
[Step 1891] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 1891] Sequence length: 145, Batch size: 2
[Step 1891] After KL computation - GPU 1: 35.25 GB
[Step 1891] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 1901] ========== MEMORY DEBUG ==========
[Step 1901] Model device: cuda:1
[Step 1901] Input device: cuda:1
[Step 1901] Teacher model device: cuda:0
[Step 1901] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 1901] GPU 1 memory: 33.76 GB (reserved: 47.65 GB)
[Step 1901] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 1901] Student model device: cuda:1
[Step 1901] GPU 0 memory before teacher forward: 16.39 GB
[Step 1901] GPU 0 memory after moving inputs: 16.39 GB
[Step 1901] GPU 0 memory after teacher forward: 17.01 GB
[Step 1901] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 1901] Teacher logits device before move: cuda:0
[Step 1901] Target device (student_logits.device): cuda:1
[Step 1901] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 1901] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 1901] GPU 0 memory after del: 16.39 GB
[Step 1901] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 1901] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 1901] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 1901] Sequence length: 1024, Batch size: 2
[Step 1901] After KL computation - GPU 1: 40.50 GB
[Step 1901] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  1%|                                                                                      | 119/10000 [42:21<58:09:13, 21.19s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None

[Step 1911] ========== MEMORY DEBUG ==========
[Step 1911] Model device: cuda:1
[Step 1911] Input device: cuda:1
[Step 1911] Teacher model device: cuda:0
[Step 1911] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 1911] GPU 1 memory: 33.76 GB (reserved: 47.53 GB)
[Step 1911] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 1911] Student model device: cuda:1
[Step 1911] GPU 0 memory before teacher forward: 16.39 GB
[Step 1911] GPU 0 memory after moving inputs: 16.39 GB
[Step 1911] GPU 0 memory after teacher forward: 17.01 GB
[Step 1911] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 1911] Teacher logits device before move: cuda:0
[Step 1911] Target device (student_logits.device): cuda:1
[Step 1911] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 1911] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 1911] GPU 0 memory after del: 16.39 GB
[Step 1911] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 1911] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 1911] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 1911] Sequence length: 1024, Batch size: 2
[Step 1911] After KL computation - GPU 1: 40.50 GB
[Step 1911] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  1%|                                                                                      | 120/10000 [42:43<58:54:44, 21.47s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 4.9904040404040406e-05, 'epoch': 0.01}

[Step 1921] ========== MEMORY DEBUG ==========
[Step 1921] Model device: cuda:1
[Step 1921] Input device: cuda:1
[Step 1921] Teacher model device: cuda:0
[Step 1921] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 1921] GPU 1 memory: 25.33 GB (reserved: 42.64 GB)
  warnings.warn(
[Step 1921] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 1921] Student model device: cuda:1
[Step 1921] GPU 0 memory before teacher forward: 16.39 GB
[Step 1921] GPU 0 memory after moving inputs: 16.39 GB
[Step 1921] GPU 0 memory after teacher forward: 17.01 GB
[Step 1921] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 1921] Teacher logits device before move: cuda:0
[Step 1921] Target device (student_logits.device): cuda:1
[Step 1921] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 1921] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 1921] GPU 0 memory after del: 16.39 GB
[Step 1921] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 1921] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 29.58 GB
[Step 1921] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 1921] Sequence length: 1024, Batch size: 2
[Step 1921] After KL computation - GPU 1: 32.07 GB
[Step 1921] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 1931] ========== MEMORY DEBUG ==========
[Step 1931] Model device: cuda:1
[Step 1931] Input device: cuda:1
[Step 1931] Teacher model device: cuda:0
[Step 1931] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 1931] GPU 1 memory: 33.76 GB (reserved: 44.45 GB)
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
[Step 1931] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 1931] Student model device: cuda:1
[Step 1931] GPU 0 memory before teacher forward: 16.39 GB
[Step 1931] GPU 0 memory after moving inputs: 16.39 GB
[Step 1931] GPU 0 memory after teacher forward: 17.01 GB
[Step 1931] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 1931] Teacher logits device before move: cuda:0
[Step 1931] Target device (student_logits.device): cuda:1
[Step 1931] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 1931] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 1931] GPU 0 memory after del: 16.39 GB
[Step 1931] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 1931] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 1931] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 1931] Sequence length: 1024, Batch size: 2
[Step 1931] After KL computation - GPU 1: 40.50 GB
[Step 1931] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  1%|                                                                                      | 121/10000 [43:05<59:24:06, 21.65s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 1941] ========== MEMORY DEBUG ==========
[Step 1941] Model device: cuda:1
[Step 1941] Input device: cuda:1
[Step 1941] Teacher model device: cuda:0
[Step 1941] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 1941] GPU 1 memory: 33.76 GB (reserved: 47.61 GB)
[Step 1941] Student logits device: cuda:1, shape: torch.Size([2, 865, 151936]), dtype: torch.float32
[Step 1941] Student model device: cuda:1
[Step 1941] GPU 0 memory before teacher forward: 16.39 GB
[Step 1941] GPU 0 memory after moving inputs: 16.39 GB
[Step 1941] GPU 0 memory after teacher forward: 16.92 GB
[Step 1941] Teacher logits shape: torch.Size([2, 865, 151936]), dtype: torch.float16
[Step 1941] Teacher logits device before move: cuda:0
[Step 1941] Target device (student_logits.device): cuda:1
[Step 1941] GPU 0 memory after moving logits to GPU 1: 16.92 GB
[Step 1941] Teacher logits device after move: cuda:1, shape: torch.Size([2, 865, 151936])
[Step 1941] GPU 0 memory after del: 16.39 GB
[Step 1941] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 1941] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 37.45 GB
[Step 1941] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 1941] Sequence length: 865, Batch size: 2
[Step 1941] After KL computation - GPU 1: 39.55 GB
[Step 1941] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 1951] ========== MEMORY DEBUG ==========
[Step 1951] Model device: cuda:1
[Step 1951] Input device: cuda:1
[Step 1951] Teacher model device: cuda:0
[Step 1951] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 1951] GPU 1 memory: 33.76 GB (reserved: 47.74 GB)
[Step 1951] Student logits device: cuda:1, shape: torch.Size([2, 476, 151936]), dtype: torch.float32
[Step 1951] Student model device: cuda:1
[Step 1951] GPU 0 memory before teacher forward: 16.39 GB
[Step 1951] GPU 0 memory after moving inputs: 16.39 GB
[Step 1951] GPU 0 memory after teacher forward: 16.68 GB
[Step 1951] Teacher logits shape: torch.Size([2, 476, 151936]), dtype: torch.float16
[Step 1951] Teacher logits device before move: cuda:0
[Step 1951] Target device (student_logits.device): cuda:1
[Step 1951] GPU 0 memory after moving logits to GPU 1: 16.68 GB
[Step 1951] Teacher logits device after move: cuda:1, shape: torch.Size([2, 476, 151936])
[Step 1951] GPU 0 memory after del: 16.39 GB
[Step 1951] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 1951] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 36.07 GB
[Step 1951] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 1951] Sequence length: 476, Batch size: 2
[Step 1951] After KL computation - GPU 1: 37.23 GB
[Step 1951] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  1%|                                                                                      | 122/10000 [43:27<59:07:58, 21.55s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 1961] ========== MEMORY DEBUG ==========
[Step 1961] Model device: cuda:1
[Step 1961] Input device: cuda:1
[Step 1961] Teacher model device: cuda:0
[Step 1961] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 1961] GPU 1 memory: 33.76 GB (reserved: 46.08 GB)
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
[Step 1961] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 1961] Student model device: cuda:1
[Step 1961] GPU 0 memory before teacher forward: 16.39 GB
[Step 1961] GPU 0 memory after moving inputs: 16.39 GB
[Step 1961] GPU 0 memory after teacher forward: 17.01 GB
[Step 1961] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 1961] Teacher logits device before move: cuda:0
[Step 1961] Target device (student_logits.device): cuda:1
[Step 1961] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 1961] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 1961] GPU 0 memory after del: 16.39 GB
[Step 1961] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 1961] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 1961] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 1961] Sequence length: 1024, Batch size: 2
[Step 1961] After KL computation - GPU 1: 40.50 GB
[Step 1961] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  1%|                                                                                      | 123/10000 [43:47<58:34:21, 21.35s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None

[Step 1971] ========== MEMORY DEBUG ==========
[Step 1971] Model device: cuda:1
[Step 1971] Input device: cuda:1
[Step 1971] Teacher model device: cuda:0
[Step 1971] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 1971] GPU 1 memory: 33.76 GB (reserved: 47.63 GB)
[Step 1971] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 1971] Student model device: cuda:1
[Step 1971] GPU 0 memory before teacher forward: 16.39 GB
[Step 1971] GPU 0 memory after moving inputs: 16.39 GB
[Step 1971] GPU 0 memory after teacher forward: 17.01 GB
[Step 1971] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 1971] Teacher logits device before move: cuda:0
[Step 1971] Target device (student_logits.device): cuda:1
[Step 1971] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 1971] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 1971] GPU 0 memory after del: 16.39 GB
[Step 1971] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 1971] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 1971] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 1971] Sequence length: 1024, Batch size: 2
[Step 1971] After KL computation - GPU 1: 40.50 GB
[Step 1971] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(

[Step 1981] ========== MEMORY DEBUG ==========
[Step 1981] Model device: cuda:1
[Step 1981] Input device: cuda:1
[Step 1981] Teacher model device: cuda:0
[Step 1981] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 1981] GPU 1 memory: 33.76 GB (reserved: 48.21 GB)
[Step 1981] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 1981] Student model device: cuda:1
[Step 1981] GPU 0 memory before teacher forward: 16.39 GB
[Step 1981] GPU 0 memory after moving inputs: 16.39 GB
[Step 1981] GPU 0 memory after teacher forward: 17.01 GB
[Step 1981] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 1981] Teacher logits device before move: cuda:0
[Step 1981] Target device (student_logits.device): cuda:1
[Step 1981] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 1981] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 1981] GPU 0 memory after del: 16.39 GB
[Step 1981] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 1981] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 1981] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 1981] Sequence length: 1024, Batch size: 2
[Step 1981] After KL computation - GPU 1: 40.50 GB
[Step 1981] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  1%|                                                                                      | 124/10000 [44:09<58:54:47, 21.48s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None

[Step 1991] ========== MEMORY DEBUG ==========
[Step 1991] Model device: cuda:1
[Step 1991] Input device: cuda:1
[Step 1991] Teacher model device: cuda:0
[Step 1991] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 1991] GPU 1 memory: 33.76 GB (reserved: 48.05 GB)
[Step 1991] Student logits device: cuda:1, shape: torch.Size([2, 566, 151936]), dtype: torch.float32
[Step 1991] Student model device: cuda:1
[Step 1991] GPU 0 memory before teacher forward: 16.39 GB
[Step 1991] GPU 0 memory after moving inputs: 16.39 GB
[Step 1991] GPU 0 memory after teacher forward: 16.74 GB
[Step 1991] Teacher logits shape: torch.Size([2, 566, 151936]), dtype: torch.float16
[Step 1991] Teacher logits device before move: cuda:0
[Step 1991] Target device (student_logits.device): cuda:1
[Step 1991] GPU 0 memory after moving logits to GPU 1: 16.74 GB
[Step 1991] Teacher logits device after move: cuda:1, shape: torch.Size([2, 566, 151936])
[Step 1991] GPU 0 memory after del: 16.39 GB
[Step 1991] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 1991] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 36.39 GB
[Step 1991] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 1991] Sequence length: 566, Batch size: 2
[Step 1991] After KL computation - GPU 1: 37.77 GB
[Step 1991] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  1%|                                                                                      | 125/10000 [44:30<57:58:00, 21.13s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None

[Step 2001] ========== MEMORY DEBUG ==========
[Step 2001] Model device: cuda:1
[Step 2001] Input device: cuda:1
[Step 2001] Teacher model device: cuda:0
[Step 2001] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 2001] GPU 1 memory: 25.33 GB (reserved: 47.46 GB)
[Step 2001] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 2001] Student model device: cuda:1
[Step 2001] GPU 0 memory before teacher forward: 16.39 GB
[Step 2001] GPU 0 memory after moving inputs: 16.39 GB
[Step 2001] GPU 0 memory after teacher forward: 17.01 GB
[Step 2001] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 2001] Teacher logits device before move: cuda:0
[Step 2001] Target device (student_logits.device): cuda:1
[Step 2001] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 2001] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 2001] GPU 0 memory after del: 16.39 GB
[Step 2001] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 2001] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 29.58 GB
[Step 2001] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 2001] Sequence length: 1024, Batch size: 2
[Step 2001] After KL computation - GPU 1: 32.07 GB
[Step 2001] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 2011] ========== MEMORY DEBUG ==========
[Step 2011] Model device: cuda:1
[Step 2011] Input device: cuda:1
[Step 2011] Teacher model device: cuda:0
[Step 2011] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 2011] GPU 1 memory: 33.76 GB (reserved: 47.63 GB)
[Step 2011] Student logits device: cuda:1, shape: torch.Size([2, 970, 151936]), dtype: torch.float32
[Step 2011] Student model device: cuda:1
[Step 2011] GPU 0 memory before teacher forward: 16.39 GB
[Step 2011] GPU 0 memory after moving inputs: 16.39 GB
[Step 2011] GPU 0 memory after teacher forward: 16.98 GB
[Step 2011] Teacher logits shape: torch.Size([2, 970, 151936]), dtype: torch.float16
[Step 2011] Teacher logits device before move: cuda:0
[Step 2011] Target device (student_logits.device): cuda:1
[Step 2011] GPU 0 memory after moving logits to GPU 1: 16.98 GB
[Step 2011] Teacher logits device after move: cuda:1, shape: torch.Size([2, 970, 151936])
[Step 2011] GPU 0 memory after del: 16.39 GB
[Step 2011] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 2011] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 37.82 GB
[Step 2011] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 2011] Sequence length: 970, Batch size: 2
[Step 2011] After KL computation - GPU 1: 40.18 GB
[Step 2011] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  1%|                                                                                      | 126/10000 [44:51<58:06:24, 21.19s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 2021] ========== MEMORY DEBUG ==========
[Step 2021] Model device: cuda:1
[Step 2021] Input device: cuda:1
[Step 2021] Teacher model device: cuda:0
[Step 2021] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 2021] GPU 1 memory: 33.76 GB (reserved: 47.75 GB)
[Step 2021] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 2021] Student model device: cuda:1
[Step 2021] GPU 0 memory before teacher forward: 16.39 GB
[Step 2021] GPU 0 memory after moving inputs: 16.39 GB
[Step 2021] GPU 0 memory after teacher forward: 17.01 GB
[Step 2021] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 2021] Teacher logits device before move: cuda:0
[Step 2021] Target device (student_logits.device): cuda:1
[Step 2021] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 2021] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 2021] GPU 0 memory after del: 16.39 GB
[Step 2021] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 2021] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 2021] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 2021] Sequence length: 1024, Batch size: 2
[Step 2021] After KL computation - GPU 1: 40.50 GB
[Step 2021] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 2031] ========== MEMORY DEBUG ==========
[Step 2031] Model device: cuda:1
[Step 2031] Input device: cuda:1
[Step 2031] Teacher model device: cuda:0
[Step 2031] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 2031] GPU 1 memory: 33.76 GB (reserved: 47.91 GB)
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
[Step 2031] Student logits device: cuda:1, shape: torch.Size([2, 798, 151936]), dtype: torch.float32
[Step 2031] Student model device: cuda:1
[Step 2031] GPU 0 memory before teacher forward: 16.39 GB
[Step 2031] GPU 0 memory after moving inputs: 16.39 GB
[Step 2031] GPU 0 memory after teacher forward: 16.88 GB
[Step 2031] Teacher logits shape: torch.Size([2, 798, 151936]), dtype: torch.float16
[Step 2031] Teacher logits device before move: cuda:0
[Step 2031] Target device (student_logits.device): cuda:1
[Step 2031] GPU 0 memory after moving logits to GPU 1: 16.88 GB
[Step 2031] Teacher logits device after move: cuda:1, shape: torch.Size([2, 798, 151936])
[Step 2031] GPU 0 memory after del: 16.39 GB
[Step 2031] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 2031] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 37.21 GB
[Step 2031] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 2031] Sequence length: 798, Batch size: 2
[Step 2031] After KL computation - GPU 1: 39.15 GB
[Step 2031] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  1%|                                                                                      | 127/10000 [45:13<58:43:39, 21.41s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 2041] ========== MEMORY DEBUG ==========
[Step 2041] Model device: cuda:1
[Step 2041] Input device: cuda:1
[Step 2041] Teacher model device: cuda:0
[Step 2041] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 2041] GPU 1 memory: 33.76 GB (reserved: 47.59 GB)
[Step 2041] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 2041] Student model device: cuda:1
[Step 2041] GPU 0 memory before teacher forward: 16.39 GB
[Step 2041] GPU 0 memory after moving inputs: 16.39 GB
[Step 2041] GPU 0 memory after teacher forward: 17.01 GB
[Step 2041] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 2041] Teacher logits device before move: cuda:0
[Step 2041] Target device (student_logits.device): cuda:1
[Step 2041] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 2041] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 2041] GPU 0 memory after del: 16.39 GB
[Step 2041] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 2041] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 2041] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 2041] Sequence length: 1024, Batch size: 2
[Step 2041] After KL computation - GPU 1: 40.50 GB
[Step 2041] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  1%|                                                                                      | 128/10000 [45:34<58:38:29, 21.38s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None

[Step 2051] ========== MEMORY DEBUG ==========
[Step 2051] Model device: cuda:1
[Step 2051] Input device: cuda:1
[Step 2051] Teacher model device: cuda:0
[Step 2051] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 2051] GPU 1 memory: 33.76 GB (reserved: 47.54 GB)
[Step 2051] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 2051] Student model device: cuda:1
[Step 2051] GPU 0 memory before teacher forward: 16.39 GB
[Step 2051] GPU 0 memory after moving inputs: 16.39 GB
[Step 2051] GPU 0 memory after teacher forward: 17.01 GB
[Step 2051] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 2051] Teacher logits device before move: cuda:0
[Step 2051] Target device (student_logits.device): cuda:1
[Step 2051] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 2051] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 2051] GPU 0 memory after del: 16.39 GB
[Step 2051] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 2051] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 2051] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 2051] Sequence length: 1024, Batch size: 2
[Step 2051] After KL computation - GPU 1: 40.50 GB
[Step 2051] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 2061] ========== MEMORY DEBUG ==========
[Step 2061] Model device: cuda:1
[Step 2061] Input device: cuda:1
[Step 2061] Teacher model device: cuda:0
[Step 2061] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 2061] GPU 1 memory: 33.76 GB (reserved: 47.58 GB)
[Step 2061] Student logits device: cuda:1, shape: torch.Size([2, 363, 151936]), dtype: torch.float32
[Step 2061] Student model device: cuda:1
[Step 2061] GPU 0 memory before teacher forward: 16.39 GB
[Step 2061] GPU 0 memory after moving inputs: 16.39 GB
[Step 2061] GPU 0 memory after teacher forward: 16.61 GB
[Step 2061] Teacher logits shape: torch.Size([2, 363, 151936]), dtype: torch.float16
[Step 2061] Teacher logits device before move: cuda:0
[Step 2061] Target device (student_logits.device): cuda:1
[Step 2061] GPU 0 memory after moving logits to GPU 1: 16.61 GB
[Step 2061] Teacher logits device after move: cuda:1, shape: torch.Size([2, 363, 151936])
[Step 2061] GPU 0 memory after del: 16.39 GB
[Step 2061] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 2061] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 35.67 GB
[Step 2061] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 2061] Sequence length: 363, Batch size: 2
[Step 2061] After KL computation - GPU 1: 36.56 GB
[Step 2061] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  1%|                                                                                      | 129/10000 [45:54<57:09:38, 20.85s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None

[Step 2071] ========== MEMORY DEBUG ==========
[Step 2071] Model device: cuda:1
[Step 2071] Input device: cuda:1
[Step 2071] Teacher model device: cuda:0
[Step 2071] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 2071] GPU 1 memory: 33.76 GB (reserved: 44.30 GB)
  warnings.warn(
[Step 2071] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 2071] Student model device: cuda:1
[Step 2071] GPU 0 memory before teacher forward: 16.39 GB
[Step 2071] GPU 0 memory after moving inputs: 16.39 GB
[Step 2071] GPU 0 memory after teacher forward: 17.01 GB
[Step 2071] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 2071] Teacher logits device before move: cuda:0
[Step 2071] Target device (student_logits.device): cuda:1
[Step 2071] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 2071] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 2071] GPU 0 memory after del: 16.39 GB
[Step 2071] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 2071] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 2071] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 2071] Sequence length: 1024, Batch size: 2
[Step 2071] After KL computation - GPU 1: 40.50 GB
[Step 2071] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  1%|                                                                                     | 130/10000 [46:15<57:40:11, 21.03s/it]
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 4.985353535353536e-05, 'epoch': 0.01}

[Step 2081] ========== MEMORY DEBUG ==========
[Step 2081] Model device: cuda:1
[Step 2081] Input device: cuda:1
[Step 2081] Teacher model device: cuda:0
[Step 2081] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 2081] GPU 1 memory: 25.33 GB (reserved: 47.37 GB)
[Step 2081] Student logits device: cuda:1, shape: torch.Size([2, 970, 151936]), dtype: torch.float32
[Step 2081] Student model device: cuda:1
[Step 2081] GPU 0 memory before teacher forward: 16.39 GB
[Step 2081] GPU 0 memory after moving inputs: 16.39 GB
[Step 2081] GPU 0 memory after teacher forward: 16.98 GB
[Step 2081] Teacher logits shape: torch.Size([2, 970, 151936]), dtype: torch.float16
[Step 2081] Teacher logits device before move: cuda:0
[Step 2081] Target device (student_logits.device): cuda:1
[Step 2081] GPU 0 memory after moving logits to GPU 1: 16.98 GB
[Step 2081] Teacher logits device after move: cuda:1, shape: torch.Size([2, 970, 151936])
[Step 2081] GPU 0 memory after del: 16.39 GB
[Step 2081] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 2081] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 29.39 GB
[Step 2081] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 2081] Sequence length: 970, Batch size: 2
[Step 2081] After KL computation - GPU 1: 31.74 GB
[Step 2081] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 2091] ========== MEMORY DEBUG ==========
[Step 2091] Model device: cuda:1
[Step 2091] Input device: cuda:1
[Step 2091] Teacher model device: cuda:0
[Step 2091] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 2091] GPU 1 memory: 33.77 GB (reserved: 48.24 GB)
[Step 2091] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 2091] Student model device: cuda:1
[Step 2091] GPU 0 memory before teacher forward: 16.39 GB
[Step 2091] GPU 0 memory after moving inputs: 16.39 GB
[Step 2091] GPU 0 memory after teacher forward: 17.01 GB
[Step 2091] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 2091] Teacher logits device before move: cuda:0
[Step 2091] Target device (student_logits.device): cuda:1
[Step 2091] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 2091] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 2091] GPU 0 memory after del: 16.39 GB
[Step 2091] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 2091] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.02 GB
[Step 2091] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 2091] Sequence length: 1024, Batch size: 2
[Step 2091] After KL computation - GPU 1: 40.51 GB
[Step 2091] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(
  1%|                                                                                     | 131/10000 [46:37<57:55:59, 21.13s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 2101] ========== MEMORY DEBUG ==========
[Step 2101] Model device: cuda:1
[Step 2101] Input device: cuda:1
[Step 2101] Teacher model device: cuda:0
[Step 2101] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 2101] GPU 1 memory: 33.76 GB (reserved: 47.77 GB)
[Step 2101] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 2101] Student model device: cuda:1
[Step 2101] GPU 0 memory before teacher forward: 16.39 GB
[Step 2101] GPU 0 memory after moving inputs: 16.39 GB
[Step 2101] GPU 0 memory after teacher forward: 17.01 GB
[Step 2101] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 2101] Teacher logits device before move: cuda:0
[Step 2101] Target device (student_logits.device): cuda:1
[Step 2101] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 2101] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 2101] GPU 0 memory after del: 16.39 GB
[Step 2101] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 2101] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 2101] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 2101] Sequence length: 1024, Batch size: 2
[Step 2101] After KL computation - GPU 1: 40.50 GB
[Step 2101] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 2111] ========== MEMORY DEBUG ==========
[Step 2111] Model device: cuda:1
[Step 2111] Input device: cuda:1
[Step 2111] Teacher model device: cuda:0
[Step 2111] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 2111] GPU 1 memory: 33.76 GB (reserved: 47.64 GB)
[Step 2111] Student logits device: cuda:1, shape: torch.Size([2, 628, 151936]), dtype: torch.float32
[Step 2111] Student model device: cuda:1
[Step 2111] GPU 0 memory before teacher forward: 16.39 GB
[Step 2111] GPU 0 memory after moving inputs: 16.39 GB
[Step 2111] GPU 0 memory after teacher forward: 16.77 GB
[Step 2111] Teacher logits shape: torch.Size([2, 628, 151936]), dtype: torch.float16
[Step 2111] Teacher logits device before move: cuda:0
[Step 2111] Target device (student_logits.device): cuda:1
[Step 2111] GPU 0 memory after moving logits to GPU 1: 16.77 GB
[Step 2111] Teacher logits device after move: cuda:1, shape: torch.Size([2, 628, 151936])
[Step 2111] GPU 0 memory after del: 16.39 GB
[Step 2111] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 2111] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 36.61 GB
[Step 2111] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 2111] Sequence length: 628, Batch size: 2
[Step 2111] After KL computation - GPU 1: 38.14 GB
[Step 2111] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  1%|                                                                                     | 132/10000 [46:55<55:46:43, 20.35s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 2121] ========== MEMORY DEBUG ==========
[Step 2121] Model device: cuda:1
[Step 2121] Input device: cuda:1
[Step 2121] Teacher model device: cuda:0
[Step 2121] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 2121] GPU 1 memory: 33.76 GB (reserved: 43.40 GB)
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
[Step 2121] Student logits device: cuda:1, shape: torch.Size([2, 642, 151936]), dtype: torch.float32
[Step 2121] Student model device: cuda:1
[Step 2121] GPU 0 memory before teacher forward: 16.39 GB
[Step 2121] GPU 0 memory after moving inputs: 16.39 GB
[Step 2121] GPU 0 memory after teacher forward: 16.78 GB
[Step 2121] Teacher logits shape: torch.Size([2, 642, 151936]), dtype: torch.float16
[Step 2121] Teacher logits device before move: cuda:0
[Step 2121] Target device (student_logits.device): cuda:1
[Step 2121] GPU 0 memory after moving logits to GPU 1: 16.78 GB
[Step 2121] Teacher logits device after move: cuda:1, shape: torch.Size([2, 642, 151936])
[Step 2121] GPU 0 memory after del: 16.39 GB
[Step 2121] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 2121] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 36.66 GB
[Step 2121] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 2121] Sequence length: 642, Batch size: 2
[Step 2121] After KL computation - GPU 1: 38.22 GB
[Step 2121] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  1%|                                                                                     | 133/10000 [47:13<54:06:37, 19.74s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None

[Step 2131] ========== MEMORY DEBUG ==========
[Step 2131] Model device: cuda:1
[Step 2131] Input device: cuda:1
[Step 2131] Teacher model device: cuda:0
[Step 2131] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 2131] GPU 1 memory: 33.77 GB (reserved: 39.77 GB)
  warnings.warn(
[Step 2131] Student logits device: cuda:1, shape: torch.Size([2, 290, 151936]), dtype: torch.float32
[Step 2131] Student model device: cuda:1
[Step 2131] GPU 0 memory before teacher forward: 16.39 GB
[Step 2131] GPU 0 memory after moving inputs: 16.39 GB
[Step 2131] GPU 0 memory after teacher forward: 16.57 GB
[Step 2131] Teacher logits shape: torch.Size([2, 290, 151936]), dtype: torch.float16
[Step 2131] Teacher logits device before move: cuda:0
[Step 2131] Target device (student_logits.device): cuda:1
[Step 2131] GPU 0 memory after moving logits to GPU 1: 16.57 GB
[Step 2131] Teacher logits device after move: cuda:1, shape: torch.Size([2, 290, 151936])
[Step 2131] GPU 0 memory after del: 16.39 GB
[Step 2131] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 2131] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 35.42 GB
[Step 2131] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 2131] Sequence length: 290, Batch size: 2
[Step 2131] After KL computation - GPU 1: 36.13 GB
[Step 2131] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 2141] ========== MEMORY DEBUG ==========
[Step 2141] Model device: cuda:1
[Step 2141] Input device: cuda:1
[Step 2141] Teacher model device: cuda:0
[Step 2141] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 2141] GPU 1 memory: 33.77 GB (reserved: 47.89 GB)
[Step 2141] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 2141] Student model device: cuda:1
[Step 2141] GPU 0 memory before teacher forward: 16.39 GB
[Step 2141] GPU 0 memory after moving inputs: 16.39 GB
[Step 2141] GPU 0 memory after teacher forward: 17.01 GB
[Step 2141] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 2141] Teacher logits device before move: cuda:0
[Step 2141] Target device (student_logits.device): cuda:1
[Step 2141] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 2141] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 2141] GPU 0 memory after del: 16.39 GB
[Step 2141] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 2141] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 2141] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 2141] Sequence length: 1024, Batch size: 2
[Step 2141] After KL computation - GPU 1: 40.50 GB
[Step 2141] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  1%|                                                                                     | 134/10000 [47:34<54:55:27, 20.04s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 2151] ========== MEMORY DEBUG ==========
[Step 2151] Model device: cuda:1
[Step 2151] Input device: cuda:1
[Step 2151] Teacher model device: cuda:0
[Step 2151] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 2151] GPU 1 memory: 33.76 GB (reserved: 47.48 GB)
[Step 2151] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 2151] Student model device: cuda:1
[Step 2151] GPU 0 memory before teacher forward: 16.39 GB
[Step 2151] GPU 0 memory after moving inputs: 16.39 GB
[Step 2151] GPU 0 memory after teacher forward: 17.01 GB
[Step 2151] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 2151] Teacher logits device before move: cuda:0
[Step 2151] Target device (student_logits.device): cuda:1
[Step 2151] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 2151] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 2151] GPU 0 memory after del: 16.39 GB
[Step 2151] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 2151] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 2151] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 2151] Sequence length: 1024, Batch size: 2
[Step 2151] After KL computation - GPU 1: 40.50 GB
[Step 2151] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  1%|                                                                                     | 135/10000 [47:55<55:28:08, 20.24s/it]

[Step 2161] ========== MEMORY DEBUG ==========
[Step 2161] Model device: cuda:1
[Step 2161] Input device: cuda:1
[Step 2161] Teacher model device: cuda:0
[Step 2161] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 2161] GPU 1 memory: 25.33 GB (reserved: 47.66 GB)
[Step 2161] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 2161] Student model device: cuda:1
[Step 2161] GPU 0 memory before teacher forward: 16.39 GB
[Step 2161] GPU 0 memory after moving inputs: 16.39 GB
[Step 2161] GPU 0 memory after teacher forward: 17.01 GB
[Step 2161] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 2161] Teacher logits device before move: cuda:0
[Step 2161] Target device (student_logits.device): cuda:1
[Step 2161] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 2161] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 2161] GPU 0 memory after del: 16.39 GB
[Step 2161] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 2161] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 29.58 GB
[Step 2161] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 2161] Sequence length: 1024, Batch size: 2
[Step 2161] After KL computation - GPU 1: 32.07 GB
[Step 2161] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 2171] ========== MEMORY DEBUG ==========
[Step 2171] Model device: cuda:1
[Step 2171] Input device: cuda:1
[Step 2171] Teacher model device: cuda:0
[Step 2171] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 2171] GPU 1 memory: 33.76 GB (reserved: 47.60 GB)
[Step 2171] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 2171] Student model device: cuda:1
[Step 2171] GPU 0 memory before teacher forward: 16.39 GB
[Step 2171] GPU 0 memory after moving inputs: 16.39 GB
[Step 2171] GPU 0 memory after teacher forward: 17.01 GB
[Step 2171] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 2171] Teacher logits device before move: cuda:0
[Step 2171] Target device (student_logits.device): cuda:1
[Step 2171] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 2171] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 2171] GPU 0 memory after del: 16.39 GB
[Step 2171] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 2171] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 2171] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 2171] Sequence length: 1024, Batch size: 2
[Step 2171] After KL computation - GPU 1: 40.50 GB
[Step 2171] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 2181] ========== MEMORY DEBUG ==========
[Step 2181] Model device: cuda:1
[Step 2181] Input device: cuda:1
[Step 2181] Teacher model device: cuda:0
[Step 2181] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 2181] GPU 1 memory: 33.77 GB (reserved: 47.88 GB)
[Step 2181] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 2181] Student model device: cuda:1
[Step 2181] GPU 0 memory before teacher forward: 16.39 GB
[Step 2181] GPU 0 memory after moving inputs: 16.39 GB
[Step 2181] GPU 0 memory after teacher forward: 17.01 GB
[Step 2181] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 2181] Teacher logits device before move: cuda:0
[Step 2181] Target device (student_logits.device): cuda:1
[Step 2181] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 2181] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 2181] GPU 0 memory after del: 16.39 GB
[Step 2181] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 2181] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.02 GB
[Step 2181] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 2181] Sequence length: 1024, Batch size: 2
[Step 2181] After KL computation - GPU 1: 40.51 GB
[Step 2181] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(

[Step 2191] ========== MEMORY DEBUG ==========
[Step 2191] Model device: cuda:1
[Step 2191] Input device: cuda:1
[Step 2191] Teacher model device: cuda:0
[Step 2191] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 2191] GPU 1 memory: 33.77 GB (reserved: 47.92 GB)
[Step 2191] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 2191] Student model device: cuda:1
[Step 2191] GPU 0 memory before teacher forward: 16.39 GB
[Step 2191] GPU 0 memory after moving inputs: 16.39 GB
[Step 2191] GPU 0 memory after teacher forward: 17.01 GB
[Step 2191] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 2191] Teacher logits device before move: cuda:0
[Step 2191] Target device (student_logits.device): cuda:1
[Step 2191] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 2191] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 2191] GPU 0 memory after del: 16.39 GB
[Step 2191] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 2191] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.02 GB
[Step 2191] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 2191] Sequence length: 1024, Batch size: 2
[Step 2191] After KL computation - GPU 1: 40.51 GB
[Step 2191] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  1%|                                                                                     | 137/10000 [48:36<55:40:50, 20.32s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 2201] ========== MEMORY DEBUG ==========
[Step 2201] Model device: cuda:1
[Step 2201] Input device: cuda:1
[Step 2201] Teacher model device: cuda:0
[Step 2201] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 2201] GPU 1 memory: 33.76 GB (reserved: 47.52 GB)
[Step 2201] Student logits device: cuda:1, shape: torch.Size([2, 956, 151936]), dtype: torch.float32
[Step 2201] Student model device: cuda:1
[Step 2201] GPU 0 memory before teacher forward: 16.39 GB
[Step 2201] GPU 0 memory after moving inputs: 16.39 GB
[Step 2201] GPU 0 memory after teacher forward: 16.97 GB
[Step 2201] Teacher logits shape: torch.Size([2, 956, 151936]), dtype: torch.float16
[Step 2201] Teacher logits device before move: cuda:0
[Step 2201] Target device (student_logits.device): cuda:1
[Step 2201] GPU 0 memory after moving logits to GPU 1: 16.97 GB
[Step 2201] Teacher logits device after move: cuda:1, shape: torch.Size([2, 956, 151936])
[Step 2201] GPU 0 memory after del: 16.39 GB
[Step 2201] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 2201] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 37.77 GB
[Step 2201] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 2201] Sequence length: 956, Batch size: 2
[Step 2201] After KL computation - GPU 1: 40.09 GB
[Step 2201] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  1%|                                                                                     | 138/10000 [48:58<57:05:03, 20.84s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None

[Step 2211] ========== MEMORY DEBUG ==========
[Step 2211] Model device: cuda:1
[Step 2211] Input device: cuda:1
[Step 2211] Teacher model device: cuda:0
[Step 2211] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 2211] GPU 1 memory: 33.76 GB (reserved: 47.71 GB)
[Step 2211] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 2211] Student model device: cuda:1
[Step 2211] GPU 0 memory before teacher forward: 16.39 GB
[Step 2211] GPU 0 memory after moving inputs: 16.39 GB
[Step 2211] GPU 0 memory after teacher forward: 17.01 GB
[Step 2211] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 2211] Teacher logits device before move: cuda:0
[Step 2211] Target device (student_logits.device): cuda:1
[Step 2211] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 2211] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 2211] GPU 0 memory after del: 16.39 GB
[Step 2211] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 2211] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 2211] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 2211] Sequence length: 1024, Batch size: 2
[Step 2211] After KL computation - GPU 1: 40.50 GB
[Step 2211] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 2221] ========== MEMORY DEBUG ==========
[Step 2221] Model device: cuda:1
[Step 2221] Input device: cuda:1
[Step 2221] Teacher model device: cuda:0
[Step 2221] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 2221] GPU 1 memory: 33.76 GB (reserved: 47.57 GB)
[Step 2221] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 2221] Student model device: cuda:1
[Step 2221] GPU 0 memory before teacher forward: 16.39 GB
[Step 2221] GPU 0 memory after moving inputs: 16.39 GB
[Step 2221] GPU 0 memory after teacher forward: 17.01 GB
[Step 2221] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 2221] Teacher logits device before move: cuda:0
[Step 2221] Target device (student_logits.device): cuda:1
[Step 2221] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 2221] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 2221] GPU 0 memory after del: 16.39 GB
[Step 2221] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 2221] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 2221] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 2221] Sequence length: 1024, Batch size: 2
[Step 2221] After KL computation - GPU 1: 40.50 GB
[Step 2221] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  1%|                                                                                     | 140/10000 [49:43<59:07:45, 21.59s/it]

[Step 2231] ========== MEMORY DEBUG ==========
[Step 2231] Model device: cuda:1
[Step 2231] Input device: cuda:1
[Step 2231] Teacher model device: cuda:0
[Step 2231] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 2231] GPU 1 memory: 33.76 GB (reserved: 45.21 GB)
[Step 2231] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 2231] Student model device: cuda:1
[Step 2231] GPU 0 memory before teacher forward: 16.39 GB
[Step 2231] GPU 0 memory after moving inputs: 16.39 GB
[Step 2231] GPU 0 memory after teacher forward: 17.01 GB
[Step 2231] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 2231] Teacher logits device before move: cuda:0
[Step 2231] Target device (student_logits.device): cuda:1
[Step 2231] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 2231] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 2231] GPU 0 memory after del: 16.39 GB
[Step 2231] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 2231] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 2231] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 2231] Sequence length: 1024, Batch size: 2
[Step 2231] After KL computation - GPU 1: 40.50 GB
[Step 2231] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 4.9803030303030305e-05, 'epoch': 0.01}

[Step 2241] ========== MEMORY DEBUG ==========
[Step 2241] Model device: cuda:1
[Step 2241] Input device: cuda:1
[Step 2241] Teacher model device: cuda:0
[Step 2241] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 2241] GPU 1 memory: 25.33 GB (reserved: 47.37 GB)
[Step 2241] Student logits device: cuda:1, shape: torch.Size([2, 455, 151936]), dtype: torch.float32
[Step 2241] Student model device: cuda:1
[Step 2241] GPU 0 memory before teacher forward: 16.39 GB
[Step 2241] GPU 0 memory after moving inputs: 16.39 GB
[Step 2241] GPU 0 memory after teacher forward: 16.67 GB
[Step 2241] Teacher logits shape: torch.Size([2, 455, 151936]), dtype: torch.float16
[Step 2241] Teacher logits device before move: cuda:0
[Step 2241] Target device (student_logits.device): cuda:1
[Step 2241] GPU 0 memory after moving logits to GPU 1: 16.67 GB
[Step 2241] Teacher logits device after move: cuda:1, shape: torch.Size([2, 455, 151936])
[Step 2241] GPU 0 memory after del: 16.39 GB
[Step 2241] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 2241] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 27.56 GB
[Step 2241] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 2241] Sequence length: 455, Batch size: 2
[Step 2241] After KL computation - GPU 1: 28.67 GB
[Step 2241] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 2251] ========== MEMORY DEBUG ==========
[Step 2251] Model device: cuda:1
[Step 2251] Input device: cuda:1
[Step 2251] Teacher model device: cuda:0
[Step 2251] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 2251] GPU 1 memory: 33.77 GB (reserved: 48.19 GB)
[Step 2251] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 2251] Student model device: cuda:1
[Step 2251] GPU 0 memory before teacher forward: 16.39 GB
[Step 2251] GPU 0 memory after moving inputs: 16.39 GB
[Step 2251] GPU 0 memory after teacher forward: 17.01 GB
[Step 2251] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 2251] Teacher logits device before move: cuda:0
[Step 2251] Target device (student_logits.device): cuda:1
[Step 2251] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 2251] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 2251] GPU 0 memory after del: 16.39 GB
[Step 2251] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 2251] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.02 GB
[Step 2251] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 2251] Sequence length: 1024, Batch size: 2
[Step 2251] After KL computation - GPU 1: 40.51 GB
[Step 2251] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  1%|                                                                                     | 141/10000 [50:02<57:41:31, 21.07s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None

[Step 2261] ========== MEMORY DEBUG ==========
[Step 2261] Model device: cuda:1
[Step 2261] Input device: cuda:1
[Step 2261] Teacher model device: cuda:0
[Step 2261] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 2261] GPU 1 memory: 33.76 GB (reserved: 47.75 GB)
[Step 2261] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 2261] Student model device: cuda:1
[Step 2261] GPU 0 memory before teacher forward: 16.39 GB
[Step 2261] GPU 0 memory after moving inputs: 16.39 GB
[Step 2261] GPU 0 memory after teacher forward: 17.01 GB
[Step 2261] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 2261] Teacher logits device before move: cuda:0
[Step 2261] Target device (student_logits.device): cuda:1
[Step 2261] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 2261] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 2261] GPU 0 memory after del: 16.39 GB
[Step 2261] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 2261] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 2261] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 2261] Sequence length: 1024, Batch size: 2
[Step 2261] After KL computation - GPU 1: 40.50 GB
[Step 2261] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 2271] ========== MEMORY DEBUG ==========
[Step 2271] Model device: cuda:1
[Step 2271] Input device: cuda:1
[Step 2271] Teacher model device: cuda:0
[Step 2271] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 2271] GPU 1 memory: 33.76 GB (reserved: 47.36 GB)
[Step 2271] Student logits device: cuda:1, shape: torch.Size([2, 857, 151936]), dtype: torch.float32
[Step 2271] Student model device: cuda:1
[Step 2271] GPU 0 memory before teacher forward: 16.39 GB
[Step 2271] GPU 0 memory after moving inputs: 16.39 GB
[Step 2271] GPU 0 memory after teacher forward: 16.91 GB
[Step 2271] Teacher logits shape: torch.Size([2, 857, 151936]), dtype: torch.float16
[Step 2271] Teacher logits device before move: cuda:0
[Step 2271] Target device (student_logits.device): cuda:1
[Step 2271] GPU 0 memory after moving logits to GPU 1: 16.91 GB
[Step 2271] Teacher logits device after move: cuda:1, shape: torch.Size([2, 857, 151936])
[Step 2271] GPU 0 memory after del: 16.39 GB
[Step 2271] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 2271] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 37.42 GB
[Step 2271] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 2271] Sequence length: 857, Batch size: 2
[Step 2271] After KL computation - GPU 1: 39.50 GB
[Step 2271] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  1%|                                                                                     | 142/10000 [50:24<58:11:12, 21.25s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None

[Step 2281] ========== MEMORY DEBUG ==========
[Step 2281] Model device: cuda:1
[Step 2281] Input device: cuda:1
[Step 2281] Teacher model device: cuda:0
[Step 2281] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 2281] GPU 1 memory: 33.76 GB (reserved: 45.27 GB)
  warnings.warn(
[Step 2281] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 2281] Student model device: cuda:1
[Step 2281] GPU 0 memory before teacher forward: 16.39 GB
[Step 2281] GPU 0 memory after moving inputs: 16.39 GB
[Step 2281] GPU 0 memory after teacher forward: 17.01 GB
[Step 2281] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 2281] Teacher logits device before move: cuda:0
[Step 2281] Target device (student_logits.device): cuda:1
[Step 2281] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 2281] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 2281] GPU 0 memory after del: 16.39 GB
[Step 2281] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 2281] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.02 GB
[Step 2281] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 2281] Sequence length: 1024, Batch size: 2
[Step 2281] After KL computation - GPU 1: 40.51 GB
[Step 2281] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  1%|                                                                                     | 143/10000 [50:43<56:14:05, 20.54s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None

[Step 2291] ========== MEMORY DEBUG ==========
[Step 2291] Model device: cuda:1
[Step 2291] Input device: cuda:1
[Step 2291] Teacher model device: cuda:0
[Step 2291] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 2291] GPU 1 memory: 33.76 GB (reserved: 38.52 GB)
  warnings.warn(
[Step 2291] Student logits device: cuda:1, shape: torch.Size([2, 416, 151936]), dtype: torch.float32
[Step 2291] Student model device: cuda:1
[Step 2291] GPU 0 memory before teacher forward: 16.39 GB
[Step 2291] GPU 0 memory after moving inputs: 16.39 GB
[Step 2291] GPU 0 memory after teacher forward: 16.65 GB
[Step 2291] Teacher logits shape: torch.Size([2, 416, 151936]), dtype: torch.float16
[Step 2291] Teacher logits device before move: cuda:0
[Step 2291] Target device (student_logits.device): cuda:1
[Step 2291] GPU 0 memory after moving logits to GPU 1: 16.65 GB
[Step 2291] Teacher logits device after move: cuda:1, shape: torch.Size([2, 416, 151936])
[Step 2291] GPU 0 memory after del: 16.39 GB
[Step 2291] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 2291] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 35.86 GB
[Step 2291] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 2291] Sequence length: 416, Batch size: 2
[Step 2291] After KL computation - GPU 1: 36.87 GB
[Step 2291] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 2301] ========== MEMORY DEBUG ==========
[Step 2301] Model device: cuda:1
[Step 2301] Input device: cuda:1
[Step 2301] Teacher model device: cuda:0
[Step 2301] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 2301] GPU 1 memory: 33.76 GB (reserved: 47.11 GB)
[Step 2301] Student logits device: cuda:1, shape: torch.Size([2, 993, 151936]), dtype: torch.float32
[Step 2301] Student model device: cuda:1
[Step 2301] GPU 0 memory before teacher forward: 16.39 GB
[Step 2301] GPU 0 memory after moving inputs: 16.39 GB
[Step 2301] GPU 0 memory after teacher forward: 17.00 GB
[Step 2301] Teacher logits shape: torch.Size([2, 993, 151936]), dtype: torch.float16
[Step 2301] Teacher logits device before move: cuda:0
[Step 2301] Target device (student_logits.device): cuda:1
[Step 2301] GPU 0 memory after moving logits to GPU 1: 17.00 GB
[Step 2301] Teacher logits device after move: cuda:1, shape: torch.Size([2, 993, 151936])
[Step 2301] GPU 0 memory after del: 16.39 GB
[Step 2301] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 2301] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 37.90 GB
[Step 2301] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 2301] Sequence length: 993, Batch size: 2
[Step 2301] After KL computation - GPU 1: 40.32 GB
[Step 2301] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  1%|                                                                                     | 144/10000 [51:04<56:17:22, 20.56s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 2311] ========== MEMORY DEBUG ==========
[Step 2311] Model device: cuda:1
[Step 2311] Input device: cuda:1
[Step 2311] Teacher model device: cuda:0
[Step 2311] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 2311] GPU 1 memory: 33.76 GB (reserved: 48.41 GB)
[Step 2311] Student logits device: cuda:1, shape: torch.Size([2, 823, 151936]), dtype: torch.float32
[Step 2311] Student model device: cuda:1
[Step 2311] GPU 0 memory before teacher forward: 16.39 GB
[Step 2311] GPU 0 memory after moving inputs: 16.39 GB
[Step 2311] GPU 0 memory after teacher forward: 16.89 GB
[Step 2311] Teacher logits shape: torch.Size([2, 823, 151936]), dtype: torch.float16
[Step 2311] Teacher logits device before move: cuda:0
[Step 2311] Target device (student_logits.device): cuda:1
[Step 2311] GPU 0 memory after moving logits to GPU 1: 16.89 GB
[Step 2311] Teacher logits device after move: cuda:1, shape: torch.Size([2, 823, 151936])
[Step 2311] GPU 0 memory after del: 16.39 GB
[Step 2311] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 2311] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 37.30 GB
[Step 2311] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 2311] Sequence length: 823, Batch size: 2
[Step 2311] After KL computation - GPU 1: 39.30 GB
[Step 2311] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  1%|                                                                                     | 145/10000 [51:26<57:30:03, 21.00s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None

[Step 2321] ========== MEMORY DEBUG ==========
[Step 2321] Model device: cuda:1
[Step 2321] Input device: cuda:1
[Step 2321] Teacher model device: cuda:0
[Step 2321] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 2321] GPU 1 memory: 25.33 GB (reserved: 47.60 GB)
[Step 2321] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 2321] Student model device: cuda:1
[Step 2321] GPU 0 memory before teacher forward: 16.39 GB
[Step 2321] GPU 0 memory after moving inputs: 16.39 GB
[Step 2321] GPU 0 memory after teacher forward: 17.01 GB
[Step 2321] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 2321] Teacher logits device before move: cuda:0
[Step 2321] Target device (student_logits.device): cuda:1
[Step 2321] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 2321] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 2321] GPU 0 memory after del: 16.39 GB
[Step 2321] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 2321] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 29.58 GB
[Step 2321] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 2321] Sequence length: 1024, Batch size: 2
[Step 2321] After KL computation - GPU 1: 32.07 GB
[Step 2321] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 2331] ========== MEMORY DEBUG ==========
[Step 2331] Model device: cuda:1
[Step 2331] Input device: cuda:1
[Step 2331] Teacher model device: cuda:0
[Step 2331] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 2331] GPU 1 memory: 33.76 GB (reserved: 47.37 GB)
[Step 2331] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 2331] Student model device: cuda:1
[Step 2331] GPU 0 memory before teacher forward: 16.39 GB
[Step 2331] GPU 0 memory after moving inputs: 16.39 GB
[Step 2331] GPU 0 memory after teacher forward: 17.01 GB
[Step 2331] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 2331] Teacher logits device before move: cuda:0
[Step 2331] Target device (student_logits.device): cuda:1
[Step 2331] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 2331] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 2331] GPU 0 memory after del: 16.39 GB
[Step 2331] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 2331] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 2331] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 2331] Sequence length: 1024, Batch size: 2
[Step 2331] After KL computation - GPU 1: 40.50 GB
[Step 2331] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  1%|                                                                                     | 146/10000 [51:48<58:41:04, 21.44s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None

[Step 2341] ========== MEMORY DEBUG ==========
[Step 2341] Model device: cuda:1
[Step 2341] Input device: cuda:1
[Step 2341] Teacher model device: cuda:0
[Step 2341] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 2341] GPU 1 memory: 33.76 GB (reserved: 44.85 GB)
  warnings.warn(
[Step 2341] Student logits device: cuda:1, shape: torch.Size([2, 595, 151936]), dtype: torch.float32
[Step 2341] Student model device: cuda:1
[Step 2341] GPU 0 memory before teacher forward: 16.39 GB
[Step 2341] GPU 0 memory after moving inputs: 16.39 GB
[Step 2341] GPU 0 memory after teacher forward: 16.75 GB
[Step 2341] Teacher logits shape: torch.Size([2, 595, 151936]), dtype: torch.float16
[Step 2341] Teacher logits device before move: cuda:0
[Step 2341] Target device (student_logits.device): cuda:1
[Step 2341] GPU 0 memory after moving logits to GPU 1: 16.75 GB
[Step 2341] Teacher logits device after move: cuda:1, shape: torch.Size([2, 595, 151936])
[Step 2341] GPU 0 memory after del: 16.39 GB
[Step 2341] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 2341] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 36.49 GB
[Step 2341] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 2341] Sequence length: 595, Batch size: 2
[Step 2341] After KL computation - GPU 1: 37.94 GB
[Step 2341] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 2351] ========== MEMORY DEBUG ==========
[Step 2351] Model device: cuda:1
[Step 2351] Input device: cuda:1
[Step 2351] Teacher model device: cuda:0
[Step 2351] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 2351] GPU 1 memory: 33.76 GB (reserved: 47.58 GB)
[Step 2351] Student logits device: cuda:1, shape: torch.Size([2, 850, 151936]), dtype: torch.float32
[Step 2351] Student model device: cuda:1
[Step 2351] GPU 0 memory before teacher forward: 16.39 GB
[Step 2351] GPU 0 memory after moving inputs: 16.39 GB
[Step 2351] GPU 0 memory after teacher forward: 16.91 GB
[Step 2351] Teacher logits shape: torch.Size([2, 850, 151936]), dtype: torch.float16
[Step 2351] Teacher logits device before move: cuda:0
[Step 2351] Target device (student_logits.device): cuda:1
[Step 2351] GPU 0 memory after moving logits to GPU 1: 16.91 GB
[Step 2351] Teacher logits device after move: cuda:1, shape: torch.Size([2, 850, 151936])
[Step 2351] GPU 0 memory after del: 16.39 GB
[Step 2351] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 2351] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 37.40 GB
[Step 2351] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 2351] Sequence length: 850, Batch size: 2
[Step 2351] After KL computation - GPU 1: 39.46 GB
[Step 2351] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  1%|                                                                                     | 147/10000 [52:08<57:41:25, 21.08s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 2361] ========== MEMORY DEBUG ==========
[Step 2361] Model device: cuda:1
[Step 2361] Input device: cuda:1
[Step 2361] Teacher model device: cuda:0
[Step 2361] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 2361] GPU 1 memory: 33.76 GB (reserved: 47.37 GB)
[Step 2361] Student logits device: cuda:1, shape: torch.Size([2, 804, 151936]), dtype: torch.float32
[Step 2361] Student model device: cuda:1
[Step 2361] GPU 0 memory before teacher forward: 16.39 GB
[Step 2361] GPU 0 memory after moving inputs: 16.39 GB
[Step 2361] GPU 0 memory after teacher forward: 16.88 GB
[Step 2361] Teacher logits shape: torch.Size([2, 804, 151936]), dtype: torch.float16
[Step 2361] Teacher logits device before move: cuda:0
[Step 2361] Target device (student_logits.device): cuda:1
[Step 2361] GPU 0 memory after moving logits to GPU 1: 16.88 GB
[Step 2361] Teacher logits device after move: cuda:1, shape: torch.Size([2, 804, 151936])
[Step 2361] GPU 0 memory after del: 16.39 GB
[Step 2361] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 2361] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 37.23 GB
[Step 2361] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 2361] Sequence length: 804, Batch size: 2
[Step 2361] After KL computation - GPU 1: 39.19 GB
[Step 2361] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  1%|                                                                                     | 148/10000 [52:29<57:28:52, 21.00s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None

[Step 2371] ========== MEMORY DEBUG ==========
[Step 2371] Model device: cuda:1
[Step 2371] Input device: cuda:1
[Step 2371] Teacher model device: cuda:0
[Step 2371] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 2371] GPU 1 memory: 33.76 GB (reserved: 47.89 GB)
[Step 2371] Student logits device: cuda:1, shape: torch.Size([2, 739, 151936]), dtype: torch.float32
[Step 2371] Student model device: cuda:1
[Step 2371] GPU 0 memory before teacher forward: 16.39 GB
[Step 2371] GPU 0 memory after moving inputs: 16.39 GB
[Step 2371] GPU 0 memory after teacher forward: 16.84 GB
[Step 2371] Teacher logits shape: torch.Size([2, 739, 151936]), dtype: torch.float16
[Step 2371] Teacher logits device before move: cuda:0
[Step 2371] Target device (student_logits.device): cuda:1
[Step 2371] GPU 0 memory after moving logits to GPU 1: 16.84 GB
[Step 2371] Teacher logits device after move: cuda:1, shape: torch.Size([2, 739, 151936])
[Step 2371] GPU 0 memory after del: 16.39 GB
[Step 2371] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 2371] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 37.00 GB
[Step 2371] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 2371] Sequence length: 739, Batch size: 2
[Step 2371] After KL computation - GPU 1: 38.80 GB
[Step 2371] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 2381] ========== MEMORY DEBUG ==========
[Step 2381] Model device: cuda:1
[Step 2381] Input device: cuda:1
[Step 2381] Teacher model device: cuda:0
[Step 2381] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 2381] GPU 1 memory: 33.76 GB (reserved: 47.91 GB)
[Step 2381] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 2381] Student model device: cuda:1
[Step 2381] GPU 0 memory before teacher forward: 16.39 GB
[Step 2381] GPU 0 memory after moving inputs: 16.39 GB
[Step 2381] GPU 0 memory after teacher forward: 17.01 GB
[Step 2381] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 2381] Teacher logits device before move: cuda:0
[Step 2381] Target device (student_logits.device): cuda:1
[Step 2381] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 2381] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 2381] GPU 0 memory after del: 16.39 GB
[Step 2381] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 2381] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 2381] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 2381] Sequence length: 1024, Batch size: 2
[Step 2381] After KL computation - GPU 1: 40.50 GB
[Step 2381] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  1%|                                                                                     | 149/10000 [52:51<58:03:55, 21.22s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 2391] ========== MEMORY DEBUG ==========
[Step 2391] Model device: cuda:1
[Step 2391] Input device: cuda:1
[Step 2391] Teacher model device: cuda:0
[Step 2391] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 2391] GPU 1 memory: 33.76 GB (reserved: 46.21 GB)
[Step 2391] Student logits device: cuda:1, shape: torch.Size([2, 777, 151936]), dtype: torch.float32
[Step 2391] Student model device: cuda:1
[Step 2391] GPU 0 memory before teacher forward: 16.39 GB
[Step 2391] GPU 0 memory after moving inputs: 16.39 GB
[Step 2391] GPU 0 memory after teacher forward: 16.86 GB
[Step 2391] Teacher logits shape: torch.Size([2, 777, 151936]), dtype: torch.float16
[Step 2391] Teacher logits device before move: cuda:0
[Step 2391] Target device (student_logits.device): cuda:1
[Step 2391] GPU 0 memory after moving logits to GPU 1: 16.86 GB
[Step 2391] Teacher logits device after move: cuda:1, shape: torch.Size([2, 777, 151936])
[Step 2391] GPU 0 memory after del: 16.39 GB
[Step 2391] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 2391] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 37.14 GB
[Step 2391] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 2391] Sequence length: 777, Batch size: 2
[Step 2391] After KL computation - GPU 1: 39.03 GB
[Step 2391] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  2%|                                                                                     | 150/10000 [53:13<58:19:07, 21.31s/it]
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 4.975252525252526e-05, 'epoch': 0.01}

[Step 2401] ========== MEMORY DEBUG ==========
[Step 2401] Model device: cuda:1
[Step 2401] Input device: cuda:1
[Step 2401] Teacher model device: cuda:0
[Step 2401] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 2401] GPU 1 memory: 25.33 GB (reserved: 47.35 GB)
[Step 2401] Student logits device: cuda:1, shape: torch.Size([2, 665, 151936]), dtype: torch.float32
[Step 2401] Student model device: cuda:1
[Step 2401] GPU 0 memory before teacher forward: 16.39 GB
[Step 2401] GPU 0 memory after moving inputs: 16.39 GB
[Step 2401] GPU 0 memory after teacher forward: 16.80 GB
[Step 2401] Teacher logits shape: torch.Size([2, 665, 151936]), dtype: torch.float16
[Step 2401] Teacher logits device before move: cuda:0
[Step 2401] Target device (student_logits.device): cuda:1
[Step 2401] GPU 0 memory after moving logits to GPU 1: 16.80 GB
[Step 2401] Teacher logits device after move: cuda:1, shape: torch.Size([2, 665, 151936])
[Step 2401] GPU 0 memory after del: 16.39 GB
[Step 2401] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 2401] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 28.30 GB
[Step 2401] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 2401] Sequence length: 665, Batch size: 2
[Step 2401] After KL computation - GPU 1: 29.92 GB
[Step 2401] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 2411] ========== MEMORY DEBUG ==========
[Step 2411] Model device: cuda:1
[Step 2411] Input device: cuda:1
[Step 2411] Teacher model device: cuda:0
[Step 2411] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 2411] GPU 1 memory: 33.76 GB (reserved: 47.57 GB)
[Step 2411] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 2411] Student model device: cuda:1
[Step 2411] GPU 0 memory before teacher forward: 16.39 GB
[Step 2411] GPU 0 memory after moving inputs: 16.39 GB
[Step 2411] GPU 0 memory after teacher forward: 17.01 GB
[Step 2411] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 2411] Teacher logits device before move: cuda:0
[Step 2411] Target device (student_logits.device): cuda:1
[Step 2411] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 2411] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 2411] GPU 0 memory after del: 16.39 GB
[Step 2411] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 2411] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.02 GB
[Step 2411] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 2411] Sequence length: 1024, Batch size: 2
[Step 2411] After KL computation - GPU 1: 40.50 GB
[Step 2411] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(
  2%|                                                                                     | 151/10000 [53:33<57:42:02, 21.09s/it]

[Step 2421] ========== MEMORY DEBUG ==========
[Step 2421] Model device: cuda:1
[Step 2421] Input device: cuda:1
[Step 2421] Teacher model device: cuda:0
[Step 2421] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 2421] GPU 1 memory: 33.77 GB (reserved: 47.89 GB)
[Step 2421] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 2421] Student model device: cuda:1
[Step 2421] GPU 0 memory before teacher forward: 16.39 GB
[Step 2421] GPU 0 memory after moving inputs: 16.39 GB
[Step 2421] GPU 0 memory after teacher forward: 17.01 GB
[Step 2421] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 2421] Teacher logits device before move: cuda:0
[Step 2421] Target device (student_logits.device): cuda:1
[Step 2421] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 2421] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 2421] GPU 0 memory after del: 16.39 GB
[Step 2421] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 2421] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.02 GB
[Step 2421] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 2421] Sequence length: 1024, Batch size: 2
[Step 2421] After KL computation - GPU 1: 40.51 GB
[Step 2421] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 2431] ========== MEMORY DEBUG ==========
[Step 2431] Model device: cuda:1
[Step 2431] Input device: cuda:1
[Step 2431] Teacher model device: cuda:0
[Step 2431] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 2431] GPU 1 memory: 33.77 GB (reserved: 47.91 GB)
[Step 2431] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 2431] Student model device: cuda:1
[Step 2431] GPU 0 memory before teacher forward: 16.39 GB
[Step 2431] GPU 0 memory after moving inputs: 16.39 GB
[Step 2431] GPU 0 memory after teacher forward: 17.01 GB
[Step 2431] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 2431] Teacher logits device before move: cuda:0
[Step 2431] Target device (student_logits.device): cuda:1
[Step 2431] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 2431] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 2431] GPU 0 memory after del: 16.39 GB
[Step 2431] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 2431] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.02 GB
[Step 2431] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 2431] Sequence length: 1024, Batch size: 2
[Step 2431] After KL computation - GPU 1: 40.51 GB
[Step 2431] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(

[Step 2441] ========== MEMORY DEBUG ==========
[Step 2441] Model device: cuda:1
[Step 2441] Input device: cuda:1
[Step 2441] Teacher model device: cuda:0
[Step 2441] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 2441] GPU 1 memory: 33.76 GB (reserved: 47.64 GB)
[Step 2441] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 2441] Student model device: cuda:1
[Step 2441] GPU 0 memory before teacher forward: 16.39 GB
[Step 2441] GPU 0 memory after moving inputs: 16.39 GB
[Step 2441] GPU 0 memory after teacher forward: 17.01 GB
[Step 2441] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 2441] Teacher logits device before move: cuda:0
[Step 2441] Target device (student_logits.device): cuda:1
[Step 2441] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 2441] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 2441] GPU 0 memory after del: 16.39 GB
[Step 2441] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 2441] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 2441] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 2441] Sequence length: 1024, Batch size: 2
[Step 2441] After KL computation - GPU 1: 40.50 GB
[Step 2441] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  2%|                                                                                     | 153/10000 [54:16<58:08:36, 21.26s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None

[Step 2451] ========== MEMORY DEBUG ==========
[Step 2451] Model device: cuda:1
[Step 2451] Input device: cuda:1
[Step 2451] Teacher model device: cuda:0
[Step 2451] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 2451] GPU 1 memory: 33.77 GB (reserved: 45.66 GB)
[Step 2451] Student logits device: cuda:1, shape: torch.Size([2, 474, 151936]), dtype: torch.float32
[Step 2451] Student model device: cuda:1
[Step 2451] GPU 0 memory before teacher forward: 16.39 GB
[Step 2451] GPU 0 memory after moving inputs: 16.39 GB
[Step 2451] GPU 0 memory after teacher forward: 16.68 GB
[Step 2451] Teacher logits shape: torch.Size([2, 474, 151936]), dtype: torch.float16
[Step 2451] Teacher logits device before move: cuda:0
[Step 2451] Target device (student_logits.device): cuda:1
[Step 2451] GPU 0 memory after moving logits to GPU 1: 16.68 GB
[Step 2451] Teacher logits device after move: cuda:1, shape: torch.Size([2, 474, 151936])
[Step 2451] GPU 0 memory after del: 16.39 GB
[Step 2451] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 2451] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 36.07 GB
[Step 2451] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 2451] Sequence length: 474, Batch size: 2
[Step 2451] After KL computation - GPU 1: 37.22 GB
[Step 2451] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 2461] ========== MEMORY DEBUG ==========
[Step 2461] Model device: cuda:1
[Step 2461] Input device: cuda:1
[Step 2461] Teacher model device: cuda:0
[Step 2461] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 2461] GPU 1 memory: 33.77 GB (reserved: 48.00 GB)
[Step 2461] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 2461] Student model device: cuda:1
[Step 2461] GPU 0 memory before teacher forward: 16.39 GB
[Step 2461] GPU 0 memory after moving inputs: 16.39 GB
[Step 2461] GPU 0 memory after teacher forward: 17.01 GB
[Step 2461] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 2461] Teacher logits device before move: cuda:0
[Step 2461] Target device (student_logits.device): cuda:1
[Step 2461] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 2461] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 2461] GPU 0 memory after del: 16.39 GB
[Step 2461] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 2461] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.02 GB
[Step 2461] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 2461] Sequence length: 1024, Batch size: 2
[Step 2461] After KL computation - GPU 1: 40.51 GB
[Step 2461] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  2%|                                                                                     | 154/10000 [54:39<59:30:14, 21.76s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 2471] ========== MEMORY DEBUG ==========
[Step 2471] Model device: cuda:1
[Step 2471] Input device: cuda:1
[Step 2471] Teacher model device: cuda:0
[Step 2471] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 2471] GPU 1 memory: 33.76 GB (reserved: 47.39 GB)
[Step 2471] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 2471] Student model device: cuda:1
[Step 2471] GPU 0 memory before teacher forward: 16.39 GB
[Step 2471] GPU 0 memory after moving inputs: 16.39 GB
[Step 2471] GPU 0 memory after teacher forward: 17.01 GB
[Step 2471] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 2471] Teacher logits device before move: cuda:0
[Step 2471] Target device (student_logits.device): cuda:1
[Step 2471] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 2471] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 2471] GPU 0 memory after del: 16.39 GB
[Step 2471] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 2471] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 2471] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 2471] Sequence length: 1024, Batch size: 2
[Step 2471] After KL computation - GPU 1: 40.50 GB
[Step 2471] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  2%|                                                                                     | 155/10000 [55:00<58:51:46, 21.52s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None

[Step 2481] ========== MEMORY DEBUG ==========
[Step 2481] Model device: cuda:1
[Step 2481] Input device: cuda:1
[Step 2481] Teacher model device: cuda:0
[Step 2481] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 2481] GPU 1 memory: 25.33 GB (reserved: 47.68 GB)
[Step 2481] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 2481] Student model device: cuda:1
[Step 2481] GPU 0 memory before teacher forward: 16.39 GB
[Step 2481] GPU 0 memory after moving inputs: 16.39 GB
[Step 2481] GPU 0 memory after teacher forward: 17.01 GB
[Step 2481] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 2481] Teacher logits device before move: cuda:0
[Step 2481] Target device (student_logits.device): cuda:1
[Step 2481] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 2481] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 2481] GPU 0 memory after del: 16.39 GB
[Step 2481] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 2481] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 29.58 GB
[Step 2481] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 2481] Sequence length: 1024, Batch size: 2
[Step 2481] After KL computation - GPU 1: 32.07 GB
[Step 2481] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 2491] ========== MEMORY DEBUG ==========
[Step 2491] Model device: cuda:1
[Step 2491] Input device: cuda:1
[Step 2491] Teacher model device: cuda:0
[Step 2491] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 2491] GPU 1 memory: 33.76 GB (reserved: 47.49 GB)
[Step 2491] Student logits device: cuda:1, shape: torch.Size([2, 771, 151936]), dtype: torch.float32
[Step 2491] Student model device: cuda:1
[Step 2491] GPU 0 memory before teacher forward: 16.39 GB
[Step 2491] GPU 0 memory after moving inputs: 16.39 GB
[Step 2491] GPU 0 memory after teacher forward: 16.86 GB
[Step 2491] Teacher logits shape: torch.Size([2, 771, 151936]), dtype: torch.float16
[Step 2491] Teacher logits device before move: cuda:0
[Step 2491] Target device (student_logits.device): cuda:1
[Step 2491] GPU 0 memory after moving logits to GPU 1: 16.86 GB
[Step 2491] Teacher logits device after move: cuda:1, shape: torch.Size([2, 771, 151936])
[Step 2491] GPU 0 memory after del: 16.39 GB
[Step 2491] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 2491] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 37.12 GB
[Step 2491] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 2491] Sequence length: 771, Batch size: 2
[Step 2491] After KL computation - GPU 1: 38.99 GB
[Step 2491] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  2%|                                                                                     | 156/10000 [55:20<57:57:56, 21.20s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 2501] ========== MEMORY DEBUG ==========
[Step 2501] Model device: cuda:1
[Step 2501] Input device: cuda:1
[Step 2501] Teacher model device: cuda:0
[Step 2501] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 2501] GPU 1 memory: 33.76 GB (reserved: 48.17 GB)
[Step 2501] Student logits device: cuda:1, shape: torch.Size([2, 792, 151936]), dtype: torch.float32
[Step 2501] Student model device: cuda:1
[Step 2501] GPU 0 memory before teacher forward: 16.39 GB
[Step 2501] GPU 0 memory after moving inputs: 16.39 GB
[Step 2501] GPU 0 memory after teacher forward: 16.87 GB
[Step 2501] Teacher logits shape: torch.Size([2, 792, 151936]), dtype: torch.float16
[Step 2501] Teacher logits device before move: cuda:0
[Step 2501] Target device (student_logits.device): cuda:1
[Step 2501] GPU 0 memory after moving logits to GPU 1: 16.87 GB
[Step 2501] Teacher logits device after move: cuda:1, shape: torch.Size([2, 792, 151936])
[Step 2501] GPU 0 memory after del: 16.39 GB
[Step 2501] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 2501] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 37.19 GB
[Step 2501] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 2501] Sequence length: 792, Batch size: 2
[Step 2501] After KL computation - GPU 1: 39.12 GB
[Step 2501] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 2511] ========== MEMORY DEBUG ==========
[Step 2511] Model device: cuda:1
[Step 2511] Input device: cuda:1
[Step 2511] Teacher model device: cuda:0
[Step 2511] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 2511] GPU 1 memory: 33.76 GB (reserved: 46.91 GB)
[Step 2511] Student logits device: cuda:1, shape: torch.Size([2, 286, 151936]), dtype: torch.float32
[Step 2511] Student model device: cuda:1
[Step 2511] GPU 0 memory before teacher forward: 16.39 GB
[Step 2511] GPU 0 memory after moving inputs: 16.39 GB
[Step 2511] GPU 0 memory after teacher forward: 16.57 GB
[Step 2511] Teacher logits shape: torch.Size([2, 286, 151936]), dtype: torch.float16
[Step 2511] Teacher logits device before move: cuda:0
[Step 2511] Target device (student_logits.device): cuda:1
[Step 2511] GPU 0 memory after moving logits to GPU 1: 16.57 GB
[Step 2511] Teacher logits device after move: cuda:1, shape: torch.Size([2, 286, 151936])
[Step 2511] GPU 0 memory after del: 16.39 GB
[Step 2511] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 2511] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 35.40 GB
[Step 2511] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 2511] Sequence length: 286, Batch size: 2
[Step 2511] After KL computation - GPU 1: 36.10 GB
[Step 2511] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  2%|                                                                                     | 157/10000 [55:41<57:31:19, 21.04s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None

[Step 2521] ========== MEMORY DEBUG ==========
[Step 2521] Model device: cuda:1
[Step 2521] Input device: cuda:1
[Step 2521] Teacher model device: cuda:0
[Step 2521] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 2521] GPU 1 memory: 33.76 GB (reserved: 47.08 GB)
  warnings.warn(
[Step 2521] Student logits device: cuda:1, shape: torch.Size([2, 939, 151936]), dtype: torch.float32
[Step 2521] Student model device: cuda:1
[Step 2521] GPU 0 memory before teacher forward: 16.39 GB
[Step 2521] GPU 0 memory after moving inputs: 16.39 GB
[Step 2521] GPU 0 memory after teacher forward: 16.96 GB
[Step 2521] Teacher logits shape: torch.Size([2, 939, 151936]), dtype: torch.float16
[Step 2521] Teacher logits device before move: cuda:0
[Step 2521] Target device (student_logits.device): cuda:1
[Step 2521] GPU 0 memory after moving logits to GPU 1: 16.96 GB
[Step 2521] Teacher logits device after move: cuda:1, shape: torch.Size([2, 939, 151936])
[Step 2521] GPU 0 memory after del: 16.39 GB
[Step 2521] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 2521] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 37.71 GB
[Step 2521] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 2521] Sequence length: 939, Batch size: 2
[Step 2521] After KL computation - GPU 1: 39.99 GB
[Step 2521] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  2%|                                                                                     | 158/10000 [56:03<58:09:29, 21.27s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None

[Step 2531] ========== MEMORY DEBUG ==========
[Step 2531] Model device: cuda:1
[Step 2531] Input device: cuda:1
[Step 2531] Teacher model device: cuda:0
[Step 2531] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 2531] GPU 1 memory: 33.76 GB (reserved: 47.54 GB)
[Step 2531] Student logits device: cuda:1, shape: torch.Size([2, 827, 151936]), dtype: torch.float32
[Step 2531] Student model device: cuda:1
[Step 2531] GPU 0 memory before teacher forward: 16.39 GB
[Step 2531] GPU 0 memory after moving inputs: 16.39 GB
[Step 2531] GPU 0 memory after teacher forward: 16.90 GB
[Step 2531] Teacher logits shape: torch.Size([2, 827, 151936]), dtype: torch.float16
[Step 2531] Teacher logits device before move: cuda:0
[Step 2531] Target device (student_logits.device): cuda:1
[Step 2531] GPU 0 memory after moving logits to GPU 1: 16.90 GB
[Step 2531] Teacher logits device after move: cuda:1, shape: torch.Size([2, 827, 151936])
[Step 2531] GPU 0 memory after del: 16.39 GB
[Step 2531] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 2531] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 37.32 GB
[Step 2531] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 2531] Sequence length: 827, Batch size: 2
[Step 2531] After KL computation - GPU 1: 39.33 GB
[Step 2531] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 2541] ========== MEMORY DEBUG ==========
[Step 2541] Model device: cuda:1
[Step 2541] Input device: cuda:1
[Step 2541] Teacher model device: cuda:0
[Step 2541] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 2541] GPU 1 memory: 33.76 GB (reserved: 46.18 GB)
[Step 2541] Student logits device: cuda:1, shape: torch.Size([2, 894, 151936]), dtype: torch.float32
[Step 2541] Student model device: cuda:1
[Step 2541] GPU 0 memory before teacher forward: 16.39 GB
[Step 2541] GPU 0 memory after moving inputs: 16.39 GB
[Step 2541] GPU 0 memory after teacher forward: 16.94 GB
[Step 2541] Teacher logits shape: torch.Size([2, 894, 151936]), dtype: torch.float16
[Step 2541] Teacher logits device before move: cuda:0
[Step 2541] Target device (student_logits.device): cuda:1
[Step 2541] GPU 0 memory after moving logits to GPU 1: 16.94 GB
[Step 2541] Teacher logits device after move: cuda:1, shape: torch.Size([2, 894, 151936])
[Step 2541] GPU 0 memory after del: 16.39 GB
[Step 2541] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 2541] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 37.55 GB
[Step 2541] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 2541] Sequence length: 894, Batch size: 2
[Step 2541] After KL computation - GPU 1: 39.72 GB
[Step 2541] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  2%|                                                                                     | 159/10000 [56:23<57:14:46, 20.94s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 2551] ========== MEMORY DEBUG ==========
[Step 2551] Model device: cuda:1
[Step 2551] Input device: cuda:1
[Step 2551] Teacher model device: cuda:0
[Step 2551] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 2551] GPU 1 memory: 33.76 GB (reserved: 42.54 GB)
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
[Step 2551] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 2551] Student model device: cuda:1
[Step 2551] GPU 0 memory before teacher forward: 16.39 GB
[Step 2551] GPU 0 memory after moving inputs: 16.39 GB
[Step 2551] GPU 0 memory after teacher forward: 17.01 GB
[Step 2551] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 2551] Teacher logits device before move: cuda:0
[Step 2551] Target device (student_logits.device): cuda:1
[Step 2551] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 2551] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 2551] GPU 0 memory after del: 16.39 GB
[Step 2551] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 2551] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 2551] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 2551] Sequence length: 1024, Batch size: 2
[Step 2551] After KL computation - GPU 1: 40.50 GB
[Step 2551] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  2%|                                                                                     | 160/10000 [56:43<56:25:10, 20.64s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
{'loss': 904468.3, 'grad_norm': nan, 'learning_rate': 4.9702020202020205e-05, 'epoch': 0.02}

[Step 2561] ========== MEMORY DEBUG ==========
[Step 2561] Model device: cuda:1
[Step 2561] Input device: cuda:1
[Step 2561] Teacher model device: cuda:0
[Step 2561] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 2561] GPU 1 memory: 25.33 GB (reserved: 47.57 GB)
[Step 2561] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 2561] Student model device: cuda:1
[Step 2561] GPU 0 memory before teacher forward: 16.39 GB
[Step 2561] GPU 0 memory after moving inputs: 16.39 GB
[Step 2561] GPU 0 memory after teacher forward: 17.01 GB
[Step 2561] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 2561] Teacher logits device before move: cuda:0
[Step 2561] Target device (student_logits.device): cuda:1
[Step 2561] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 2561] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 2561] GPU 0 memory after del: 16.39 GB
[Step 2561] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 2561] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 29.58 GB
[Step 2561] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 2561] Sequence length: 1024, Batch size: 2
[Step 2561] After KL computation - GPU 1: 32.07 GB
[Step 2561] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(

[Step 2571] ========== MEMORY DEBUG ==========
[Step 2571] Model device: cuda:1
[Step 2571] Input device: cuda:1
[Step 2571] Teacher model device: cuda:0
[Step 2571] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 2571] GPU 1 memory: 33.76 GB (reserved: 42.44 GB)
[Step 2571] Student logits device: cuda:1, shape: torch.Size([2, 823, 151936]), dtype: torch.float32
[Step 2571] Student model device: cuda:1
[Step 2571] GPU 0 memory before teacher forward: 16.39 GB
[Step 2571] GPU 0 memory after moving inputs: 16.39 GB
[Step 2571] GPU 0 memory after teacher forward: 16.89 GB
[Step 2571] Teacher logits shape: torch.Size([2, 823, 151936]), dtype: torch.float16
[Step 2571] Teacher logits device before move: cuda:0
[Step 2571] Target device (student_logits.device): cuda:1
[Step 2571] GPU 0 memory after moving logits to GPU 1: 16.89 GB
[Step 2571] Teacher logits device after move: cuda:1, shape: torch.Size([2, 823, 151936])
[Step 2571] GPU 0 memory after del: 16.39 GB
[Step 2571] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 2571] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 37.30 GB
[Step 2571] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 2571] Sequence length: 823, Batch size: 2
[Step 2571] After KL computation - GPU 1: 39.30 GB
[Step 2571] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  2%|                                                                                     | 161/10000 [57:04<56:36:14, 20.71s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None

[Step 2581] ========== MEMORY DEBUG ==========
[Step 2581] Model device: cuda:1
[Step 2581] Input device: cuda:1
[Step 2581] Teacher model device: cuda:0
[Step 2581] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 2581] GPU 1 memory: 33.76 GB (reserved: 47.54 GB)
[Step 2581] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 2581] Student model device: cuda:1
[Step 2581] GPU 0 memory before teacher forward: 16.39 GB
[Step 2581] GPU 0 memory after moving inputs: 16.39 GB
[Step 2581] GPU 0 memory after teacher forward: 17.01 GB
[Step 2581] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 2581] Teacher logits device before move: cuda:0
[Step 2581] Target device (student_logits.device): cuda:1
[Step 2581] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 2581] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 2581] GPU 0 memory after del: 16.39 GB
[Step 2581] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 2581] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 2581] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 2581] Sequence length: 1024, Batch size: 2
[Step 2581] After KL computation - GPU 1: 40.50 GB
[Step 2581] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 2591] ========== MEMORY DEBUG ==========
[Step 2591] Model device: cuda:1
[Step 2591] Input device: cuda:1
[Step 2591] Teacher model device: cuda:0
[Step 2591] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 2591] GPU 1 memory: 33.76 GB (reserved: 47.53 GB)
[Step 2591] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 2591] Student model device: cuda:1
[Step 2591] GPU 0 memory before teacher forward: 16.39 GB
[Step 2591] GPU 0 memory after moving inputs: 16.39 GB
[Step 2591] GPU 0 memory after teacher forward: 17.01 GB
[Step 2591] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 2591] Teacher logits device before move: cuda:0
[Step 2591] Target device (student_logits.device): cuda:1
[Step 2591] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 2591] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 2591] GPU 0 memory after del: 16.39 GB
[Step 2591] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 2591] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 2591] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 2591] Sequence length: 1024, Batch size: 2
[Step 2591] After KL computation - GPU 1: 40.50 GB
[Step 2591] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  2%|                                                                                     | 163/10000 [57:48<58:12:09, 21.30s/it]

[Step 2601] ========== MEMORY DEBUG ==========
[Step 2601] Model device: cuda:1
[Step 2601] Input device: cuda:1
[Step 2601] Teacher model device: cuda:0
[Step 2601] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 2601] GPU 1 memory: 33.76 GB (reserved: 47.39 GB)
[Step 2601] Student logits device: cuda:1, shape: torch.Size([2, 520, 151936]), dtype: torch.float32
[Step 2601] Student model device: cuda:1
[Step 2601] GPU 0 memory before teacher forward: 16.39 GB
[Step 2601] GPU 0 memory after moving inputs: 16.39 GB
[Step 2601] GPU 0 memory after teacher forward: 16.71 GB
[Step 2601] Teacher logits shape: torch.Size([2, 520, 151936]), dtype: torch.float16
[Step 2601] Teacher logits device before move: cuda:0
[Step 2601] Target device (student_logits.device): cuda:1
[Step 2601] GPU 0 memory after moving logits to GPU 1: 16.71 GB
[Step 2601] Teacher logits device after move: cuda:1, shape: torch.Size([2, 520, 151936])
[Step 2601] GPU 0 memory after del: 16.39 GB
[Step 2601] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 2601] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 36.23 GB
[Step 2601] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 2601] Sequence length: 520, Batch size: 2
[Step 2601] After KL computation - GPU 1: 37.49 GB
[Step 2601] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 2611] ========== MEMORY DEBUG ==========
[Step 2611] Model device: cuda:1
[Step 2611] Input device: cuda:1
[Step 2611] Teacher model device: cuda:0
[Step 2611] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 2611] GPU 1 memory: 33.77 GB (reserved: 48.05 GB)
[Step 2611] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 2611] Student model device: cuda:1
[Step 2611] GPU 0 memory before teacher forward: 16.39 GB
[Step 2611] GPU 0 memory after moving inputs: 16.39 GB
[Step 2611] GPU 0 memory after teacher forward: 17.01 GB
[Step 2611] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 2611] Teacher logits device before move: cuda:0
[Step 2611] Target device (student_logits.device): cuda:1
[Step 2611] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 2611] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 2611] GPU 0 memory after del: 16.39 GB
[Step 2611] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 2611] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.02 GB
[Step 2611] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 2611] Sequence length: 1024, Batch size: 2
[Step 2611] After KL computation - GPU 1: 40.51 GB
[Step 2611] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 2621] ========== MEMORY DEBUG ==========
[Step 2621] Model device: cuda:1
[Step 2621] Input device: cuda:1
[Step 2621] Teacher model device: cuda:0
[Step 2621] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 2621] GPU 1 memory: 33.77 GB (reserved: 43.76 GB)
[Step 2621] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 2621] Student model device: cuda:1
[Step 2621] GPU 0 memory before teacher forward: 16.39 GB
[Step 2621] GPU 0 memory after moving inputs: 16.39 GB
[Step 2621] GPU 0 memory after teacher forward: 17.01 GB
[Step 2621] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 2621] Teacher logits device before move: cuda:0
[Step 2621] Target device (student_logits.device): cuda:1
[Step 2621] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 2621] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 2621] GPU 0 memory after del: 16.39 GB
[Step 2621] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 2621] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.02 GB
[Step 2621] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 2621] Sequence length: 1024, Batch size: 2
[Step 2621] After KL computation - GPU 1: 40.51 GB
[Step 2621] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 2631] ========== MEMORY DEBUG ==========
[Step 2631] Model device: cuda:1
[Step 2631] Input device: cuda:1
[Step 2631] Teacher model device: cuda:0
[Step 2631] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 2631] GPU 1 memory: 33.76 GB (reserved: 43.21 GB)
[Step 2631] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 2631] Student model device: cuda:1
[Step 2631] GPU 0 memory before teacher forward: 16.39 GB
[Step 2631] GPU 0 memory after moving inputs: 16.39 GB
[Step 2631] GPU 0 memory after teacher forward: 17.01 GB
[Step 2631] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 2631] Teacher logits device before move: cuda:0
[Step 2631] Target device (student_logits.device): cuda:1
[Step 2631] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 2631] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 2631] GPU 0 memory after del: 16.39 GB
[Step 2631] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 2631] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 2631] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 2631] Sequence length: 1024, Batch size: 2
[Step 2631] After KL computation - GPU 1: 40.50 GB
[Step 2631] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(
  2%|                                                                                     | 165/10000 [58:27<55:42:16, 20.39s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None

[Step 2641] ========== MEMORY DEBUG ==========
[Step 2641] Model device: cuda:1
[Step 2641] Input device: cuda:1
[Step 2641] Teacher model device: cuda:0
[Step 2641] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 2641] GPU 1 memory: 25.33 GB (reserved: 44.17 GB)
[Step 2641] Student logits device: cuda:1, shape: torch.Size([2, 369, 151936]), dtype: torch.float32
[Step 2641] Student model device: cuda:1
[Step 2641] GPU 0 memory before teacher forward: 16.39 GB
[Step 2641] GPU 0 memory after moving inputs: 16.39 GB
[Step 2641] GPU 0 memory after teacher forward: 16.62 GB
[Step 2641] Teacher logits shape: torch.Size([2, 369, 151936]), dtype: torch.float16
[Step 2641] Teacher logits device before move: cuda:0
[Step 2641] Target device (student_logits.device): cuda:1
[Step 2641] GPU 0 memory after moving logits to GPU 1: 16.62 GB
[Step 2641] Teacher logits device after move: cuda:1, shape: torch.Size([2, 369, 151936])
[Step 2641] GPU 0 memory after del: 16.39 GB
[Step 2641] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 2641] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 27.26 GB
[Step 2641] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 2641] Sequence length: 369, Batch size: 2
[Step 2641] After KL computation - GPU 1: 28.15 GB
[Step 2641] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(

[Step 2651] ========== MEMORY DEBUG ==========
[Step 2651] Model device: cuda:1
[Step 2651] Input device: cuda:1
[Step 2651] Teacher model device: cuda:0
[Step 2651] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 2651] GPU 1 memory: 33.77 GB (reserved: 47.50 GB)
[Step 2651] Student logits device: cuda:1, shape: torch.Size([2, 766, 151936]), dtype: torch.float32
[Step 2651] Student model device: cuda:1
[Step 2651] GPU 0 memory before teacher forward: 16.39 GB
[Step 2651] GPU 0 memory after moving inputs: 16.39 GB
[Step 2651] GPU 0 memory after teacher forward: 16.86 GB
[Step 2651] Teacher logits shape: torch.Size([2, 766, 151936]), dtype: torch.float16
[Step 2651] Teacher logits device before move: cuda:0
[Step 2651] Target device (student_logits.device): cuda:1
[Step 2651] GPU 0 memory after moving logits to GPU 1: 16.86 GB
[Step 2651] Teacher logits device after move: cuda:1, shape: torch.Size([2, 766, 151936])
[Step 2651] GPU 0 memory after del: 16.39 GB
[Step 2651] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 2651] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 37.11 GB
[Step 2651] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 2651] Sequence length: 766, Batch size: 2
[Step 2651] After KL computation - GPU 1: 38.97 GB
[Step 2651] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  2%|                                                                                     | 166/10000 [58:47<55:39:56, 20.38s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 2661] ========== MEMORY DEBUG ==========
[Step 2661] Model device: cuda:1
[Step 2661] Input device: cuda:1
[Step 2661] Teacher model device: cuda:0
[Step 2661] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 2661] GPU 1 memory: 33.76 GB (reserved: 47.84 GB)
[Step 2661] Student logits device: cuda:1, shape: torch.Size([2, 444, 151936]), dtype: torch.float32
[Step 2661] Student model device: cuda:1
[Step 2661] GPU 0 memory before teacher forward: 16.39 GB
[Step 2661] GPU 0 memory after moving inputs: 16.39 GB
[Step 2661] GPU 0 memory after teacher forward: 16.66 GB
[Step 2661] Teacher logits shape: torch.Size([2, 444, 151936]), dtype: torch.float16
[Step 2661] Teacher logits device before move: cuda:0
[Step 2661] Target device (student_logits.device): cuda:1
[Step 2661] GPU 0 memory after moving logits to GPU 1: 16.66 GB
[Step 2661] Teacher logits device after move: cuda:1, shape: torch.Size([2, 444, 151936])
[Step 2661] GPU 0 memory after del: 16.39 GB
[Step 2661] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 2661] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 35.96 GB
[Step 2661] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 2661] Sequence length: 444, Batch size: 2
[Step 2661] After KL computation - GPU 1: 37.04 GB
[Step 2661] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 2671] ========== MEMORY DEBUG ==========
[Step 2671] Model device: cuda:1
[Step 2671] Input device: cuda:1
[Step 2671] Teacher model device: cuda:0
[Step 2671] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 2671] GPU 1 memory: 33.76 GB (reserved: 47.90 GB)
[Step 2671] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 2671] Student model device: cuda:1
[Step 2671] GPU 0 memory before teacher forward: 16.39 GB
[Step 2671] GPU 0 memory after moving inputs: 16.39 GB
[Step 2671] GPU 0 memory after teacher forward: 17.01 GB
[Step 2671] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 2671] Teacher logits device before move: cuda:0
[Step 2671] Target device (student_logits.device): cuda:1
[Step 2671] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 2671] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 2671] GPU 0 memory after del: 16.39 GB
[Step 2671] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 2671] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 2671] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 2671] Sequence length: 1024, Batch size: 2
[Step 2671] After KL computation - GPU 1: 40.50 GB
[Step 2671] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  2%|                                                                                     | 167/10000 [59:10<57:18:31, 20.98s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 2681] ========== MEMORY DEBUG ==========
[Step 2681] Model device: cuda:1
[Step 2681] Input device: cuda:1
[Step 2681] Teacher model device: cuda:0
[Step 2681] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 2681] GPU 1 memory: 33.76 GB (reserved: 46.15 GB)
[Step 2681] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 2681] Student model device: cuda:1
[Step 2681] GPU 0 memory before teacher forward: 16.39 GB
[Step 2681] GPU 0 memory after moving inputs: 16.39 GB
[Step 2681] GPU 0 memory after teacher forward: 17.01 GB
[Step 2681] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 2681] Teacher logits device before move: cuda:0
[Step 2681] Target device (student_logits.device): cuda:1
[Step 2681] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 2681] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 2681] GPU 0 memory after del: 16.39 GB
[Step 2681] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 2681] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 2681] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 2681] Sequence length: 1024, Batch size: 2
[Step 2681] After KL computation - GPU 1: 40.50 GB
[Step 2681] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  2%|                                                                                     | 168/10000 [59:30<56:32:54, 20.71s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None

[Step 2691] ========== MEMORY DEBUG ==========
[Step 2691] Model device: cuda:1
[Step 2691] Input device: cuda:1
[Step 2691] Teacher model device: cuda:0
[Step 2691] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 2691] GPU 1 memory: 33.78 GB (reserved: 39.00 GB)
  warnings.warn(
[Step 2691] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 2691] Student model device: cuda:1
[Step 2691] GPU 0 memory before teacher forward: 16.39 GB
[Step 2691] GPU 0 memory after moving inputs: 16.39 GB
[Step 2691] GPU 0 memory after teacher forward: 17.01 GB
[Step 2691] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 2691] Teacher logits device before move: cuda:0
[Step 2691] Target device (student_logits.device): cuda:1
[Step 2691] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 2691] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 2691] GPU 0 memory after del: 16.39 GB
[Step 2691] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 2691] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.03 GB
[Step 2691] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 2691] Sequence length: 1024, Batch size: 2
[Step 2691] After KL computation - GPU 1: 40.52 GB
[Step 2691] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 2701] ========== MEMORY DEBUG ==========
[Step 2701] Model device: cuda:1
[Step 2701] Input device: cuda:1
[Step 2701] Teacher model device: cuda:0
[Step 2701] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 2701] GPU 1 memory: 33.78 GB (reserved: 47.77 GB)
[Step 2701] Student logits device: cuda:1, shape: torch.Size([2, 976, 151936]), dtype: torch.float32
[Step 2701] Student model device: cuda:1
[Step 2701] GPU 0 memory before teacher forward: 16.39 GB
[Step 2701] GPU 0 memory after moving inputs: 16.39 GB
[Step 2701] GPU 0 memory after teacher forward: 16.99 GB
[Step 2701] Teacher logits shape: torch.Size([2, 976, 151936]), dtype: torch.float16
[Step 2701] Teacher logits device before move: cuda:0
[Step 2701] Target device (student_logits.device): cuda:1
[Step 2701] GPU 0 memory after moving logits to GPU 1: 16.99 GB
[Step 2701] Teacher logits device after move: cuda:1, shape: torch.Size([2, 976, 151936])
[Step 2701] GPU 0 memory after del: 16.39 GB
[Step 2701] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 2701] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 37.86 GB
[Step 2701] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 2701] Sequence length: 976, Batch size: 2
[Step 2701] After KL computation - GPU 1: 40.23 GB
[Step 2701] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  2%|                                                                                     | 169/10000 [59:51<56:48:26, 20.80s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None

[Step 2711] ========== MEMORY DEBUG ==========
[Step 2711] Model device: cuda:1
[Step 2711] Input device: cuda:1
[Step 2711] Teacher model device: cuda:0
[Step 2711] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 2711] GPU 1 memory: 33.77 GB (reserved: 45.38 GB)
[Step 2711] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 2711] Student model device: cuda:1
[Step 2711] GPU 0 memory before teacher forward: 16.39 GB
[Step 2711] GPU 0 memory after moving inputs: 16.39 GB
[Step 2711] GPU 0 memory after teacher forward: 17.01 GB
[Step 2711] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 2711] Teacher logits device before move: cuda:0
[Step 2711] Target device (student_logits.device): cuda:1
[Step 2711] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 2711] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 2711] GPU 0 memory after del: 16.39 GB
[Step 2711] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 2711] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.02 GB
[Step 2711] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 2711] Sequence length: 1024, Batch size: 2
[Step 2711] After KL computation - GPU 1: 40.51 GB
[Step 2711] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(
  2%|                                                                                   | 170/10000 [1:00:11<56:23:02, 20.65s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
{'loss': 14.0286, 'grad_norm': nan, 'learning_rate': 4.965151515151515e-05, 'epoch': 0.02}

[Step 2721] ========== MEMORY DEBUG ==========
[Step 2721] Model device: cuda:1
[Step 2721] Input device: cuda:1
[Step 2721] Teacher model device: cuda:0
[Step 2721] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 2721] GPU 1 memory: 25.33 GB (reserved: 48.69 GB)
[Step 2721] Student logits device: cuda:1, shape: torch.Size([2, 521, 151936]), dtype: torch.float32
[Step 2721] Student model device: cuda:1
[Step 2721] GPU 0 memory before teacher forward: 16.39 GB
[Step 2721] GPU 0 memory after moving inputs: 16.39 GB
[Step 2721] GPU 0 memory after teacher forward: 16.71 GB
[Step 2721] Teacher logits shape: torch.Size([2, 521, 151936]), dtype: torch.float16
[Step 2721] Teacher logits device before move: cuda:0
[Step 2721] Target device (student_logits.device): cuda:1
[Step 2721] GPU 0 memory after moving logits to GPU 1: 16.71 GB
[Step 2721] Teacher logits device after move: cuda:1, shape: torch.Size([2, 521, 151936])
[Step 2721] GPU 0 memory after del: 16.39 GB
[Step 2721] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 2721] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 27.79 GB
[Step 2721] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 2721] Sequence length: 521, Batch size: 2
[Step 2721] After KL computation - GPU 1: 29.06 GB
[Step 2721] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(

[Step 2731] ========== MEMORY DEBUG ==========
[Step 2731] Model device: cuda:1
[Step 2731] Input device: cuda:1
[Step 2731] Teacher model device: cuda:0
[Step 2731] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 2731] GPU 1 memory: 33.77 GB (reserved: 44.76 GB)
[Step 2731] Student logits device: cuda:1, shape: torch.Size([2, 424, 151936]), dtype: torch.float32
[Step 2731] Student model device: cuda:1
[Step 2731] GPU 0 memory before teacher forward: 16.39 GB
[Step 2731] GPU 0 memory after moving inputs: 16.39 GB
[Step 2731] GPU 0 memory after teacher forward: 16.65 GB
[Step 2731] Teacher logits shape: torch.Size([2, 424, 151936]), dtype: torch.float16
[Step 2731] Teacher logits device before move: cuda:0
[Step 2731] Target device (student_logits.device): cuda:1
[Step 2731] GPU 0 memory after moving logits to GPU 1: 16.65 GB
[Step 2731] Teacher logits device after move: cuda:1, shape: torch.Size([2, 424, 151936])
[Step 2731] GPU 0 memory after del: 16.39 GB
[Step 2731] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 2731] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 35.90 GB
[Step 2731] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 2731] Sequence length: 424, Batch size: 2
[Step 2731] After KL computation - GPU 1: 36.93 GB
[Step 2731] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  2%|                                                                                   | 171/10000 [1:00:31<55:42:03, 20.40s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 2741] ========== MEMORY DEBUG ==========
[Step 2741] Model device: cuda:1
[Step 2741] Input device: cuda:1
[Step 2741] Teacher model device: cuda:0
[Step 2741] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 2741] GPU 1 memory: 33.76 GB (reserved: 44.13 GB)
[Step 2741] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 2741] Student model device: cuda:1
[Step 2741] GPU 0 memory before teacher forward: 16.39 GB
[Step 2741] GPU 0 memory after moving inputs: 16.39 GB
[Step 2741] GPU 0 memory after teacher forward: 17.01 GB
[Step 2741] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 2741] Teacher logits device before move: cuda:0
[Step 2741] Target device (student_logits.device): cuda:1
[Step 2741] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 2741] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 2741] GPU 0 memory after del: 16.39 GB
[Step 2741] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 2741] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 2741] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 2741] Sequence length: 1024, Batch size: 2
[Step 2741] After KL computation - GPU 1: 40.50 GB
[Step 2741] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 2751] ========== MEMORY DEBUG ==========
[Step 2751] Model device: cuda:1
[Step 2751] Input device: cuda:1
[Step 2751] Teacher model device: cuda:0
[Step 2751] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 2751] GPU 1 memory: 33.76 GB (reserved: 47.50 GB)
[Step 2751] Student logits device: cuda:1, shape: torch.Size([2, 306, 151936]), dtype: torch.float32
[Step 2751] Student model device: cuda:1
[Step 2751] GPU 0 memory before teacher forward: 16.39 GB
[Step 2751] GPU 0 memory after moving inputs: 16.39 GB
[Step 2751] GPU 0 memory after teacher forward: 16.58 GB
[Step 2751] Teacher logits shape: torch.Size([2, 306, 151936]), dtype: torch.float16
[Step 2751] Teacher logits device before move: cuda:0
[Step 2751] Target device (student_logits.device): cuda:1
[Step 2751] GPU 0 memory after moving logits to GPU 1: 16.58 GB
[Step 2751] Teacher logits device after move: cuda:1, shape: torch.Size([2, 306, 151936])
[Step 2751] GPU 0 memory after del: 16.39 GB
[Step 2751] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 2751] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 35.47 GB
[Step 2751] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 2751] Sequence length: 306, Batch size: 2
[Step 2751] After KL computation - GPU 1: 36.21 GB
[Step 2751] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  2%|                                                                                   | 172/10000 [1:00:51<55:27:15, 20.31s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 2761] ========== MEMORY DEBUG ==========
[Step 2761] Model device: cuda:1
[Step 2761] Input device: cuda:1
[Step 2761] Teacher model device: cuda:0
[Step 2761] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 2761] GPU 1 memory: 33.76 GB (reserved: 47.44 GB)
[Step 2761] Student logits device: cuda:1, shape: torch.Size([2, 237, 151936]), dtype: torch.float32
[Step 2761] Student model device: cuda:1
[Step 2761] GPU 0 memory before teacher forward: 16.39 GB
[Step 2761] GPU 0 memory after moving inputs: 16.39 GB
[Step 2761] GPU 0 memory after teacher forward: 16.54 GB
[Step 2761] Teacher logits shape: torch.Size([2, 237, 151936]), dtype: torch.float16
[Step 2761] Teacher logits device before move: cuda:0
[Step 2761] Target device (student_logits.device): cuda:1
[Step 2761] GPU 0 memory after moving logits to GPU 1: 16.54 GB
[Step 2761] Teacher logits device after move: cuda:1, shape: torch.Size([2, 237, 151936])
[Step 2761] GPU 0 memory after del: 16.39 GB
[Step 2761] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 2761] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 35.23 GB
[Step 2761] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 2761] Sequence length: 237, Batch size: 2
[Step 2761] After KL computation - GPU 1: 35.81 GB
[Step 2761] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  2%|                                                                                   | 173/10000 [1:01:10<54:50:32, 20.09s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 2771] ========== MEMORY DEBUG ==========
[Step 2771] Model device: cuda:1
[Step 2771] Input device: cuda:1
[Step 2771] Teacher model device: cuda:0
[Step 2771] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 2771] GPU 1 memory: 33.76 GB (reserved: 47.82 GB)
[Step 2771] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 2771] Student model device: cuda:1
[Step 2771] GPU 0 memory before teacher forward: 16.39 GB
[Step 2771] GPU 0 memory after moving inputs: 16.39 GB
[Step 2771] GPU 0 memory after teacher forward: 17.01 GB
[Step 2771] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 2771] Teacher logits device before move: cuda:0
[Step 2771] Target device (student_logits.device): cuda:1
[Step 2771] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 2771] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 2771] GPU 0 memory after del: 16.39 GB
[Step 2771] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 2771] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.02 GB
[Step 2771] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 2771] Sequence length: 1024, Batch size: 2
[Step 2771] After KL computation - GPU 1: 40.51 GB
[Step 2771] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 2781] ========== MEMORY DEBUG ==========
[Step 2781] Model device: cuda:1
[Step 2781] Input device: cuda:1
[Step 2781] Teacher model device: cuda:0
[Step 2781] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 2781] GPU 1 memory: 33.76 GB (reserved: 47.81 GB)
[Step 2781] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 2781] Student model device: cuda:1
[Step 2781] GPU 0 memory before teacher forward: 16.39 GB
[Step 2781] GPU 0 memory after moving inputs: 16.39 GB
[Step 2781] GPU 0 memory after teacher forward: 17.01 GB
[Step 2781] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 2781] Teacher logits device before move: cuda:0
[Step 2781] Target device (student_logits.device): cuda:1
[Step 2781] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 2781] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 2781] GPU 0 memory after del: 16.39 GB
[Step 2781] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 2781] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.02 GB
[Step 2781] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 2781] Sequence length: 1024, Batch size: 2
[Step 2781] After KL computation - GPU 1: 40.51 GB
[Step 2781] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  2%|                                                                                   | 174/10000 [1:01:31<55:20:49, 20.28s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 2791] ========== MEMORY DEBUG ==========
[Step 2791] Model device: cuda:1
[Step 2791] Input device: cuda:1
[Step 2791] Teacher model device: cuda:0
[Step 2791] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 2791] GPU 1 memory: 33.77 GB (reserved: 47.65 GB)
[Step 2791] Student logits device: cuda:1, shape: torch.Size([2, 887, 151936]), dtype: torch.float32
[Step 2791] Student model device: cuda:1
[Step 2791] GPU 0 memory before teacher forward: 16.39 GB
[Step 2791] GPU 0 memory after moving inputs: 16.39 GB
[Step 2791] GPU 0 memory after teacher forward: 16.93 GB
[Step 2791] Teacher logits shape: torch.Size([2, 887, 151936]), dtype: torch.float16
[Step 2791] Teacher logits device before move: cuda:0
[Step 2791] Target device (student_logits.device): cuda:1
[Step 2791] GPU 0 memory after moving logits to GPU 1: 16.93 GB
[Step 2791] Teacher logits device after move: cuda:1, shape: torch.Size([2, 887, 151936])
[Step 2791] GPU 0 memory after del: 16.39 GB
[Step 2791] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 2791] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 37.53 GB
[Step 2791] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 2791] Sequence length: 887, Batch size: 2
[Step 2791] After KL computation - GPU 1: 39.69 GB
[Step 2791] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  2%|                                                                                   | 175/10000 [1:01:51<54:58:34, 20.14s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None

[Step 2801] ========== MEMORY DEBUG ==========
[Step 2801] Model device: cuda:1
[Step 2801] Input device: cuda:1
[Step 2801] Teacher model device: cuda:0
[Step 2801] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 2801] GPU 1 memory: 25.33 GB (reserved: 47.79 GB)
[Step 2801] Student logits device: cuda:1, shape: torch.Size([2, 930, 151936]), dtype: torch.float32
[Step 2801] Student model device: cuda:1
[Step 2801] GPU 0 memory before teacher forward: 16.39 GB
[Step 2801] GPU 0 memory after moving inputs: 16.39 GB
[Step 2801] GPU 0 memory after teacher forward: 16.96 GB
[Step 2801] Teacher logits shape: torch.Size([2, 930, 151936]), dtype: torch.float16
[Step 2801] Teacher logits device before move: cuda:0
[Step 2801] Target device (student_logits.device): cuda:1
[Step 2801] GPU 0 memory after moving logits to GPU 1: 16.96 GB
[Step 2801] Teacher logits device after move: cuda:1, shape: torch.Size([2, 930, 151936])
[Step 2801] GPU 0 memory after del: 16.39 GB
[Step 2801] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 2801] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 29.24 GB
[Step 2801] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 2801] Sequence length: 930, Batch size: 2
[Step 2801] After KL computation - GPU 1: 31.50 GB
[Step 2801] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(

[Step 2811] ========== MEMORY DEBUG ==========
[Step 2811] Model device: cuda:1
[Step 2811] Input device: cuda:1
[Step 2811] Teacher model device: cuda:0
[Step 2811] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 2811] GPU 1 memory: 33.77 GB (reserved: 47.86 GB)
[Step 2811] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 2811] Student model device: cuda:1
[Step 2811] GPU 0 memory before teacher forward: 16.39 GB
[Step 2811] GPU 0 memory after moving inputs: 16.39 GB
[Step 2811] GPU 0 memory after teacher forward: 17.01 GB
[Step 2811] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 2811] Teacher logits device before move: cuda:0
[Step 2811] Target device (student_logits.device): cuda:1
[Step 2811] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 2811] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 2811] GPU 0 memory after del: 16.39 GB
[Step 2811] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 2811] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.02 GB
[Step 2811] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 2811] Sequence length: 1024, Batch size: 2
[Step 2811] After KL computation - GPU 1: 40.51 GB
[Step 2811] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  2%|                                                                                   | 176/10000 [1:02:13<56:28:33, 20.70s/it]

[Step 2821] ========== MEMORY DEBUG ==========
[Step 2821] Model device: cuda:1
[Step 2821] Input device: cuda:1
[Step 2821] Teacher model device: cuda:0
[Step 2821] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 2821] GPU 1 memory: 33.77 GB (reserved: 41.45 GB)
[Step 2821] Student logits device: cuda:1, shape: torch.Size([2, 609, 151936]), dtype: torch.float32
[Step 2821] Student model device: cuda:1
[Step 2821] GPU 0 memory before teacher forward: 16.39 GB
[Step 2821] GPU 0 memory after moving inputs: 16.39 GB
[Step 2821] GPU 0 memory after teacher forward: 16.76 GB
[Step 2821] Teacher logits shape: torch.Size([2, 609, 151936]), dtype: torch.float16
[Step 2821] Teacher logits device before move: cuda:0
[Step 2821] Target device (student_logits.device): cuda:1
[Step 2821] GPU 0 memory after moving logits to GPU 1: 16.76 GB
[Step 2821] Teacher logits device after move: cuda:1, shape: torch.Size([2, 609, 151936])
[Step 2821] GPU 0 memory after del: 16.39 GB
[Step 2821] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 2821] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 36.54 GB
[Step 2821] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 2821] Sequence length: 609, Batch size: 2
[Step 2821] After KL computation - GPU 1: 38.03 GB
[Step 2821] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 2831] ========== MEMORY DEBUG ==========
[Step 2831] Model device: cuda:1
[Step 2831] Input device: cuda:1
[Step 2831] Teacher model device: cuda:0
[Step 2831] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 2831] GPU 1 memory: 33.77 GB (reserved: 43.81 GB)
[Step 2831] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 2831] Student model device: cuda:1
[Step 2831] GPU 0 memory before teacher forward: 16.39 GB
[Step 2831] GPU 0 memory after moving inputs: 16.39 GB
[Step 2831] GPU 0 memory after teacher forward: 17.01 GB
[Step 2831] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 2831] Teacher logits device before move: cuda:0
[Step 2831] Target device (student_logits.device): cuda:1
[Step 2831] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 2831] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 2831] GPU 0 memory after del: 16.39 GB
[Step 2831] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 2831] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.02 GB
[Step 2831] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 2831] Sequence length: 1024, Batch size: 2
[Step 2831] After KL computation - GPU 1: 40.51 GB
[Step 2831] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(

[Step 2841] ========== MEMORY DEBUG ==========
[Step 2841] Model device: cuda:1
[Step 2841] Input device: cuda:1
[Step 2841] Teacher model device: cuda:0
[Step 2841] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 2841] GPU 1 memory: 33.76 GB (reserved: 47.88 GB)
[Step 2841] Student logits device: cuda:1, shape: torch.Size([2, 943, 151936]), dtype: torch.float32
[Step 2841] Student model device: cuda:1
[Step 2841] GPU 0 memory before teacher forward: 16.39 GB
[Step 2841] GPU 0 memory after moving inputs: 16.39 GB
[Step 2841] GPU 0 memory after teacher forward: 16.97 GB
[Step 2841] Teacher logits shape: torch.Size([2, 943, 151936]), dtype: torch.float16
[Step 2841] Teacher logits device before move: cuda:0
[Step 2841] Target device (student_logits.device): cuda:1
[Step 2841] GPU 0 memory after moving logits to GPU 1: 16.97 GB
[Step 2841] Teacher logits device after move: cuda:1, shape: torch.Size([2, 943, 151936])
[Step 2841] GPU 0 memory after del: 16.39 GB
[Step 2841] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 2841] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 37.73 GB
[Step 2841] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 2841] Sequence length: 943, Batch size: 2
[Step 2841] After KL computation - GPU 1: 40.02 GB
[Step 2841] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  2%|                                                                                   | 178/10000 [1:02:58<59:00:29, 21.63s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 2851] ========== MEMORY DEBUG ==========
[Step 2851] Model device: cuda:1
[Step 2851] Input device: cuda:1
[Step 2851] Teacher model device: cuda:0
[Step 2851] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 2851] GPU 1 memory: 33.76 GB (reserved: 45.98 GB)
[Step 2851] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 2851] Student model device: cuda:1
[Step 2851] GPU 0 memory before teacher forward: 16.39 GB
[Step 2851] GPU 0 memory after moving inputs: 16.39 GB
[Step 2851] GPU 0 memory after teacher forward: 17.01 GB
[Step 2851] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 2851] Teacher logits device before move: cuda:0
[Step 2851] Target device (student_logits.device): cuda:1
[Step 2851] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 2851] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 2851] GPU 0 memory after del: 16.39 GB
[Step 2851] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 2851] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 2851] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 2851] Sequence length: 1024, Batch size: 2
[Step 2851] After KL computation - GPU 1: 40.50 GB
[Step 2851] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 2861] ========== MEMORY DEBUG ==========
[Step 2861] Model device: cuda:1
[Step 2861] Input device: cuda:1
[Step 2861] Teacher model device: cuda:0
[Step 2861] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 2861] GPU 1 memory: 33.76 GB (reserved: 47.53 GB)
[Step 2861] Student logits device: cuda:1, shape: torch.Size([2, 423, 151936]), dtype: torch.float32
[Step 2861] Student model device: cuda:1
[Step 2861] GPU 0 memory before teacher forward: 16.39 GB
[Step 2861] GPU 0 memory after moving inputs: 16.39 GB
[Step 2861] GPU 0 memory after teacher forward: 16.65 GB
[Step 2861] Teacher logits shape: torch.Size([2, 423, 151936]), dtype: torch.float16
[Step 2861] Teacher logits device before move: cuda:0
[Step 2861] Target device (student_logits.device): cuda:1
[Step 2861] GPU 0 memory after moving logits to GPU 1: 16.65 GB
[Step 2861] Teacher logits device after move: cuda:1, shape: torch.Size([2, 423, 151936])
[Step 2861] GPU 0 memory after del: 16.39 GB
[Step 2861] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 2861] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 35.88 GB
[Step 2861] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 2861] Sequence length: 423, Batch size: 2
[Step 2861] After KL computation - GPU 1: 36.91 GB
[Step 2861] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  2%|                                                                                   | 179/10000 [1:03:19<59:05:08, 21.66s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None

[Step 2871] ========== MEMORY DEBUG ==========
[Step 2871] Model device: cuda:1
[Step 2871] Input device: cuda:1
[Step 2871] Teacher model device: cuda:0
[Step 2871] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 2871] GPU 1 memory: 33.76 GB (reserved: 42.63 GB)
[Step 2871] Student logits device: cuda:1, shape: torch.Size([2, 955, 151936]), dtype: torch.float32
[Step 2871] Student model device: cuda:1
[Step 2871] GPU 0 memory before teacher forward: 16.39 GB
[Step 2871] GPU 0 memory after moving inputs: 16.39 GB
[Step 2871] GPU 0 memory after teacher forward: 16.97 GB
[Step 2871] Teacher logits shape: torch.Size([2, 955, 151936]), dtype: torch.float16
[Step 2871] Teacher logits device before move: cuda:0
[Step 2871] Target device (student_logits.device): cuda:1
[Step 2871] GPU 0 memory after moving logits to GPU 1: 16.97 GB
[Step 2871] Teacher logits device after move: cuda:1, shape: torch.Size([2, 955, 151936])
[Step 2871] GPU 0 memory after del: 16.39 GB
[Step 2871] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 2871] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 37.77 GB
[Step 2871] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 2871] Sequence length: 955, Batch size: 2
[Step 2871] After KL computation - GPU 1: 40.09 GB
[Step 2871] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(
  2%|                                                                                   | 180/10000 [1:03:39<57:21:12, 21.03s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
{'loss': 101319.7625, 'grad_norm': nan, 'learning_rate': 4.9601010101010104e-05, 'epoch': 0.02}

[Step 2881] ========== MEMORY DEBUG ==========
[Step 2881] Model device: cuda:1
[Step 2881] Input device: cuda:1
[Step 2881] Teacher model device: cuda:0
[Step 2881] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 2881] GPU 1 memory: 25.33 GB (reserved: 47.33 GB)
[Step 2881] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 2881] Student model device: cuda:1
[Step 2881] GPU 0 memory before teacher forward: 16.39 GB
[Step 2881] GPU 0 memory after moving inputs: 16.39 GB
[Step 2881] GPU 0 memory after teacher forward: 17.01 GB
[Step 2881] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 2881] Teacher logits device before move: cuda:0
[Step 2881] Target device (student_logits.device): cuda:1
[Step 2881] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 2881] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 2881] GPU 0 memory after del: 16.39 GB
[Step 2881] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 2881] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 29.58 GB
[Step 2881] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 2881] Sequence length: 1024, Batch size: 2
[Step 2881] After KL computation - GPU 1: 32.07 GB
[Step 2881] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(

[Step 2891] ========== MEMORY DEBUG ==========
[Step 2891] Model device: cuda:1
[Step 2891] Input device: cuda:1
[Step 2891] Teacher model device: cuda:0
[Step 2891] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 2891] GPU 1 memory: 33.76 GB (reserved: 47.79 GB)
[Step 2891] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 2891] Student model device: cuda:1
[Step 2891] GPU 0 memory before teacher forward: 16.39 GB
[Step 2891] GPU 0 memory after moving inputs: 16.39 GB
[Step 2891] GPU 0 memory after teacher forward: 17.01 GB
[Step 2891] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 2891] Teacher logits device before move: cuda:0
[Step 2891] Target device (student_logits.device): cuda:1
[Step 2891] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 2891] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 2891] GPU 0 memory after del: 16.39 GB
[Step 2891] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 2891] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 2891] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 2891] Sequence length: 1024, Batch size: 2
[Step 2891] After KL computation - GPU 1: 40.50 GB
[Step 2891] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  2%|                                                                                   | 181/10000 [1:04:02<58:59:52, 21.63s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None

[Step 2901] ========== MEMORY DEBUG ==========
[Step 2901] Model device: cuda:1
[Step 2901] Input device: cuda:1
[Step 2901] Teacher model device: cuda:0
[Step 2901] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 2901] GPU 1 memory: 33.76 GB (reserved: 43.89 GB)
[Step 2901] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 2901] Student model device: cuda:1
[Step 2901] GPU 0 memory before teacher forward: 16.39 GB
[Step 2901] GPU 0 memory after moving inputs: 16.39 GB
[Step 2901] GPU 0 memory after teacher forward: 17.01 GB
[Step 2901] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 2901] Teacher logits device before move: cuda:0
[Step 2901] Target device (student_logits.device): cuda:1
[Step 2901] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 2901] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 2901] GPU 0 memory after del: 16.39 GB
[Step 2901] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 2901] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 2901] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 2901] Sequence length: 1024, Batch size: 2
[Step 2901] After KL computation - GPU 1: 40.50 GB
[Step 2901] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 2911] ========== MEMORY DEBUG ==========
[Step 2911] Model device: cuda:1
[Step 2911] Input device: cuda:1
[Step 2911] Teacher model device: cuda:0
[Step 2911] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 2911] GPU 1 memory: 33.76 GB (reserved: 47.70 GB)
[Step 2911] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 2911] Student model device: cuda:1
[Step 2911] GPU 0 memory before teacher forward: 16.39 GB
[Step 2911] GPU 0 memory after moving inputs: 16.39 GB
[Step 2911] GPU 0 memory after teacher forward: 17.01 GB
[Step 2911] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 2911] Teacher logits device before move: cuda:0
[Step 2911] Target device (student_logits.device): cuda:1
[Step 2911] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 2911] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 2911] GPU 0 memory after del: 16.39 GB
[Step 2911] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 2911] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 2911] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 2911] Sequence length: 1024, Batch size: 2
[Step 2911] After KL computation - GPU 1: 40.50 GB
[Step 2911] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  2%|                                                                                   | 182/10000 [1:04:22<57:59:30, 21.26s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 2921] ========== MEMORY DEBUG ==========
[Step 2921] Model device: cuda:1
[Step 2921] Input device: cuda:1
[Step 2921] Teacher model device: cuda:0
[Step 2921] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 2921] GPU 1 memory: 33.76 GB (reserved: 47.23 GB)
[Step 2921] Student logits device: cuda:1, shape: torch.Size([2, 644, 151936]), dtype: torch.float32
[Step 2921] Student model device: cuda:1
[Step 2921] GPU 0 memory before teacher forward: 16.39 GB
[Step 2921] GPU 0 memory after moving inputs: 16.39 GB
[Step 2921] GPU 0 memory after teacher forward: 16.78 GB
[Step 2921] Teacher logits shape: torch.Size([2, 644, 151936]), dtype: torch.float16
[Step 2921] Teacher logits device before move: cuda:0
[Step 2921] Target device (student_logits.device): cuda:1
[Step 2921] GPU 0 memory after moving logits to GPU 1: 16.78 GB
[Step 2921] Teacher logits device after move: cuda:1, shape: torch.Size([2, 644, 151936])
[Step 2921] GPU 0 memory after del: 16.39 GB
[Step 2921] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 2921] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 36.67 GB
[Step 2921] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 2921] Sequence length: 644, Batch size: 2
[Step 2921] After KL computation - GPU 1: 38.23 GB
[Step 2921] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  2%|                                                                                   | 183/10000 [1:04:43<57:20:48, 21.03s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None

[Step 2931] ========== MEMORY DEBUG ==========
[Step 2931] Model device: cuda:1
[Step 2931] Input device: cuda:1
[Step 2931] Teacher model device: cuda:0
[Step 2931] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 2931] GPU 1 memory: 33.77 GB (reserved: 46.93 GB)
[Step 2931] Student logits device: cuda:1, shape: torch.Size([2, 183, 151936]), dtype: torch.float32
[Step 2931] Student model device: cuda:1
[Step 2931] GPU 0 memory before teacher forward: 16.39 GB
[Step 2931] GPU 0 memory after moving inputs: 16.39 GB
[Step 2931] GPU 0 memory after teacher forward: 16.50 GB
[Step 2931] Teacher logits shape: torch.Size([2, 183, 151936]), dtype: torch.float16
[Step 2931] Teacher logits device before move: cuda:0
[Step 2931] Target device (student_logits.device): cuda:1
[Step 2931] GPU 0 memory after moving logits to GPU 1: 16.50 GB
[Step 2931] Teacher logits device after move: cuda:1, shape: torch.Size([2, 183, 151936])
[Step 2931] GPU 0 memory after del: 16.39 GB
[Step 2931] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 2931] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 35.04 GB
[Step 2931] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 2931] Sequence length: 183, Batch size: 2
[Step 2931] After KL computation - GPU 1: 35.49 GB
[Step 2931] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 2941] ========== MEMORY DEBUG ==========
[Step 2941] Model device: cuda:1
[Step 2941] Input device: cuda:1
[Step 2941] Teacher model device: cuda:0
[Step 2941] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 2941] GPU 1 memory: 33.77 GB (reserved: 47.80 GB)
[Step 2941] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 2941] Student model device: cuda:1
[Step 2941] GPU 0 memory before teacher forward: 16.39 GB
[Step 2941] GPU 0 memory after moving inputs: 16.39 GB
[Step 2941] GPU 0 memory after teacher forward: 17.01 GB
[Step 2941] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 2941] Teacher logits device before move: cuda:0
[Step 2941] Target device (student_logits.device): cuda:1
[Step 2941] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 2941] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 2941] GPU 0 memory after del: 16.39 GB
[Step 2941] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 2941] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.02 GB
[Step 2941] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 2941] Sequence length: 1024, Batch size: 2
[Step 2941] After KL computation - GPU 1: 40.51 GB
[Step 2941] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  2%|                                                                                   | 184/10000 [1:05:04<57:36:22, 21.13s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 2951] ========== MEMORY DEBUG ==========
[Step 2951] Model device: cuda:1
[Step 2951] Input device: cuda:1
[Step 2951] Teacher model device: cuda:0
[Step 2951] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 2951] GPU 1 memory: 33.77 GB (reserved: 48.40 GB)
[Step 2951] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 2951] Student model device: cuda:1
[Step 2951] GPU 0 memory before teacher forward: 16.39 GB
[Step 2951] GPU 0 memory after moving inputs: 16.39 GB
[Step 2951] GPU 0 memory after teacher forward: 17.01 GB
[Step 2951] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 2951] Teacher logits device before move: cuda:0
[Step 2951] Target device (student_logits.device): cuda:1
[Step 2951] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 2951] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 2951] GPU 0 memory after del: 16.39 GB
[Step 2951] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 2951] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.02 GB
[Step 2951] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 2951] Sequence length: 1024, Batch size: 2
[Step 2951] After KL computation - GPU 1: 40.51 GB
[Step 2951] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  2%|                                                                                   | 185/10000 [1:05:26<58:10:31, 21.34s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None

[Step 2961] ========== MEMORY DEBUG ==========
[Step 2961] Model device: cuda:1
[Step 2961] Input device: cuda:1
[Step 2961] Teacher model device: cuda:0
[Step 2961] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 2961] GPU 1 memory: 25.33 GB (reserved: 48.07 GB)
[Step 2961] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 2961] Student model device: cuda:1
[Step 2961] GPU 0 memory before teacher forward: 16.39 GB
[Step 2961] GPU 0 memory after moving inputs: 16.39 GB
[Step 2961] GPU 0 memory after teacher forward: 17.01 GB
[Step 2961] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 2961] Teacher logits device before move: cuda:0
[Step 2961] Target device (student_logits.device): cuda:1
[Step 2961] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 2961] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 2961] GPU 0 memory after del: 16.39 GB
[Step 2961] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 2961] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 29.58 GB
[Step 2961] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 2961] Sequence length: 1024, Batch size: 2
[Step 2961] After KL computation - GPU 1: 32.06 GB
[Step 2961] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(

[Step 2971] ========== MEMORY DEBUG ==========
[Step 2971] Model device: cuda:1
[Step 2971] Input device: cuda:1
[Step 2971] Teacher model device: cuda:0
[Step 2971] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 2971] GPU 1 memory: 33.76 GB (reserved: 45.70 GB)
[Step 2971] Student logits device: cuda:1, shape: torch.Size([2, 485, 151936]), dtype: torch.float32
[Step 2971] Student model device: cuda:1
[Step 2971] GPU 0 memory before teacher forward: 16.39 GB
[Step 2971] GPU 0 memory after moving inputs: 16.39 GB
[Step 2971] GPU 0 memory after teacher forward: 16.69 GB
[Step 2971] Teacher logits shape: torch.Size([2, 485, 151936]), dtype: torch.float16
[Step 2971] Teacher logits device before move: cuda:0
[Step 2971] Target device (student_logits.device): cuda:1
[Step 2971] GPU 0 memory after moving logits to GPU 1: 16.69 GB
[Step 2971] Teacher logits device after move: cuda:1, shape: torch.Size([2, 485, 151936])
[Step 2971] GPU 0 memory after del: 16.39 GB
[Step 2971] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 2971] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 36.10 GB
[Step 2971] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 2971] Sequence length: 485, Batch size: 2
[Step 2971] After KL computation - GPU 1: 37.28 GB
[Step 2971] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  2%|                                                                                   | 186/10000 [1:05:45<56:18:43, 20.66s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None

[Step 2981] ========== MEMORY DEBUG ==========
[Step 2981] Model device: cuda:1
[Step 2981] Input device: cuda:1
[Step 2981] Teacher model device: cuda:0
[Step 2981] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 2981] GPU 1 memory: 33.76 GB (reserved: 47.73 GB)
[Step 2981] Student logits device: cuda:1, shape: torch.Size([2, 720, 151936]), dtype: torch.float32
[Step 2981] Student model device: cuda:1
[Step 2981] GPU 0 memory before teacher forward: 16.39 GB
[Step 2981] GPU 0 memory after moving inputs: 16.39 GB
[Step 2981] GPU 0 memory after teacher forward: 16.83 GB
[Step 2981] Teacher logits shape: torch.Size([2, 720, 151936]), dtype: torch.float16
[Step 2981] Teacher logits device before move: cuda:0
[Step 2981] Target device (student_logits.device): cuda:1
[Step 2981] GPU 0 memory after moving logits to GPU 1: 16.83 GB
[Step 2981] Teacher logits device after move: cuda:1, shape: torch.Size([2, 720, 151936])
[Step 2981] GPU 0 memory after del: 16.39 GB
[Step 2981] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 2981] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 36.93 GB
[Step 2981] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 2981] Sequence length: 720, Batch size: 2
[Step 2981] After KL computation - GPU 1: 38.68 GB
[Step 2981] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(

[Step 2991] ========== MEMORY DEBUG ==========
[Step 2991] Model device: cuda:1
[Step 2991] Input device: cuda:1
[Step 2991] Teacher model device: cuda:0
[Step 2991] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 2991] GPU 1 memory: 33.76 GB (reserved: 42.80 GB)
[Step 2991] Student logits device: cuda:1, shape: torch.Size([2, 538, 151936]), dtype: torch.float32
[Step 2991] Student model device: cuda:1
[Step 2991] GPU 0 memory before teacher forward: 16.39 GB
[Step 2991] GPU 0 memory after moving inputs: 16.39 GB
[Step 2991] GPU 0 memory after teacher forward: 16.72 GB
[Step 2991] Teacher logits shape: torch.Size([2, 538, 151936]), dtype: torch.float16
[Step 2991] Teacher logits device before move: cuda:0
[Step 2991] Target device (student_logits.device): cuda:1
[Step 2991] GPU 0 memory after moving logits to GPU 1: 16.72 GB
[Step 2991] Teacher logits device after move: cuda:1, shape: torch.Size([2, 538, 151936])
[Step 2991] GPU 0 memory after del: 16.39 GB
[Step 2991] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 2991] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 36.29 GB
[Step 2991] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 2991] Sequence length: 538, Batch size: 2
[Step 2991] After KL computation - GPU 1: 37.60 GB
[Step 2991] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  2%|                                                                                   | 187/10000 [1:06:06<56:12:00, 20.62s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None

[Step 3001] ========== MEMORY DEBUG ==========
[Step 3001] Model device: cuda:1
[Step 3001] Input device: cuda:1
[Step 3001] Teacher model device: cuda:0
[Step 3001] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 3001] GPU 1 memory: 33.76 GB (reserved: 44.70 GB)
[Step 3001] Student logits device: cuda:1, shape: torch.Size([2, 778, 151936]), dtype: torch.float32
[Step 3001] Student model device: cuda:1
[Step 3001] GPU 0 memory before teacher forward: 16.39 GB
[Step 3001] GPU 0 memory after moving inputs: 16.39 GB
[Step 3001] GPU 0 memory after teacher forward: 16.86 GB
[Step 3001] Teacher logits shape: torch.Size([2, 778, 151936]), dtype: torch.float16
[Step 3001] Teacher logits device before move: cuda:0
[Step 3001] Target device (student_logits.device): cuda:1
[Step 3001] GPU 0 memory after moving logits to GPU 1: 16.86 GB
[Step 3001] Teacher logits device after move: cuda:1, shape: torch.Size([2, 778, 151936])
[Step 3001] GPU 0 memory after del: 16.39 GB
[Step 3001] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 3001] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 37.15 GB
[Step 3001] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 3001] Sequence length: 778, Batch size: 2
[Step 3001] After KL computation - GPU 1: 39.04 GB
[Step 3001] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(
  2%|                                                                                   | 188/10000 [1:06:28<57:48:38, 21.21s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None

[Step 3011] ========== MEMORY DEBUG ==========
[Step 3011] Model device: cuda:1
[Step 3011] Input device: cuda:1
[Step 3011] Teacher model device: cuda:0
[Step 3011] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 3011] GPU 1 memory: 33.76 GB (reserved: 47.54 GB)
[Step 3011] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 3011] Student model device: cuda:1
[Step 3011] GPU 0 memory before teacher forward: 16.39 GB
[Step 3011] GPU 0 memory after moving inputs: 16.39 GB
[Step 3011] GPU 0 memory after teacher forward: 17.01 GB
[Step 3011] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 3011] Teacher logits device before move: cuda:0
[Step 3011] Target device (student_logits.device): cuda:1
[Step 3011] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 3011] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 3011] GPU 0 memory after del: 16.39 GB
[Step 3011] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 3011] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.02 GB
[Step 3011] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 3011] Sequence length: 1024, Batch size: 2
[Step 3011] After KL computation - GPU 1: 40.50 GB
[Step 3011] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(

[Step 3021] ========== MEMORY DEBUG ==========
[Step 3021] Model device: cuda:1
[Step 3021] Input device: cuda:1
[Step 3021] Teacher model device: cuda:0
[Step 3021] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 3021] GPU 1 memory: 33.76 GB (reserved: 44.74 GB)
[Step 3021] Student logits device: cuda:1, shape: torch.Size([2, 506, 151936]), dtype: torch.float32
[Step 3021] Student model device: cuda:1
[Step 3021] GPU 0 memory before teacher forward: 16.39 GB
[Step 3021] GPU 0 memory after moving inputs: 16.39 GB
[Step 3021] GPU 0 memory after teacher forward: 16.70 GB
[Step 3021] Teacher logits shape: torch.Size([2, 506, 151936]), dtype: torch.float16
[Step 3021] Teacher logits device before move: cuda:0
[Step 3021] Target device (student_logits.device): cuda:1
[Step 3021] GPU 0 memory after moving logits to GPU 1: 16.70 GB
[Step 3021] Teacher logits device after move: cuda:1, shape: torch.Size([2, 506, 151936])
[Step 3021] GPU 0 memory after del: 16.39 GB
[Step 3021] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 3021] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 36.18 GB
[Step 3021] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 3021] Sequence length: 506, Batch size: 2
[Step 3021] After KL computation - GPU 1: 37.41 GB
[Step 3021] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  2%|                                                                                   | 189/10000 [1:06:49<57:33:02, 21.12s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None

[Step 3031] ========== MEMORY DEBUG ==========
[Step 3031] Model device: cuda:1
[Step 3031] Input device: cuda:1
[Step 3031] Teacher model device: cuda:0
[Step 3031] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 3031] GPU 1 memory: 33.76 GB (reserved: 45.67 GB)
[Step 3031] Student logits device: cuda:1, shape: torch.Size([2, 469, 151936]), dtype: torch.float32
[Step 3031] Student model device: cuda:1
[Step 3031] GPU 0 memory before teacher forward: 16.39 GB
[Step 3031] GPU 0 memory after moving inputs: 16.39 GB
[Step 3031] GPU 0 memory after teacher forward: 16.68 GB
[Step 3031] Teacher logits shape: torch.Size([2, 469, 151936]), dtype: torch.float16
[Step 3031] Teacher logits device before move: cuda:0
[Step 3031] Target device (student_logits.device): cuda:1
[Step 3031] GPU 0 memory after moving logits to GPU 1: 16.68 GB
[Step 3031] Teacher logits device after move: cuda:1, shape: torch.Size([2, 469, 151936])
[Step 3031] GPU 0 memory after del: 16.39 GB
[Step 3031] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 3031] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 36.06 GB
[Step 3031] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 3031] Sequence length: 469, Batch size: 2
[Step 3031] After KL computation - GPU 1: 37.20 GB
[Step 3031] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(
  2%|                                                                                   | 190/10000 [1:07:11<57:50:36, 21.23s/it]
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 4.955050505050505e-05, 'epoch': 0.02}

[Step 3041] ========== MEMORY DEBUG ==========
[Step 3041] Model device: cuda:1
[Step 3041] Input device: cuda:1
[Step 3041] Teacher model device: cuda:0
[Step 3041] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 3041] GPU 1 memory: 25.33 GB (reserved: 42.15 GB)
[Step 3041] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 3041] Student model device: cuda:1
[Step 3041] GPU 0 memory before teacher forward: 16.39 GB
[Step 3041] GPU 0 memory after moving inputs: 16.39 GB
[Step 3041] GPU 0 memory after teacher forward: 17.01 GB
[Step 3041] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 3041] Teacher logits device before move: cuda:0
[Step 3041] Target device (student_logits.device): cuda:1
[Step 3041] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 3041] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 3041] GPU 0 memory after del: 16.39 GB
[Step 3041] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 3041] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 29.58 GB
[Step 3041] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 3041] Sequence length: 1024, Batch size: 2
[Step 3041] After KL computation - GPU 1: 32.07 GB
[Step 3041] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 3051] ========== MEMORY DEBUG ==========
[Step 3051] Model device: cuda:1
[Step 3051] Input device: cuda:1
[Step 3051] Teacher model device: cuda:0
[Step 3051] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 3051] GPU 1 memory: 33.76 GB (reserved: 47.85 GB)
[Step 3051] Student logits device: cuda:1, shape: torch.Size([2, 210, 151936]), dtype: torch.float32
[Step 3051] Student model device: cuda:1
[Step 3051] GPU 0 memory before teacher forward: 16.39 GB
[Step 3051] GPU 0 memory after moving inputs: 16.39 GB
[Step 3051] GPU 0 memory after teacher forward: 16.52 GB
[Step 3051] Teacher logits shape: torch.Size([2, 210, 151936]), dtype: torch.float16
[Step 3051] Teacher logits device before move: cuda:0
[Step 3051] Target device (student_logits.device): cuda:1
[Step 3051] GPU 0 memory after moving logits to GPU 1: 16.52 GB
[Step 3051] Teacher logits device after move: cuda:1, shape: torch.Size([2, 210, 151936])
[Step 3051] GPU 0 memory after del: 16.39 GB
[Step 3051] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 3051] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 35.14 GB
[Step 3051] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 3051] Sequence length: 210, Batch size: 2
[Step 3051] After KL computation - GPU 1: 35.66 GB
[Step 3051] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 3061] ========== MEMORY DEBUG ==========
[Step 3061] Model device: cuda:1
[Step 3061] Input device: cuda:1
[Step 3061] Teacher model device: cuda:0
[Step 3061] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 3061] GPU 1 memory: 33.76 GB (reserved: 47.66 GB)
[Step 3061] Student logits device: cuda:1, shape: torch.Size([2, 887, 151936]), dtype: torch.float32
[Step 3061] Student model device: cuda:1
[Step 3061] GPU 0 memory before teacher forward: 16.39 GB
[Step 3061] GPU 0 memory after moving inputs: 16.39 GB
[Step 3061] GPU 0 memory after teacher forward: 16.93 GB
[Step 3061] Teacher logits shape: torch.Size([2, 887, 151936]), dtype: torch.float16
[Step 3061] Teacher logits device before move: cuda:0
[Step 3061] Target device (student_logits.device): cuda:1
[Step 3061] GPU 0 memory after moving logits to GPU 1: 16.93 GB
[Step 3061] Teacher logits device after move: cuda:1, shape: torch.Size([2, 887, 151936])
[Step 3061] GPU 0 memory after del: 16.39 GB
[Step 3061] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 3061] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 37.53 GB
[Step 3061] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 3061] Sequence length: 887, Batch size: 2
[Step 3061] After KL computation - GPU 1: 39.68 GB
[Step 3061] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 3071] ========== MEMORY DEBUG ==========
[Step 3071] Model device: cuda:1
[Step 3071] Input device: cuda:1
[Step 3071] Teacher model device: cuda:0
[Step 3071] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 3071] GPU 1 memory: 33.76 GB (reserved: 46.49 GB)
[Step 3071] Student logits device: cuda:1, shape: torch.Size([2, 577, 151936]), dtype: torch.float32
[Step 3071] Student model device: cuda:1
[Step 3071] GPU 0 memory before teacher forward: 16.39 GB
[Step 3071] GPU 0 memory after moving inputs: 16.39 GB
[Step 3071] GPU 0 memory after teacher forward: 16.74 GB
[Step 3071] Teacher logits shape: torch.Size([2, 577, 151936]), dtype: torch.float16
[Step 3071] Teacher logits device before move: cuda:0
[Step 3071] Target device (student_logits.device): cuda:1
[Step 3071] GPU 0 memory after moving logits to GPU 1: 16.74 GB
[Step 3071] Teacher logits device after move: cuda:1, shape: torch.Size([2, 577, 151936])
[Step 3071] GPU 0 memory after del: 16.39 GB
[Step 3071] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 3071] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 36.43 GB
[Step 3071] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 3071] Sequence length: 577, Batch size: 2
[Step 3071] After KL computation - GPU 1: 37.83 GB
[Step 3071] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 3081] ========== MEMORY DEBUG ==========
[Step 3081] Model device: cuda:1
[Step 3081] Input device: cuda:1
[Step 3081] Teacher model device: cuda:0
[Step 3081] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 3081] GPU 1 memory: 33.77 GB (reserved: 48.13 GB)
[Step 3081] Student logits device: cuda:1, shape: torch.Size([2, 990, 151936]), dtype: torch.float32
[Step 3081] Student model device: cuda:1
[Step 3081] GPU 0 memory before teacher forward: 16.39 GB
[Step 3081] GPU 0 memory after moving inputs: 16.39 GB
[Step 3081] GPU 0 memory after teacher forward: 16.99 GB
[Step 3081] Teacher logits shape: torch.Size([2, 990, 151936]), dtype: torch.float16
[Step 3081] Teacher logits device before move: cuda:0
[Step 3081] Target device (student_logits.device): cuda:1
[Step 3081] GPU 0 memory after moving logits to GPU 1: 16.99 GB
[Step 3081] Teacher logits device after move: cuda:1, shape: torch.Size([2, 990, 151936])
[Step 3081] GPU 0 memory after del: 16.39 GB
[Step 3081] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 3081] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 37.90 GB
[Step 3081] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 3081] Sequence length: 990, Batch size: 2
[Step 3081] After KL computation - GPU 1: 40.31 GB
[Step 3081] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(
  2%|                                                                                   | 193/10000 [1:08:13<57:11:37, 20.99s/it]

[Step 3091] ========== MEMORY DEBUG ==========
[Step 3091] Model device: cuda:1
[Step 3091] Input device: cuda:1
[Step 3091] Teacher model device: cuda:0
[Step 3091] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 3091] GPU 1 memory: 33.76 GB (reserved: 47.90 GB)
[Step 3091] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 3091] Student model device: cuda:1
[Step 3091] GPU 0 memory before teacher forward: 16.39 GB
[Step 3091] GPU 0 memory after moving inputs: 16.39 GB
[Step 3091] GPU 0 memory after teacher forward: 17.01 GB
[Step 3091] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 3091] Teacher logits device before move: cuda:0
[Step 3091] Target device (student_logits.device): cuda:1
[Step 3091] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 3091] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 3091] GPU 0 memory after del: 16.39 GB
[Step 3091] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 3091] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 3091] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 3091] Sequence length: 1024, Batch size: 2
[Step 3091] After KL computation - GPU 1: 40.50 GB
[Step 3091] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 3101] ========== MEMORY DEBUG ==========
[Step 3101] Model device: cuda:1
[Step 3101] Input device: cuda:1
[Step 3101] Teacher model device: cuda:0
[Step 3101] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 3101] GPU 1 memory: 33.76 GB (reserved: 47.56 GB)
[Step 3101] Student logits device: cuda:1, shape: torch.Size([2, 738, 151936]), dtype: torch.float32
[Step 3101] Student model device: cuda:1
[Step 3101] GPU 0 memory before teacher forward: 16.39 GB
[Step 3101] GPU 0 memory after moving inputs: 16.39 GB
[Step 3101] GPU 0 memory after teacher forward: 16.84 GB
[Step 3101] Teacher logits shape: torch.Size([2, 738, 151936]), dtype: torch.float16
[Step 3101] Teacher logits device before move: cuda:0
[Step 3101] Target device (student_logits.device): cuda:1
[Step 3101] GPU 0 memory after moving logits to GPU 1: 16.84 GB
[Step 3101] Teacher logits device after move: cuda:1, shape: torch.Size([2, 738, 151936])
[Step 3101] GPU 0 memory after del: 16.39 GB
[Step 3101] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 3101] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 37.00 GB
[Step 3101] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 3101] Sequence length: 738, Batch size: 2
[Step 3101] After KL computation - GPU 1: 38.79 GB
[Step 3101] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(
  2%|                                                                                   | 194/10000 [1:08:35<58:04:14, 21.32s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 3111] ========== MEMORY DEBUG ==========
[Step 3111] Model device: cuda:1
[Step 3111] Input device: cuda:1
[Step 3111] Teacher model device: cuda:0
[Step 3111] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 3111] GPU 1 memory: 33.77 GB (reserved: 46.82 GB)
[Step 3111] Student logits device: cuda:1, shape: torch.Size([2, 569, 151936]), dtype: torch.float32
[Step 3111] Student model device: cuda:1
[Step 3111] GPU 0 memory before teacher forward: 16.39 GB
[Step 3111] GPU 0 memory after moving inputs: 16.39 GB
[Step 3111] GPU 0 memory after teacher forward: 16.74 GB
[Step 3111] Teacher logits shape: torch.Size([2, 569, 151936]), dtype: torch.float16
[Step 3111] Teacher logits device before move: cuda:0
[Step 3111] Target device (student_logits.device): cuda:1
[Step 3111] GPU 0 memory after moving logits to GPU 1: 16.74 GB
[Step 3111] Teacher logits device after move: cuda:1, shape: torch.Size([2, 569, 151936])
[Step 3111] GPU 0 memory after del: 16.39 GB
[Step 3111] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 3111] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 36.41 GB
[Step 3111] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 3111] Sequence length: 569, Batch size: 2
[Step 3111] After KL computation - GPU 1: 37.79 GB
[Step 3111] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  2%|                                                                                   | 195/10000 [1:08:58<59:33:20, 21.87s/it]

[Step 3121] ========== MEMORY DEBUG ==========
[Step 3121] Model device: cuda:1
[Step 3121] Input device: cuda:1
[Step 3121] Teacher model device: cuda:0
[Step 3121] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 3121] GPU 1 memory: 25.33 GB (reserved: 47.59 GB)
[Step 3121] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 3121] Student model device: cuda:1
[Step 3121] GPU 0 memory before teacher forward: 16.39 GB
[Step 3121] GPU 0 memory after moving inputs: 16.39 GB
[Step 3121] GPU 0 memory after teacher forward: 17.01 GB
[Step 3121] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 3121] Teacher logits device before move: cuda:0
[Step 3121] Target device (student_logits.device): cuda:1
[Step 3121] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 3121] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 3121] GPU 0 memory after del: 16.39 GB
[Step 3121] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 3121] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 29.58 GB
[Step 3121] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 3121] Sequence length: 1024, Batch size: 2
[Step 3121] After KL computation - GPU 1: 32.07 GB
[Step 3121] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 3131] ========== MEMORY DEBUG ==========
[Step 3131] Model device: cuda:1
[Step 3131] Input device: cuda:1
[Step 3131] Teacher model device: cuda:0
[Step 3131] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 3131] GPU 1 memory: 33.76 GB (reserved: 47.59 GB)
[Step 3131] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 3131] Student model device: cuda:1
[Step 3131] GPU 0 memory before teacher forward: 16.39 GB
[Step 3131] GPU 0 memory after moving inputs: 16.39 GB
[Step 3131] GPU 0 memory after teacher forward: 17.01 GB
[Step 3131] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 3131] Teacher logits device before move: cuda:0
[Step 3131] Target device (student_logits.device): cuda:1
[Step 3131] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 3131] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 3131] GPU 0 memory after del: 16.39 GB
[Step 3131] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 3131] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 3131] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 3131] Sequence length: 1024, Batch size: 2
[Step 3131] After KL computation - GPU 1: 40.50 GB
[Step 3131] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 3141] ========== MEMORY DEBUG ==========
[Step 3141] Model device: cuda:1
[Step 3141] Input device: cuda:1
[Step 3141] Teacher model device: cuda:0
[Step 3141] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 3141] GPU 1 memory: 33.76 GB (reserved: 46.56 GB)
[Step 3141] Student logits device: cuda:1, shape: torch.Size([2, 443, 151936]), dtype: torch.float32
[Step 3141] Student model device: cuda:1
[Step 3141] GPU 0 memory before teacher forward: 16.39 GB
[Step 3141] GPU 0 memory after moving inputs: 16.39 GB
[Step 3141] GPU 0 memory after teacher forward: 16.66 GB
[Step 3141] Teacher logits shape: torch.Size([2, 443, 151936]), dtype: torch.float16
[Step 3141] Teacher logits device before move: cuda:0
[Step 3141] Target device (student_logits.device): cuda:1
[Step 3141] GPU 0 memory after moving logits to GPU 1: 16.66 GB
[Step 3141] Teacher logits device after move: cuda:1, shape: torch.Size([2, 443, 151936])
[Step 3141] GPU 0 memory after del: 16.39 GB
[Step 3141] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 3141] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 35.96 GB
[Step 3141] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 3141] Sequence length: 443, Batch size: 2
[Step 3141] After KL computation - GPU 1: 37.04 GB
[Step 3141] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 3151] ========== MEMORY DEBUG ==========
[Step 3151] Model device: cuda:1
[Step 3151] Input device: cuda:1
[Step 3151] Teacher model device: cuda:0
[Step 3151] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 3151] GPU 1 memory: 33.76 GB (reserved: 47.72 GB)
[Step 3151] Student logits device: cuda:1, shape: torch.Size([2, 362, 151936]), dtype: torch.float32
[Step 3151] Student model device: cuda:1
[Step 3151] GPU 0 memory before teacher forward: 16.39 GB
[Step 3151] GPU 0 memory after moving inputs: 16.39 GB
[Step 3151] GPU 0 memory after teacher forward: 16.61 GB
[Step 3151] Teacher logits shape: torch.Size([2, 362, 151936]), dtype: torch.float16
[Step 3151] Teacher logits device before move: cuda:0
[Step 3151] Target device (student_logits.device): cuda:1
[Step 3151] GPU 0 memory after moving logits to GPU 1: 16.61 GB
[Step 3151] Teacher logits device after move: cuda:1, shape: torch.Size([2, 362, 151936])
[Step 3151] GPU 0 memory after del: 16.39 GB
[Step 3151] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 3151] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 35.67 GB
[Step 3151] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 3151] Sequence length: 362, Batch size: 2
[Step 3151] After KL computation - GPU 1: 36.55 GB
[Step 3151] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  2%|                                                                                   | 197/10000 [1:09:38<56:44:44, 20.84s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 3161] ========== MEMORY DEBUG ==========
[Step 3161] Model device: cuda:1
[Step 3161] Input device: cuda:1
[Step 3161] Teacher model device: cuda:0
[Step 3161] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 3161] GPU 1 memory: 33.77 GB (reserved: 48.05 GB)
[Step 3161] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 3161] Student model device: cuda:1
[Step 3161] GPU 0 memory before teacher forward: 16.39 GB
[Step 3161] GPU 0 memory after moving inputs: 16.39 GB
[Step 3161] GPU 0 memory after teacher forward: 17.01 GB
[Step 3161] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 3161] Teacher logits device before move: cuda:0
[Step 3161] Target device (student_logits.device): cuda:1
[Step 3161] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 3161] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 3161] GPU 0 memory after del: 16.39 GB
[Step 3161] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 3161] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.03 GB
[Step 3161] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 3161] Sequence length: 1024, Batch size: 2
[Step 3161] After KL computation - GPU 1: 40.51 GB
[Step 3161] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  2%|                                                                                   | 198/10000 [1:10:00<57:36:39, 21.16s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None

[Step 3171] ========== MEMORY DEBUG ==========
[Step 3171] Model device: cuda:1
[Step 3171] Input device: cuda:1
[Step 3171] Teacher model device: cuda:0
[Step 3171] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 3171] GPU 1 memory: 33.76 GB (reserved: 47.65 GB)
[Step 3171] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 3171] Student model device: cuda:1
[Step 3171] GPU 0 memory before teacher forward: 16.39 GB
[Step 3171] GPU 0 memory after moving inputs: 16.39 GB
[Step 3171] GPU 0 memory after teacher forward: 17.01 GB
[Step 3171] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 3171] Teacher logits device before move: cuda:0
[Step 3171] Target device (student_logits.device): cuda:1
[Step 3171] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 3171] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 3171] GPU 0 memory after del: 16.39 GB
[Step 3171] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 3171] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 3171] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 3171] Sequence length: 1024, Batch size: 2
[Step 3171] After KL computation - GPU 1: 40.50 GB
[Step 3171] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 3181] ========== MEMORY DEBUG ==========
[Step 3181] Model device: cuda:1
[Step 3181] Input device: cuda:1
[Step 3181] Teacher model device: cuda:0
[Step 3181] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 3181] GPU 1 memory: 33.76 GB (reserved: 43.85 GB)
  warnings.warn(
[Step 3181] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 3181] Student model device: cuda:1
[Step 3181] GPU 0 memory before teacher forward: 16.39 GB
[Step 3181] GPU 0 memory after moving inputs: 16.39 GB
[Step 3181] GPU 0 memory after teacher forward: 17.01 GB
[Step 3181] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 3181] Teacher logits device before move: cuda:0
[Step 3181] Target device (student_logits.device): cuda:1
[Step 3181] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 3181] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 3181] GPU 0 memory after del: 16.39 GB
[Step 3181] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 3181] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 3181] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 3181] Sequence length: 1024, Batch size: 2
[Step 3181] After KL computation - GPU 1: 40.50 GB
[Step 3181] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  2%|                                                                                   | 199/10000 [1:10:22<58:30:15, 21.49s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None

[Step 3191] ========== MEMORY DEBUG ==========
[Step 3191] Model device: cuda:1
[Step 3191] Input device: cuda:1
[Step 3191] Teacher model device: cuda:0
[Step 3191] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 3191] GPU 1 memory: 33.76 GB (reserved: 43.15 GB)
[Step 3191] Student logits device: cuda:1, shape: torch.Size([2, 838, 151936]), dtype: torch.float32
[Step 3191] Student model device: cuda:1
[Step 3191] GPU 0 memory before teacher forward: 16.39 GB
[Step 3191] GPU 0 memory after moving inputs: 16.39 GB
[Step 3191] GPU 0 memory after teacher forward: 16.90 GB
[Step 3191] Teacher logits shape: torch.Size([2, 838, 151936]), dtype: torch.float16
[Step 3191] Teacher logits device before move: cuda:0
[Step 3191] Target device (student_logits.device): cuda:1
[Step 3191] GPU 0 memory after moving logits to GPU 1: 16.90 GB
[Step 3191] Teacher logits device after move: cuda:1, shape: torch.Size([2, 838, 151936])
[Step 3191] GPU 0 memory after del: 16.39 GB
[Step 3191] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 3191] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 37.36 GB
[Step 3191] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 3191] Sequence length: 838, Batch size: 2
[Step 3191] After KL computation - GPU 1: 39.39 GB
[Step 3191] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  2%|                                                                                   | 200/10000 [1:10:43<58:03:39, 21.33s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
{'loss': 253248.0, 'grad_norm': nan, 'learning_rate': 4.9500000000000004e-05, 'epoch': 0.02}

[Step 3201] ========== MEMORY DEBUG ==========
[Step 3201] Model device: cuda:1
[Step 3201] Input device: cuda:1
[Step 3201] Teacher model device: cuda:0
[Step 3201] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 3201] GPU 1 memory: 25.33 GB (reserved: 46.73 GB)
  warnings.warn(
[Step 3201] Student logits device: cuda:1, shape: torch.Size([2, 480, 151936]), dtype: torch.float32
[Step 3201] Student model device: cuda:1
[Step 3201] GPU 0 memory before teacher forward: 16.39 GB
[Step 3201] GPU 0 memory after moving inputs: 16.39 GB
[Step 3201] GPU 0 memory after teacher forward: 16.68 GB
[Step 3201] Teacher logits shape: torch.Size([2, 480, 151936]), dtype: torch.float16
[Step 3201] Teacher logits device before move: cuda:0
[Step 3201] Target device (student_logits.device): cuda:1
[Step 3201] GPU 0 memory after moving logits to GPU 1: 16.68 GB
[Step 3201] Teacher logits device after move: cuda:1, shape: torch.Size([2, 480, 151936])
[Step 3201] GPU 0 memory after del: 16.39 GB
[Step 3201] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 3201] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 27.65 GB
[Step 3201] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 3201] Sequence length: 480, Batch size: 2
[Step 3201] After KL computation - GPU 1: 28.82 GB
[Step 3201] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 3211] ========== MEMORY DEBUG ==========
[Step 3211] Model device: cuda:1
[Step 3211] Input device: cuda:1
[Step 3211] Teacher model device: cuda:0
[Step 3211] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 3211] GPU 1 memory: 33.76 GB (reserved: 47.84 GB)
[Step 3211] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 3211] Student model device: cuda:1
[Step 3211] GPU 0 memory before teacher forward: 16.39 GB
[Step 3211] GPU 0 memory after moving inputs: 16.39 GB
[Step 3211] GPU 0 memory after teacher forward: 17.01 GB
[Step 3211] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 3211] Teacher logits device before move: cuda:0
[Step 3211] Target device (student_logits.device): cuda:1
[Step 3211] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 3211] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 3211] GPU 0 memory after del: 16.39 GB
[Step 3211] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 3211] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.02 GB
[Step 3211] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 3211] Sequence length: 1024, Batch size: 2
[Step 3211] After KL computation - GPU 1: 40.50 GB
[Step 3211] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  2%|                                                                                   | 201/10000 [1:11:44<90:10:45, 33.13s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None

[Step 3221] ========== MEMORY DEBUG ==========
[Step 3221] Model device: cuda:1
[Step 3221] Input device: cuda:1
[Step 3221] Teacher model device: cuda:0
[Step 3221] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 3221] GPU 1 memory: 33.77 GB (reserved: 43.57 GB)
[Step 3221] Student logits device: cuda:1, shape: torch.Size([2, 471, 151936]), dtype: torch.float32
[Step 3221] Student model device: cuda:1
[Step 3221] GPU 0 memory before teacher forward: 16.39 GB
[Step 3221] GPU 0 memory after moving inputs: 16.39 GB
[Step 3221] GPU 0 memory after teacher forward: 16.68 GB
[Step 3221] Teacher logits shape: torch.Size([2, 471, 151936]), dtype: torch.float16
[Step 3221] Teacher logits device before move: cuda:0
[Step 3221] Target device (student_logits.device): cuda:1
[Step 3221] GPU 0 memory after moving logits to GPU 1: 16.68 GB
[Step 3221] Teacher logits device after move: cuda:1, shape: torch.Size([2, 471, 151936])
[Step 3221] GPU 0 memory after del: 16.39 GB
[Step 3221] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 3221] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 36.06 GB
[Step 3221] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 3221] Sequence length: 471, Batch size: 2
[Step 3221] After KL computation - GPU 1: 37.20 GB
[Step 3221] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(

[Step 3231] ========== MEMORY DEBUG ==========
[Step 3231] Model device: cuda:1
[Step 3231] Input device: cuda:1
[Step 3231] Teacher model device: cuda:0
[Step 3231] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 3231] GPU 1 memory: 33.77 GB (reserved: 47.68 GB)
[Step 3231] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 3231] Student model device: cuda:1
[Step 3231] GPU 0 memory before teacher forward: 16.39 GB
[Step 3231] GPU 0 memory after moving inputs: 16.39 GB
[Step 3231] GPU 0 memory after teacher forward: 17.01 GB
[Step 3231] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 3231] Teacher logits device before move: cuda:0
[Step 3231] Target device (student_logits.device): cuda:1
[Step 3231] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 3231] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 3231] GPU 0 memory after del: 16.39 GB
[Step 3231] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 3231] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.02 GB
[Step 3231] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 3231] Sequence length: 1024, Batch size: 2
[Step 3231] After KL computation - GPU 1: 40.51 GB
[Step 3231] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  2%|                                                                                   | 203/10000 [1:12:25<73:06:21, 26.86s/it]

[Step 3241] ========== MEMORY DEBUG ==========
[Step 3241] Model device: cuda:1
[Step 3241] Input device: cuda:1
[Step 3241] Teacher model device: cuda:0
[Step 3241] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 3241] GPU 1 memory: 33.76 GB (reserved: 47.73 GB)
[Step 3241] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 3241] Student model device: cuda:1
[Step 3241] GPU 0 memory before teacher forward: 16.39 GB
[Step 3241] GPU 0 memory after moving inputs: 16.39 GB
[Step 3241] GPU 0 memory after teacher forward: 17.01 GB
[Step 3241] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 3241] Teacher logits device before move: cuda:0
[Step 3241] Target device (student_logits.device): cuda:1
[Step 3241] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 3241] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 3241] GPU 0 memory after del: 16.39 GB
[Step 3241] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 3241] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 3241] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 3241] Sequence length: 1024, Batch size: 2
[Step 3241] After KL computation - GPU 1: 40.50 GB
[Step 3241] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 3251] ========== MEMORY DEBUG ==========
[Step 3251] Model device: cuda:1
[Step 3251] Input device: cuda:1
[Step 3251] Teacher model device: cuda:0
[Step 3251] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 3251] GPU 1 memory: 33.76 GB (reserved: 44.78 GB)
[Step 3251] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 3251] Student model device: cuda:1
[Step 3251] GPU 0 memory before teacher forward: 16.39 GB
[Step 3251] GPU 0 memory after moving inputs: 16.39 GB
[Step 3251] GPU 0 memory after teacher forward: 17.01 GB
[Step 3251] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 3251] Teacher logits device before move: cuda:0
[Step 3251] Target device (student_logits.device): cuda:1
[Step 3251] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 3251] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 3251] GPU 0 memory after del: 16.39 GB
[Step 3251] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 3251] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 3251] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 3251] Sequence length: 1024, Batch size: 2
[Step 3251] After KL computation - GPU 1: 40.50 GB
[Step 3251] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 3261] ========== MEMORY DEBUG ==========
[Step 3261] Model device: cuda:1
[Step 3261] Input device: cuda:1
[Step 3261] Teacher model device: cuda:0
[Step 3261] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 3261] GPU 1 memory: 33.76 GB (reserved: 47.59 GB)
[Step 3261] Student logits device: cuda:1, shape: torch.Size([2, 802, 151936]), dtype: torch.float32
[Step 3261] Student model device: cuda:1
[Step 3261] GPU 0 memory before teacher forward: 16.39 GB
[Step 3261] GPU 0 memory after moving inputs: 16.39 GB
[Step 3261] GPU 0 memory after teacher forward: 16.88 GB
[Step 3261] Teacher logits shape: torch.Size([2, 802, 151936]), dtype: torch.float16
[Step 3261] Teacher logits device before move: cuda:0
[Step 3261] Target device (student_logits.device): cuda:1
[Step 3261] GPU 0 memory after moving logits to GPU 1: 16.88 GB
[Step 3261] Teacher logits device after move: cuda:1, shape: torch.Size([2, 802, 151936])
[Step 3261] GPU 0 memory after del: 16.39 GB
[Step 3261] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 3261] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 37.23 GB
[Step 3261] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 3261] Sequence length: 802, Batch size: 2
[Step 3261] After KL computation - GPU 1: 39.18 GB
[Step 3261] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(

[Step 3271] ========== MEMORY DEBUG ==========
[Step 3271] Model device: cuda:1
[Step 3271] Input device: cuda:1
[Step 3271] Teacher model device: cuda:0
[Step 3271] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 3271] GPU 1 memory: 33.76 GB (reserved: 47.61 GB)
[Step 3271] Student logits device: cuda:1, shape: torch.Size([2, 189, 151936]), dtype: torch.float32
[Step 3271] Student model device: cuda:1
[Step 3271] GPU 0 memory before teacher forward: 16.39 GB
[Step 3271] GPU 0 memory after moving inputs: 16.39 GB
[Step 3271] GPU 0 memory after teacher forward: 16.51 GB
[Step 3271] Teacher logits shape: torch.Size([2, 189, 151936]), dtype: torch.float16
[Step 3271] Teacher logits device before move: cuda:0
[Step 3271] Target device (student_logits.device): cuda:1
[Step 3271] GPU 0 memory after moving logits to GPU 1: 16.51 GB
[Step 3271] Teacher logits device after move: cuda:1, shape: torch.Size([2, 189, 151936])
[Step 3271] GPU 0 memory after del: 16.39 GB
[Step 3271] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 3271] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 35.06 GB
[Step 3271] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 3271] Sequence length: 189, Batch size: 2
[Step 3271] After KL computation - GPU 1: 35.52 GB
[Step 3271] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  2%|                                                                                   | 205/10000 [1:13:07<64:23:13, 23.66s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None

[Step 3281] ========== MEMORY DEBUG ==========
[Step 3281] Model device: cuda:1
[Step 3281] Input device: cuda:1
[Step 3281] Teacher model device: cuda:0
[Step 3281] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 3281] GPU 1 memory: 25.33 GB (reserved: 43.87 GB)
[Step 3281] Student logits device: cuda:1, shape: torch.Size([2, 417, 151936]), dtype: torch.float32
[Step 3281] Student model device: cuda:1
[Step 3281] GPU 0 memory before teacher forward: 16.39 GB
[Step 3281] GPU 0 memory after moving inputs: 16.39 GB
[Step 3281] GPU 0 memory after teacher forward: 16.65 GB
[Step 3281] Teacher logits shape: torch.Size([2, 417, 151936]), dtype: torch.float16
[Step 3281] Teacher logits device before move: cuda:0
[Step 3281] Target device (student_logits.device): cuda:1
[Step 3281] GPU 0 memory after moving logits to GPU 1: 16.65 GB
[Step 3281] Teacher logits device after move: cuda:1, shape: torch.Size([2, 417, 151936])
[Step 3281] GPU 0 memory after del: 16.39 GB
[Step 3281] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 3281] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 27.43 GB
[Step 3281] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 3281] Sequence length: 417, Batch size: 2
[Step 3281] After KL computation - GPU 1: 28.44 GB
[Step 3281] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(

[Step 3291] ========== MEMORY DEBUG ==========
[Step 3291] Model device: cuda:1
[Step 3291] Input device: cuda:1
[Step 3291] Teacher model device: cuda:0
[Step 3291] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 3291] GPU 1 memory: 33.76 GB (reserved: 47.67 GB)
[Step 3291] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 3291] Student model device: cuda:1
[Step 3291] GPU 0 memory before teacher forward: 16.39 GB
[Step 3291] GPU 0 memory after moving inputs: 16.39 GB
[Step 3291] GPU 0 memory after teacher forward: 17.01 GB
[Step 3291] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 3291] Teacher logits device before move: cuda:0
[Step 3291] Target device (student_logits.device): cuda:1
[Step 3291] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 3291] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 3291] GPU 0 memory after del: 16.39 GB
[Step 3291] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 3291] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 3291] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 3291] Sequence length: 1024, Batch size: 2
[Step 3291] After KL computation - GPU 1: 40.50 GB
[Step 3291] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  2%|                                                                                   | 206/10000 [1:13:27<61:44:50, 22.70s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 3301] ========== MEMORY DEBUG ==========
[Step 3301] Model device: cuda:1
[Step 3301] Input device: cuda:1
[Step 3301] Teacher model device: cuda:0
[Step 3301] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 3301] GPU 1 memory: 33.77 GB (reserved: 41.17 GB)
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
[Step 3301] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 3301] Student model device: cuda:1
[Step 3301] GPU 0 memory before teacher forward: 16.39 GB
[Step 3301] GPU 0 memory after moving inputs: 16.39 GB
[Step 3301] GPU 0 memory after teacher forward: 17.01 GB
[Step 3301] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 3301] Teacher logits device before move: cuda:0
[Step 3301] Target device (student_logits.device): cuda:1
[Step 3301] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 3301] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 3301] GPU 0 memory after del: 16.39 GB
[Step 3301] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 3301] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.02 GB
[Step 3301] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 3301] Sequence length: 1024, Batch size: 2
[Step 3301] After KL computation - GPU 1: 40.51 GB
[Step 3301] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 3311] ========== MEMORY DEBUG ==========
[Step 3311] Model device: cuda:1
[Step 3311] Input device: cuda:1
[Step 3311] Teacher model device: cuda:0
[Step 3311] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 3311] GPU 1 memory: 33.77 GB (reserved: 47.65 GB)
[Step 3311] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 3311] Student model device: cuda:1
[Step 3311] GPU 0 memory before teacher forward: 16.39 GB
[Step 3311] GPU 0 memory after moving inputs: 16.39 GB
[Step 3311] GPU 0 memory after teacher forward: 17.01 GB
[Step 3311] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 3311] Teacher logits device before move: cuda:0
[Step 3311] Target device (student_logits.device): cuda:1
[Step 3311] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 3311] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 3311] GPU 0 memory after del: 16.39 GB
[Step 3311] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 3311] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.02 GB
[Step 3311] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 3311] Sequence length: 1024, Batch size: 2
[Step 3311] After KL computation - GPU 1: 40.51 GB
[Step 3311] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  2%|                                                                                   | 208/10000 [1:14:07<58:23:06, 21.47s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None

[Step 3321] ========== MEMORY DEBUG ==========
[Step 3321] Model device: cuda:1
[Step 3321] Input device: cuda:1
[Step 3321] Teacher model device: cuda:0
[Step 3321] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 3321] GPU 1 memory: 33.76 GB (reserved: 47.42 GB)
[Step 3321] Student logits device: cuda:1, shape: torch.Size([2, 793, 151936]), dtype: torch.float32
[Step 3321] Student model device: cuda:1
[Step 3321] GPU 0 memory before teacher forward: 16.39 GB
[Step 3321] GPU 0 memory after moving inputs: 16.39 GB
[Step 3321] GPU 0 memory after teacher forward: 16.87 GB
[Step 3321] Teacher logits shape: torch.Size([2, 793, 151936]), dtype: torch.float16
[Step 3321] Teacher logits device before move: cuda:0
[Step 3321] Target device (student_logits.device): cuda:1
[Step 3321] GPU 0 memory after moving logits to GPU 1: 16.87 GB
[Step 3321] Teacher logits device after move: cuda:1, shape: torch.Size([2, 793, 151936])
[Step 3321] GPU 0 memory after del: 16.39 GB
[Step 3321] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 3321] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 37.20 GB
[Step 3321] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 3321] Sequence length: 793, Batch size: 2
[Step 3321] After KL computation - GPU 1: 39.12 GB
[Step 3321] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(

[Step 3331] ========== MEMORY DEBUG ==========
[Step 3331] Model device: cuda:1
[Step 3331] Input device: cuda:1
[Step 3331] Teacher model device: cuda:0
[Step 3331] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 3331] GPU 1 memory: 33.77 GB (reserved: 48.41 GB)
[Step 3331] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 3331] Student model device: cuda:1
[Step 3331] GPU 0 memory before teacher forward: 16.39 GB
[Step 3331] GPU 0 memory after moving inputs: 16.39 GB
[Step 3331] GPU 0 memory after teacher forward: 17.01 GB
[Step 3331] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 3331] Teacher logits device before move: cuda:0
[Step 3331] Target device (student_logits.device): cuda:1
[Step 3331] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 3331] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 3331] GPU 0 memory after del: 16.39 GB
[Step 3331] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 3331] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.02 GB
[Step 3331] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 3331] Sequence length: 1024, Batch size: 2
[Step 3331] After KL computation - GPU 1: 40.51 GB
[Step 3331] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 3341] ========== MEMORY DEBUG ==========
[Step 3341] Model device: cuda:1
[Step 3341] Input device: cuda:1
[Step 3341] Teacher model device: cuda:0
[Step 3341] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 3341] GPU 1 memory: 33.77 GB (reserved: 47.98 GB)
[Step 3341] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 3341] Student model device: cuda:1
[Step 3341] GPU 0 memory before teacher forward: 16.39 GB
[Step 3341] GPU 0 memory after moving inputs: 16.39 GB
[Step 3341] GPU 0 memory after teacher forward: 17.01 GB
[Step 3341] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 3341] Teacher logits device before move: cuda:0
[Step 3341] Target device (student_logits.device): cuda:1
[Step 3341] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 3341] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 3341] GPU 0 memory after del: 16.39 GB
[Step 3341] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 3341] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.02 GB
[Step 3341] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 3341] Sequence length: 1024, Batch size: 2
[Step 3341] After KL computation - GPU 1: 40.51 GB
[Step 3341] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  2%|                                                                                   | 209/10000 [1:14:28<57:27:09, 21.12s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 3351] ========== MEMORY DEBUG ==========
[Step 3351] Model device: cuda:1
[Step 3351] Input device: cuda:1
[Step 3351] Teacher model device: cuda:0
[Step 3351] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 3351] GPU 1 memory: 33.76 GB (reserved: 47.58 GB)
[Step 3351] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 3351] Student model device: cuda:1
[Step 3351] GPU 0 memory before teacher forward: 16.39 GB
[Step 3351] GPU 0 memory after moving inputs: 16.39 GB
[Step 3351] GPU 0 memory after teacher forward: 17.01 GB
[Step 3351] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 3351] Teacher logits device before move: cuda:0
[Step 3351] Target device (student_logits.device): cuda:1
[Step 3351] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 3351] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 3351] GPU 0 memory after del: 16.39 GB
[Step 3351] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 3351] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 3351] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 3351] Sequence length: 1024, Batch size: 2
[Step 3351] After KL computation - GPU 1: 40.50 GB
[Step 3351] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  2%|                                                                                   | 210/10000 [1:14:49<57:22:50, 21.10s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 4.944949494949495e-05, 'epoch': 0.02}

[Step 3361] ========== MEMORY DEBUG ==========
[Step 3361] Model device: cuda:1
[Step 3361] Input device: cuda:1
[Step 3361] Teacher model device: cuda:0
[Step 3361] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 3361] GPU 1 memory: 25.33 GB (reserved: 47.73 GB)
[Step 3361] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 3361] Student model device: cuda:1
[Step 3361] GPU 0 memory before teacher forward: 16.39 GB
[Step 3361] GPU 0 memory after moving inputs: 16.39 GB
[Step 3361] GPU 0 memory after teacher forward: 17.01 GB
[Step 3361] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 3361] Teacher logits device before move: cuda:0
[Step 3361] Target device (student_logits.device): cuda:1
[Step 3361] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 3361] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 3361] GPU 0 memory after del: 16.39 GB
[Step 3361] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 3361] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 29.58 GB
[Step 3361] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 3361] Sequence length: 1024, Batch size: 2
[Step 3361] After KL computation - GPU 1: 32.06 GB
[Step 3361] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(

[Step 3371] ========== MEMORY DEBUG ==========
[Step 3371] Model device: cuda:1
[Step 3371] Input device: cuda:1
[Step 3371] Teacher model device: cuda:0
[Step 3371] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 3371] GPU 1 memory: 33.76 GB (reserved: 43.90 GB)
[Step 3371] Student logits device: cuda:1, shape: torch.Size([2, 812, 151936]), dtype: torch.float32
[Step 3371] Student model device: cuda:1
[Step 3371] GPU 0 memory before teacher forward: 16.39 GB
[Step 3371] GPU 0 memory after moving inputs: 16.39 GB
[Step 3371] GPU 0 memory after teacher forward: 16.89 GB
[Step 3371] Teacher logits shape: torch.Size([2, 812, 151936]), dtype: torch.float16
[Step 3371] Teacher logits device before move: cuda:0
[Step 3371] Target device (student_logits.device): cuda:1
[Step 3371] GPU 0 memory after moving logits to GPU 1: 16.89 GB
[Step 3371] Teacher logits device after move: cuda:1, shape: torch.Size([2, 812, 151936])
[Step 3371] GPU 0 memory after del: 16.39 GB
[Step 3371] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 3371] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 37.26 GB
[Step 3371] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 3371] Sequence length: 812, Batch size: 2
[Step 3371] After KL computation - GPU 1: 39.24 GB
[Step 3371] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  2%|                                                                                   | 211/10000 [1:15:08<56:04:30, 20.62s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 3381] ========== MEMORY DEBUG ==========
[Step 3381] Model device: cuda:1
[Step 3381] Input device: cuda:1
[Step 3381] Teacher model device: cuda:0
[Step 3381] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 3381] GPU 1 memory: 33.76 GB (reserved: 47.84 GB)
[Step 3381] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 3381] Student model device: cuda:1
[Step 3381] GPU 0 memory before teacher forward: 16.39 GB
[Step 3381] GPU 0 memory after moving inputs: 16.39 GB
[Step 3381] GPU 0 memory after teacher forward: 17.01 GB
[Step 3381] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 3381] Teacher logits device before move: cuda:0
[Step 3381] Target device (student_logits.device): cuda:1
[Step 3381] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 3381] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 3381] GPU 0 memory after del: 16.39 GB
[Step 3381] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 3381] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.02 GB
[Step 3381] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 3381] Sequence length: 1024, Batch size: 2
[Step 3381] After KL computation - GPU 1: 40.51 GB
[Step 3381] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 3391] ========== MEMORY DEBUG ==========
[Step 3391] Model device: cuda:1
[Step 3391] Input device: cuda:1
[Step 3391] Teacher model device: cuda:0
[Step 3391] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 3391] GPU 1 memory: 33.76 GB (reserved: 47.70 GB)
[Step 3391] Student logits device: cuda:1, shape: torch.Size([2, 654, 151936]), dtype: torch.float32
[Step 3391] Student model device: cuda:1
[Step 3391] GPU 0 memory before teacher forward: 16.39 GB
[Step 3391] GPU 0 memory after moving inputs: 16.39 GB
[Step 3391] GPU 0 memory after teacher forward: 16.79 GB
[Step 3391] Teacher logits shape: torch.Size([2, 654, 151936]), dtype: torch.float16
[Step 3391] Teacher logits device before move: cuda:0
[Step 3391] Target device (student_logits.device): cuda:1
[Step 3391] GPU 0 memory after moving logits to GPU 1: 16.79 GB
[Step 3391] Teacher logits device after move: cuda:1, shape: torch.Size([2, 654, 151936])
[Step 3391] GPU 0 memory after del: 16.39 GB
[Step 3391] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 3391] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 36.70 GB
[Step 3391] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 3391] Sequence length: 654, Batch size: 2
[Step 3391] After KL computation - GPU 1: 38.29 GB
[Step 3391] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  2%|                                                                                   | 212/10000 [1:15:30<56:42:49, 20.86s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None

[Step 3401] ========== MEMORY DEBUG ==========
[Step 3401] Model device: cuda:1
[Step 3401] Input device: cuda:1
[Step 3401] Teacher model device: cuda:0
[Step 3401] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 3401] GPU 1 memory: 33.76 GB (reserved: 47.57 GB)
[Step 3401] Student logits device: cuda:1, shape: torch.Size([2, 313, 151936]), dtype: torch.float32
[Step 3401] Student model device: cuda:1
[Step 3401] GPU 0 memory before teacher forward: 16.39 GB
[Step 3401] GPU 0 memory after moving inputs: 16.39 GB
[Step 3401] GPU 0 memory after teacher forward: 16.58 GB
[Step 3401] Teacher logits shape: torch.Size([2, 313, 151936]), dtype: torch.float16
[Step 3401] Teacher logits device before move: cuda:0
[Step 3401] Target device (student_logits.device): cuda:1
[Step 3401] GPU 0 memory after moving logits to GPU 1: 16.58 GB
[Step 3401] Teacher logits device after move: cuda:1, shape: torch.Size([2, 313, 151936])
[Step 3401] GPU 0 memory after del: 16.39 GB
[Step 3401] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 3401] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 35.49 GB
[Step 3401] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 3401] Sequence length: 313, Batch size: 2
[Step 3401] After KL computation - GPU 1: 36.26 GB
[Step 3401] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(
  2%|                                                                                   | 213/10000 [1:15:50<56:08:38, 20.65s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None

[Step 3411] ========== MEMORY DEBUG ==========
[Step 3411] Model device: cuda:1
[Step 3411] Input device: cuda:1
[Step 3411] Teacher model device: cuda:0
[Step 3411] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 3411] GPU 1 memory: 33.76 GB (reserved: 46.49 GB)
[Step 3411] Student logits device: cuda:1, shape: torch.Size([2, 998, 151936]), dtype: torch.float32
[Step 3411] Student model device: cuda:1
[Step 3411] GPU 0 memory before teacher forward: 16.39 GB
[Step 3411] GPU 0 memory after moving inputs: 16.39 GB
[Step 3411] GPU 0 memory after teacher forward: 17.00 GB
[Step 3411] Teacher logits shape: torch.Size([2, 998, 151936]), dtype: torch.float16
[Step 3411] Teacher logits device before move: cuda:0
[Step 3411] Target device (student_logits.device): cuda:1
[Step 3411] GPU 0 memory after moving logits to GPU 1: 17.00 GB
[Step 3411] Teacher logits device after move: cuda:1, shape: torch.Size([2, 998, 151936])
[Step 3411] GPU 0 memory after del: 16.39 GB
[Step 3411] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 3411] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 37.92 GB
[Step 3411] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 3411] Sequence length: 998, Batch size: 2
[Step 3411] After KL computation - GPU 1: 40.35 GB
[Step 3411] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 3421] ========== MEMORY DEBUG ==========
[Step 3421] Model device: cuda:1
[Step 3421] Input device: cuda:1
[Step 3421] Teacher model device: cuda:0
[Step 3421] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 3421] GPU 1 memory: 33.76 GB (reserved: 42.00 GB)
[Step 3421] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 3421] Student model device: cuda:1
[Step 3421] GPU 0 memory before teacher forward: 16.39 GB
[Step 3421] GPU 0 memory after moving inputs: 16.39 GB
[Step 3421] GPU 0 memory after teacher forward: 17.01 GB
[Step 3421] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 3421] Teacher logits device before move: cuda:0
[Step 3421] Target device (student_logits.device): cuda:1
[Step 3421] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 3421] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 3421] GPU 0 memory after del: 16.39 GB
[Step 3421] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 3421] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 3421] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 3421] Sequence length: 1024, Batch size: 2
[Step 3421] After KL computation - GPU 1: 40.50 GB
[Step 3421] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  2%|                                                                                   | 214/10000 [1:16:10<55:26:37, 20.40s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 3431] ========== MEMORY DEBUG ==========
[Step 3431] Model device: cuda:1
[Step 3431] Input device: cuda:1
[Step 3431] Teacher model device: cuda:0
[Step 3431] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 3431] GPU 1 memory: 33.77 GB (reserved: 47.87 GB)
[Step 3431] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 3431] Student model device: cuda:1
[Step 3431] GPU 0 memory before teacher forward: 16.39 GB
[Step 3431] GPU 0 memory after moving inputs: 16.39 GB
[Step 3431] GPU 0 memory after teacher forward: 17.01 GB
[Step 3431] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 3431] Teacher logits device before move: cuda:0
[Step 3431] Target device (student_logits.device): cuda:1
[Step 3431] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 3431] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 3431] GPU 0 memory after del: 16.39 GB
[Step 3431] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 3431] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.02 GB
[Step 3431] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 3431] Sequence length: 1024, Batch size: 2
[Step 3431] After KL computation - GPU 1: 40.51 GB
[Step 3431] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  2%|                                                                                   | 215/10000 [1:16:33<57:40:31, 21.22s/it]

[Step 3441] ========== MEMORY DEBUG ==========
[Step 3441] Model device: cuda:1
[Step 3441] Input device: cuda:1
[Step 3441] Teacher model device: cuda:0
[Step 3441] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 3441] GPU 1 memory: 25.33 GB (reserved: 47.87 GB)
[Step 3441] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 3441] Student model device: cuda:1
[Step 3441] GPU 0 memory before teacher forward: 16.39 GB
[Step 3441] GPU 0 memory after moving inputs: 16.39 GB
[Step 3441] GPU 0 memory after teacher forward: 17.01 GB
[Step 3441] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 3441] Teacher logits device before move: cuda:0
[Step 3441] Target device (student_logits.device): cuda:1
[Step 3441] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 3441] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 3441] GPU 0 memory after del: 16.39 GB
[Step 3441] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 3441] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 29.58 GB
[Step 3441] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 3441] Sequence length: 1024, Batch size: 2
[Step 3441] After KL computation - GPU 1: 32.07 GB
[Step 3441] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 3451] ========== MEMORY DEBUG ==========
[Step 3451] Model device: cuda:1
[Step 3451] Input device: cuda:1
[Step 3451] Teacher model device: cuda:0
[Step 3451] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 3451] GPU 1 memory: 33.76 GB (reserved: 46.12 GB)
[Step 3451] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 3451] Student model device: cuda:1
[Step 3451] GPU 0 memory before teacher forward: 16.39 GB
[Step 3451] GPU 0 memory after moving inputs: 16.39 GB
[Step 3451] GPU 0 memory after teacher forward: 17.01 GB
[Step 3451] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 3451] Teacher logits device before move: cuda:0
[Step 3451] Target device (student_logits.device): cuda:1
[Step 3451] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 3451] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 3451] GPU 0 memory after del: 16.39 GB
[Step 3451] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 3451] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 3451] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 3451] Sequence length: 1024, Batch size: 2
[Step 3451] After KL computation - GPU 1: 40.50 GB
[Step 3451] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(
  2%|                                                                                   | 216/10000 [1:16:56<59:04:08, 21.73s/it]

[Step 3461] ========== MEMORY DEBUG ==========
[Step 3461] Model device: cuda:1
[Step 3461] Input device: cuda:1
[Step 3461] Teacher model device: cuda:0
[Step 3461] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 3461] GPU 1 memory: 33.77 GB (reserved: 44.34 GB)
[Step 3461] Student logits device: cuda:1, shape: torch.Size([2, 438, 151936]), dtype: torch.float32
[Step 3461] Student model device: cuda:1
[Step 3461] GPU 0 memory before teacher forward: 16.39 GB
[Step 3461] GPU 0 memory after moving inputs: 16.39 GB
[Step 3461] GPU 0 memory after teacher forward: 16.66 GB
[Step 3461] Teacher logits shape: torch.Size([2, 438, 151936]), dtype: torch.float16
[Step 3461] Teacher logits device before move: cuda:0
[Step 3461] Target device (student_logits.device): cuda:1
[Step 3461] GPU 0 memory after moving logits to GPU 1: 16.66 GB
[Step 3461] Teacher logits device after move: cuda:1, shape: torch.Size([2, 438, 151936])
[Step 3461] GPU 0 memory after del: 16.39 GB
[Step 3461] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 3461] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 35.94 GB
[Step 3461] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 3461] Sequence length: 438, Batch size: 2
[Step 3461] After KL computation - GPU 1: 37.01 GB
[Step 3461] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 3471] ========== MEMORY DEBUG ==========
[Step 3471] Model device: cuda:1
[Step 3471] Input device: cuda:1
[Step 3471] Teacher model device: cuda:0
[Step 3471] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 3471] GPU 1 memory: 33.77 GB (reserved: 45.19 GB)
[Step 3471] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 3471] Student model device: cuda:1
[Step 3471] GPU 0 memory before teacher forward: 16.39 GB
[Step 3471] GPU 0 memory after moving inputs: 16.39 GB
[Step 3471] GPU 0 memory after teacher forward: 17.01 GB
[Step 3471] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 3471] Teacher logits device before move: cuda:0
[Step 3471] Target device (student_logits.device): cuda:1
[Step 3471] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 3471] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 3471] GPU 0 memory after del: 16.39 GB
[Step 3471] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 3471] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.02 GB
[Step 3471] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 3471] Sequence length: 1024, Batch size: 2
[Step 3471] After KL computation - GPU 1: 40.51 GB
[Step 3471] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(

[Step 3481] ========== MEMORY DEBUG ==========
[Step 3481] Model device: cuda:1
[Step 3481] Input device: cuda:1
[Step 3481] Teacher model device: cuda:0
[Step 3481] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 3481] GPU 1 memory: 33.76 GB (reserved: 47.41 GB)
[Step 3481] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 3481] Student model device: cuda:1
[Step 3481] GPU 0 memory before teacher forward: 16.39 GB
[Step 3481] GPU 0 memory after moving inputs: 16.39 GB
[Step 3481] GPU 0 memory after teacher forward: 17.01 GB
[Step 3481] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 3481] Teacher logits device before move: cuda:0
[Step 3481] Target device (student_logits.device): cuda:1
[Step 3481] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 3481] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 3481] GPU 0 memory after del: 16.39 GB
[Step 3481] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 3481] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 3481] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 3481] Sequence length: 1024, Batch size: 2
[Step 3481] After KL computation - GPU 1: 40.50 GB
[Step 3481] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  2%|                                                                                   | 218/10000 [1:17:35<56:08:04, 20.66s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None

[Step 3491] ========== MEMORY DEBUG ==========
[Step 3491] Model device: cuda:1
[Step 3491] Input device: cuda:1
[Step 3491] Teacher model device: cuda:0
[Step 3491] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 3491] GPU 1 memory: 33.76 GB (reserved: 47.64 GB)
[Step 3491] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 3491] Student model device: cuda:1
[Step 3491] GPU 0 memory before teacher forward: 16.39 GB
[Step 3491] GPU 0 memory after moving inputs: 16.39 GB
[Step 3491] GPU 0 memory after teacher forward: 17.01 GB
[Step 3491] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 3491] Teacher logits device before move: cuda:0
[Step 3491] Target device (student_logits.device): cuda:1
[Step 3491] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 3491] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 3491] GPU 0 memory after del: 16.39 GB
[Step 3491] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 3491] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 3491] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 3491] Sequence length: 1024, Batch size: 2
[Step 3491] After KL computation - GPU 1: 40.50 GB
[Step 3491] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(

[Step 3501] ========== MEMORY DEBUG ==========
[Step 3501] Model device: cuda:1
[Step 3501] Input device: cuda:1
[Step 3501] Teacher model device: cuda:0
[Step 3501] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 3501] GPU 1 memory: 33.76 GB (reserved: 45.16 GB)
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
[Step 3501] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 3501] Student model device: cuda:1
[Step 3501] GPU 0 memory before teacher forward: 16.39 GB
[Step 3501] GPU 0 memory after moving inputs: 16.39 GB
[Step 3501] GPU 0 memory after teacher forward: 17.01 GB
[Step 3501] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 3501] Teacher logits device before move: cuda:0
[Step 3501] Target device (student_logits.device): cuda:1
[Step 3501] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 3501] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 3501] GPU 0 memory after del: 16.39 GB
[Step 3501] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 3501] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 3501] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 3501] Sequence length: 1024, Batch size: 2
[Step 3501] After KL computation - GPU 1: 40.50 GB
[Step 3501] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  2%|                                                                                   | 219/10000 [1:17:59<58:58:57, 21.71s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 3511] ========== MEMORY DEBUG ==========
[Step 3511] Model device: cuda:1
[Step 3511] Input device: cuda:1
[Step 3511] Teacher model device: cuda:0
[Step 3511] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 3511] GPU 1 memory: 33.76 GB (reserved: 43.40 GB)
[Step 3511] Student logits device: cuda:1, shape: torch.Size([2, 619, 151936]), dtype: torch.float32
[Step 3511] Student model device: cuda:1
[Step 3511] GPU 0 memory before teacher forward: 16.39 GB
[Step 3511] GPU 0 memory after moving inputs: 16.39 GB
[Step 3511] GPU 0 memory after teacher forward: 16.77 GB
[Step 3511] Teacher logits shape: torch.Size([2, 619, 151936]), dtype: torch.float16
[Step 3511] Teacher logits device before move: cuda:0
[Step 3511] Target device (student_logits.device): cuda:1
[Step 3511] GPU 0 memory after moving logits to GPU 1: 16.77 GB
[Step 3511] Teacher logits device after move: cuda:1, shape: torch.Size([2, 619, 151936])
[Step 3511] GPU 0 memory after del: 16.39 GB
[Step 3511] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 3511] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 36.58 GB
[Step 3511] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 3511] Sequence length: 619, Batch size: 2
[Step 3511] After KL computation - GPU 1: 38.09 GB
[Step 3511] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  2%|                                                                                   | 220/10000 [1:18:16<55:39:24, 20.49s/it]
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 4.93989898989899e-05, 'epoch': 0.02}

[Step 3521] ========== MEMORY DEBUG ==========
[Step 3521] Model device: cuda:1
[Step 3521] Input device: cuda:1
[Step 3521] Teacher model device: cuda:0
[Step 3521] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 3521] GPU 1 memory: 25.33 GB (reserved: 45.17 GB)
[Step 3521] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 3521] Student model device: cuda:1
[Step 3521] GPU 0 memory before teacher forward: 16.39 GB
[Step 3521] GPU 0 memory after moving inputs: 16.39 GB
[Step 3521] GPU 0 memory after teacher forward: 17.01 GB
[Step 3521] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 3521] Teacher logits device before move: cuda:0
[Step 3521] Target device (student_logits.device): cuda:1
[Step 3521] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 3521] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 3521] GPU 0 memory after del: 16.39 GB
[Step 3521] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 3521] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 29.58 GB
[Step 3521] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 3521] Sequence length: 1024, Batch size: 2
[Step 3521] After KL computation - GPU 1: 32.07 GB
[Step 3521] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 3531] ========== MEMORY DEBUG ==========
[Step 3531] Model device: cuda:1
[Step 3531] Input device: cuda:1
[Step 3531] Teacher model device: cuda:0
[Step 3531] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 3531] GPU 1 memory: 33.76 GB (reserved: 43.14 GB)
[Step 3531] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 3531] Student model device: cuda:1
[Step 3531] GPU 0 memory before teacher forward: 16.39 GB
[Step 3531] GPU 0 memory after moving inputs: 16.39 GB
[Step 3531] GPU 0 memory after teacher forward: 17.01 GB
[Step 3531] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 3531] Teacher logits device before move: cuda:0
[Step 3531] Target device (student_logits.device): cuda:1
[Step 3531] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 3531] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 3531] GPU 0 memory after del: 16.39 GB
[Step 3531] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 3531] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 3531] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 3531] Sequence length: 1024, Batch size: 2
[Step 3531] After KL computation - GPU 1: 40.50 GB
[Step 3531] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 3541] ========== MEMORY DEBUG ==========
[Step 3541] Model device: cuda:1
[Step 3541] Input device: cuda:1
[Step 3541] Teacher model device: cuda:0
[Step 3541] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 3541] GPU 1 memory: 33.76 GB (reserved: 47.75 GB)
[Step 3541] Student logits device: cuda:1, shape: torch.Size([2, 653, 151936]), dtype: torch.float32
[Step 3541] Student model device: cuda:1
[Step 3541] GPU 0 memory before teacher forward: 16.39 GB
[Step 3541] GPU 0 memory after moving inputs: 16.39 GB
[Step 3541] GPU 0 memory after teacher forward: 16.79 GB
[Step 3541] Teacher logits shape: torch.Size([2, 653, 151936]), dtype: torch.float16
[Step 3541] Teacher logits device before move: cuda:0
[Step 3541] Target device (student_logits.device): cuda:1
[Step 3541] GPU 0 memory after moving logits to GPU 1: 16.79 GB
[Step 3541] Teacher logits device after move: cuda:1, shape: torch.Size([2, 653, 151936])
[Step 3541] GPU 0 memory after del: 16.39 GB
[Step 3541] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 3541] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 36.70 GB
[Step 3541] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 3541] Sequence length: 653, Batch size: 2
[Step 3541] After KL computation - GPU 1: 38.29 GB
[Step 3541] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 3551] ========== MEMORY DEBUG ==========
[Step 3551] Model device: cuda:1
[Step 3551] Input device: cuda:1
[Step 3551] Teacher model device: cuda:0
[Step 3551] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 3551] GPU 1 memory: 33.76 GB (reserved: 47.70 GB)
[Step 3551] Student logits device: cuda:1, shape: torch.Size([2, 868, 151936]), dtype: torch.float32
[Step 3551] Student model device: cuda:1
[Step 3551] GPU 0 memory before teacher forward: 16.39 GB
[Step 3551] GPU 0 memory after moving inputs: 16.39 GB
[Step 3551] GPU 0 memory after teacher forward: 16.92 GB
[Step 3551] Teacher logits shape: torch.Size([2, 868, 151936]), dtype: torch.float16
[Step 3551] Teacher logits device before move: cuda:0
[Step 3551] Target device (student_logits.device): cuda:1
[Step 3551] GPU 0 memory after moving logits to GPU 1: 16.92 GB
[Step 3551] Teacher logits device after move: cuda:1, shape: torch.Size([2, 868, 151936])
[Step 3551] GPU 0 memory after del: 16.39 GB
[Step 3551] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 3551] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 37.46 GB
[Step 3551] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 3551] Sequence length: 868, Batch size: 2
[Step 3551] After KL computation - GPU 1: 39.57 GB
[Step 3551] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 3561] ========== MEMORY DEBUG ==========
[Step 3561] Model device: cuda:1
[Step 3561] Input device: cuda:1
[Step 3561] Teacher model device: cuda:0
[Step 3561] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 3561] GPU 1 memory: 33.76 GB (reserved: 47.28 GB)
[Step 3561] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 3561] Student model device: cuda:1
[Step 3561] GPU 0 memory before teacher forward: 16.39 GB
[Step 3561] GPU 0 memory after moving inputs: 16.39 GB
[Step 3561] GPU 0 memory after teacher forward: 17.01 GB
[Step 3561] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 3561] Teacher logits device before move: cuda:0
[Step 3561] Target device (student_logits.device): cuda:1
[Step 3561] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 3561] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 3561] GPU 0 memory after del: 16.39 GB
[Step 3561] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 3561] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 3561] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 3561] Sequence length: 1024, Batch size: 2
[Step 3561] After KL computation - GPU 1: 40.50 GB
[Step 3561] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  2%|                                                                                   | 223/10000 [1:19:19<56:26:24, 20.78s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 3571] ========== MEMORY DEBUG ==========
[Step 3571] Model device: cuda:1
[Step 3571] Input device: cuda:1
[Step 3571] Teacher model device: cuda:0
[Step 3571] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 3571] GPU 1 memory: 33.77 GB (reserved: 45.49 GB)
[Step 3571] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 3571] Student model device: cuda:1
[Step 3571] GPU 0 memory before teacher forward: 16.39 GB
[Step 3571] GPU 0 memory after moving inputs: 16.39 GB
[Step 3571] GPU 0 memory after teacher forward: 17.01 GB
[Step 3571] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 3571] Teacher logits device before move: cuda:0
[Step 3571] Target device (student_logits.device): cuda:1
[Step 3571] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 3571] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 3571] GPU 0 memory after del: 16.39 GB
[Step 3571] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 3571] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.02 GB
[Step 3571] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 3571] Sequence length: 1024, Batch size: 2
[Step 3571] After KL computation - GPU 1: 40.51 GB
[Step 3571] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 3581] ========== MEMORY DEBUG ==========
[Step 3581] Model device: cuda:1
[Step 3581] Input device: cuda:1
[Step 3581] Teacher model device: cuda:0
[Step 3581] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 3581] GPU 1 memory: 33.77 GB (reserved: 43.85 GB)
[Step 3581] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 3581] Student model device: cuda:1
[Step 3581] GPU 0 memory before teacher forward: 16.39 GB
[Step 3581] GPU 0 memory after moving inputs: 16.39 GB
[Step 3581] GPU 0 memory after teacher forward: 17.01 GB
[Step 3581] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 3581] Teacher logits device before move: cuda:0
[Step 3581] Target device (student_logits.device): cuda:1
[Step 3581] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 3581] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 3581] GPU 0 memory after del: 16.39 GB
[Step 3581] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 3581] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.02 GB
[Step 3581] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 3581] Sequence length: 1024, Batch size: 2
[Step 3581] After KL computation - GPU 1: 40.51 GB
[Step 3581] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  2%|                                                                                   | 225/10000 [1:20:00<56:09:17, 20.68s/it]

[Step 3591] ========== MEMORY DEBUG ==========
[Step 3591] Model device: cuda:1
[Step 3591] Input device: cuda:1
[Step 3591] Teacher model device: cuda:0
[Step 3591] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 3591] GPU 1 memory: 33.76 GB (reserved: 43.53 GB)
[Step 3591] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 3591] Student model device: cuda:1
[Step 3591] GPU 0 memory before teacher forward: 16.39 GB
[Step 3591] GPU 0 memory after moving inputs: 16.39 GB
[Step 3591] GPU 0 memory after teacher forward: 17.01 GB
[Step 3591] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 3591] Teacher logits device before move: cuda:0
[Step 3591] Target device (student_logits.device): cuda:1
[Step 3591] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 3591] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 3591] GPU 0 memory after del: 16.39 GB
[Step 3591] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 3591] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 3591] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 3591] Sequence length: 1024, Batch size: 2
[Step 3591] After KL computation - GPU 1: 40.50 GB
[Step 3591] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 3601] ========== MEMORY DEBUG ==========
[Step 3601] Model device: cuda:1
[Step 3601] Input device: cuda:1
[Step 3601] Teacher model device: cuda:0
[Step 3601] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 3601] GPU 1 memory: 25.33 GB (reserved: 47.54 GB)
[Step 3601] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 3601] Student model device: cuda:1
[Step 3601] GPU 0 memory before teacher forward: 16.39 GB
[Step 3601] GPU 0 memory after moving inputs: 16.39 GB
[Step 3601] GPU 0 memory after teacher forward: 17.01 GB
[Step 3601] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 3601] Teacher logits device before move: cuda:0
[Step 3601] Target device (student_logits.device): cuda:1
[Step 3601] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 3601] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 3601] GPU 0 memory after del: 16.39 GB
[Step 3601] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 3601] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 29.58 GB
[Step 3601] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 3601] Sequence length: 1024, Batch size: 2
[Step 3601] After KL computation - GPU 1: 32.07 GB
[Step 3601] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 3611] ========== MEMORY DEBUG ==========
[Step 3611] Model device: cuda:1
[Step 3611] Input device: cuda:1
[Step 3611] Teacher model device: cuda:0
[Step 3611] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 3611] GPU 1 memory: 33.76 GB (reserved: 47.43 GB)
[Step 3611] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 3611] Student model device: cuda:1
[Step 3611] GPU 0 memory before teacher forward: 16.39 GB
[Step 3611] GPU 0 memory after moving inputs: 16.39 GB
[Step 3611] GPU 0 memory after teacher forward: 17.01 GB
[Step 3611] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 3611] Teacher logits device before move: cuda:0
[Step 3611] Target device (student_logits.device): cuda:1
[Step 3611] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 3611] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 3611] GPU 0 memory after del: 16.39 GB
[Step 3611] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 3611] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 3611] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 3611] Sequence length: 1024, Batch size: 2
[Step 3611] After KL computation - GPU 1: 40.50 GB
[Step 3611] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 3621] ========== MEMORY DEBUG ==========
[Step 3621] Model device: cuda:1
[Step 3621] Input device: cuda:1
[Step 3621] Teacher model device: cuda:0
[Step 3621] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 3621] GPU 1 memory: 33.76 GB (reserved: 42.02 GB)
[Step 3621] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 3621] Student model device: cuda:1
[Step 3621] GPU 0 memory before teacher forward: 16.39 GB
[Step 3621] GPU 0 memory after moving inputs: 16.39 GB
[Step 3621] GPU 0 memory after teacher forward: 17.01 GB
[Step 3621] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 3621] Teacher logits device before move: cuda:0
[Step 3621] Target device (student_logits.device): cuda:1
[Step 3621] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 3621] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 3621] GPU 0 memory after del: 16.39 GB
[Step 3621] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 3621] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 3621] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 3621] Sequence length: 1024, Batch size: 2
[Step 3621] After KL computation - GPU 1: 40.50 GB
[Step 3621] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(

[Step 3631] ========== MEMORY DEBUG ==========
[Step 3631] Model device: cuda:1
[Step 3631] Input device: cuda:1
[Step 3631] Teacher model device: cuda:0
[Step 3631] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 3631] GPU 1 memory: 33.76 GB (reserved: 47.20 GB)
[Step 3631] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 3631] Student model device: cuda:1
[Step 3631] GPU 0 memory before teacher forward: 16.39 GB
[Step 3631] GPU 0 memory after moving inputs: 16.39 GB
[Step 3631] GPU 0 memory after teacher forward: 17.01 GB
[Step 3631] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 3631] Teacher logits device before move: cuda:0
[Step 3631] Target device (student_logits.device): cuda:1
[Step 3631] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 3631] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 3631] GPU 0 memory after del: 16.39 GB
[Step 3631] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 3631] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 3631] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 3631] Sequence length: 1024, Batch size: 2
[Step 3631] After KL computation - GPU 1: 40.50 GB
[Step 3631] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  2%|                                                                                   | 227/10000 [1:20:42<56:44:08, 20.90s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 3641] ========== MEMORY DEBUG ==========
[Step 3641] Model device: cuda:1
[Step 3641] Input device: cuda:1
[Step 3641] Teacher model device: cuda:0
[Step 3641] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 3641] GPU 1 memory: 33.76 GB (reserved: 47.61 GB)
[Step 3641] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 3641] Student model device: cuda:1
[Step 3641] GPU 0 memory before teacher forward: 16.39 GB
[Step 3641] GPU 0 memory after moving inputs: 16.39 GB
[Step 3641] GPU 0 memory after teacher forward: 17.01 GB
[Step 3641] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 3641] Teacher logits device before move: cuda:0
[Step 3641] Target device (student_logits.device): cuda:1
[Step 3641] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 3641] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 3641] GPU 0 memory after del: 16.39 GB
[Step 3641] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 3641] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 3641] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 3641] Sequence length: 1024, Batch size: 2
[Step 3641] After KL computation - GPU 1: 40.50 GB
[Step 3641] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  2%|                                                                                   | 228/10000 [1:21:05<58:29:11, 21.55s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None

[Step 3651] ========== MEMORY DEBUG ==========
[Step 3651] Model device: cuda:1
[Step 3651] Input device: cuda:1
[Step 3651] Teacher model device: cuda:0
[Step 3651] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 3651] GPU 1 memory: 33.76 GB (reserved: 43.35 GB)
[Step 3651] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 3651] Student model device: cuda:1
[Step 3651] GPU 0 memory before teacher forward: 16.39 GB
[Step 3651] GPU 0 memory after moving inputs: 16.39 GB
[Step 3651] GPU 0 memory after teacher forward: 17.01 GB
[Step 3651] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 3651] Teacher logits device before move: cuda:0
[Step 3651] Target device (student_logits.device): cuda:1
[Step 3651] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 3651] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 3651] GPU 0 memory after del: 16.39 GB
[Step 3651] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 3651] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 3651] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 3651] Sequence length: 1024, Batch size: 2
[Step 3651] After KL computation - GPU 1: 40.50 GB
[Step 3651] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(

[Step 3661] ========== MEMORY DEBUG ==========
[Step 3661] Model device: cuda:1
[Step 3661] Input device: cuda:1
[Step 3661] Teacher model device: cuda:0
[Step 3661] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 3661] GPU 1 memory: 33.76 GB (reserved: 43.21 GB)
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
[Step 3661] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 3661] Student model device: cuda:1
[Step 3661] GPU 0 memory before teacher forward: 16.39 GB
[Step 3661] GPU 0 memory after moving inputs: 16.39 GB
[Step 3661] GPU 0 memory after teacher forward: 17.01 GB
[Step 3661] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 3661] Teacher logits device before move: cuda:0
[Step 3661] Target device (student_logits.device): cuda:1
[Step 3661] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 3661] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 3661] GPU 0 memory after del: 16.39 GB
[Step 3661] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 3661] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 3661] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 3661] Sequence length: 1024, Batch size: 2
[Step 3661] After KL computation - GPU 1: 40.50 GB
[Step 3661] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  2%|                                                                                   | 230/10000 [1:21:49<58:40:46, 21.62s/it]

[Step 3671] ========== MEMORY DEBUG ==========
[Step 3671] Model device: cuda:1
[Step 3671] Input device: cuda:1
[Step 3671] Teacher model device: cuda:0
[Step 3671] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 3671] GPU 1 memory: 33.76 GB (reserved: 47.59 GB)
[Step 3671] Student logits device: cuda:1, shape: torch.Size([2, 714, 151936]), dtype: torch.float32
[Step 3671] Student model device: cuda:1
[Step 3671] GPU 0 memory before teacher forward: 16.39 GB
[Step 3671] GPU 0 memory after moving inputs: 16.39 GB
[Step 3671] GPU 0 memory after teacher forward: 16.83 GB
[Step 3671] Teacher logits shape: torch.Size([2, 714, 151936]), dtype: torch.float16
[Step 3671] Teacher logits device before move: cuda:0
[Step 3671] Target device (student_logits.device): cuda:1
[Step 3671] GPU 0 memory after moving logits to GPU 1: 16.83 GB
[Step 3671] Teacher logits device after move: cuda:1, shape: torch.Size([2, 714, 151936])
[Step 3671] GPU 0 memory after del: 16.39 GB
[Step 3671] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 3671] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 36.91 GB
[Step 3671] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 3671] Sequence length: 714, Batch size: 2
[Step 3671] After KL computation - GPU 1: 38.65 GB
[Step 3671] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 4.934848484848485e-05, 'epoch': 0.02}

[Step 3681] ========== MEMORY DEBUG ==========
[Step 3681] Model device: cuda:1
[Step 3681] Input device: cuda:1
[Step 3681] Teacher model device: cuda:0
[Step 3681] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 3681] GPU 1 memory: 25.33 GB (reserved: 47.46 GB)
[Step 3681] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 3681] Student model device: cuda:1
[Step 3681] GPU 0 memory before teacher forward: 16.39 GB
[Step 3681] GPU 0 memory after moving inputs: 16.39 GB
[Step 3681] GPU 0 memory after teacher forward: 17.01 GB
[Step 3681] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 3681] Teacher logits device before move: cuda:0
[Step 3681] Target device (student_logits.device): cuda:1
[Step 3681] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 3681] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 3681] GPU 0 memory after del: 16.39 GB
[Step 3681] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 3681] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 29.58 GB
[Step 3681] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 3681] Sequence length: 1024, Batch size: 2
[Step 3681] After KL computation - GPU 1: 32.07 GB
[Step 3681] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 3691] ========== MEMORY DEBUG ==========
[Step 3691] Model device: cuda:1
[Step 3691] Input device: cuda:1
[Step 3691] Teacher model device: cuda:0
[Step 3691] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 3691] GPU 1 memory: 33.76 GB (reserved: 47.50 GB)
[Step 3691] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 3691] Student model device: cuda:1
[Step 3691] GPU 0 memory before teacher forward: 16.39 GB
[Step 3691] GPU 0 memory after moving inputs: 16.39 GB
[Step 3691] GPU 0 memory after teacher forward: 17.01 GB
[Step 3691] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 3691] Teacher logits device before move: cuda:0
[Step 3691] Target device (student_logits.device): cuda:1
[Step 3691] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 3691] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 3691] GPU 0 memory after del: 16.39 GB
[Step 3691] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 3691] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 3691] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 3691] Sequence length: 1024, Batch size: 2
[Step 3691] After KL computation - GPU 1: 40.50 GB
[Step 3691] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 3701] ========== MEMORY DEBUG ==========
[Step 3701] Model device: cuda:1
[Step 3701] Input device: cuda:1
[Step 3701] Teacher model device: cuda:0
[Step 3701] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 3701] GPU 1 memory: 33.76 GB (reserved: 47.48 GB)
[Step 3701] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 3701] Student model device: cuda:1
[Step 3701] GPU 0 memory before teacher forward: 16.39 GB
[Step 3701] GPU 0 memory after moving inputs: 16.39 GB
[Step 3701] GPU 0 memory after teacher forward: 17.01 GB
[Step 3701] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 3701] Teacher logits device before move: cuda:0
[Step 3701] Target device (student_logits.device): cuda:1
[Step 3701] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 3701] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 3701] GPU 0 memory after del: 16.39 GB
[Step 3701] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 3701] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 3701] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 3701] Sequence length: 1024, Batch size: 2
[Step 3701] After KL computation - GPU 1: 40.50 GB
[Step 3701] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 3711] ========== MEMORY DEBUG ==========
[Step 3711] Model device: cuda:1
[Step 3711] Input device: cuda:1
[Step 3711] Teacher model device: cuda:0
[Step 3711] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 3711] GPU 1 memory: 33.76 GB (reserved: 44.46 GB)
[Step 3711] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 3711] Student model device: cuda:1
[Step 3711] GPU 0 memory before teacher forward: 16.39 GB
[Step 3711] GPU 0 memory after moving inputs: 16.39 GB
[Step 3711] GPU 0 memory after teacher forward: 17.01 GB
[Step 3711] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 3711] Teacher logits device before move: cuda:0
[Step 3711] Target device (student_logits.device): cuda:1
[Step 3711] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 3711] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 3711] GPU 0 memory after del: 16.39 GB
[Step 3711] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 3711] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 3711] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 3711] Sequence length: 1024, Batch size: 2
[Step 3711] After KL computation - GPU 1: 40.50 GB
[Step 3711] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  2%|                                                                                   | 233/10000 [1:22:52<57:10:24, 21.07s/it]

[Step 3721] ========== MEMORY DEBUG ==========
[Step 3721] Model device: cuda:1
[Step 3721] Input device: cuda:1
[Step 3721] Teacher model device: cuda:0
[Step 3721] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 3721] GPU 1 memory: 33.76 GB (reserved: 47.76 GB)
[Step 3721] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 3721] Student model device: cuda:1
[Step 3721] GPU 0 memory before teacher forward: 16.39 GB
[Step 3721] GPU 0 memory after moving inputs: 16.39 GB
[Step 3721] GPU 0 memory after teacher forward: 17.01 GB
[Step 3721] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 3721] Teacher logits device before move: cuda:0
[Step 3721] Target device (student_logits.device): cuda:1
[Step 3721] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 3721] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 3721] GPU 0 memory after del: 16.39 GB
[Step 3721] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 3721] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 3721] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 3721] Sequence length: 1024, Batch size: 2
[Step 3721] After KL computation - GPU 1: 40.50 GB
[Step 3721] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 3731] ========== MEMORY DEBUG ==========
[Step 3731] Model device: cuda:1
[Step 3731] Input device: cuda:1
[Step 3731] Teacher model device: cuda:0
[Step 3731] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 3731] GPU 1 memory: 33.76 GB (reserved: 44.57 GB)
[Step 3731] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 3731] Student model device: cuda:1
[Step 3731] GPU 0 memory before teacher forward: 16.39 GB
[Step 3731] GPU 0 memory after moving inputs: 16.39 GB
[Step 3731] GPU 0 memory after teacher forward: 17.01 GB
[Step 3731] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 3731] Teacher logits device before move: cuda:0
[Step 3731] Target device (student_logits.device): cuda:1
[Step 3731] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 3731] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 3731] GPU 0 memory after del: 16.39 GB
[Step 3731] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 3731] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 3731] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 3731] Sequence length: 1024, Batch size: 2
[Step 3731] After KL computation - GPU 1: 40.50 GB
[Step 3731] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 3741] ========== MEMORY DEBUG ==========
[Step 3741] Model device: cuda:1
[Step 3741] Input device: cuda:1
[Step 3741] Teacher model device: cuda:0
[Step 3741] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 3741] GPU 1 memory: 33.76 GB (reserved: 47.58 GB)
[Step 3741] Student logits device: cuda:1, shape: torch.Size([2, 741, 151936]), dtype: torch.float32
[Step 3741] Student model device: cuda:1
[Step 3741] GPU 0 memory before teacher forward: 16.39 GB
[Step 3741] GPU 0 memory after moving inputs: 16.39 GB
[Step 3741] GPU 0 memory after teacher forward: 16.84 GB
[Step 3741] Teacher logits shape: torch.Size([2, 741, 151936]), dtype: torch.float16
[Step 3741] Teacher logits device before move: cuda:0
[Step 3741] Target device (student_logits.device): cuda:1
[Step 3741] GPU 0 memory after moving logits to GPU 1: 16.84 GB
[Step 3741] Teacher logits device after move: cuda:1, shape: torch.Size([2, 741, 151936])
[Step 3741] GPU 0 memory after del: 16.39 GB
[Step 3741] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 3741] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 37.01 GB
[Step 3741] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 3741] Sequence length: 741, Batch size: 2
[Step 3741] After KL computation - GPU 1: 38.81 GB
[Step 3741] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(

[Step 3751] ========== MEMORY DEBUG ==========
[Step 3751] Model device: cuda:1
[Step 3751] Input device: cuda:1
[Step 3751] Teacher model device: cuda:0
[Step 3751] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 3751] GPU 1 memory: 33.76 GB (reserved: 47.35 GB)
[Step 3751] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 3751] Student model device: cuda:1
[Step 3751] GPU 0 memory before teacher forward: 16.39 GB
[Step 3751] GPU 0 memory after moving inputs: 16.39 GB
[Step 3751] GPU 0 memory after teacher forward: 17.01 GB
[Step 3751] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 3751] Teacher logits device before move: cuda:0
[Step 3751] Target device (student_logits.device): cuda:1
[Step 3751] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 3751] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 3751] GPU 0 memory after del: 16.39 GB
[Step 3751] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 3751] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 3751] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 3751] Sequence length: 1024, Batch size: 2
[Step 3751] After KL computation - GPU 1: 40.50 GB
[Step 3751] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  2%|                                                                                   | 235/10000 [1:23:33<56:27:15, 20.81s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None

[Step 3761] ========== MEMORY DEBUG ==========
[Step 3761] Model device: cuda:1
[Step 3761] Input device: cuda:1
[Step 3761] Teacher model device: cuda:0
[Step 3761] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 3761] GPU 1 memory: 25.33 GB (reserved: 47.59 GB)
[Step 3761] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 3761] Student model device: cuda:1
[Step 3761] GPU 0 memory before teacher forward: 16.39 GB
[Step 3761] GPU 0 memory after moving inputs: 16.39 GB
[Step 3761] GPU 0 memory after teacher forward: 17.01 GB
[Step 3761] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 3761] Teacher logits device before move: cuda:0
[Step 3761] Target device (student_logits.device): cuda:1
[Step 3761] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 3761] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 3761] GPU 0 memory after del: 16.39 GB
[Step 3761] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 3761] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 29.58 GB
[Step 3761] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 3761] Sequence length: 1024, Batch size: 2
[Step 3761] After KL computation - GPU 1: 32.06 GB
[Step 3761] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(

[Step 3771] ========== MEMORY DEBUG ==========
[Step 3771] Model device: cuda:1
[Step 3771] Input device: cuda:1
[Step 3771] Teacher model device: cuda:0
[Step 3771] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 3771] GPU 1 memory: 33.76 GB (reserved: 43.36 GB)
[Step 3771] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 3771] Student model device: cuda:1
[Step 3771] GPU 0 memory before teacher forward: 16.39 GB
[Step 3771] GPU 0 memory after moving inputs: 16.39 GB
[Step 3771] GPU 0 memory after teacher forward: 17.01 GB
[Step 3771] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 3771] Teacher logits device before move: cuda:0
[Step 3771] Target device (student_logits.device): cuda:1
[Step 3771] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 3771] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 3771] GPU 0 memory after del: 16.39 GB
[Step 3771] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 3771] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 3771] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 3771] Sequence length: 1024, Batch size: 2
[Step 3771] After KL computation - GPU 1: 40.50 GB
[Step 3771] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  2%|                                                                                   | 236/10000 [1:23:53<55:22:37, 20.42s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None

[Step 3781] ========== MEMORY DEBUG ==========
[Step 3781] Model device: cuda:1
[Step 3781] Input device: cuda:1
[Step 3781] Teacher model device: cuda:0
[Step 3781] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 3781] GPU 1 memory: 33.76 GB (reserved: 47.52 GB)
[Step 3781] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 3781] Student model device: cuda:1
[Step 3781] GPU 0 memory before teacher forward: 16.39 GB
[Step 3781] GPU 0 memory after moving inputs: 16.39 GB
[Step 3781] GPU 0 memory after teacher forward: 17.01 GB
[Step 3781] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 3781] Teacher logits device before move: cuda:0
[Step 3781] Target device (student_logits.device): cuda:1
[Step 3781] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 3781] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 3781] GPU 0 memory after del: 16.39 GB
[Step 3781] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 3781] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 3781] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 3781] Sequence length: 1024, Batch size: 2
[Step 3781] After KL computation - GPU 1: 40.50 GB
[Step 3781] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 3791] ========== MEMORY DEBUG ==========
[Step 3791] Model device: cuda:1
[Step 3791] Input device: cuda:1
[Step 3791] Teacher model device: cuda:0
[Step 3791] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 3791] GPU 1 memory: 33.76 GB (reserved: 47.59 GB)
[Step 3791] Student logits device: cuda:1, shape: torch.Size([2, 347, 151936]), dtype: torch.float32
[Step 3791] Student model device: cuda:1
[Step 3791] GPU 0 memory before teacher forward: 16.39 GB
[Step 3791] GPU 0 memory after moving inputs: 16.39 GB
[Step 3791] GPU 0 memory after teacher forward: 16.60 GB
[Step 3791] Teacher logits shape: torch.Size([2, 347, 151936]), dtype: torch.float16
[Step 3791] Teacher logits device before move: cuda:0
[Step 3791] Target device (student_logits.device): cuda:1
[Step 3791] GPU 0 memory after moving logits to GPU 1: 16.60 GB
[Step 3791] Teacher logits device after move: cuda:1, shape: torch.Size([2, 347, 151936])
[Step 3791] GPU 0 memory after del: 16.39 GB
[Step 3791] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 3791] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 35.62 GB
[Step 3791] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 3791] Sequence length: 347, Batch size: 2
[Step 3791] After KL computation - GPU 1: 36.46 GB
[Step 3791] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  2%|                                                                                   | 237/10000 [1:24:15<56:36:50, 20.88s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None

[Step 3801] ========== MEMORY DEBUG ==========
[Step 3801] Model device: cuda:1
[Step 3801] Input device: cuda:1
[Step 3801] Teacher model device: cuda:0
[Step 3801] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 3801] GPU 1 memory: 33.77 GB (reserved: 47.96 GB)
[Step 3801] Student logits device: cuda:1, shape: torch.Size([2, 939, 151936]), dtype: torch.float32
[Step 3801] Student model device: cuda:1
[Step 3801] GPU 0 memory before teacher forward: 16.39 GB
[Step 3801] GPU 0 memory after moving inputs: 16.39 GB
[Step 3801] GPU 0 memory after teacher forward: 16.96 GB
[Step 3801] Teacher logits shape: torch.Size([2, 939, 151936]), dtype: torch.float16
[Step 3801] Teacher logits device before move: cuda:0
[Step 3801] Target device (student_logits.device): cuda:1
[Step 3801] GPU 0 memory after moving logits to GPU 1: 16.96 GB
[Step 3801] Teacher logits device after move: cuda:1, shape: torch.Size([2, 939, 151936])
[Step 3801] GPU 0 memory after del: 16.39 GB
[Step 3801] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 3801] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 37.72 GB
[Step 3801] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 3801] Sequence length: 939, Batch size: 2
[Step 3801] After KL computation - GPU 1: 40.00 GB
[Step 3801] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(
  2%|                                                                                   | 238/10000 [1:24:36<56:43:56, 20.92s/it]

[Step 3811] ========== MEMORY DEBUG ==========
[Step 3811] Model device: cuda:1
[Step 3811] Input device: cuda:1
[Step 3811] Teacher model device: cuda:0
[Step 3811] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 3811] GPU 1 memory: 33.77 GB (reserved: 48.32 GB)
[Step 3811] Student logits device: cuda:1, shape: torch.Size([2, 471, 151936]), dtype: torch.float32
[Step 3811] Student model device: cuda:1
[Step 3811] GPU 0 memory before teacher forward: 16.39 GB
[Step 3811] GPU 0 memory after moving inputs: 16.39 GB
[Step 3811] GPU 0 memory after teacher forward: 16.68 GB
[Step 3811] Teacher logits shape: torch.Size([2, 471, 151936]), dtype: torch.float16
[Step 3811] Teacher logits device before move: cuda:0
[Step 3811] Target device (student_logits.device): cuda:1
[Step 3811] GPU 0 memory after moving logits to GPU 1: 16.68 GB
[Step 3811] Teacher logits device after move: cuda:1, shape: torch.Size([2, 471, 151936])
[Step 3811] GPU 0 memory after del: 16.39 GB
[Step 3811] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 3811] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 36.06 GB
[Step 3811] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 3811] Sequence length: 471, Batch size: 2
[Step 3811] After KL computation - GPU 1: 37.21 GB
[Step 3811] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 3821] ========== MEMORY DEBUG ==========
[Step 3821] Model device: cuda:1
[Step 3821] Input device: cuda:1
[Step 3821] Teacher model device: cuda:0
[Step 3821] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 3821] GPU 1 memory: 33.77 GB (reserved: 41.91 GB)
[Step 3821] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 3821] Student model device: cuda:1
[Step 3821] GPU 0 memory before teacher forward: 16.39 GB
[Step 3821] GPU 0 memory after moving inputs: 16.39 GB
[Step 3821] GPU 0 memory after teacher forward: 17.01 GB
[Step 3821] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 3821] Teacher logits device before move: cuda:0
[Step 3821] Target device (student_logits.device): cuda:1
[Step 3821] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 3821] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 3821] GPU 0 memory after del: 16.39 GB
[Step 3821] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 3821] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.02 GB
[Step 3821] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 3821] Sequence length: 1024, Batch size: 2
[Step 3821] After KL computation - GPU 1: 40.51 GB
[Step 3821] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 3831] ========== MEMORY DEBUG ==========
[Step 3831] Model device: cuda:1
[Step 3831] Input device: cuda:1
[Step 3831] Teacher model device: cuda:0
[Step 3831] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 3831] GPU 1 memory: 33.76 GB (reserved: 47.58 GB)
[Step 3831] Student logits device: cuda:1, shape: torch.Size([2, 760, 151936]), dtype: torch.float32
[Step 3831] Student model device: cuda:1
[Step 3831] GPU 0 memory before teacher forward: 16.39 GB
[Step 3831] GPU 0 memory after moving inputs: 16.39 GB
[Step 3831] GPU 0 memory after teacher forward: 16.85 GB
[Step 3831] Teacher logits shape: torch.Size([2, 760, 151936]), dtype: torch.float16
[Step 3831] Teacher logits device before move: cuda:0
[Step 3831] Target device (student_logits.device): cuda:1
[Step 3831] GPU 0 memory after moving logits to GPU 1: 16.85 GB
[Step 3831] Teacher logits device after move: cuda:1, shape: torch.Size([2, 760, 151936])
[Step 3831] GPU 0 memory after del: 16.39 GB
[Step 3831] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 3831] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 37.08 GB
[Step 3831] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 3831] Sequence length: 760, Batch size: 2
[Step 3831] After KL computation - GPU 1: 38.92 GB
[Step 3831] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 4.9297979797979796e-05, 'epoch': 0.02}

[Step 3841] ========== MEMORY DEBUG ==========
[Step 3841] Model device: cuda:1
[Step 3841] Input device: cuda:1
[Step 3841] Teacher model device: cuda:0
[Step 3841] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 3841] GPU 1 memory: 25.33 GB (reserved: 47.56 GB)
[Step 3841] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 3841] Student model device: cuda:1
[Step 3841] GPU 0 memory before teacher forward: 16.39 GB
[Step 3841] GPU 0 memory after moving inputs: 16.39 GB
[Step 3841] GPU 0 memory after teacher forward: 17.01 GB
[Step 3841] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 3841] Teacher logits device before move: cuda:0
[Step 3841] Target device (student_logits.device): cuda:1
[Step 3841] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 3841] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 3841] GPU 0 memory after del: 16.39 GB
[Step 3841] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 3841] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 29.58 GB
[Step 3841] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 3841] Sequence length: 1024, Batch size: 2
[Step 3841] After KL computation - GPU 1: 32.06 GB
[Step 3841] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 3851] ========== MEMORY DEBUG ==========
[Step 3851] Model device: cuda:1
[Step 3851] Input device: cuda:1
[Step 3851] Teacher model device: cuda:0
[Step 3851] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 3851] GPU 1 memory: 33.76 GB (reserved: 47.63 GB)
[Step 3851] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 3851] Student model device: cuda:1
[Step 3851] GPU 0 memory before teacher forward: 16.39 GB
[Step 3851] GPU 0 memory after moving inputs: 16.39 GB
[Step 3851] GPU 0 memory after teacher forward: 17.01 GB
[Step 3851] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 3851] Teacher logits device before move: cuda:0
[Step 3851] Target device (student_logits.device): cuda:1
[Step 3851] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 3851] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 3851] GPU 0 memory after del: 16.39 GB
[Step 3851] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 3851] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 3851] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 3851] Sequence length: 1024, Batch size: 2
[Step 3851] After KL computation - GPU 1: 40.50 GB
[Step 3851] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  2%|                                                                                   | 241/10000 [1:25:38<56:40:18, 20.91s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 3861] ========== MEMORY DEBUG ==========
[Step 3861] Model device: cuda:1
[Step 3861] Input device: cuda:1
[Step 3861] Teacher model device: cuda:0
[Step 3861] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 3861] GPU 1 memory: 33.76 GB (reserved: 44.72 GB)
[Step 3861] Student logits device: cuda:1, shape: torch.Size([2, 1000, 151936]), dtype: torch.float32
[Step 3861] Student model device: cuda:1
[Step 3861] GPU 0 memory before teacher forward: 16.39 GB
[Step 3861] GPU 0 memory after moving inputs: 16.39 GB
[Step 3861] GPU 0 memory after teacher forward: 17.00 GB
[Step 3861] Teacher logits shape: torch.Size([2, 1000, 151936]), dtype: torch.float16
[Step 3861] Teacher logits device before move: cuda:0
[Step 3861] Target device (student_logits.device): cuda:1
[Step 3861] GPU 0 memory after moving logits to GPU 1: 17.00 GB
[Step 3861] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1000, 151936])
[Step 3861] GPU 0 memory after del: 16.39 GB
[Step 3861] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 3861] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 37.93 GB
[Step 3861] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 3861] Sequence length: 1000, Batch size: 2
[Step 3861] After KL computation - GPU 1: 40.36 GB
[Step 3861] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 3871] ========== MEMORY DEBUG ==========
[Step 3871] Model device: cuda:1
[Step 3871] Input device: cuda:1
[Step 3871] Teacher model device: cuda:0
[Step 3871] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 3871] GPU 1 memory: 33.76 GB (reserved: 47.75 GB)
[Step 3871] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 3871] Student model device: cuda:1
[Step 3871] GPU 0 memory before teacher forward: 16.39 GB
[Step 3871] GPU 0 memory after moving inputs: 16.39 GB
[Step 3871] GPU 0 memory after teacher forward: 17.01 GB
[Step 3871] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 3871] Teacher logits device before move: cuda:0
[Step 3871] Target device (student_logits.device): cuda:1
[Step 3871] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 3871] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 3871] GPU 0 memory after del: 16.39 GB
[Step 3871] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 3871] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 3871] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 3871] Sequence length: 1024, Batch size: 2
[Step 3871] After KL computation - GPU 1: 40.50 GB
[Step 3871] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  2%|                                                                                   | 242/10000 [1:25:59<56:44:45, 20.94s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 3881] ========== MEMORY DEBUG ==========
[Step 3881] Model device: cuda:1
[Step 3881] Input device: cuda:1
[Step 3881] Teacher model device: cuda:0
[Step 3881] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 3881] GPU 1 memory: 33.77 GB (reserved: 46.50 GB)
[Step 3881] Student logits device: cuda:1, shape: torch.Size([2, 545, 151936]), dtype: torch.float32
[Step 3881] Student model device: cuda:1
[Step 3881] GPU 0 memory before teacher forward: 16.39 GB
[Step 3881] GPU 0 memory after moving inputs: 16.39 GB
[Step 3881] GPU 0 memory after teacher forward: 16.72 GB
[Step 3881] Teacher logits shape: torch.Size([2, 545, 151936]), dtype: torch.float16
[Step 3881] Teacher logits device before move: cuda:0
[Step 3881] Target device (student_logits.device): cuda:1
[Step 3881] GPU 0 memory after moving logits to GPU 1: 16.72 GB
[Step 3881] Teacher logits device after move: cuda:1, shape: torch.Size([2, 545, 151936])
[Step 3881] GPU 0 memory after del: 16.39 GB
[Step 3881] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 3881] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 36.32 GB
[Step 3881] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 3881] Sequence length: 545, Batch size: 2
[Step 3881] After KL computation - GPU 1: 37.65 GB
[Step 3881] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  2%|                                                                                   | 243/10000 [1:26:19<56:02:29, 20.68s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None

[Step 3891] ========== MEMORY DEBUG ==========
[Step 3891] Model device: cuda:1
[Step 3891] Input device: cuda:1
[Step 3891] Teacher model device: cuda:0
[Step 3891] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 3891] GPU 1 memory: 33.76 GB (reserved: 45.88 GB)
[Step 3891] Student logits device: cuda:1, shape: torch.Size([2, 417, 151936]), dtype: torch.float32
[Step 3891] Student model device: cuda:1
[Step 3891] GPU 0 memory before teacher forward: 16.39 GB
[Step 3891] GPU 0 memory after moving inputs: 16.39 GB
[Step 3891] GPU 0 memory after teacher forward: 16.65 GB
[Step 3891] Teacher logits shape: torch.Size([2, 417, 151936]), dtype: torch.float16
[Step 3891] Teacher logits device before move: cuda:0
[Step 3891] Target device (student_logits.device): cuda:1
[Step 3891] GPU 0 memory after moving logits to GPU 1: 16.65 GB
[Step 3891] Teacher logits device after move: cuda:1, shape: torch.Size([2, 417, 151936])
[Step 3891] GPU 0 memory after del: 16.39 GB
[Step 3891] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 3891] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 35.86 GB
[Step 3891] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 3891] Sequence length: 417, Batch size: 2
[Step 3891] After KL computation - GPU 1: 36.88 GB
[Step 3891] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(

[Step 3901] ========== MEMORY DEBUG ==========
[Step 3901] Model device: cuda:1
[Step 3901] Input device: cuda:1
[Step 3901] Teacher model device: cuda:0
[Step 3901] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 3901] GPU 1 memory: 33.76 GB (reserved: 47.78 GB)
[Step 3901] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 3901] Student model device: cuda:1
[Step 3901] GPU 0 memory before teacher forward: 16.39 GB
[Step 3901] GPU 0 memory after moving inputs: 16.39 GB
[Step 3901] GPU 0 memory after teacher forward: 17.01 GB
[Step 3901] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 3901] Teacher logits device before move: cuda:0
[Step 3901] Target device (student_logits.device): cuda:1
[Step 3901] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 3901] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 3901] GPU 0 memory after del: 16.39 GB
[Step 3901] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 3901] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 3901] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 3901] Sequence length: 1024, Batch size: 2
[Step 3901] After KL computation - GPU 1: 40.50 GB
[Step 3901] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  2%|                                                                                   | 245/10000 [1:27:01<56:31:04, 20.86s/it]

[Step 3911] ========== MEMORY DEBUG ==========
[Step 3911] Model device: cuda:1
[Step 3911] Input device: cuda:1
[Step 3911] Teacher model device: cuda:0
[Step 3911] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 3911] GPU 1 memory: 33.76 GB (reserved: 47.67 GB)
[Step 3911] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 3911] Student model device: cuda:1
[Step 3911] GPU 0 memory before teacher forward: 16.39 GB
[Step 3911] GPU 0 memory after moving inputs: 16.39 GB
[Step 3911] GPU 0 memory after teacher forward: 17.01 GB
[Step 3911] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 3911] Teacher logits device before move: cuda:0
[Step 3911] Target device (student_logits.device): cuda:1
[Step 3911] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 3911] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 3911] GPU 0 memory after del: 16.39 GB
[Step 3911] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 3911] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 3911] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 3911] Sequence length: 1024, Batch size: 2
[Step 3911] After KL computation - GPU 1: 40.50 GB
[Step 3911] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 3921] ========== MEMORY DEBUG ==========
[Step 3921] Model device: cuda:1
[Step 3921] Input device: cuda:1
[Step 3921] Teacher model device: cuda:0
[Step 3921] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 3921] GPU 1 memory: 25.33 GB (reserved: 43.25 GB)
[Step 3921] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 3921] Student model device: cuda:1
[Step 3921] GPU 0 memory before teacher forward: 16.39 GB
[Step 3921] GPU 0 memory after moving inputs: 16.39 GB
[Step 3921] GPU 0 memory after teacher forward: 17.01 GB
[Step 3921] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 3921] Teacher logits device before move: cuda:0
[Step 3921] Target device (student_logits.device): cuda:1
[Step 3921] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 3921] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 3921] GPU 0 memory after del: 16.39 GB
[Step 3921] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 3921] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 29.58 GB
[Step 3921] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 3921] Sequence length: 1024, Batch size: 2
[Step 3921] After KL computation - GPU 1: 32.06 GB
[Step 3921] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 3931] ========== MEMORY DEBUG ==========
[Step 3931] Model device: cuda:1
[Step 3931] Input device: cuda:1
[Step 3931] Teacher model device: cuda:0
[Step 3931] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 3931] GPU 1 memory: 33.76 GB (reserved: 47.49 GB)
[Step 3931] Student logits device: cuda:1, shape: torch.Size([2, 427, 151936]), dtype: torch.float32
[Step 3931] Student model device: cuda:1
[Step 3931] GPU 0 memory before teacher forward: 16.39 GB
[Step 3931] GPU 0 memory after moving inputs: 16.39 GB
[Step 3931] GPU 0 memory after teacher forward: 16.65 GB
[Step 3931] Teacher logits shape: torch.Size([2, 427, 151936]), dtype: torch.float16
[Step 3931] Teacher logits device before move: cuda:0
[Step 3931] Target device (student_logits.device): cuda:1
[Step 3931] GPU 0 memory after moving logits to GPU 1: 16.65 GB
[Step 3931] Teacher logits device after move: cuda:1, shape: torch.Size([2, 427, 151936])
[Step 3931] GPU 0 memory after del: 16.39 GB
[Step 3931] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 3931] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 35.90 GB
[Step 3931] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 3931] Sequence length: 427, Batch size: 2
[Step 3931] After KL computation - GPU 1: 36.94 GB
[Step 3931] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(
  2%|                                                                                   | 246/10000 [1:27:22<56:46:06, 20.95s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 3941] ========== MEMORY DEBUG ==========
[Step 3941] Model device: cuda:1
[Step 3941] Input device: cuda:1
[Step 3941] Teacher model device: cuda:0
[Step 3941] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 3941] GPU 1 memory: 33.77 GB (reserved: 47.68 GB)
[Step 3941] Student logits device: cuda:1, shape: torch.Size([2, 1017, 151936]), dtype: torch.float32
[Step 3941] Student model device: cuda:1
[Step 3941] GPU 0 memory before teacher forward: 16.39 GB
[Step 3941] GPU 0 memory after moving inputs: 16.39 GB
[Step 3941] GPU 0 memory after teacher forward: 17.01 GB
[Step 3941] Teacher logits shape: torch.Size([2, 1017, 151936]), dtype: torch.float16
[Step 3941] Teacher logits device before move: cuda:0
[Step 3941] Target device (student_logits.device): cuda:1
[Step 3941] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 3941] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1017, 151936])
[Step 3941] GPU 0 memory after del: 16.39 GB
[Step 3941] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 3941] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 37.99 GB
[Step 3941] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 3941] Sequence length: 1017, Batch size: 2
[Step 3941] After KL computation - GPU 1: 40.46 GB
[Step 3941] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 3951] ========== MEMORY DEBUG ==========
[Step 3951] Model device: cuda:1
[Step 3951] Input device: cuda:1
[Step 3951] Teacher model device: cuda:0
[Step 3951] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 3951] GPU 1 memory: 33.77 GB (reserved: 48.02 GB)
[Step 3951] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 3951] Student model device: cuda:1
[Step 3951] GPU 0 memory before teacher forward: 16.39 GB
[Step 3951] GPU 0 memory after moving inputs: 16.39 GB
[Step 3951] GPU 0 memory after teacher forward: 17.01 GB
[Step 3951] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 3951] Teacher logits device before move: cuda:0
[Step 3951] Target device (student_logits.device): cuda:1
[Step 3951] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 3951] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 3951] GPU 0 memory after del: 16.39 GB
[Step 3951] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 3951] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.02 GB
[Step 3951] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 3951] Sequence length: 1024, Batch size: 2
[Step 3951] After KL computation - GPU 1: 40.51 GB
[Step 3951] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  2%|                                                                                   | 247/10000 [1:27:44<57:14:33, 21.13s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None

[Step 3961] ========== MEMORY DEBUG ==========
[Step 3961] Model device: cuda:1
[Step 3961] Input device: cuda:1
[Step 3961] Teacher model device: cuda:0
[Step 3961] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 3961] GPU 1 memory: 33.77 GB (reserved: 47.10 GB)
  warnings.warn(
[Step 3961] Student logits device: cuda:1, shape: torch.Size([2, 208, 151936]), dtype: torch.float32
[Step 3961] Student model device: cuda:1
[Step 3961] GPU 0 memory before teacher forward: 16.39 GB
[Step 3961] GPU 0 memory after moving inputs: 16.39 GB
[Step 3961] GPU 0 memory after teacher forward: 16.52 GB
[Step 3961] Teacher logits shape: torch.Size([2, 208, 151936]), dtype: torch.float16
[Step 3961] Teacher logits device before move: cuda:0
[Step 3961] Target device (student_logits.device): cuda:1
[Step 3961] GPU 0 memory after moving logits to GPU 1: 16.52 GB
[Step 3961] Teacher logits device after move: cuda:1, shape: torch.Size([2, 208, 151936])
[Step 3961] GPU 0 memory after del: 16.39 GB
[Step 3961] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 3961] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 35.14 GB
[Step 3961] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 3961] Sequence length: 208, Batch size: 2
[Step 3961] After KL computation - GPU 1: 35.65 GB
[Step 3961] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  2%|                                                                                   | 248/10000 [1:28:04<56:05:29, 20.71s/it]

[Step 3971] ========== MEMORY DEBUG ==========
[Step 3971] Model device: cuda:1
[Step 3971] Input device: cuda:1
[Step 3971] Teacher model device: cuda:0
[Step 3971] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 3971] GPU 1 memory: 33.77 GB (reserved: 44.88 GB)
[Step 3971] Student logits device: cuda:1, shape: torch.Size([2, 845, 151936]), dtype: torch.float32
[Step 3971] Student model device: cuda:1
[Step 3971] GPU 0 memory before teacher forward: 16.39 GB
[Step 3971] GPU 0 memory after moving inputs: 16.39 GB
[Step 3971] GPU 0 memory after teacher forward: 16.91 GB
[Step 3971] Teacher logits shape: torch.Size([2, 845, 151936]), dtype: torch.float16
[Step 3971] Teacher logits device before move: cuda:0
[Step 3971] Target device (student_logits.device): cuda:1
[Step 3971] GPU 0 memory after moving logits to GPU 1: 16.91 GB
[Step 3971] Teacher logits device after move: cuda:1, shape: torch.Size([2, 845, 151936])
[Step 3971] GPU 0 memory after del: 16.39 GB
[Step 3971] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 3971] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 37.39 GB
[Step 3971] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 3971] Sequence length: 845, Batch size: 2
[Step 3971] After KL computation - GPU 1: 39.44 GB
[Step 3971] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 3981] ========== MEMORY DEBUG ==========
[Step 3981] Model device: cuda:1
[Step 3981] Input device: cuda:1
[Step 3981] Teacher model device: cuda:0
[Step 3981] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 3981] GPU 1 memory: 33.77 GB (reserved: 47.59 GB)
[Step 3981] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 3981] Student model device: cuda:1
[Step 3981] GPU 0 memory before teacher forward: 16.39 GB
[Step 3981] GPU 0 memory after moving inputs: 16.39 GB
[Step 3981] GPU 0 memory after teacher forward: 17.01 GB
[Step 3981] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 3981] Teacher logits device before move: cuda:0
[Step 3981] Target device (student_logits.device): cuda:1
[Step 3981] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 3981] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 3981] GPU 0 memory after del: 16.39 GB
[Step 3981] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 3981] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.02 GB
[Step 3981] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 3981] Sequence length: 1024, Batch size: 2
[Step 3981] After KL computation - GPU 1: 40.51 GB
[Step 3981] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 3991] ========== MEMORY DEBUG ==========
[Step 3991] Model device: cuda:1
[Step 3991] Input device: cuda:1
[Step 3991] Teacher model device: cuda:0
[Step 3991] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 3991] GPU 1 memory: 33.76 GB (reserved: 47.67 GB)
[Step 3991] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 3991] Student model device: cuda:1
[Step 3991] GPU 0 memory before teacher forward: 16.39 GB
[Step 3991] GPU 0 memory after moving inputs: 16.39 GB
[Step 3991] GPU 0 memory after teacher forward: 17.01 GB
[Step 3991] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 3991] Teacher logits device before move: cuda:0
[Step 3991] Target device (student_logits.device): cuda:1
[Step 3991] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 3991] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 3991] GPU 0 memory after del: 16.39 GB
[Step 3991] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 3991] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 3991] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 3991] Sequence length: 1024, Batch size: 2
[Step 3991] After KL computation - GPU 1: 40.50 GB
[Step 3991] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(
  2%|                                                                                  | 250/10000 [1:28:46<57:16:31, 21.15s/it]
{'loss': 0.6655, 'grad_norm': nan, 'learning_rate': 4.924747474747475e-05, 'epoch': 0.03}

[Step 4001] ========== MEMORY DEBUG ==========
[Step 4001] Model device: cuda:1
[Step 4001] Input device: cuda:1
[Step 4001] Teacher model device: cuda:0
[Step 4001] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 4001] GPU 1 memory: 25.33 GB (reserved: 39.53 GB)
[Step 4001] Student logits device: cuda:1, shape: torch.Size([2, 413, 151936]), dtype: torch.float32
[Step 4001] Student model device: cuda:1
[Step 4001] GPU 0 memory before teacher forward: 16.39 GB
[Step 4001] GPU 0 memory after moving inputs: 16.39 GB
[Step 4001] GPU 0 memory after teacher forward: 16.64 GB
[Step 4001] Teacher logits shape: torch.Size([2, 413, 151936]), dtype: torch.float16
[Step 4001] Teacher logits device before move: cuda:0
[Step 4001] Target device (student_logits.device): cuda:1
[Step 4001] GPU 0 memory after moving logits to GPU 1: 16.64 GB
[Step 4001] Teacher logits device after move: cuda:1, shape: torch.Size([2, 413, 151936])
[Step 4001] GPU 0 memory after del: 16.39 GB
[Step 4001] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 4001] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 27.41 GB
[Step 4001] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 4001] Sequence length: 413, Batch size: 2
[Step 4001] After KL computation - GPU 1: 28.42 GB
[Step 4001] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 4011] ========== MEMORY DEBUG ==========
[Step 4011] Model device: cuda:1
[Step 4011] Input device: cuda:1
[Step 4011] Teacher model device: cuda:0
[Step 4011] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 4011] GPU 1 memory: 33.76 GB (reserved: 43.54 GB)
[Step 4011] Student logits device: cuda:1, shape: torch.Size([2, 755, 151936]), dtype: torch.float32
[Step 4011] Student model device: cuda:1
[Step 4011] GPU 0 memory before teacher forward: 16.39 GB
[Step 4011] GPU 0 memory after moving inputs: 16.39 GB
[Step 4011] GPU 0 memory after teacher forward: 16.85 GB
[Step 4011] Teacher logits shape: torch.Size([2, 755, 151936]), dtype: torch.float16
[Step 4011] Teacher logits device before move: cuda:0
[Step 4011] Target device (student_logits.device): cuda:1
[Step 4011] GPU 0 memory after moving logits to GPU 1: 16.85 GB
[Step 4011] Teacher logits device after move: cuda:1, shape: torch.Size([2, 755, 151936])
[Step 4011] GPU 0 memory after del: 16.39 GB
[Step 4011] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 4011] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 37.06 GB
[Step 4011] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 4011] Sequence length: 755, Batch size: 2
[Step 4011] After KL computation - GPU 1: 38.90 GB
[Step 4011] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 4021] ========== MEMORY DEBUG ==========
[Step 4021] Model device: cuda:1
[Step 4021] Input device: cuda:1
[Step 4021] Teacher model device: cuda:0
[Step 4021] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 4021] GPU 1 memory: 33.77 GB (reserved: 48.11 GB)
[Step 4021] Student logits device: cuda:1, shape: torch.Size([2, 675, 151936]), dtype: torch.float32
[Step 4021] Student model device: cuda:1
[Step 4021] GPU 0 memory before teacher forward: 16.39 GB
[Step 4021] GPU 0 memory after moving inputs: 16.39 GB
[Step 4021] GPU 0 memory after teacher forward: 16.80 GB
[Step 4021] Teacher logits shape: torch.Size([2, 675, 151936]), dtype: torch.float16
[Step 4021] Teacher logits device before move: cuda:0
[Step 4021] Target device (student_logits.device): cuda:1
[Step 4021] GPU 0 memory after moving logits to GPU 1: 16.80 GB
[Step 4021] Teacher logits device after move: cuda:1, shape: torch.Size([2, 675, 151936])
[Step 4021] GPU 0 memory after del: 16.39 GB
[Step 4021] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 4021] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 36.79 GB
[Step 4021] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 4021] Sequence length: 675, Batch size: 2
[Step 4021] After KL computation - GPU 1: 38.43 GB
[Step 4021] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 4031] ========== MEMORY DEBUG ==========
[Step 4031] Model device: cuda:1
[Step 4031] Input device: cuda:1
[Step 4031] Teacher model device: cuda:0
[Step 4031] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 4031] GPU 1 memory: 33.77 GB (reserved: 46.02 GB)
[Step 4031] Student logits device: cuda:1, shape: torch.Size([2, 710, 151936]), dtype: torch.float32
[Step 4031] Student model device: cuda:1
[Step 4031] GPU 0 memory before teacher forward: 16.39 GB
[Step 4031] GPU 0 memory after moving inputs: 16.39 GB
[Step 4031] GPU 0 memory after teacher forward: 16.82 GB
[Step 4031] Teacher logits shape: torch.Size([2, 710, 151936]), dtype: torch.float16
[Step 4031] Teacher logits device before move: cuda:0
[Step 4031] Target device (student_logits.device): cuda:1
[Step 4031] GPU 0 memory after moving logits to GPU 1: 16.82 GB
[Step 4031] Teacher logits device after move: cuda:1, shape: torch.Size([2, 710, 151936])
[Step 4031] GPU 0 memory after del: 16.39 GB
[Step 4031] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 4031] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 36.91 GB
[Step 4031] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 4031] Sequence length: 710, Batch size: 2
[Step 4031] After KL computation - GPU 1: 38.64 GB
[Step 4031] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(

[Step 4041] ========== MEMORY DEBUG ==========
[Step 4041] Model device: cuda:1
[Step 4041] Input device: cuda:1
[Step 4041] Teacher model device: cuda:0
[Step 4041] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 4041] GPU 1 memory: 33.76 GB (reserved: 45.14 GB)
[Step 4041] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 4041] Student model device: cuda:1
[Step 4041] GPU 0 memory before teacher forward: 16.39 GB
[Step 4041] GPU 0 memory after moving inputs: 16.39 GB
[Step 4041] GPU 0 memory after teacher forward: 17.01 GB
[Step 4041] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 4041] Teacher logits device before move: cuda:0
[Step 4041] Target device (student_logits.device): cuda:1
[Step 4041] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 4041] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 4041] GPU 0 memory after del: 16.39 GB
[Step 4041] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 4041] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 4041] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 4041] Sequence length: 1024, Batch size: 2
[Step 4041] After KL computation - GPU 1: 40.50 GB
[Step 4041] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  3%|                                                                                  | 253/10000 [1:29:45<54:59:27, 20.31s/it]

[Step 4051] ========== MEMORY DEBUG ==========
[Step 4051] Model device: cuda:1
[Step 4051] Input device: cuda:1
[Step 4051] Teacher model device: cuda:0
[Step 4051] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 4051] GPU 1 memory: 33.76 GB (reserved: 44.81 GB)
[Step 4051] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 4051] Student model device: cuda:1
[Step 4051] GPU 0 memory before teacher forward: 16.39 GB
[Step 4051] GPU 0 memory after moving inputs: 16.39 GB
[Step 4051] GPU 0 memory after teacher forward: 17.01 GB
[Step 4051] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 4051] Teacher logits device before move: cuda:0
[Step 4051] Target device (student_logits.device): cuda:1
[Step 4051] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 4051] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 4051] GPU 0 memory after del: 16.39 GB
[Step 4051] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 4051] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 4051] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 4051] Sequence length: 1024, Batch size: 2
[Step 4051] After KL computation - GPU 1: 40.50 GB
[Step 4051] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 4061] ========== MEMORY DEBUG ==========
[Step 4061] Model device: cuda:1
[Step 4061] Input device: cuda:1
[Step 4061] Teacher model device: cuda:0
[Step 4061] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 4061] GPU 1 memory: 33.76 GB (reserved: 39.44 GB)
[Step 4061] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 4061] Student model device: cuda:1
[Step 4061] GPU 0 memory before teacher forward: 16.39 GB
[Step 4061] GPU 0 memory after moving inputs: 16.39 GB
[Step 4061] GPU 0 memory after teacher forward: 17.01 GB
[Step 4061] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 4061] Teacher logits device before move: cuda:0
[Step 4061] Target device (student_logits.device): cuda:1
[Step 4061] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 4061] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 4061] GPU 0 memory after del: 16.39 GB
[Step 4061] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 4061] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 4061] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 4061] Sequence length: 1024, Batch size: 2
[Step 4061] After KL computation - GPU 1: 40.50 GB
[Step 4061] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 4071] ========== MEMORY DEBUG ==========
[Step 4071] Model device: cuda:1
[Step 4071] Input device: cuda:1
[Step 4071] Teacher model device: cuda:0
[Step 4071] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 4071] GPU 1 memory: 33.76 GB (reserved: 47.60 GB)
[Step 4071] Student logits device: cuda:1, shape: torch.Size([2, 617, 151936]), dtype: torch.float32
[Step 4071] Student model device: cuda:1
[Step 4071] GPU 0 memory before teacher forward: 16.39 GB
[Step 4071] GPU 0 memory after moving inputs: 16.39 GB
[Step 4071] GPU 0 memory after teacher forward: 16.77 GB
[Step 4071] Teacher logits shape: torch.Size([2, 617, 151936]), dtype: torch.float16
[Step 4071] Teacher logits device before move: cuda:0
[Step 4071] Target device (student_logits.device): cuda:1
[Step 4071] GPU 0 memory after moving logits to GPU 1: 16.77 GB
[Step 4071] Teacher logits device after move: cuda:1, shape: torch.Size([2, 617, 151936])
[Step 4071] GPU 0 memory after del: 16.39 GB
[Step 4071] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 4071] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 36.57 GB
[Step 4071] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 4071] Sequence length: 617, Batch size: 2
[Step 4071] After KL computation - GPU 1: 38.07 GB
[Step 4071] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(
  3%|                                                                                  | 255/10000 [1:30:27<55:33:25, 20.52s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None

[Step 4081] ========== MEMORY DEBUG ==========
[Step 4081] Model device: cuda:1
[Step 4081] Input device: cuda:1
[Step 4081] Teacher model device: cuda:0
[Step 4081] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 4081] GPU 1 memory: 25.33 GB (reserved: 47.53 GB)
[Step 4081] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 4081] Student model device: cuda:1
[Step 4081] GPU 0 memory before teacher forward: 16.39 GB
[Step 4081] GPU 0 memory after moving inputs: 16.39 GB
[Step 4081] GPU 0 memory after teacher forward: 17.01 GB
[Step 4081] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 4081] Teacher logits device before move: cuda:0
[Step 4081] Target device (student_logits.device): cuda:1
[Step 4081] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 4081] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 4081] GPU 0 memory after del: 16.39 GB
[Step 4081] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 4081] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 29.58 GB
[Step 4081] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 4081] Sequence length: 1024, Batch size: 2
[Step 4081] After KL computation - GPU 1: 32.07 GB
[Step 4081] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(

[Step 4091] ========== MEMORY DEBUG ==========
[Step 4091] Model device: cuda:1
[Step 4091] Input device: cuda:1
[Step 4091] Teacher model device: cuda:0
[Step 4091] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 4091] GPU 1 memory: 33.76 GB (reserved: 44.38 GB)
[Step 4091] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 4091] Student model device: cuda:1
[Step 4091] GPU 0 memory before teacher forward: 16.39 GB
[Step 4091] GPU 0 memory after moving inputs: 16.39 GB
[Step 4091] GPU 0 memory after teacher forward: 17.01 GB
[Step 4091] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 4091] Teacher logits device before move: cuda:0
[Step 4091] Target device (student_logits.device): cuda:1
[Step 4091] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 4091] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 4091] GPU 0 memory after del: 16.39 GB
[Step 4091] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 4091] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 4091] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 4091] Sequence length: 1024, Batch size: 2
[Step 4091] After KL computation - GPU 1: 40.50 GB
[Step 4091] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  3%|                                                                                  | 256/10000 [1:30:49<57:21:24, 21.19s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None

[Step 4101] ========== MEMORY DEBUG ==========
[Step 4101] Model device: cuda:1
[Step 4101] Input device: cuda:1
[Step 4101] Teacher model device: cuda:0
[Step 4101] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 4101] GPU 1 memory: 33.77 GB (reserved: 47.92 GB)
[Step 4101] Student logits device: cuda:1, shape: torch.Size([2, 866, 151936]), dtype: torch.float32
[Step 4101] Student model device: cuda:1
[Step 4101] GPU 0 memory before teacher forward: 16.39 GB
[Step 4101] GPU 0 memory after moving inputs: 16.39 GB
[Step 4101] GPU 0 memory after teacher forward: 16.92 GB
[Step 4101] Teacher logits shape: torch.Size([2, 866, 151936]), dtype: torch.float16
[Step 4101] Teacher logits device before move: cuda:0
[Step 4101] Target device (student_logits.device): cuda:1
[Step 4101] GPU 0 memory after moving logits to GPU 1: 16.92 GB
[Step 4101] Teacher logits device after move: cuda:1, shape: torch.Size([2, 866, 151936])
[Step 4101] GPU 0 memory after del: 16.39 GB
[Step 4101] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 4101] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 37.46 GB
[Step 4101] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 4101] Sequence length: 866, Batch size: 2
[Step 4101] After KL computation - GPU 1: 39.57 GB
[Step 4101] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(

[Step 4111] ========== MEMORY DEBUG ==========
[Step 4111] Model device: cuda:1
[Step 4111] Input device: cuda:1
[Step 4111] Teacher model device: cuda:0
[Step 4111] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 4111] GPU 1 memory: 33.77 GB (reserved: 47.50 GB)
[Step 4111] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 4111] Student model device: cuda:1
[Step 4111] GPU 0 memory before teacher forward: 16.39 GB
[Step 4111] GPU 0 memory after moving inputs: 16.39 GB
[Step 4111] GPU 0 memory after teacher forward: 17.01 GB
[Step 4111] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 4111] Teacher logits device before move: cuda:0
[Step 4111] Target device (student_logits.device): cuda:1
[Step 4111] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 4111] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 4111] GPU 0 memory after del: 16.39 GB
[Step 4111] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 4111] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.02 GB
[Step 4111] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 4111] Sequence length: 1024, Batch size: 2
[Step 4111] After KL computation - GPU 1: 40.51 GB
[Step 4111] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  3%|                                                                                  | 257/10000 [1:31:11<57:52:14, 21.38s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 4121] ========== MEMORY DEBUG ==========
[Step 4121] Model device: cuda:1
[Step 4121] Input device: cuda:1
[Step 4121] Teacher model device: cuda:0
[Step 4121] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 4121] GPU 1 memory: 33.77 GB (reserved: 47.71 GB)
[Step 4121] Student logits device: cuda:1, shape: torch.Size([2, 929, 151936]), dtype: torch.float32
[Step 4121] Student model device: cuda:1
[Step 4121] GPU 0 memory before teacher forward: 16.39 GB
[Step 4121] GPU 0 memory after moving inputs: 16.39 GB
[Step 4121] GPU 0 memory after teacher forward: 16.96 GB
[Step 4121] Teacher logits shape: torch.Size([2, 929, 151936]), dtype: torch.float16
[Step 4121] Teacher logits device before move: cuda:0
[Step 4121] Target device (student_logits.device): cuda:1
[Step 4121] GPU 0 memory after moving logits to GPU 1: 16.96 GB
[Step 4121] Teacher logits device after move: cuda:1, shape: torch.Size([2, 929, 151936])
[Step 4121] GPU 0 memory after del: 16.39 GB
[Step 4121] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 4121] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 37.68 GB
[Step 4121] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 4121] Sequence length: 929, Batch size: 2
[Step 4121] After KL computation - GPU 1: 39.94 GB
[Step 4121] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  3%|                                                                                  | 258/10000 [1:31:33<58:20:27, 21.56s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None

[Step 4131] ========== MEMORY DEBUG ==========
[Step 4131] Model device: cuda:1
[Step 4131] Input device: cuda:1
[Step 4131] Teacher model device: cuda:0
[Step 4131] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 4131] GPU 1 memory: 33.76 GB (reserved: 46.58 GB)
  warnings.warn(
[Step 4131] Student logits device: cuda:1, shape: torch.Size([2, 678, 151936]), dtype: torch.float32
[Step 4131] Student model device: cuda:1
[Step 4131] GPU 0 memory before teacher forward: 16.39 GB
[Step 4131] GPU 0 memory after moving inputs: 16.39 GB
[Step 4131] GPU 0 memory after teacher forward: 16.80 GB
[Step 4131] Teacher logits shape: torch.Size([2, 678, 151936]), dtype: torch.float16
[Step 4131] Teacher logits device before move: cuda:0
[Step 4131] Target device (student_logits.device): cuda:1
[Step 4131] GPU 0 memory after moving logits to GPU 1: 16.80 GB
[Step 4131] Teacher logits device after move: cuda:1, shape: torch.Size([2, 678, 151936])
[Step 4131] GPU 0 memory after del: 16.39 GB
[Step 4131] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 4131] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 36.79 GB
[Step 4131] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 4131] Sequence length: 678, Batch size: 2
[Step 4131] After KL computation - GPU 1: 38.43 GB
[Step 4131] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 4141] ========== MEMORY DEBUG ==========
[Step 4141] Model device: cuda:1
[Step 4141] Input device: cuda:1
[Step 4141] Teacher model device: cuda:0
[Step 4141] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 4141] GPU 1 memory: 33.76 GB (reserved: 47.58 GB)
[Step 4141] Student logits device: cuda:1, shape: torch.Size([2, 142, 151936]), dtype: torch.float32
[Step 4141] Student model device: cuda:1
[Step 4141] GPU 0 memory before teacher forward: 16.39 GB
[Step 4141] GPU 0 memory after moving inputs: 16.39 GB
[Step 4141] GPU 0 memory after teacher forward: 16.48 GB
[Step 4141] Teacher logits shape: torch.Size([2, 142, 151936]), dtype: torch.float16
[Step 4141] Teacher logits device before move: cuda:0
[Step 4141] Target device (student_logits.device): cuda:1
[Step 4141] GPU 0 memory after moving logits to GPU 1: 16.48 GB
[Step 4141] Teacher logits device after move: cuda:1, shape: torch.Size([2, 142, 151936])
[Step 4141] GPU 0 memory after del: 16.39 GB
[Step 4141] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 4141] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 34.89 GB
[Step 4141] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 4141] Sequence length: 142, Batch size: 2
[Step 4141] After KL computation - GPU 1: 35.23 GB
[Step 4141] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  3%|                                                                                  | 259/10000 [1:31:53<56:43:59, 20.97s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 4151] ========== MEMORY DEBUG ==========
[Step 4151] Model device: cuda:1
[Step 4151] Input device: cuda:1
[Step 4151] Teacher model device: cuda:0
[Step 4151] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 4151] GPU 1 memory: 33.76 GB (reserved: 47.64 GB)
[Step 4151] Student logits device: cuda:1, shape: torch.Size([2, 359, 151936]), dtype: torch.float32
[Step 4151] Student model device: cuda:1
[Step 4151] GPU 0 memory before teacher forward: 16.39 GB
[Step 4151] GPU 0 memory after moving inputs: 16.39 GB
[Step 4151] GPU 0 memory after teacher forward: 16.61 GB
[Step 4151] Teacher logits shape: torch.Size([2, 359, 151936]), dtype: torch.float16
[Step 4151] Teacher logits device before move: cuda:0
[Step 4151] Target device (student_logits.device): cuda:1
[Step 4151] GPU 0 memory after moving logits to GPU 1: 16.61 GB
[Step 4151] Teacher logits device after move: cuda:1, shape: torch.Size([2, 359, 151936])
[Step 4151] GPU 0 memory after del: 16.39 GB
[Step 4151] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 4151] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 35.66 GB
[Step 4151] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 4151] Sequence length: 359, Batch size: 2
[Step 4151] After KL computation - GPU 1: 36.54 GB
[Step 4151] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  3%|                                                                                  | 260/10000 [1:32:12<55:20:37, 20.46s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 4.9196969696969695e-05, 'epoch': 0.03}

[Step 4161] ========== MEMORY DEBUG ==========
[Step 4161] Model device: cuda:1
[Step 4161] Input device: cuda:1
[Step 4161] Teacher model device: cuda:0
[Step 4161] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 4161] GPU 1 memory: 25.33 GB (reserved: 47.74 GB)
[Step 4161] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 4161] Student model device: cuda:1
[Step 4161] GPU 0 memory before teacher forward: 16.39 GB
[Step 4161] GPU 0 memory after moving inputs: 16.39 GB
[Step 4161] GPU 0 memory after teacher forward: 17.01 GB
[Step 4161] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 4161] Teacher logits device before move: cuda:0
[Step 4161] Target device (student_logits.device): cuda:1
[Step 4161] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 4161] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 4161] GPU 0 memory after del: 16.39 GB
[Step 4161] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 4161] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 29.58 GB
[Step 4161] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 4161] Sequence length: 1024, Batch size: 2
[Step 4161] After KL computation - GPU 1: 32.07 GB
[Step 4161] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(

[Step 4171] ========== MEMORY DEBUG ==========
[Step 4171] Model device: cuda:1
[Step 4171] Input device: cuda:1
[Step 4171] Teacher model device: cuda:0
[Step 4171] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 4171] GPU 1 memory: 33.76 GB (reserved: 45.25 GB)
[Step 4171] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 4171] Student model device: cuda:1
[Step 4171] GPU 0 memory before teacher forward: 16.39 GB
[Step 4171] GPU 0 memory after moving inputs: 16.39 GB
[Step 4171] GPU 0 memory after teacher forward: 17.01 GB
[Step 4171] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 4171] Teacher logits device before move: cuda:0
[Step 4171] Target device (student_logits.device): cuda:1
[Step 4171] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 4171] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 4171] GPU 0 memory after del: 16.39 GB
[Step 4171] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 4171] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 4171] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 4171] Sequence length: 1024, Batch size: 2
[Step 4171] After KL computation - GPU 1: 40.50 GB
[Step 4171] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  3%|                                                                                  | 261/10000 [1:32:34<56:07:32, 20.75s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None

[Step 4181] ========== MEMORY DEBUG ==========
[Step 4181] Model device: cuda:1
[Step 4181] Input device: cuda:1
[Step 4181] Teacher model device: cuda:0
[Step 4181] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 4181] GPU 1 memory: 33.76 GB (reserved: 47.33 GB)
[Step 4181] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 4181] Student model device: cuda:1
[Step 4181] GPU 0 memory before teacher forward: 16.39 GB
[Step 4181] GPU 0 memory after moving inputs: 16.39 GB
[Step 4181] GPU 0 memory after teacher forward: 17.01 GB
[Step 4181] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 4181] Teacher logits device before move: cuda:0
[Step 4181] Target device (student_logits.device): cuda:1
[Step 4181] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 4181] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 4181] GPU 0 memory after del: 16.39 GB
[Step 4181] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 4181] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 4181] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 4181] Sequence length: 1024, Batch size: 2
[Step 4181] After KL computation - GPU 1: 40.50 GB
[Step 4181] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 4191] ========== MEMORY DEBUG ==========
[Step 4191] Model device: cuda:1
[Step 4191] Input device: cuda:1
[Step 4191] Teacher model device: cuda:0
[Step 4191] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 4191] GPU 1 memory: 33.76 GB (reserved: 47.60 GB)
[Step 4191] Student logits device: cuda:1, shape: torch.Size([2, 249, 151936]), dtype: torch.float32
[Step 4191] Student model device: cuda:1
[Step 4191] GPU 0 memory before teacher forward: 16.39 GB
[Step 4191] GPU 0 memory after moving inputs: 16.39 GB
[Step 4191] GPU 0 memory after teacher forward: 16.54 GB
[Step 4191] Teacher logits shape: torch.Size([2, 249, 151936]), dtype: torch.float16
[Step 4191] Teacher logits device before move: cuda:0
[Step 4191] Target device (student_logits.device): cuda:1
[Step 4191] GPU 0 memory after moving logits to GPU 1: 16.54 GB
[Step 4191] Teacher logits device after move: cuda:1, shape: torch.Size([2, 249, 151936])
[Step 4191] GPU 0 memory after del: 16.39 GB
[Step 4191] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 4191] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 35.27 GB
[Step 4191] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 4191] Sequence length: 249, Batch size: 2
[Step 4191] After KL computation - GPU 1: 35.87 GB
[Step 4191] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  3%|                                                                                  | 262/10000 [1:32:55<56:59:37, 21.07s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None

[Step 4201] ========== MEMORY DEBUG ==========
[Step 4201] Model device: cuda:1
[Step 4201] Input device: cuda:1
[Step 4201] Teacher model device: cuda:0
[Step 4201] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 4201] GPU 1 memory: 33.76 GB (reserved: 47.39 GB)
[Step 4201] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 4201] Student model device: cuda:1
[Step 4201] GPU 0 memory before teacher forward: 16.39 GB
[Step 4201] GPU 0 memory after moving inputs: 16.39 GB
[Step 4201] GPU 0 memory after teacher forward: 17.01 GB
[Step 4201] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 4201] Teacher logits device before move: cuda:0
[Step 4201] Target device (student_logits.device): cuda:1
[Step 4201] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 4201] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 4201] GPU 0 memory after del: 16.39 GB
[Step 4201] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 4201] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 4201] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 4201] Sequence length: 1024, Batch size: 2
[Step 4201] After KL computation - GPU 1: 40.50 GB
[Step 4201] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(
  3%|                                                                                  | 263/10000 [1:33:16<56:39:23, 20.95s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None

[Step 4211] ========== MEMORY DEBUG ==========
[Step 4211] Model device: cuda:1
[Step 4211] Input device: cuda:1
[Step 4211] Teacher model device: cuda:0
[Step 4211] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 4211] GPU 1 memory: 33.76 GB (reserved: 46.68 GB)
[Step 4211] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 4211] Student model device: cuda:1
[Step 4211] GPU 0 memory before teacher forward: 16.39 GB
[Step 4211] GPU 0 memory after moving inputs: 16.39 GB
[Step 4211] GPU 0 memory after teacher forward: 17.01 GB
[Step 4211] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 4211] Teacher logits device before move: cuda:0
[Step 4211] Target device (student_logits.device): cuda:1
[Step 4211] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 4211] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 4211] GPU 0 memory after del: 16.39 GB
[Step 4211] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 4211] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 4211] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 4211] Sequence length: 1024, Batch size: 2
[Step 4211] After KL computation - GPU 1: 40.50 GB
[Step 4211] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(

[Step 4221] ========== MEMORY DEBUG ==========
[Step 4221] Model device: cuda:1
[Step 4221] Input device: cuda:1
[Step 4221] Teacher model device: cuda:0
[Step 4221] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 4221] GPU 1 memory: 33.76 GB (reserved: 42.71 GB)
[Step 4221] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 4221] Student model device: cuda:1
[Step 4221] GPU 0 memory before teacher forward: 16.39 GB
[Step 4221] GPU 0 memory after moving inputs: 16.39 GB
[Step 4221] GPU 0 memory after teacher forward: 17.01 GB
[Step 4221] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 4221] Teacher logits device before move: cuda:0
[Step 4221] Target device (student_logits.device): cuda:1
[Step 4221] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 4221] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 4221] GPU 0 memory after del: 16.39 GB
[Step 4221] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 4221] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 4221] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 4221] Sequence length: 1024, Batch size: 2
[Step 4221] After KL computation - GPU 1: 40.50 GB
[Step 4221] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  3%|                                                                                  | 264/10000 [1:33:36<55:46:25, 20.62s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None

[Step 4231] ========== MEMORY DEBUG ==========
[Step 4231] Model device: cuda:1
[Step 4231] Input device: cuda:1
[Step 4231] Teacher model device: cuda:0
[Step 4231] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 4231] GPU 1 memory: 33.76 GB (reserved: 42.18 GB)
  warnings.warn(
[Step 4231] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 4231] Student model device: cuda:1
[Step 4231] GPU 0 memory before teacher forward: 16.39 GB
[Step 4231] GPU 0 memory after moving inputs: 16.39 GB
[Step 4231] GPU 0 memory after teacher forward: 17.01 GB
[Step 4231] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 4231] Teacher logits device before move: cuda:0
[Step 4231] Target device (student_logits.device): cuda:1
[Step 4231] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 4231] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 4231] GPU 0 memory after del: 16.39 GB
[Step 4231] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 4231] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 4231] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 4231] Sequence length: 1024, Batch size: 2
[Step 4231] After KL computation - GPU 1: 40.50 GB
[Step 4231] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  3%|                                                                                  | 265/10000 [1:33:57<55:56:55, 20.69s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None

[Step 4241] ========== MEMORY DEBUG ==========
[Step 4241] Model device: cuda:1
[Step 4241] Input device: cuda:1
[Step 4241] Teacher model device: cuda:0
[Step 4241] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 4241] GPU 1 memory: 25.33 GB (reserved: 44.31 GB)
[Step 4241] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 4241] Student model device: cuda:1
[Step 4241] GPU 0 memory before teacher forward: 16.39 GB
[Step 4241] GPU 0 memory after moving inputs: 16.39 GB
[Step 4241] GPU 0 memory after teacher forward: 17.01 GB
[Step 4241] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 4241] Teacher logits device before move: cuda:0
[Step 4241] Target device (student_logits.device): cuda:1
[Step 4241] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 4241] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 4241] GPU 0 memory after del: 16.39 GB
[Step 4241] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 4241] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 29.58 GB
[Step 4241] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 4241] Sequence length: 1024, Batch size: 2
[Step 4241] After KL computation - GPU 1: 32.07 GB
[Step 4241] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 4251] ========== MEMORY DEBUG ==========
[Step 4251] Model device: cuda:1
[Step 4251] Input device: cuda:1
[Step 4251] Teacher model device: cuda:0
[Step 4251] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 4251] GPU 1 memory: 33.76 GB (reserved: 46.37 GB)
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
[Step 4251] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 4251] Student model device: cuda:1
[Step 4251] GPU 0 memory before teacher forward: 16.39 GB
[Step 4251] GPU 0 memory after moving inputs: 16.39 GB
[Step 4251] GPU 0 memory after teacher forward: 17.01 GB
[Step 4251] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 4251] Teacher logits device before move: cuda:0
[Step 4251] Target device (student_logits.device): cuda:1
[Step 4251] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 4251] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 4251] GPU 0 memory after del: 16.39 GB
[Step 4251] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 4251] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 4251] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 4251] Sequence length: 1024, Batch size: 2
[Step 4251] After KL computation - GPU 1: 40.50 GB
[Step 4251] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  3%|                                                                                  | 266/10000 [1:34:17<55:29:03, 20.52s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None

[Step 4261] ========== MEMORY DEBUG ==========
[Step 4261] Model device: cuda:1
[Step 4261] Input device: cuda:1
[Step 4261] Teacher model device: cuda:0
[Step 4261] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 4261] GPU 1 memory: 33.76 GB (reserved: 47.00 GB)
[Step 4261] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 4261] Student model device: cuda:1
[Step 4261] GPU 0 memory before teacher forward: 16.39 GB
[Step 4261] GPU 0 memory after moving inputs: 16.39 GB
[Step 4261] GPU 0 memory after teacher forward: 17.01 GB
[Step 4261] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 4261] Teacher logits device before move: cuda:0
[Step 4261] Target device (student_logits.device): cuda:1
[Step 4261] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 4261] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 4261] GPU 0 memory after del: 16.39 GB
[Step 4261] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 4261] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 4261] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 4261] Sequence length: 1024, Batch size: 2
[Step 4261] After KL computation - GPU 1: 40.50 GB
[Step 4261] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(

[Step 4271] ========== MEMORY DEBUG ==========
[Step 4271] Model device: cuda:1
[Step 4271] Input device: cuda:1
[Step 4271] Teacher model device: cuda:0
[Step 4271] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 4271] GPU 1 memory: 33.76 GB (reserved: 38.77 GB)
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
[Step 4271] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 4271] Student model device: cuda:1
[Step 4271] GPU 0 memory before teacher forward: 16.39 GB
[Step 4271] GPU 0 memory after moving inputs: 16.39 GB
[Step 4271] GPU 0 memory after teacher forward: 17.01 GB
[Step 4271] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 4271] Teacher logits device before move: cuda:0
[Step 4271] Target device (student_logits.device): cuda:1
[Step 4271] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 4271] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 4271] GPU 0 memory after del: 16.39 GB
[Step 4271] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 4271] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 4271] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 4271] Sequence length: 1024, Batch size: 2
[Step 4271] After KL computation - GPU 1: 40.50 GB
[Step 4271] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  3%|                                                                                  | 268/10000 [1:34:58<55:39:48, 20.59s/it]

[Step 4281] ========== MEMORY DEBUG ==========
[Step 4281] Model device: cuda:1
[Step 4281] Input device: cuda:1
[Step 4281] Teacher model device: cuda:0
[Step 4281] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 4281] GPU 1 memory: 33.76 GB (reserved: 47.38 GB)
[Step 4281] Student logits device: cuda:1, shape: torch.Size([2, 958, 151936]), dtype: torch.float32
[Step 4281] Student model device: cuda:1
[Step 4281] GPU 0 memory before teacher forward: 16.39 GB
[Step 4281] GPU 0 memory after moving inputs: 16.39 GB
[Step 4281] GPU 0 memory after teacher forward: 16.98 GB
[Step 4281] Teacher logits shape: torch.Size([2, 958, 151936]), dtype: torch.float16
[Step 4281] Teacher logits device before move: cuda:0
[Step 4281] Target device (student_logits.device): cuda:1
[Step 4281] GPU 0 memory after moving logits to GPU 1: 16.98 GB
[Step 4281] Teacher logits device after move: cuda:1, shape: torch.Size([2, 958, 151936])
[Step 4281] GPU 0 memory after del: 16.39 GB
[Step 4281] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 4281] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 37.78 GB
[Step 4281] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 4281] Sequence length: 958, Batch size: 2
[Step 4281] After KL computation - GPU 1: 40.11 GB
[Step 4281] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 4291] ========== MEMORY DEBUG ==========
[Step 4291] Model device: cuda:1
[Step 4291] Input device: cuda:1
[Step 4291] Teacher model device: cuda:0
[Step 4291] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 4291] GPU 1 memory: 33.76 GB (reserved: 47.46 GB)
[Step 4291] Student logits device: cuda:1, shape: torch.Size([2, 838, 151936]), dtype: torch.float32
[Step 4291] Student model device: cuda:1
[Step 4291] GPU 0 memory before teacher forward: 16.39 GB
[Step 4291] GPU 0 memory after moving inputs: 16.39 GB
[Step 4291] GPU 0 memory after teacher forward: 16.90 GB
[Step 4291] Teacher logits shape: torch.Size([2, 838, 151936]), dtype: torch.float16
[Step 4291] Teacher logits device before move: cuda:0
[Step 4291] Target device (student_logits.device): cuda:1
[Step 4291] GPU 0 memory after moving logits to GPU 1: 16.90 GB
[Step 4291] Teacher logits device after move: cuda:1, shape: torch.Size([2, 838, 151936])
[Step 4291] GPU 0 memory after del: 16.39 GB
[Step 4291] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 4291] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 37.35 GB
[Step 4291] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 4291] Sequence length: 838, Batch size: 2
[Step 4291] After KL computation - GPU 1: 39.39 GB
[Step 4291] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(

[Step 4301] ========== MEMORY DEBUG ==========
[Step 4301] Model device: cuda:1
[Step 4301] Input device: cuda:1
[Step 4301] Teacher model device: cuda:0
[Step 4301] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 4301] GPU 1 memory: 33.76 GB (reserved: 47.41 GB)
[Step 4301] Student logits device: cuda:1, shape: torch.Size([2, 779, 151936]), dtype: torch.float32
[Step 4301] Student model device: cuda:1
[Step 4301] GPU 0 memory before teacher forward: 16.39 GB
[Step 4301] GPU 0 memory after moving inputs: 16.39 GB
[Step 4301] GPU 0 memory after teacher forward: 16.87 GB
[Step 4301] Teacher logits shape: torch.Size([2, 779, 151936]), dtype: torch.float16
[Step 4301] Teacher logits device before move: cuda:0
[Step 4301] Target device (student_logits.device): cuda:1
[Step 4301] GPU 0 memory after moving logits to GPU 1: 16.87 GB
[Step 4301] Teacher logits device after move: cuda:1, shape: torch.Size([2, 779, 151936])
[Step 4301] GPU 0 memory after del: 16.39 GB
[Step 4301] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 4301] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 37.15 GB
[Step 4301] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 4301] Sequence length: 779, Batch size: 2
[Step 4301] After KL computation - GPU 1: 39.04 GB
[Step 4301] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  3%|                                                                                  | 269/10000 [1:35:20<56:29:37, 20.90s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 4311] ========== MEMORY DEBUG ==========
[Step 4311] Model device: cuda:1
[Step 4311] Input device: cuda:1
[Step 4311] Teacher model device: cuda:0
[Step 4311] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 4311] GPU 1 memory: 33.76 GB (reserved: 47.47 GB)
[Step 4311] Student logits device: cuda:1, shape: torch.Size([2, 874, 151936]), dtype: torch.float32
[Step 4311] Student model device: cuda:1
[Step 4311] GPU 0 memory before teacher forward: 16.39 GB
[Step 4311] GPU 0 memory after moving inputs: 16.39 GB
[Step 4311] GPU 0 memory after teacher forward: 16.92 GB
[Step 4311] Teacher logits shape: torch.Size([2, 874, 151936]), dtype: torch.float16
[Step 4311] Teacher logits device before move: cuda:0
[Step 4311] Target device (student_logits.device): cuda:1
[Step 4311] GPU 0 memory after moving logits to GPU 1: 16.92 GB
[Step 4311] Teacher logits device after move: cuda:1, shape: torch.Size([2, 874, 151936])
[Step 4311] GPU 0 memory after del: 16.39 GB
[Step 4311] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 4311] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 37.48 GB
[Step 4311] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 4311] Sequence length: 874, Batch size: 2
[Step 4311] After KL computation - GPU 1: 39.61 GB
[Step 4311] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  3%|                                                                                  | 270/10000 [1:35:41<56:40:16, 20.97s/it]
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 4.914646464646465e-05, 'epoch': 0.03}

[Step 4321] ========== MEMORY DEBUG ==========
[Step 4321] Model device: cuda:1
[Step 4321] Input device: cuda:1
[Step 4321] Teacher model device: cuda:0
[Step 4321] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 4321] GPU 1 memory: 25.33 GB (reserved: 43.67 GB)
[Step 4321] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 4321] Student model device: cuda:1
[Step 4321] GPU 0 memory before teacher forward: 16.39 GB
[Step 4321] GPU 0 memory after moving inputs: 16.39 GB
[Step 4321] GPU 0 memory after teacher forward: 17.01 GB
[Step 4321] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 4321] Teacher logits device before move: cuda:0
[Step 4321] Target device (student_logits.device): cuda:1
[Step 4321] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 4321] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 4321] GPU 0 memory after del: 16.39 GB
[Step 4321] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 4321] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 29.58 GB
[Step 4321] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 4321] Sequence length: 1024, Batch size: 2
[Step 4321] After KL computation - GPU 1: 32.07 GB
[Step 4321] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 4331] ========== MEMORY DEBUG ==========
[Step 4331] Model device: cuda:1
[Step 4331] Input device: cuda:1
[Step 4331] Teacher model device: cuda:0
[Step 4331] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 4331] GPU 1 memory: 33.76 GB (reserved: 39.30 GB)
[Step 4331] Student logits device: cuda:1, shape: torch.Size([2, 467, 151936]), dtype: torch.float32
[Step 4331] Student model device: cuda:1
[Step 4331] GPU 0 memory before teacher forward: 16.39 GB
[Step 4331] GPU 0 memory after moving inputs: 16.39 GB
[Step 4331] GPU 0 memory after teacher forward: 16.68 GB
[Step 4331] Teacher logits shape: torch.Size([2, 467, 151936]), dtype: torch.float16
[Step 4331] Teacher logits device before move: cuda:0
[Step 4331] Target device (student_logits.device): cuda:1
[Step 4331] GPU 0 memory after moving logits to GPU 1: 16.68 GB
[Step 4331] Teacher logits device after move: cuda:1, shape: torch.Size([2, 467, 151936])
[Step 4331] GPU 0 memory after del: 16.39 GB
[Step 4331] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 4331] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 36.04 GB
[Step 4331] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 4331] Sequence length: 467, Batch size: 2
[Step 4331] After KL computation - GPU 1: 37.18 GB
[Step 4331] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 4341] ========== MEMORY DEBUG ==========
[Step 4341] Model device: cuda:1
[Step 4341] Input device: cuda:1
[Step 4341] Teacher model device: cuda:0
[Step 4341] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 4341] GPU 1 memory: 33.76 GB (reserved: 47.34 GB)
[Step 4341] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 4341] Student model device: cuda:1
[Step 4341] GPU 0 memory before teacher forward: 16.39 GB
[Step 4341] GPU 0 memory after moving inputs: 16.39 GB
[Step 4341] GPU 0 memory after teacher forward: 17.01 GB
[Step 4341] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 4341] Teacher logits device before move: cuda:0
[Step 4341] Target device (student_logits.device): cuda:1
[Step 4341] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 4341] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 4341] GPU 0 memory after del: 16.39 GB
[Step 4341] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 4341] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 4341] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 4341] Sequence length: 1024, Batch size: 2
[Step 4341] After KL computation - GPU 1: 40.50 GB
[Step 4341] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(

[Step 4351] ========== MEMORY DEBUG ==========
[Step 4351] Model device: cuda:1
[Step 4351] Input device: cuda:1
[Step 4351] Teacher model device: cuda:0
[Step 4351] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 4351] GPU 1 memory: 33.76 GB (reserved: 47.81 GB)
[Step 4351] Student logits device: cuda:1, shape: torch.Size([2, 731, 151936]), dtype: torch.float32
[Step 4351] Student model device: cuda:1
[Step 4351] GPU 0 memory before teacher forward: 16.39 GB
[Step 4351] GPU 0 memory after moving inputs: 16.39 GB
[Step 4351] GPU 0 memory after teacher forward: 16.84 GB
[Step 4351] Teacher logits shape: torch.Size([2, 731, 151936]), dtype: torch.float16
[Step 4351] Teacher logits device before move: cuda:0
[Step 4351] Target device (student_logits.device): cuda:1
[Step 4351] GPU 0 memory after moving logits to GPU 1: 16.84 GB
[Step 4351] Teacher logits device after move: cuda:1, shape: torch.Size([2, 731, 151936])
[Step 4351] GPU 0 memory after del: 16.39 GB
[Step 4351] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 4351] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 36.98 GB
[Step 4351] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 4351] Sequence length: 731, Batch size: 2
[Step 4351] After KL computation - GPU 1: 38.75 GB
[Step 4351] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  3%|                                                                                  | 273/10000 [1:36:40<54:15:46, 20.08s/it]

[Step 4361] ========== MEMORY DEBUG ==========
[Step 4361] Model device: cuda:1
[Step 4361] Input device: cuda:1
[Step 4361] Teacher model device: cuda:0
[Step 4361] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 4361] GPU 1 memory: 33.76 GB (reserved: 47.70 GB)
[Step 4361] Student logits device: cuda:1, shape: torch.Size([2, 826, 151936]), dtype: torch.float32
[Step 4361] Student model device: cuda:1
[Step 4361] GPU 0 memory before teacher forward: 16.39 GB
[Step 4361] GPU 0 memory after moving inputs: 16.39 GB
[Step 4361] GPU 0 memory after teacher forward: 16.89 GB
[Step 4361] Teacher logits shape: torch.Size([2, 826, 151936]), dtype: torch.float16
[Step 4361] Teacher logits device before move: cuda:0
[Step 4361] Target device (student_logits.device): cuda:1
[Step 4361] GPU 0 memory after moving logits to GPU 1: 16.89 GB
[Step 4361] Teacher logits device after move: cuda:1, shape: torch.Size([2, 826, 151936])
[Step 4361] GPU 0 memory after del: 16.39 GB
[Step 4361] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 4361] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 37.31 GB
[Step 4361] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 4361] Sequence length: 826, Batch size: 2
[Step 4361] After KL computation - GPU 1: 39.32 GB
[Step 4361] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 4371] ========== MEMORY DEBUG ==========
[Step 4371] Model device: cuda:1
[Step 4371] Input device: cuda:1
[Step 4371] Teacher model device: cuda:0
[Step 4371] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 4371] GPU 1 memory: 33.76 GB (reserved: 46.20 GB)
[Step 4371] Student logits device: cuda:1, shape: torch.Size([2, 818, 151936]), dtype: torch.float32
[Step 4371] Student model device: cuda:1
[Step 4371] GPU 0 memory before teacher forward: 16.39 GB
[Step 4371] GPU 0 memory after moving inputs: 16.39 GB
[Step 4371] GPU 0 memory after teacher forward: 16.89 GB
[Step 4371] Teacher logits shape: torch.Size([2, 818, 151936]), dtype: torch.float16
[Step 4371] Teacher logits device before move: cuda:0
[Step 4371] Target device (student_logits.device): cuda:1
[Step 4371] GPU 0 memory after moving logits to GPU 1: 16.89 GB
[Step 4371] Teacher logits device after move: cuda:1, shape: torch.Size([2, 818, 151936])
[Step 4371] GPU 0 memory after del: 16.39 GB
[Step 4371] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 4371] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 37.28 GB
[Step 4371] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 4371] Sequence length: 818, Batch size: 2
[Step 4371] After KL computation - GPU 1: 39.27 GB
[Step 4371] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 4381] ========== MEMORY DEBUG ==========
[Step 4381] Model device: cuda:1
[Step 4381] Input device: cuda:1
[Step 4381] Teacher model device: cuda:0
[Step 4381] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 4381] GPU 1 memory: 33.76 GB (reserved: 46.06 GB)
[Step 4381] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 4381] Student model device: cuda:1
[Step 4381] GPU 0 memory before teacher forward: 16.39 GB
[Step 4381] GPU 0 memory after moving inputs: 16.39 GB
[Step 4381] GPU 0 memory after teacher forward: 17.01 GB
[Step 4381] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 4381] Teacher logits device before move: cuda:0
[Step 4381] Target device (student_logits.device): cuda:1
[Step 4381] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 4381] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 4381] GPU 0 memory after del: 16.39 GB
[Step 4381] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 4381] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.02 GB
[Step 4381] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 4381] Sequence length: 1024, Batch size: 2
[Step 4381] After KL computation - GPU 1: 40.51 GB
[Step 4381] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 4391] ========== MEMORY DEBUG ==========
[Step 4391] Model device: cuda:1
[Step 4391] Input device: cuda:1
[Step 4391] Teacher model device: cuda:0
[Step 4391] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 4391] GPU 1 memory: 33.76 GB (reserved: 47.50 GB)
[Step 4391] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 4391] Student model device: cuda:1
[Step 4391] GPU 0 memory before teacher forward: 16.39 GB
[Step 4391] GPU 0 memory after moving inputs: 16.39 GB
[Step 4391] GPU 0 memory after teacher forward: 17.01 GB
[Step 4391] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 4391] Teacher logits device before move: cuda:0
[Step 4391] Target device (student_logits.device): cuda:1
[Step 4391] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 4391] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 4391] GPU 0 memory after del: 16.39 GB
[Step 4391] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 4391] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 4391] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 4391] Sequence length: 1024, Batch size: 2
[Step 4391] After KL computation - GPU 1: 40.50 GB
[Step 4391] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(
  3%|                                                                                  | 275/10000 [1:37:22<56:02:43, 20.75s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None

[Step 4401] ========== MEMORY DEBUG ==========
[Step 4401] Model device: cuda:1
[Step 4401] Input device: cuda:1
[Step 4401] Teacher model device: cuda:0
[Step 4401] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 4401] GPU 1 memory: 25.33 GB (reserved: 44.16 GB)
[Step 4401] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 4401] Student model device: cuda:1
[Step 4401] GPU 0 memory before teacher forward: 16.39 GB
[Step 4401] GPU 0 memory after moving inputs: 16.39 GB
[Step 4401] GPU 0 memory after teacher forward: 17.01 GB
[Step 4401] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 4401] Teacher logits device before move: cuda:0
[Step 4401] Target device (student_logits.device): cuda:1
[Step 4401] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 4401] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 4401] GPU 0 memory after del: 16.39 GB
[Step 4401] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 4401] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 29.58 GB
[Step 4401] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 4401] Sequence length: 1024, Batch size: 2
[Step 4401] After KL computation - GPU 1: 32.07 GB
[Step 4401] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(

[Step 4411] ========== MEMORY DEBUG ==========
[Step 4411] Model device: cuda:1
[Step 4411] Input device: cuda:1
[Step 4411] Teacher model device: cuda:0
[Step 4411] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 4411] GPU 1 memory: 33.76 GB (reserved: 47.30 GB)
[Step 4411] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 4411] Student model device: cuda:1
[Step 4411] GPU 0 memory before teacher forward: 16.39 GB
[Step 4411] GPU 0 memory after moving inputs: 16.39 GB
[Step 4411] GPU 0 memory after teacher forward: 17.01 GB
[Step 4411] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 4411] Teacher logits device before move: cuda:0
[Step 4411] Target device (student_logits.device): cuda:1
[Step 4411] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 4411] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 4411] GPU 0 memory after del: 16.39 GB
[Step 4411] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 4411] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 4411] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 4411] Sequence length: 1024, Batch size: 2
[Step 4411] After KL computation - GPU 1: 40.50 GB
[Step 4411] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  3%|                                                                                  | 276/10000 [1:37:45<57:20:28, 21.23s/it]

[Step 4421] ========== MEMORY DEBUG ==========
[Step 4421] Model device: cuda:1
[Step 4421] Input device: cuda:1
[Step 4421] Teacher model device: cuda:0
[Step 4421] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 4421] GPU 1 memory: 33.76 GB (reserved: 42.25 GB)
[Step 4421] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 4421] Student model device: cuda:1
[Step 4421] GPU 0 memory before teacher forward: 16.39 GB
[Step 4421] GPU 0 memory after moving inputs: 16.39 GB
[Step 4421] GPU 0 memory after teacher forward: 17.01 GB
[Step 4421] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 4421] Teacher logits device before move: cuda:0
[Step 4421] Target device (student_logits.device): cuda:1
[Step 4421] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 4421] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 4421] GPU 0 memory after del: 16.39 GB
[Step 4421] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 4421] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 4421] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 4421] Sequence length: 1024, Batch size: 2
[Step 4421] After KL computation - GPU 1: 40.50 GB
[Step 4421] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 4431] ========== MEMORY DEBUG ==========
[Step 4431] Model device: cuda:1
[Step 4431] Input device: cuda:1
[Step 4431] Teacher model device: cuda:0
[Step 4431] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 4431] GPU 1 memory: 33.76 GB (reserved: 47.68 GB)
[Step 4431] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 4431] Student model device: cuda:1
[Step 4431] GPU 0 memory before teacher forward: 16.39 GB
[Step 4431] GPU 0 memory after moving inputs: 16.39 GB
[Step 4431] GPU 0 memory after teacher forward: 17.01 GB
[Step 4431] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 4431] Teacher logits device before move: cuda:0
[Step 4431] Target device (student_logits.device): cuda:1
[Step 4431] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 4431] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 4431] GPU 0 memory after del: 16.39 GB
[Step 4431] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 4431] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 4431] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 4431] Sequence length: 1024, Batch size: 2
[Step 4431] After KL computation - GPU 1: 40.50 GB
[Step 4431] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 4441] ========== MEMORY DEBUG ==========
[Step 4441] Model device: cuda:1
[Step 4441] Input device: cuda:1
[Step 4441] Teacher model device: cuda:0
[Step 4441] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 4441] GPU 1 memory: 33.76 GB (reserved: 44.64 GB)
[Step 4441] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 4441] Student model device: cuda:1
[Step 4441] GPU 0 memory before teacher forward: 16.39 GB
[Step 4441] GPU 0 memory after moving inputs: 16.39 GB
[Step 4441] GPU 0 memory after teacher forward: 17.01 GB
[Step 4441] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 4441] Teacher logits device before move: cuda:0
[Step 4441] Target device (student_logits.device): cuda:1
[Step 4441] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 4441] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 4441] GPU 0 memory after del: 16.39 GB
[Step 4441] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 4441] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 4441] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 4441] Sequence length: 1024, Batch size: 2
[Step 4441] After KL computation - GPU 1: 40.50 GB
[Step 4441] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 4451] ========== MEMORY DEBUG ==========
[Step 4451] Model device: cuda:1
[Step 4451] Input device: cuda:1
[Step 4451] Teacher model device: cuda:0
[Step 4451] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 4451] GPU 1 memory: 33.76 GB (reserved: 47.34 GB)
[Step 4451] Student logits device: cuda:1, shape: torch.Size([2, 844, 151936]), dtype: torch.float32
[Step 4451] Student model device: cuda:1
[Step 4451] GPU 0 memory before teacher forward: 16.39 GB
[Step 4451] GPU 0 memory after moving inputs: 16.39 GB
[Step 4451] GPU 0 memory after teacher forward: 16.91 GB
[Step 4451] Teacher logits shape: torch.Size([2, 844, 151936]), dtype: torch.float16
[Step 4451] Teacher logits device before move: cuda:0
[Step 4451] Target device (student_logits.device): cuda:1
[Step 4451] GPU 0 memory after moving logits to GPU 1: 16.91 GB
[Step 4451] Teacher logits device after move: cuda:1, shape: torch.Size([2, 844, 151936])
[Step 4451] GPU 0 memory after del: 16.39 GB
[Step 4451] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 4451] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 37.37 GB
[Step 4451] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 4451] Sequence length: 844, Batch size: 2
[Step 4451] After KL computation - GPU 1: 39.43 GB
[Step 4451] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(

[Step 4461] ========== MEMORY DEBUG ==========
[Step 4461] Model device: cuda:1
[Step 4461] Input device: cuda:1
[Step 4461] Teacher model device: cuda:0
[Step 4461] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 4461] GPU 1 memory: 33.76 GB (reserved: 47.35 GB)
[Step 4461] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 4461] Student model device: cuda:1
[Step 4461] GPU 0 memory before teacher forward: 16.39 GB
[Step 4461] GPU 0 memory after moving inputs: 16.39 GB
[Step 4461] GPU 0 memory after teacher forward: 17.01 GB
[Step 4461] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 4461] Teacher logits device before move: cuda:0
[Step 4461] Target device (student_logits.device): cuda:1
[Step 4461] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 4461] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 4461] GPU 0 memory after del: 16.39 GB
[Step 4461] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 4461] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 4461] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 4461] Sequence length: 1024, Batch size: 2
[Step 4461] After KL computation - GPU 1: 40.50 GB
[Step 4461] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  3%|                                                                                  | 280/10000 [1:39:07<55:56:44, 20.72s/it]

[Step 4471] ========== MEMORY DEBUG ==========
[Step 4471] Model device: cuda:1
[Step 4471] Input device: cuda:1
[Step 4471] Teacher model device: cuda:0
[Step 4471] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 4471] GPU 1 memory: 33.76 GB (reserved: 43.79 GB)
[Step 4471] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 4471] Student model device: cuda:1
[Step 4471] GPU 0 memory before teacher forward: 16.39 GB
[Step 4471] GPU 0 memory after moving inputs: 16.39 GB
[Step 4471] GPU 0 memory after teacher forward: 17.01 GB
[Step 4471] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 4471] Teacher logits device before move: cuda:0
[Step 4471] Target device (student_logits.device): cuda:1
[Step 4471] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 4471] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 4471] GPU 0 memory after del: 16.39 GB
[Step 4471] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 4471] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 4471] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 4471] Sequence length: 1024, Batch size: 2
[Step 4471] After KL computation - GPU 1: 40.50 GB
[Step 4471] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 4.90959595959596e-05, 'epoch': 0.03}

[Step 4481] ========== MEMORY DEBUG ==========
[Step 4481] Model device: cuda:1
[Step 4481] Input device: cuda:1
[Step 4481] Teacher model device: cuda:0
[Step 4481] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 4481] GPU 1 memory: 25.33 GB (reserved: 47.76 GB)
[Step 4481] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 4481] Student model device: cuda:1
[Step 4481] GPU 0 memory before teacher forward: 16.39 GB
[Step 4481] GPU 0 memory after moving inputs: 16.39 GB
[Step 4481] GPU 0 memory after teacher forward: 17.01 GB
[Step 4481] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 4481] Teacher logits device before move: cuda:0
[Step 4481] Target device (student_logits.device): cuda:1
[Step 4481] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 4481] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 4481] GPU 0 memory after del: 16.39 GB
[Step 4481] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 4481] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 29.58 GB
[Step 4481] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 4481] Sequence length: 1024, Batch size: 2
[Step 4481] After KL computation - GPU 1: 32.06 GB
[Step 4481] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 4491] ========== MEMORY DEBUG ==========
[Step 4491] Model device: cuda:1
[Step 4491] Input device: cuda:1
[Step 4491] Teacher model device: cuda:0
[Step 4491] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 4491] GPU 1 memory: 33.76 GB (reserved: 45.58 GB)
[Step 4491] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 4491] Student model device: cuda:1
[Step 4491] GPU 0 memory before teacher forward: 16.39 GB
[Step 4491] GPU 0 memory after moving inputs: 16.39 GB
[Step 4491] GPU 0 memory after teacher forward: 17.01 GB
[Step 4491] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 4491] Teacher logits device before move: cuda:0
[Step 4491] Target device (student_logits.device): cuda:1
[Step 4491] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 4491] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 4491] GPU 0 memory after del: 16.39 GB
[Step 4491] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 4491] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 4491] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 4491] Sequence length: 1024, Batch size: 2
[Step 4491] After KL computation - GPU 1: 40.50 GB
[Step 4491] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  3%|                                                                                  | 281/10000 [1:39:28<56:21:14, 20.87s/it]

[Step 4501] ========== MEMORY DEBUG ==========
[Step 4501] Model device: cuda:1
[Step 4501] Input device: cuda:1
[Step 4501] Teacher model device: cuda:0
[Step 4501] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 4501] GPU 1 memory: 33.77 GB (reserved: 44.36 GB)
[Step 4501] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 4501] Student model device: cuda:1
[Step 4501] GPU 0 memory before teacher forward: 16.39 GB
[Step 4501] GPU 0 memory after moving inputs: 16.39 GB
[Step 4501] GPU 0 memory after teacher forward: 17.01 GB
[Step 4501] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 4501] Teacher logits device before move: cuda:0
[Step 4501] Target device (student_logits.device): cuda:1
[Step 4501] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 4501] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 4501] GPU 0 memory after del: 16.39 GB
[Step 4501] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 4501] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.02 GB
[Step 4501] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 4501] Sequence length: 1024, Batch size: 2
[Step 4501] After KL computation - GPU 1: 40.51 GB
[Step 4501] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 4511] ========== MEMORY DEBUG ==========
[Step 4511] Model device: cuda:1
[Step 4511] Input device: cuda:1
[Step 4511] Teacher model device: cuda:0
[Step 4511] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 4511] GPU 1 memory: 33.77 GB (reserved: 47.26 GB)
[Step 4511] Student logits device: cuda:1, shape: torch.Size([2, 735, 151936]), dtype: torch.float32
[Step 4511] Student model device: cuda:1
[Step 4511] GPU 0 memory before teacher forward: 16.39 GB
[Step 4511] GPU 0 memory after moving inputs: 16.39 GB
[Step 4511] GPU 0 memory after teacher forward: 16.84 GB
[Step 4511] Teacher logits shape: torch.Size([2, 735, 151936]), dtype: torch.float16
[Step 4511] Teacher logits device before move: cuda:0
[Step 4511] Target device (student_logits.device): cuda:1
[Step 4511] GPU 0 memory after moving logits to GPU 1: 16.84 GB
[Step 4511] Teacher logits device after move: cuda:1, shape: torch.Size([2, 735, 151936])
[Step 4511] GPU 0 memory after del: 16.39 GB
[Step 4511] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 4511] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 36.99 GB
[Step 4511] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 4511] Sequence length: 735, Batch size: 2
[Step 4511] After KL computation - GPU 1: 38.78 GB
[Step 4511] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(
  3%|                                                                                  | 282/10000 [1:39:52<58:30:29, 21.67s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None

[Step 4521] ========== MEMORY DEBUG ==========
[Step 4521] Model device: cuda:1
[Step 4521] Input device: cuda:1
[Step 4521] Teacher model device: cuda:0
[Step 4521] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 4521] GPU 1 memory: 33.76 GB (reserved: 46.30 GB)
[Step 4521] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 4521] Student model device: cuda:1
[Step 4521] GPU 0 memory before teacher forward: 16.39 GB
[Step 4521] GPU 0 memory after moving inputs: 16.39 GB
[Step 4521] GPU 0 memory after teacher forward: 17.01 GB
[Step 4521] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 4521] Teacher logits device before move: cuda:0
[Step 4521] Target device (student_logits.device): cuda:1
[Step 4521] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 4521] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 4521] GPU 0 memory after del: 16.39 GB
[Step 4521] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 4521] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 4521] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 4521] Sequence length: 1024, Batch size: 2
[Step 4521] After KL computation - GPU 1: 40.50 GB
[Step 4521] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(
  3%|                                                                                  | 283/10000 [1:40:13<58:08:49, 21.54s/it]

[Step 4531] ========== MEMORY DEBUG ==========
[Step 4531] Model device: cuda:1
[Step 4531] Input device: cuda:1
[Step 4531] Teacher model device: cuda:0
[Step 4531] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 4531] GPU 1 memory: 33.76 GB (reserved: 43.54 GB)
[Step 4531] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 4531] Student model device: cuda:1
[Step 4531] GPU 0 memory before teacher forward: 16.39 GB
[Step 4531] GPU 0 memory after moving inputs: 16.39 GB
[Step 4531] GPU 0 memory after teacher forward: 17.01 GB
[Step 4531] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 4531] Teacher logits device before move: cuda:0
[Step 4531] Target device (student_logits.device): cuda:1
[Step 4531] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 4531] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 4531] GPU 0 memory after del: 16.39 GB
[Step 4531] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 4531] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 4531] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 4531] Sequence length: 1024, Batch size: 2
[Step 4531] After KL computation - GPU 1: 40.50 GB
[Step 4531] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 4541] ========== MEMORY DEBUG ==========
[Step 4541] Model device: cuda:1
[Step 4541] Input device: cuda:1
[Step 4541] Teacher model device: cuda:0
[Step 4541] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 4541] GPU 1 memory: 33.76 GB (reserved: 47.75 GB)
[Step 4541] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 4541] Student model device: cuda:1
[Step 4541] GPU 0 memory before teacher forward: 16.39 GB
[Step 4541] GPU 0 memory after moving inputs: 16.39 GB
[Step 4541] GPU 0 memory after teacher forward: 17.01 GB
[Step 4541] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 4541] Teacher logits device before move: cuda:0
[Step 4541] Target device (student_logits.device): cuda:1
[Step 4541] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 4541] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 4541] GPU 0 memory after del: 16.39 GB
[Step 4541] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 4541] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 4541] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 4541] Sequence length: 1024, Batch size: 2
[Step 4541] After KL computation - GPU 1: 40.50 GB
[Step 4541] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 4551] ========== MEMORY DEBUG ==========
[Step 4551] Model device: cuda:1
[Step 4551] Input device: cuda:1
[Step 4551] Teacher model device: cuda:0
[Step 4551] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 4551] GPU 1 memory: 33.76 GB (reserved: 44.26 GB)
[Step 4551] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 4551] Student model device: cuda:1
[Step 4551] GPU 0 memory before teacher forward: 16.39 GB
[Step 4551] GPU 0 memory after moving inputs: 16.39 GB
[Step 4551] GPU 0 memory after teacher forward: 17.01 GB
[Step 4551] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 4551] Teacher logits device before move: cuda:0
[Step 4551] Target device (student_logits.device): cuda:1
[Step 4551] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 4551] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 4551] GPU 0 memory after del: 16.39 GB
[Step 4551] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 4551] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 4551] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 4551] Sequence length: 1024, Batch size: 2
[Step 4551] After KL computation - GPU 1: 40.50 GB
[Step 4551] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(
  3%|                                                                                  | 285/10000 [1:40:57<58:52:07, 21.81s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None

[Step 4561] ========== MEMORY DEBUG ==========
[Step 4561] Model device: cuda:1
[Step 4561] Input device: cuda:1
[Step 4561] Teacher model device: cuda:0
[Step 4561] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 4561] GPU 1 memory: 25.33 GB (reserved: 44.72 GB)
[Step 4561] Student logits device: cuda:1, shape: torch.Size([2, 276, 151936]), dtype: torch.float32
[Step 4561] Student model device: cuda:1
[Step 4561] GPU 0 memory before teacher forward: 16.39 GB
[Step 4561] GPU 0 memory after moving inputs: 16.39 GB
[Step 4561] GPU 0 memory after teacher forward: 16.56 GB
[Step 4561] Teacher logits shape: torch.Size([2, 276, 151936]), dtype: torch.float16
[Step 4561] Teacher logits device before move: cuda:0
[Step 4561] Target device (student_logits.device): cuda:1
[Step 4561] GPU 0 memory after moving logits to GPU 1: 16.56 GB
[Step 4561] Teacher logits device after move: cuda:1, shape: torch.Size([2, 276, 151936])
[Step 4561] GPU 0 memory after del: 16.39 GB
[Step 4561] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 4561] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 26.93 GB
[Step 4561] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 4561] Sequence length: 276, Batch size: 2
[Step 4561] After KL computation - GPU 1: 27.60 GB
[Step 4561] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(

[Step 4571] ========== MEMORY DEBUG ==========
[Step 4571] Model device: cuda:1
[Step 4571] Input device: cuda:1
[Step 4571] Teacher model device: cuda:0
[Step 4571] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 4571] GPU 1 memory: 33.76 GB (reserved: 48.10 GB)
[Step 4571] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 4571] Student model device: cuda:1
[Step 4571] GPU 0 memory before teacher forward: 16.39 GB
[Step 4571] GPU 0 memory after moving inputs: 16.39 GB
[Step 4571] GPU 0 memory after teacher forward: 17.01 GB
[Step 4571] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 4571] Teacher logits device before move: cuda:0
[Step 4571] Target device (student_logits.device): cuda:1
[Step 4571] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 4571] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 4571] GPU 0 memory after del: 16.39 GB
[Step 4571] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 4571] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.02 GB
[Step 4571] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 4571] Sequence length: 1024, Batch size: 2
[Step 4571] After KL computation - GPU 1: 40.50 GB
[Step 4571] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  3%|                                                                                  | 286/10000 [1:41:17<57:17:24, 21.23s/it]

[Step 4581] ========== MEMORY DEBUG ==========
[Step 4581] Model device: cuda:1
[Step 4581] Input device: cuda:1
[Step 4581] Teacher model device: cuda:0
[Step 4581] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 4581] GPU 1 memory: 33.76 GB (reserved: 47.37 GB)
[Step 4581] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 4581] Student model device: cuda:1
[Step 4581] GPU 0 memory before teacher forward: 16.39 GB
[Step 4581] GPU 0 memory after moving inputs: 16.39 GB
[Step 4581] GPU 0 memory after teacher forward: 17.01 GB
[Step 4581] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 4581] Teacher logits device before move: cuda:0
[Step 4581] Target device (student_logits.device): cuda:1
[Step 4581] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 4581] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 4581] GPU 0 memory after del: 16.39 GB
[Step 4581] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 4581] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 4581] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 4581] Sequence length: 1024, Batch size: 2
[Step 4581] After KL computation - GPU 1: 40.50 GB
[Step 4581] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 4591] ========== MEMORY DEBUG ==========
[Step 4591] Model device: cuda:1
[Step 4591] Input device: cuda:1
[Step 4591] Teacher model device: cuda:0
[Step 4591] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 4591] GPU 1 memory: 33.76 GB (reserved: 47.37 GB)
[Step 4591] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 4591] Student model device: cuda:1
[Step 4591] GPU 0 memory before teacher forward: 16.39 GB
[Step 4591] GPU 0 memory after moving inputs: 16.39 GB
[Step 4591] GPU 0 memory after teacher forward: 17.01 GB
[Step 4591] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 4591] Teacher logits device before move: cuda:0
[Step 4591] Target device (student_logits.device): cuda:1
[Step 4591] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 4591] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 4591] GPU 0 memory after del: 16.39 GB
[Step 4591] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 4591] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 4591] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 4591] Sequence length: 1024, Batch size: 2
[Step 4591] After KL computation - GPU 1: 40.50 GB
[Step 4591] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 4601] ========== MEMORY DEBUG ==========
[Step 4601] Model device: cuda:1
[Step 4601] Input device: cuda:1
[Step 4601] Teacher model device: cuda:0
[Step 4601] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 4601] GPU 1 memory: 33.76 GB (reserved: 47.84 GB)
  warnings.warn(
[Step 4601] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 4601] Student model device: cuda:1
[Step 4601] GPU 0 memory before teacher forward: 16.39 GB
[Step 4601] GPU 0 memory after moving inputs: 16.39 GB
[Step 4601] GPU 0 memory after teacher forward: 17.01 GB
[Step 4601] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 4601] Teacher logits device before move: cuda:0
[Step 4601] Target device (student_logits.device): cuda:1
[Step 4601] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 4601] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 4601] GPU 0 memory after del: 16.39 GB
[Step 4601] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 4601] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 4601] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 4601] Sequence length: 1024, Batch size: 2
[Step 4601] After KL computation - GPU 1: 40.50 GB
[Step 4601] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  3%|                                                                                  | 288/10000 [1:42:00<56:52:31, 21.08s/it]

[Step 4611] ========== MEMORY DEBUG ==========
[Step 4611] Model device: cuda:1
[Step 4611] Input device: cuda:1
[Step 4611] Teacher model device: cuda:0
[Step 4611] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 4611] GPU 1 memory: 33.76 GB (reserved: 44.85 GB)
[Step 4611] Student logits device: cuda:1, shape: torch.Size([2, 658, 151936]), dtype: torch.float32
[Step 4611] Student model device: cuda:1
[Step 4611] GPU 0 memory before teacher forward: 16.39 GB
[Step 4611] GPU 0 memory after moving inputs: 16.39 GB
[Step 4611] GPU 0 memory after teacher forward: 16.79 GB
[Step 4611] Teacher logits shape: torch.Size([2, 658, 151936]), dtype: torch.float16
[Step 4611] Teacher logits device before move: cuda:0
[Step 4611] Target device (student_logits.device): cuda:1
[Step 4611] GPU 0 memory after moving logits to GPU 1: 16.79 GB
[Step 4611] Teacher logits device after move: cuda:1, shape: torch.Size([2, 658, 151936])
[Step 4611] GPU 0 memory after del: 16.39 GB
[Step 4611] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 4611] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 36.72 GB
[Step 4611] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 4611] Sequence length: 658, Batch size: 2
[Step 4611] After KL computation - GPU 1: 38.32 GB
[Step 4611] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 4621] ========== MEMORY DEBUG ==========
[Step 4621] Model device: cuda:1
[Step 4621] Input device: cuda:1
[Step 4621] Teacher model device: cuda:0
[Step 4621] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 4621] GPU 1 memory: 33.76 GB (reserved: 48.00 GB)
[Step 4621] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 4621] Student model device: cuda:1
[Step 4621] GPU 0 memory before teacher forward: 16.39 GB
[Step 4621] GPU 0 memory after moving inputs: 16.39 GB
[Step 4621] GPU 0 memory after teacher forward: 17.01 GB
[Step 4621] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 4621] Teacher logits device before move: cuda:0
[Step 4621] Target device (student_logits.device): cuda:1
[Step 4621] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 4621] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 4621] GPU 0 memory after del: 16.39 GB
[Step 4621] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 4621] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 4621] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 4621] Sequence length: 1024, Batch size: 2
[Step 4621] After KL computation - GPU 1: 40.50 GB
[Step 4621] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 4631] ========== MEMORY DEBUG ==========
[Step 4631] Model device: cuda:1
[Step 4631] Input device: cuda:1
[Step 4631] Teacher model device: cuda:0
[Step 4631] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 4631] GPU 1 memory: 33.76 GB (reserved: 47.62 GB)
[Step 4631] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 4631] Student model device: cuda:1
[Step 4631] GPU 0 memory before teacher forward: 16.39 GB
[Step 4631] GPU 0 memory after moving inputs: 16.39 GB
[Step 4631] GPU 0 memory after teacher forward: 17.01 GB
[Step 4631] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 4631] Teacher logits device before move: cuda:0
[Step 4631] Target device (student_logits.device): cuda:1
[Step 4631] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 4631] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 4631] GPU 0 memory after del: 16.39 GB
[Step 4631] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 4631] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 4631] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 4631] Sequence length: 1024, Batch size: 2
[Step 4631] After KL computation - GPU 1: 40.50 GB
[Step 4631] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 4.904545454545455e-05, 'epoch': 0.03}

[Step 4641] ========== MEMORY DEBUG ==========
[Step 4641] Model device: cuda:1
[Step 4641] Input device: cuda:1
[Step 4641] Teacher model device: cuda:0
[Step 4641] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 4641] GPU 1 memory: 25.33 GB (reserved: 45.31 GB)
[Step 4641] Student logits device: cuda:1, shape: torch.Size([2, 601, 151936]), dtype: torch.float32
[Step 4641] Student model device: cuda:1
[Step 4641] GPU 0 memory before teacher forward: 16.39 GB
[Step 4641] GPU 0 memory after moving inputs: 16.39 GB
[Step 4641] GPU 0 memory after teacher forward: 16.76 GB
[Step 4641] Teacher logits shape: torch.Size([2, 601, 151936]), dtype: torch.float16
[Step 4641] Teacher logits device before move: cuda:0
[Step 4641] Target device (student_logits.device): cuda:1
[Step 4641] GPU 0 memory after moving logits to GPU 1: 16.76 GB
[Step 4641] Teacher logits device after move: cuda:1, shape: torch.Size([2, 601, 151936])
[Step 4641] GPU 0 memory after del: 16.39 GB
[Step 4641] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 4641] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 28.08 GB
[Step 4641] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 4641] Sequence length: 601, Batch size: 2
[Step 4641] After KL computation - GPU 1: 29.54 GB
[Step 4641] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 4651] ========== MEMORY DEBUG ==========
[Step 4651] Model device: cuda:1
[Step 4651] Input device: cuda:1
[Step 4651] Teacher model device: cuda:0
[Step 4651] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 4651] GPU 1 memory: 33.77 GB (reserved: 47.81 GB)
[Step 4651] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 4651] Student model device: cuda:1
[Step 4651] GPU 0 memory before teacher forward: 16.39 GB
[Step 4651] GPU 0 memory after moving inputs: 16.39 GB
[Step 4651] GPU 0 memory after teacher forward: 17.01 GB
[Step 4651] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 4651] Teacher logits device before move: cuda:0
[Step 4651] Target device (student_logits.device): cuda:1
[Step 4651] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 4651] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 4651] GPU 0 memory after del: 16.39 GB
[Step 4651] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 4651] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.02 GB
[Step 4651] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 4651] Sequence length: 1024, Batch size: 2
[Step 4651] After KL computation - GPU 1: 40.51 GB
[Step 4651] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(

[Step 4661] ========== MEMORY DEBUG ==========
[Step 4661] Model device: cuda:1
[Step 4661] Input device: cuda:1
[Step 4661] Teacher model device: cuda:0
[Step 4661] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 4661] GPU 1 memory: 33.76 GB (reserved: 47.82 GB)
[Step 4661] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 4661] Student model device: cuda:1
[Step 4661] GPU 0 memory before teacher forward: 16.39 GB
[Step 4661] GPU 0 memory after moving inputs: 16.39 GB
[Step 4661] GPU 0 memory after teacher forward: 17.01 GB
[Step 4661] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 4661] Teacher logits device before move: cuda:0
[Step 4661] Target device (student_logits.device): cuda:1
[Step 4661] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 4661] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 4661] GPU 0 memory after del: 16.39 GB
[Step 4661] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 4661] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 4661] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 4661] Sequence length: 1024, Batch size: 2
[Step 4661] After KL computation - GPU 1: 40.50 GB
[Step 4661] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 4671] ========== MEMORY DEBUG ==========
[Step 4671] Model device: cuda:1
[Step 4671] Input device: cuda:1
[Step 4671] Teacher model device: cuda:0
[Step 4671] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 4671] GPU 1 memory: 33.76 GB (reserved: 46.85 GB)
[Step 4671] Student logits device: cuda:1, shape: torch.Size([2, 308, 151936]), dtype: torch.float32
[Step 4671] Student model device: cuda:1
[Step 4671] GPU 0 memory before teacher forward: 16.39 GB
[Step 4671] GPU 0 memory after moving inputs: 16.39 GB
[Step 4671] GPU 0 memory after teacher forward: 16.58 GB
[Step 4671] Teacher logits shape: torch.Size([2, 308, 151936]), dtype: torch.float16
[Step 4671] Teacher logits device before move: cuda:0
[Step 4671] Target device (student_logits.device): cuda:1
[Step 4671] GPU 0 memory after moving logits to GPU 1: 16.58 GB
[Step 4671] Teacher logits device after move: cuda:1, shape: torch.Size([2, 308, 151936])
[Step 4671] GPU 0 memory after del: 16.39 GB
[Step 4671] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 4671] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 35.49 GB
[Step 4671] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 4671] Sequence length: 308, Batch size: 2
[Step 4671] After KL computation - GPU 1: 36.24 GB
[Step 4671] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  3%|                                                                                  | 293/10000 [1:43:45<56:51:38, 21.09s/it]

[Step 4681] ========== MEMORY DEBUG ==========
[Step 4681] Model device: cuda:1
[Step 4681] Input device: cuda:1
[Step 4681] Teacher model device: cuda:0
[Step 4681] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 4681] GPU 1 memory: 33.76 GB (reserved: 47.53 GB)
[Step 4681] Student logits device: cuda:1, shape: torch.Size([2, 480, 151936]), dtype: torch.float32
[Step 4681] Student model device: cuda:1
[Step 4681] GPU 0 memory before teacher forward: 16.39 GB
[Step 4681] GPU 0 memory after moving inputs: 16.39 GB
[Step 4681] GPU 0 memory after teacher forward: 16.68 GB
[Step 4681] Teacher logits shape: torch.Size([2, 480, 151936]), dtype: torch.float16
[Step 4681] Teacher logits device before move: cuda:0
[Step 4681] Target device (student_logits.device): cuda:1
[Step 4681] GPU 0 memory after moving logits to GPU 1: 16.68 GB
[Step 4681] Teacher logits device after move: cuda:1, shape: torch.Size([2, 480, 151936])
[Step 4681] GPU 0 memory after del: 16.39 GB
[Step 4681] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 4681] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 36.09 GB
[Step 4681] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 4681] Sequence length: 480, Batch size: 2
[Step 4681] After KL computation - GPU 1: 37.25 GB
[Step 4681] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 4691] ========== MEMORY DEBUG ==========
[Step 4691] Model device: cuda:1
[Step 4691] Input device: cuda:1
[Step 4691] Teacher model device: cuda:0
[Step 4691] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 4691] GPU 1 memory: 33.76 GB (reserved: 46.37 GB)
[Step 4691] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 4691] Student model device: cuda:1
[Step 4691] GPU 0 memory before teacher forward: 16.39 GB
[Step 4691] GPU 0 memory after moving inputs: 16.39 GB
[Step 4691] GPU 0 memory after teacher forward: 17.01 GB
[Step 4691] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 4691] Teacher logits device before move: cuda:0
[Step 4691] Target device (student_logits.device): cuda:1
[Step 4691] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 4691] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 4691] GPU 0 memory after del: 16.39 GB
[Step 4691] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 4691] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.02 GB
[Step 4691] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 4691] Sequence length: 1024, Batch size: 2
[Step 4691] After KL computation - GPU 1: 40.50 GB
[Step 4691] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 4701] ========== MEMORY DEBUG ==========
[Step 4701] Model device: cuda:1
[Step 4701] Input device: cuda:1
[Step 4701] Teacher model device: cuda:0
[Step 4701] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 4701] GPU 1 memory: 33.76 GB (reserved: 46.76 GB)
[Step 4701] Student logits device: cuda:1, shape: torch.Size([2, 704, 151936]), dtype: torch.float32
[Step 4701] Student model device: cuda:1
[Step 4701] GPU 0 memory before teacher forward: 16.39 GB
[Step 4701] GPU 0 memory after moving inputs: 16.39 GB
[Step 4701] GPU 0 memory after teacher forward: 16.82 GB
[Step 4701] Teacher logits shape: torch.Size([2, 704, 151936]), dtype: torch.float16
[Step 4701] Teacher logits device before move: cuda:0
[Step 4701] Target device (student_logits.device): cuda:1
[Step 4701] GPU 0 memory after moving logits to GPU 1: 16.82 GB
[Step 4701] Teacher logits device after move: cuda:1, shape: torch.Size([2, 704, 151936])
[Step 4701] GPU 0 memory after del: 16.39 GB
[Step 4701] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 4701] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 36.88 GB
[Step 4701] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 4701] Sequence length: 704, Batch size: 2
[Step 4701] After KL computation - GPU 1: 38.59 GB
[Step 4701] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 4711] ========== MEMORY DEBUG ==========
[Step 4711] Model device: cuda:1
[Step 4711] Input device: cuda:1
[Step 4711] Teacher model device: cuda:0
[Step 4711] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 4711] GPU 1 memory: 33.76 GB (reserved: 47.59 GB)
[Step 4711] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 4711] Student model device: cuda:1
[Step 4711] GPU 0 memory before teacher forward: 16.39 GB
[Step 4711] GPU 0 memory after moving inputs: 16.39 GB
[Step 4711] GPU 0 memory after teacher forward: 17.01 GB
[Step 4711] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 4711] Teacher logits device before move: cuda:0
[Step 4711] Target device (student_logits.device): cuda:1
[Step 4711] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 4711] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 4711] GPU 0 memory after del: 16.39 GB
[Step 4711] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 4711] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 4711] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 4711] Sequence length: 1024, Batch size: 2
[Step 4711] After KL computation - GPU 1: 40.50 GB
[Step 4711] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 4721] ========== MEMORY DEBUG ==========
[Step 4721] Model device: cuda:1
[Step 4721] Input device: cuda:1
[Step 4721] Teacher model device: cuda:0
[Step 4721] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 4721] GPU 1 memory: 25.33 GB (reserved: 42.18 GB)
[Step 4721] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 4721] Student model device: cuda:1
[Step 4721] GPU 0 memory before teacher forward: 16.39 GB
[Step 4721] GPU 0 memory after moving inputs: 16.39 GB
[Step 4721] GPU 0 memory after teacher forward: 17.01 GB
[Step 4721] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 4721] Teacher logits device before move: cuda:0
[Step 4721] Target device (student_logits.device): cuda:1
[Step 4721] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 4721] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 4721] GPU 0 memory after del: 16.39 GB
[Step 4721] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 4721] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 29.58 GB
[Step 4721] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 4721] Sequence length: 1024, Batch size: 2
[Step 4721] After KL computation - GPU 1: 32.07 GB
[Step 4721] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 4731] ========== MEMORY DEBUG ==========
[Step 4731] Model device: cuda:1
[Step 4731] Input device: cuda:1
[Step 4731] Teacher model device: cuda:0
[Step 4731] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 4731] GPU 1 memory: 33.76 GB (reserved: 47.79 GB)
[Step 4731] Student logits device: cuda:1, shape: torch.Size([2, 559, 151936]), dtype: torch.float32
[Step 4731] Student model device: cuda:1
[Step 4731] GPU 0 memory before teacher forward: 16.39 GB
[Step 4731] GPU 0 memory after moving inputs: 16.39 GB
[Step 4731] GPU 0 memory after teacher forward: 16.73 GB
[Step 4731] Teacher logits shape: torch.Size([2, 559, 151936]), dtype: torch.float16
[Step 4731] Teacher logits device before move: cuda:0
[Step 4731] Target device (student_logits.device): cuda:1
[Step 4731] GPU 0 memory after moving logits to GPU 1: 16.73 GB
[Step 4731] Teacher logits device after move: cuda:1, shape: torch.Size([2, 559, 151936])
[Step 4731] GPU 0 memory after del: 16.39 GB
[Step 4731] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 4731] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 36.36 GB
[Step 4731] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 4731] Sequence length: 559, Batch size: 2
[Step 4731] After KL computation - GPU 1: 37.72 GB
[Step 4731] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 4741] ========== MEMORY DEBUG ==========
[Step 4741] Model device: cuda:1
[Step 4741] Input device: cuda:1
[Step 4741] Teacher model device: cuda:0
[Step 4741] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 4741] GPU 1 memory: 33.76 GB (reserved: 44.64 GB)
[Step 4741] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 4741] Student model device: cuda:1
[Step 4741] GPU 0 memory before teacher forward: 16.39 GB
[Step 4741] GPU 0 memory after moving inputs: 16.39 GB
[Step 4741] GPU 0 memory after teacher forward: 17.01 GB
[Step 4741] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 4741] Teacher logits device before move: cuda:0
[Step 4741] Target device (student_logits.device): cuda:1
[Step 4741] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 4741] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 4741] GPU 0 memory after del: 16.39 GB
[Step 4741] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 4741] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 4741] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 4741] Sequence length: 1024, Batch size: 2
[Step 4741] After KL computation - GPU 1: 40.50 GB
[Step 4741] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 4751] ========== MEMORY DEBUG ==========
[Step 4751] Model device: cuda:1
[Step 4751] Input device: cuda:1
[Step 4751] Teacher model device: cuda:0
[Step 4751] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 4751] GPU 1 memory: 33.76 GB (reserved: 47.57 GB)
[Step 4751] Student logits device: cuda:1, shape: torch.Size([2, 387, 151936]), dtype: torch.float32
[Step 4751] Student model device: cuda:1
[Step 4751] GPU 0 memory before teacher forward: 16.39 GB
[Step 4751] GPU 0 memory after moving inputs: 16.39 GB
[Step 4751] GPU 0 memory after teacher forward: 16.63 GB
[Step 4751] Teacher logits shape: torch.Size([2, 387, 151936]), dtype: torch.float16
[Step 4751] Teacher logits device before move: cuda:0
[Step 4751] Target device (student_logits.device): cuda:1
[Step 4751] GPU 0 memory after moving logits to GPU 1: 16.63 GB
[Step 4751] Teacher logits device after move: cuda:1, shape: torch.Size([2, 387, 151936])
[Step 4751] GPU 0 memory after del: 16.39 GB
[Step 4751] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 4751] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 35.76 GB
[Step 4751] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 4751] Sequence length: 387, Batch size: 2
[Step 4751] After KL computation - GPU 1: 36.70 GB
[Step 4751] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 4761] ========== MEMORY DEBUG ==========
[Step 4761] Model device: cuda:1
[Step 4761] Input device: cuda:1
[Step 4761] Teacher model device: cuda:0
[Step 4761] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 4761] GPU 1 memory: 33.76 GB (reserved: 47.60 GB)
[Step 4761] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 4761] Student model device: cuda:1
[Step 4761] GPU 0 memory before teacher forward: 16.39 GB
[Step 4761] GPU 0 memory after moving inputs: 16.39 GB
[Step 4761] GPU 0 memory after teacher forward: 17.01 GB
[Step 4761] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 4761] Teacher logits device before move: cuda:0
[Step 4761] Target device (student_logits.device): cuda:1
[Step 4761] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 4761] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 4761] GPU 0 memory after del: 16.39 GB
[Step 4761] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 4761] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 4761] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 4761] Sequence length: 1024, Batch size: 2
[Step 4761] After KL computation - GPU 1: 40.50 GB
[Step 4761] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 4771] ========== MEMORY DEBUG ==========
[Step 4771] Model device: cuda:1
[Step 4771] Input device: cuda:1
[Step 4771] Teacher model device: cuda:0
[Step 4771] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 4771] GPU 1 memory: 33.76 GB (reserved: 44.77 GB)
[Step 4771] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 4771] Student model device: cuda:1
[Step 4771] GPU 0 memory before teacher forward: 16.39 GB
[Step 4771] GPU 0 memory after moving inputs: 16.39 GB
[Step 4771] GPU 0 memory after teacher forward: 17.01 GB
[Step 4771] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 4771] Teacher logits device before move: cuda:0
[Step 4771] Target device (student_logits.device): cuda:1
[Step 4771] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 4771] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 4771] GPU 0 memory after del: 16.39 GB
[Step 4771] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 4771] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 4771] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 4771] Sequence length: 1024, Batch size: 2
[Step 4771] After KL computation - GPU 1: 40.50 GB
[Step 4771] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 4781] ========== MEMORY DEBUG ==========
[Step 4781] Model device: cuda:1
[Step 4781] Input device: cuda:1
[Step 4781] Teacher model device: cuda:0
[Step 4781] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 4781] GPU 1 memory: 33.76 GB (reserved: 48.13 GB)
[Step 4781] Student logits device: cuda:1, shape: torch.Size([2, 366, 151936]), dtype: torch.float32
[Step 4781] Student model device: cuda:1
[Step 4781] GPU 0 memory before teacher forward: 16.39 GB
[Step 4781] GPU 0 memory after moving inputs: 16.39 GB
[Step 4781] GPU 0 memory after teacher forward: 16.61 GB
[Step 4781] Teacher logits shape: torch.Size([2, 366, 151936]), dtype: torch.float16
[Step 4781] Teacher logits device before move: cuda:0
[Step 4781] Target device (student_logits.device): cuda:1
[Step 4781] GPU 0 memory after moving logits to GPU 1: 16.61 GB
[Step 4781] Teacher logits device after move: cuda:1, shape: torch.Size([2, 366, 151936])
[Step 4781] GPU 0 memory after del: 16.39 GB
[Step 4781] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 4781] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 35.69 GB
[Step 4781] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 4781] Sequence length: 366, Batch size: 2
[Step 4781] After KL computation - GPU 1: 36.58 GB
[Step 4781] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 4791] ========== MEMORY DEBUG ==========
[Step 4791] Model device: cuda:1
[Step 4791] Input device: cuda:1
[Step 4791] Teacher model device: cuda:0
[Step 4791] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 4791] GPU 1 memory: 33.77 GB (reserved: 48.00 GB)
[Step 4791] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 4791] Student model device: cuda:1
[Step 4791] GPU 0 memory before teacher forward: 16.39 GB
[Step 4791] GPU 0 memory after moving inputs: 16.39 GB
[Step 4791] GPU 0 memory after teacher forward: 17.01 GB
[Step 4791] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 4791] Teacher logits device before move: cuda:0
[Step 4791] Target device (student_logits.device): cuda:1
[Step 4791] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 4791] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 4791] GPU 0 memory after del: 16.39 GB
[Step 4791] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 4791] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.02 GB
[Step 4791] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 4791] Sequence length: 1024, Batch size: 2
[Step 4791] After KL computation - GPU 1: 40.51 GB
[Step 4791] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 4.89949494949495e-05, 'epoch': 0.03}

[Step 4801] ========== MEMORY DEBUG ==========
[Step 4801] Model device: cuda:1
[Step 4801] Input device: cuda:1
[Step 4801] Teacher model device: cuda:0
[Step 4801] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 4801] GPU 1 memory: 25.33 GB (reserved: 47.95 GB)
[Step 4801] Student logits device: cuda:1, shape: torch.Size([2, 876, 151936]), dtype: torch.float32
[Step 4801] Student model device: cuda:1
[Step 4801] GPU 0 memory before teacher forward: 16.39 GB
[Step 4801] GPU 0 memory after moving inputs: 16.39 GB
[Step 4801] GPU 0 memory after teacher forward: 16.92 GB
[Step 4801] Teacher logits shape: torch.Size([2, 876, 151936]), dtype: torch.float16
[Step 4801] Teacher logits device before move: cuda:0
[Step 4801] Target device (student_logits.device): cuda:1
[Step 4801] GPU 0 memory after moving logits to GPU 1: 16.92 GB
[Step 4801] Teacher logits device after move: cuda:1, shape: torch.Size([2, 876, 151936])
[Step 4801] GPU 0 memory after del: 16.39 GB
[Step 4801] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 4801] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 29.05 GB
[Step 4801] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 4801] Sequence length: 876, Batch size: 2
[Step 4801] After KL computation - GPU 1: 31.18 GB
[Step 4801] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 4811] ========== MEMORY DEBUG ==========
[Step 4811] Model device: cuda:1
[Step 4811] Input device: cuda:1
[Step 4811] Teacher model device: cuda:0
[Step 4811] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 4811] GPU 1 memory: 33.76 GB (reserved: 47.71 GB)
[Step 4811] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 4811] Student model device: cuda:1
[Step 4811] GPU 0 memory before teacher forward: 16.39 GB
[Step 4811] GPU 0 memory after moving inputs: 16.39 GB
[Step 4811] GPU 0 memory after teacher forward: 17.01 GB
[Step 4811] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 4811] Teacher logits device before move: cuda:0
[Step 4811] Target device (student_logits.device): cuda:1
[Step 4811] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 4811] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 4811] GPU 0 memory after del: 16.39 GB
[Step 4811] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 4811] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 4811] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 4811] Sequence length: 1024, Batch size: 2
[Step 4811] After KL computation - GPU 1: 40.50 GB
[Step 4811] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 4821] ========== MEMORY DEBUG ==========
[Step 4821] Model device: cuda:1
[Step 4821] Input device: cuda:1
[Step 4821] Teacher model device: cuda:0
[Step 4821] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 4821] GPU 1 memory: 33.76 GB (reserved: 47.51 GB)
[Step 4821] Student logits device: cuda:1, shape: torch.Size([2, 788, 151936]), dtype: torch.float32
[Step 4821] Student model device: cuda:1
[Step 4821] GPU 0 memory before teacher forward: 16.39 GB
[Step 4821] GPU 0 memory after moving inputs: 16.39 GB
[Step 4821] GPU 0 memory after teacher forward: 16.87 GB
[Step 4821] Teacher logits shape: torch.Size([2, 788, 151936]), dtype: torch.float16
[Step 4821] Teacher logits device before move: cuda:0
[Step 4821] Target device (student_logits.device): cuda:1
[Step 4821] GPU 0 memory after moving logits to GPU 1: 16.87 GB
[Step 4821] Teacher logits device after move: cuda:1, shape: torch.Size([2, 788, 151936])
[Step 4821] GPU 0 memory after del: 16.39 GB
[Step 4821] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 4821] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 37.18 GB
[Step 4821] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 4821] Sequence length: 788, Batch size: 2
[Step 4821] After KL computation - GPU 1: 39.10 GB
[Step 4821] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(

[Step 4831] ========== MEMORY DEBUG ==========
[Step 4831] Model device: cuda:1
[Step 4831] Input device: cuda:1
[Step 4831] Teacher model device: cuda:0
[Step 4831] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 4831] GPU 1 memory: 33.76 GB (reserved: 47.30 GB)
[Step 4831] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 4831] Student model device: cuda:1
[Step 4831] GPU 0 memory before teacher forward: 16.39 GB
[Step 4831] GPU 0 memory after moving inputs: 16.39 GB
[Step 4831] GPU 0 memory after teacher forward: 17.01 GB
[Step 4831] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 4831] Teacher logits device before move: cuda:0
[Step 4831] Target device (student_logits.device): cuda:1
[Step 4831] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 4831] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 4831] GPU 0 memory after del: 16.39 GB
[Step 4831] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 4831] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 4831] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 4831] Sequence length: 1024, Batch size: 2
[Step 4831] After KL computation - GPU 1: 40.50 GB
[Step 4831] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  3%|                                                                                  | 302/10000 [1:46:50<56:42:00, 21.05s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None

[Step 4841] ========== MEMORY DEBUG ==========
[Step 4841] Model device: cuda:1
[Step 4841] Input device: cuda:1
[Step 4841] Teacher model device: cuda:0
[Step 4841] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 4841] GPU 1 memory: 33.76 GB (reserved: 42.39 GB)
[Step 4841] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 4841] Student model device: cuda:1
[Step 4841] GPU 0 memory before teacher forward: 16.39 GB
[Step 4841] GPU 0 memory after moving inputs: 16.39 GB
[Step 4841] GPU 0 memory after teacher forward: 17.01 GB
[Step 4841] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 4841] Teacher logits device before move: cuda:0
[Step 4841] Target device (student_logits.device): cuda:1
[Step 4841] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 4841] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 4841] GPU 0 memory after del: 16.39 GB
[Step 4841] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 4841] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 4841] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 4841] Sequence length: 1024, Batch size: 2
[Step 4841] After KL computation - GPU 1: 40.50 GB
[Step 4841] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(
  3%|                                                                                  | 303/10000 [1:47:11<56:38:59, 21.03s/it]

[Step 4851] ========== MEMORY DEBUG ==========
[Step 4851] Model device: cuda:1
[Step 4851] Input device: cuda:1
[Step 4851] Teacher model device: cuda:0
[Step 4851] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 4851] GPU 1 memory: 33.76 GB (reserved: 43.94 GB)
[Step 4851] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 4851] Student model device: cuda:1
[Step 4851] GPU 0 memory before teacher forward: 16.39 GB
[Step 4851] GPU 0 memory after moving inputs: 16.39 GB
[Step 4851] GPU 0 memory after teacher forward: 17.01 GB
[Step 4851] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 4851] Teacher logits device before move: cuda:0
[Step 4851] Target device (student_logits.device): cuda:1
[Step 4851] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 4851] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 4851] GPU 0 memory after del: 16.39 GB
[Step 4851] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 4851] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 4851] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 4851] Sequence length: 1024, Batch size: 2
[Step 4851] After KL computation - GPU 1: 40.50 GB
[Step 4851] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 4861] ========== MEMORY DEBUG ==========
[Step 4861] Model device: cuda:1
[Step 4861] Input device: cuda:1
[Step 4861] Teacher model device: cuda:0
[Step 4861] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 4861] GPU 1 memory: 33.76 GB (reserved: 44.02 GB)
[Step 4861] Student logits device: cuda:1, shape: torch.Size([2, 852, 151936]), dtype: torch.float32
[Step 4861] Student model device: cuda:1
[Step 4861] GPU 0 memory before teacher forward: 16.39 GB
[Step 4861] GPU 0 memory after moving inputs: 16.39 GB
[Step 4861] GPU 0 memory after teacher forward: 16.91 GB
[Step 4861] Teacher logits shape: torch.Size([2, 852, 151936]), dtype: torch.float16
[Step 4861] Teacher logits device before move: cuda:0
[Step 4861] Target device (student_logits.device): cuda:1
[Step 4861] GPU 0 memory after moving logits to GPU 1: 16.91 GB
[Step 4861] Teacher logits device after move: cuda:1, shape: torch.Size([2, 852, 151936])
[Step 4861] GPU 0 memory after del: 16.39 GB
[Step 4861] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 4861] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 37.40 GB
[Step 4861] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 4861] Sequence length: 852, Batch size: 2
[Step 4861] After KL computation - GPU 1: 39.47 GB
[Step 4861] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 4871] ========== MEMORY DEBUG ==========
[Step 4871] Model device: cuda:1
[Step 4871] Input device: cuda:1
[Step 4871] Teacher model device: cuda:0
[Step 4871] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 4871] GPU 1 memory: 33.76 GB (reserved: 43.33 GB)
[Step 4871] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 4871] Student model device: cuda:1
[Step 4871] GPU 0 memory before teacher forward: 16.39 GB
[Step 4871] GPU 0 memory after moving inputs: 16.39 GB
[Step 4871] GPU 0 memory after teacher forward: 17.01 GB
[Step 4871] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 4871] Teacher logits device before move: cuda:0
[Step 4871] Target device (student_logits.device): cuda:1
[Step 4871] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 4871] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 4871] GPU 0 memory after del: 16.39 GB
[Step 4871] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 4871] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 4871] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 4871] Sequence length: 1024, Batch size: 2
[Step 4871] After KL computation - GPU 1: 40.50 GB
[Step 4871] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(
  3%|                                                                                  | 305/10000 [1:47:51<54:26:48, 20.22s/it]

[Step 4881] ========== MEMORY DEBUG ==========
[Step 4881] Model device: cuda:1
[Step 4881] Input device: cuda:1
[Step 4881] Teacher model device: cuda:0
[Step 4881] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 4881] GPU 1 memory: 25.33 GB (reserved: 47.62 GB)
[Step 4881] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 4881] Student model device: cuda:1
[Step 4881] GPU 0 memory before teacher forward: 16.39 GB
[Step 4881] GPU 0 memory after moving inputs: 16.39 GB
[Step 4881] GPU 0 memory after teacher forward: 17.01 GB
[Step 4881] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 4881] Teacher logits device before move: cuda:0
[Step 4881] Target device (student_logits.device): cuda:1
[Step 4881] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 4881] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 4881] GPU 0 memory after del: 16.39 GB
[Step 4881] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 4881] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 29.58 GB
[Step 4881] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 4881] Sequence length: 1024, Batch size: 2
[Step 4881] After KL computation - GPU 1: 32.07 GB
[Step 4881] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 4891] ========== MEMORY DEBUG ==========
[Step 4891] Model device: cuda:1
[Step 4891] Input device: cuda:1
[Step 4891] Teacher model device: cuda:0
[Step 4891] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 4891] GPU 1 memory: 33.76 GB (reserved: 47.57 GB)
[Step 4891] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 4891] Student model device: cuda:1
[Step 4891] GPU 0 memory before teacher forward: 16.39 GB
[Step 4891] GPU 0 memory after moving inputs: 16.39 GB
[Step 4891] GPU 0 memory after teacher forward: 17.01 GB
[Step 4891] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 4891] Teacher logits device before move: cuda:0
[Step 4891] Target device (student_logits.device): cuda:1
[Step 4891] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 4891] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 4891] GPU 0 memory after del: 16.39 GB
[Step 4891] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 4891] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 4891] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 4891] Sequence length: 1024, Batch size: 2
[Step 4891] After KL computation - GPU 1: 40.50 GB
[Step 4891] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 4901] ========== MEMORY DEBUG ==========
[Step 4901] Model device: cuda:1
[Step 4901] Input device: cuda:1
[Step 4901] Teacher model device: cuda:0
[Step 4901] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 4901] GPU 1 memory: 33.77 GB (reserved: 47.48 GB)
[Step 4901] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 4901] Student model device: cuda:1
[Step 4901] GPU 0 memory before teacher forward: 16.39 GB
[Step 4901] GPU 0 memory after moving inputs: 16.39 GB
[Step 4901] GPU 0 memory after teacher forward: 17.01 GB
[Step 4901] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 4901] Teacher logits device before move: cuda:0
[Step 4901] Target device (student_logits.device): cuda:1
[Step 4901] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 4901] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 4901] GPU 0 memory after del: 16.39 GB
[Step 4901] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 4901] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.03 GB
[Step 4901] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 4901] Sequence length: 1024, Batch size: 2
[Step 4901] After KL computation - GPU 1: 40.51 GB
[Step 4901] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(

[Step 4911] ========== MEMORY DEBUG ==========
[Step 4911] Model device: cuda:1
[Step 4911] Input device: cuda:1
[Step 4911] Teacher model device: cuda:0
[Step 4911] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 4911] GPU 1 memory: 33.77 GB (reserved: 47.72 GB)
[Step 4911] Student logits device: cuda:1, shape: torch.Size([2, 546, 151936]), dtype: torch.float32
[Step 4911] Student model device: cuda:1
[Step 4911] GPU 0 memory before teacher forward: 16.39 GB
[Step 4911] GPU 0 memory after moving inputs: 16.39 GB
[Step 4911] GPU 0 memory after teacher forward: 16.72 GB
[Step 4911] Teacher logits shape: torch.Size([2, 546, 151936]), dtype: torch.float16
[Step 4911] Teacher logits device before move: cuda:0
[Step 4911] Target device (student_logits.device): cuda:1
[Step 4911] GPU 0 memory after moving logits to GPU 1: 16.72 GB
[Step 4911] Teacher logits device after move: cuda:1, shape: torch.Size([2, 546, 151936])
[Step 4911] GPU 0 memory after del: 16.39 GB
[Step 4911] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 4911] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 36.33 GB
[Step 4911] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 4911] Sequence length: 546, Batch size: 2
[Step 4911] After KL computation - GPU 1: 37.66 GB
[Step 4911] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  3%|                                                                                  | 308/10000 [1:48:52<55:11:03, 20.50s/it]

[Step 4921] ========== MEMORY DEBUG ==========
[Step 4921] Model device: cuda:1
[Step 4921] Input device: cuda:1
[Step 4921] Teacher model device: cuda:0
[Step 4921] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 4921] GPU 1 memory: 33.76 GB (reserved: 47.44 GB)
[Step 4921] Student logits device: cuda:1, shape: torch.Size([2, 971, 151936]), dtype: torch.float32
[Step 4921] Student model device: cuda:1
[Step 4921] GPU 0 memory before teacher forward: 16.39 GB
[Step 4921] GPU 0 memory after moving inputs: 16.39 GB
[Step 4921] GPU 0 memory after teacher forward: 16.98 GB
[Step 4921] Teacher logits shape: torch.Size([2, 971, 151936]), dtype: torch.float16
[Step 4921] Teacher logits device before move: cuda:0
[Step 4921] Target device (student_logits.device): cuda:1
[Step 4921] GPU 0 memory after moving logits to GPU 1: 16.98 GB
[Step 4921] Teacher logits device after move: cuda:1, shape: torch.Size([2, 971, 151936])
[Step 4921] GPU 0 memory after del: 16.39 GB
[Step 4921] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 4921] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 37.83 GB
[Step 4921] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 4921] Sequence length: 971, Batch size: 2
[Step 4921] After KL computation - GPU 1: 40.19 GB
[Step 4921] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 4931] ========== MEMORY DEBUG ==========
[Step 4931] Model device: cuda:1
[Step 4931] Input device: cuda:1
[Step 4931] Teacher model device: cuda:0
[Step 4931] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 4931] GPU 1 memory: 33.76 GB (reserved: 47.78 GB)
[Step 4931] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 4931] Student model device: cuda:1
[Step 4931] GPU 0 memory before teacher forward: 16.39 GB
[Step 4931] GPU 0 memory after moving inputs: 16.39 GB
[Step 4931] GPU 0 memory after teacher forward: 17.01 GB
[Step 4931] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 4931] Teacher logits device before move: cuda:0
[Step 4931] Target device (student_logits.device): cuda:1
[Step 4931] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 4931] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 4931] GPU 0 memory after del: 16.39 GB
[Step 4931] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 4931] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 4931] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 4931] Sequence length: 1024, Batch size: 2
[Step 4931] After KL computation - GPU 1: 40.50 GB
[Step 4931] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(

[Step 4941] ========== MEMORY DEBUG ==========
[Step 4941] Model device: cuda:1
[Step 4941] Input device: cuda:1
[Step 4941] Teacher model device: cuda:0
[Step 4941] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 4941] GPU 1 memory: 33.76 GB (reserved: 47.64 GB)
[Step 4941] Student logits device: cuda:1, shape: torch.Size([2, 667, 151936]), dtype: torch.float32
[Step 4941] Student model device: cuda:1
[Step 4941] GPU 0 memory before teacher forward: 16.39 GB
[Step 4941] GPU 0 memory after moving inputs: 16.39 GB
[Step 4941] GPU 0 memory after teacher forward: 16.80 GB
[Step 4941] Teacher logits shape: torch.Size([2, 667, 151936]), dtype: torch.float16
[Step 4941] Teacher logits device before move: cuda:0
[Step 4941] Target device (student_logits.device): cuda:1
[Step 4941] GPU 0 memory after moving logits to GPU 1: 16.80 GB
[Step 4941] Teacher logits device after move: cuda:1, shape: torch.Size([2, 667, 151936])
[Step 4941] GPU 0 memory after del: 16.39 GB
[Step 4941] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 4941] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 36.75 GB
[Step 4941] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 4941] Sequence length: 667, Batch size: 2
[Step 4941] After KL computation - GPU 1: 38.37 GB
[Step 4941] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  3%|                                                                                  | 309/10000 [1:49:13<55:21:56, 20.57s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None

[Step 4951] ========== MEMORY DEBUG ==========
[Step 4951] Model device: cuda:1
[Step 4951] Input device: cuda:1
[Step 4951] Teacher model device: cuda:0
[Step 4951] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 4951] GPU 1 memory: 33.76 GB (reserved: 47.22 GB)
[Step 4951] Student logits device: cuda:1, shape: torch.Size([2, 167, 151936]), dtype: torch.float32
[Step 4951] Student model device: cuda:1
[Step 4951] GPU 0 memory before teacher forward: 16.39 GB
[Step 4951] GPU 0 memory after moving inputs: 16.39 GB
[Step 4951] GPU 0 memory after teacher forward: 16.49 GB
[Step 4951] Teacher logits shape: torch.Size([2, 167, 151936]), dtype: torch.float16
[Step 4951] Teacher logits device before move: cuda:0
[Step 4951] Target device (student_logits.device): cuda:1
[Step 4951] GPU 0 memory after moving logits to GPU 1: 16.49 GB
[Step 4951] Teacher logits device after move: cuda:1, shape: torch.Size([2, 167, 151936])
[Step 4951] GPU 0 memory after del: 16.39 GB
[Step 4951] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 4951] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 34.98 GB
[Step 4951] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 4951] Sequence length: 167, Batch size: 2
[Step 4951] After KL computation - GPU 1: 35.39 GB
[Step 4951] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(
  3%|                                                                                  | 310/10000 [1:49:32<54:03:38, 20.08s/it]
{'loss': 5916.9711, 'grad_norm': nan, 'learning_rate': 4.894444444444445e-05, 'epoch': 0.03}

[Step 4961] ========== MEMORY DEBUG ==========
[Step 4961] Model device: cuda:1
[Step 4961] Input device: cuda:1
[Step 4961] Teacher model device: cuda:0
[Step 4961] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 4961] GPU 1 memory: 25.33 GB (reserved: 48.60 GB)
[Step 4961] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 4961] Student model device: cuda:1
[Step 4961] GPU 0 memory before teacher forward: 16.39 GB
[Step 4961] GPU 0 memory after moving inputs: 16.39 GB
[Step 4961] GPU 0 memory after teacher forward: 17.01 GB
[Step 4961] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 4961] Teacher logits device before move: cuda:0
[Step 4961] Target device (student_logits.device): cuda:1
[Step 4961] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 4961] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 4961] GPU 0 memory after del: 16.39 GB
[Step 4961] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 4961] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 29.58 GB
[Step 4961] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 4961] Sequence length: 1024, Batch size: 2
[Step 4961] After KL computation - GPU 1: 32.07 GB
[Step 4961] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 4971] ========== MEMORY DEBUG ==========
[Step 4971] Model device: cuda:1
[Step 4971] Input device: cuda:1
[Step 4971] Teacher model device: cuda:0
[Step 4971] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 4971] GPU 1 memory: 33.76 GB (reserved: 47.53 GB)
[Step 4971] Student logits device: cuda:1, shape: torch.Size([2, 862, 151936]), dtype: torch.float32
[Step 4971] Student model device: cuda:1
[Step 4971] GPU 0 memory before teacher forward: 16.39 GB
[Step 4971] GPU 0 memory after moving inputs: 16.39 GB
[Step 4971] GPU 0 memory after teacher forward: 16.92 GB
[Step 4971] Teacher logits shape: torch.Size([2, 862, 151936]), dtype: torch.float16
[Step 4971] Teacher logits device before move: cuda:0
[Step 4971] Target device (student_logits.device): cuda:1
[Step 4971] GPU 0 memory after moving logits to GPU 1: 16.92 GB
[Step 4971] Teacher logits device after move: cuda:1, shape: torch.Size([2, 862, 151936])
[Step 4971] GPU 0 memory after del: 16.39 GB
[Step 4971] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 4971] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 37.44 GB
[Step 4971] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 4971] Sequence length: 862, Batch size: 2
[Step 4971] After KL computation - GPU 1: 39.54 GB
[Step 4971] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 4981] ========== MEMORY DEBUG ==========
[Step 4981] Model device: cuda:1
[Step 4981] Input device: cuda:1
[Step 4981] Teacher model device: cuda:0
[Step 4981] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 4981] GPU 1 memory: 33.76 GB (reserved: 44.46 GB)
[Step 4981] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 4981] Student model device: cuda:1
[Step 4981] GPU 0 memory before teacher forward: 16.39 GB
[Step 4981] GPU 0 memory after moving inputs: 16.39 GB
[Step 4981] GPU 0 memory after teacher forward: 17.01 GB
[Step 4981] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 4981] Teacher logits device before move: cuda:0
[Step 4981] Target device (student_logits.device): cuda:1
[Step 4981] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 4981] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 4981] GPU 0 memory after del: 16.39 GB
[Step 4981] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 4981] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 4981] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 4981] Sequence length: 1024, Batch size: 2
[Step 4981] After KL computation - GPU 1: 40.50 GB
[Step 4981] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(

[Step 4991] ========== MEMORY DEBUG ==========
[Step 4991] Model device: cuda:1
[Step 4991] Input device: cuda:1
[Step 4991] Teacher model device: cuda:0
[Step 4991] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 4991] GPU 1 memory: 33.76 GB (reserved: 47.51 GB)
[Step 4991] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 4991] Student model device: cuda:1
[Step 4991] GPU 0 memory before teacher forward: 16.39 GB
[Step 4991] GPU 0 memory after moving inputs: 16.39 GB
[Step 4991] GPU 0 memory after teacher forward: 17.01 GB
[Step 4991] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 4991] Teacher logits device before move: cuda:0
[Step 4991] Target device (student_logits.device): cuda:1
[Step 4991] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 4991] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 4991] GPU 0 memory after del: 16.39 GB
[Step 4991] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 4991] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 4991] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 4991] Sequence length: 1024, Batch size: 2
[Step 4991] After KL computation - GPU 1: 40.50 GB
[Step 4991] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  3%|                                                                                  | 312/10000 [1:50:14<55:42:43, 20.70s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 5001] ========== MEMORY DEBUG ==========
[Step 5001] Model device: cuda:1
[Step 5001] Input device: cuda:1
[Step 5001] Teacher model device: cuda:0
[Step 5001] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 5001] GPU 1 memory: 33.77 GB (reserved: 47.83 GB)
[Step 5001] Student logits device: cuda:1, shape: torch.Size([2, 528, 151936]), dtype: torch.float32
[Step 5001] Student model device: cuda:1
[Step 5001] GPU 0 memory before teacher forward: 16.39 GB
[Step 5001] GPU 0 memory after moving inputs: 16.39 GB
[Step 5001] GPU 0 memory after teacher forward: 16.71 GB
[Step 5001] Teacher logits shape: torch.Size([2, 528, 151936]), dtype: torch.float16
[Step 5001] Teacher logits device before move: cuda:0
[Step 5001] Target device (student_logits.device): cuda:1
[Step 5001] GPU 0 memory after moving logits to GPU 1: 16.71 GB
[Step 5001] Teacher logits device after move: cuda:1, shape: torch.Size([2, 528, 151936])
[Step 5001] GPU 0 memory after del: 16.39 GB
[Step 5001] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 5001] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 36.26 GB
[Step 5001] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 5001] Sequence length: 528, Batch size: 2
[Step 5001] After KL computation - GPU 1: 37.54 GB
[Step 5001] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  3%|                                                                                  | 313/10000 [1:50:36<57:18:34, 21.30s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None

[Step 5011] ========== MEMORY DEBUG ==========
[Step 5011] Model device: cuda:1
[Step 5011] Input device: cuda:1
[Step 5011] Teacher model device: cuda:0
[Step 5011] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 5011] GPU 1 memory: 33.76 GB (reserved: 46.87 GB)
[Step 5011] Student logits device: cuda:1, shape: torch.Size([2, 1002, 151936]), dtype: torch.float32
[Step 5011] Student model device: cuda:1
[Step 5011] GPU 0 memory before teacher forward: 16.39 GB
[Step 5011] GPU 0 memory after moving inputs: 16.39 GB
[Step 5011] GPU 0 memory after teacher forward: 17.00 GB
[Step 5011] Teacher logits shape: torch.Size([2, 1002, 151936]), dtype: torch.float16
[Step 5011] Teacher logits device before move: cuda:0
[Step 5011] Target device (student_logits.device): cuda:1
[Step 5011] GPU 0 memory after moving logits to GPU 1: 17.00 GB
[Step 5011] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1002, 151936])
[Step 5011] GPU 0 memory after del: 16.39 GB
[Step 5011] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 5011] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 37.94 GB
[Step 5011] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 5011] Sequence length: 1002, Batch size: 2
[Step 5011] After KL computation - GPU 1: 40.37 GB
[Step 5011] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 5021] ========== MEMORY DEBUG ==========
[Step 5021] Model device: cuda:1
[Step 5021] Input device: cuda:1
[Step 5021] Teacher model device: cuda:0
[Step 5021] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 5021] GPU 1 memory: 33.76 GB (reserved: 44.98 GB)
  warnings.warn(
[Step 5021] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 5021] Student model device: cuda:1
[Step 5021] GPU 0 memory before teacher forward: 16.39 GB
[Step 5021] GPU 0 memory after moving inputs: 16.39 GB
[Step 5021] GPU 0 memory after teacher forward: 17.01 GB
[Step 5021] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 5021] Teacher logits device before move: cuda:0
[Step 5021] Target device (student_logits.device): cuda:1
[Step 5021] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 5021] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 5021] GPU 0 memory after del: 16.39 GB
[Step 5021] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 5021] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 5021] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 5021] Sequence length: 1024, Batch size: 2
[Step 5021] After KL computation - GPU 1: 40.50 GB
[Step 5021] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  3%|                                                                                  | 314/10000 [1:51:00<58:42:10, 21.82s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 5031] ========== MEMORY DEBUG ==========
[Step 5031] Model device: cuda:1
[Step 5031] Input device: cuda:1
[Step 5031] Teacher model device: cuda:0
[Step 5031] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 5031] GPU 1 memory: 33.77 GB (reserved: 48.01 GB)
[Step 5031] Student logits device: cuda:1, shape: torch.Size([2, 124, 151936]), dtype: torch.float32
[Step 5031] Student model device: cuda:1
[Step 5031] GPU 0 memory before teacher forward: 16.39 GB
[Step 5031] GPU 0 memory after moving inputs: 16.39 GB
[Step 5031] GPU 0 memory after teacher forward: 16.47 GB
[Step 5031] Teacher logits shape: torch.Size([2, 124, 151936]), dtype: torch.float16
[Step 5031] Teacher logits device before move: cuda:0
[Step 5031] Target device (student_logits.device): cuda:1
[Step 5031] GPU 0 memory after moving logits to GPU 1: 16.47 GB
[Step 5031] Teacher logits device after move: cuda:1, shape: torch.Size([2, 124, 151936])
[Step 5031] GPU 0 memory after del: 16.39 GB
[Step 5031] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 5031] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 34.83 GB
[Step 5031] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 5031] Sequence length: 124, Batch size: 2
[Step 5031] After KL computation - GPU 1: 35.13 GB
[Step 5031] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  3%|                                                                                  | 315/10000 [1:51:21<58:25:25, 21.72s/it]

[Step 5041] ========== MEMORY DEBUG ==========
[Step 5041] Model device: cuda:1
[Step 5041] Input device: cuda:1
[Step 5041] Teacher model device: cuda:0
[Step 5041] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 5041] GPU 1 memory: 25.33 GB (reserved: 47.86 GB)
[Step 5041] Student logits device: cuda:1, shape: torch.Size([2, 712, 151936]), dtype: torch.float32
[Step 5041] Student model device: cuda:1
[Step 5041] GPU 0 memory before teacher forward: 16.39 GB
[Step 5041] GPU 0 memory after moving inputs: 16.39 GB
[Step 5041] GPU 0 memory after teacher forward: 16.82 GB
[Step 5041] Teacher logits shape: torch.Size([2, 712, 151936]), dtype: torch.float16
[Step 5041] Teacher logits device before move: cuda:0
[Step 5041] Target device (student_logits.device): cuda:1
[Step 5041] GPU 0 memory after moving logits to GPU 1: 16.82 GB
[Step 5041] Teacher logits device after move: cuda:1, shape: torch.Size([2, 712, 151936])
[Step 5041] GPU 0 memory after del: 16.39 GB
[Step 5041] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 5041] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 28.47 GB
[Step 5041] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 5041] Sequence length: 712, Batch size: 2
[Step 5041] After KL computation - GPU 1: 30.20 GB
[Step 5041] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 5051] ========== MEMORY DEBUG ==========
[Step 5051] Model device: cuda:1
[Step 5051] Input device: cuda:1
[Step 5051] Teacher model device: cuda:0
[Step 5051] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 5051] GPU 1 memory: 33.78 GB (reserved: 47.81 GB)
[Step 5051] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 5051] Student model device: cuda:1
[Step 5051] GPU 0 memory before teacher forward: 16.39 GB
[Step 5051] GPU 0 memory after moving inputs: 16.39 GB
[Step 5051] GPU 0 memory after teacher forward: 17.01 GB
[Step 5051] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 5051] Teacher logits device before move: cuda:0
[Step 5051] Target device (student_logits.device): cuda:1
[Step 5051] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 5051] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 5051] GPU 0 memory after del: 16.39 GB
[Step 5051] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 5051] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.03 GB
[Step 5051] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 5051] Sequence length: 1024, Batch size: 2
[Step 5051] After KL computation - GPU 1: 40.52 GB
[Step 5051] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 5061] ========== MEMORY DEBUG ==========
[Step 5061] Model device: cuda:1
[Step 5061] Input device: cuda:1
[Step 5061] Teacher model device: cuda:0
[Step 5061] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 5061] GPU 1 memory: 33.76 GB (reserved: 47.58 GB)
[Step 5061] Student logits device: cuda:1, shape: torch.Size([2, 652, 151936]), dtype: torch.float32
[Step 5061] Student model device: cuda:1
[Step 5061] GPU 0 memory before teacher forward: 16.39 GB
[Step 5061] GPU 0 memory after moving inputs: 16.39 GB
[Step 5061] GPU 0 memory after teacher forward: 16.79 GB
[Step 5061] Teacher logits shape: torch.Size([2, 652, 151936]), dtype: torch.float16
[Step 5061] Teacher logits device before move: cuda:0
[Step 5061] Target device (student_logits.device): cuda:1
[Step 5061] GPU 0 memory after moving logits to GPU 1: 16.79 GB
[Step 5061] Teacher logits device after move: cuda:1, shape: torch.Size([2, 652, 151936])
[Step 5061] GPU 0 memory after del: 16.39 GB
[Step 5061] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 5061] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 36.69 GB
[Step 5061] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 5061] Sequence length: 652, Batch size: 2
[Step 5061] After KL computation - GPU 1: 38.28 GB
[Step 5061] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 5071] ========== MEMORY DEBUG ==========
[Step 5071] Model device: cuda:1
[Step 5071] Input device: cuda:1
[Step 5071] Teacher model device: cuda:0
[Step 5071] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 5071] GPU 1 memory: 33.76 GB (reserved: 47.60 GB)
[Step 5071] Student logits device: cuda:1, shape: torch.Size([2, 270, 151936]), dtype: torch.float32
[Step 5071] Student model device: cuda:1
[Step 5071] GPU 0 memory before teacher forward: 16.39 GB
[Step 5071] GPU 0 memory after moving inputs: 16.39 GB
[Step 5071] GPU 0 memory after teacher forward: 16.56 GB
[Step 5071] Teacher logits shape: torch.Size([2, 270, 151936]), dtype: torch.float16
[Step 5071] Teacher logits device before move: cuda:0
[Step 5071] Target device (student_logits.device): cuda:1
[Step 5071] GPU 0 memory after moving logits to GPU 1: 16.56 GB
[Step 5071] Teacher logits device after move: cuda:1, shape: torch.Size([2, 270, 151936])
[Step 5071] GPU 0 memory after del: 16.39 GB
[Step 5071] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 5071] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 35.34 GB
[Step 5071] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 5071] Sequence length: 270, Batch size: 2
[Step 5071] After KL computation - GPU 1: 36.00 GB
[Step 5071] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(
  3%|                                                                                  | 318/10000 [1:52:22<56:03:17, 20.84s/it]

[Step 5081] ========== MEMORY DEBUG ==========
[Step 5081] Model device: cuda:1
[Step 5081] Input device: cuda:1
[Step 5081] Teacher model device: cuda:0
[Step 5081] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 5081] GPU 1 memory: 33.76 GB (reserved: 42.93 GB)
[Step 5081] Student logits device: cuda:1, shape: torch.Size([2, 1004, 151936]), dtype: torch.float32
[Step 5081] Student model device: cuda:1
[Step 5081] GPU 0 memory before teacher forward: 16.39 GB
[Step 5081] GPU 0 memory after moving inputs: 16.39 GB
[Step 5081] GPU 0 memory after teacher forward: 17.00 GB
[Step 5081] Teacher logits shape: torch.Size([2, 1004, 151936]), dtype: torch.float16
[Step 5081] Teacher logits device before move: cuda:0
[Step 5081] Target device (student_logits.device): cuda:1
[Step 5081] GPU 0 memory after moving logits to GPU 1: 17.00 GB
[Step 5081] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1004, 151936])
[Step 5081] GPU 0 memory after del: 16.39 GB
[Step 5081] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 5081] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 37.94 GB
[Step 5081] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 5081] Sequence length: 1004, Batch size: 2
[Step 5081] After KL computation - GPU 1: 40.38 GB
[Step 5081] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 5091] ========== MEMORY DEBUG ==========
[Step 5091] Model device: cuda:1
[Step 5091] Input device: cuda:1
[Step 5091] Teacher model device: cuda:0
[Step 5091] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 5091] GPU 1 memory: 33.76 GB (reserved: 42.11 GB)
[Step 5091] Student logits device: cuda:1, shape: torch.Size([2, 898, 151936]), dtype: torch.float32
[Step 5091] Student model device: cuda:1
[Step 5091] GPU 0 memory before teacher forward: 16.39 GB
[Step 5091] GPU 0 memory after moving inputs: 16.39 GB
[Step 5091] GPU 0 memory after teacher forward: 16.94 GB
[Step 5091] Teacher logits shape: torch.Size([2, 898, 151936]), dtype: torch.float16
[Step 5091] Teacher logits device before move: cuda:0
[Step 5091] Target device (student_logits.device): cuda:1
[Step 5091] GPU 0 memory after moving logits to GPU 1: 16.94 GB
[Step 5091] Teacher logits device after move: cuda:1, shape: torch.Size([2, 898, 151936])
[Step 5091] GPU 0 memory after del: 16.39 GB
[Step 5091] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 5091] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 37.57 GB
[Step 5091] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 5091] Sequence length: 898, Batch size: 2
[Step 5091] After KL computation - GPU 1: 39.75 GB
[Step 5091] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 5101] ========== MEMORY DEBUG ==========
[Step 5101] Model device: cuda:1
[Step 5101] Input device: cuda:1
[Step 5101] Teacher model device: cuda:0
[Step 5101] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 5101] GPU 1 memory: 33.76 GB (reserved: 47.58 GB)
[Step 5101] Student logits device: cuda:1, shape: torch.Size([2, 741, 151936]), dtype: torch.float32
[Step 5101] Student model device: cuda:1
[Step 5101] GPU 0 memory before teacher forward: 16.39 GB
[Step 5101] GPU 0 memory after moving inputs: 16.39 GB
[Step 5101] GPU 0 memory after teacher forward: 16.84 GB
[Step 5101] Teacher logits shape: torch.Size([2, 741, 151936]), dtype: torch.float16
[Step 5101] Teacher logits device before move: cuda:0
[Step 5101] Target device (student_logits.device): cuda:1
[Step 5101] GPU 0 memory after moving logits to GPU 1: 16.84 GB
[Step 5101] Teacher logits device after move: cuda:1, shape: torch.Size([2, 741, 151936])
[Step 5101] GPU 0 memory after del: 16.39 GB
[Step 5101] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 5101] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 37.01 GB
[Step 5101] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 5101] Sequence length: 741, Batch size: 2
[Step 5101] After KL computation - GPU 1: 38.81 GB
[Step 5101] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 5111] ========== MEMORY DEBUG ==========
[Step 5111] Model device: cuda:1
[Step 5111] Input device: cuda:1
[Step 5111] Teacher model device: cuda:0
[Step 5111] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 5111] GPU 1 memory: 33.76 GB (reserved: 47.71 GB)
[Step 5111] Student logits device: cuda:1, shape: torch.Size([2, 578, 151936]), dtype: torch.float32
[Step 5111] Student model device: cuda:1
[Step 5111] GPU 0 memory before teacher forward: 16.39 GB
[Step 5111] GPU 0 memory after moving inputs: 16.39 GB
[Step 5111] GPU 0 memory after teacher forward: 16.74 GB
[Step 5111] Teacher logits shape: torch.Size([2, 578, 151936]), dtype: torch.float16
[Step 5111] Teacher logits device before move: cuda:0
[Step 5111] Target device (student_logits.device): cuda:1
[Step 5111] GPU 0 memory after moving logits to GPU 1: 16.74 GB
[Step 5111] Teacher logits device after move: cuda:1, shape: torch.Size([2, 578, 151936])
[Step 5111] GPU 0 memory after del: 16.39 GB
[Step 5111] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 5111] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 36.44 GB
[Step 5111] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 5111] Sequence length: 578, Batch size: 2
[Step 5111] After KL computation - GPU 1: 37.84 GB
[Step 5111] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 4.88939393939394e-05, 'epoch': 0.03}

[Step 5121] ========== MEMORY DEBUG ==========
[Step 5121] Model device: cuda:1
[Step 5121] Input device: cuda:1
[Step 5121] Teacher model device: cuda:0
[Step 5121] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 5121] GPU 1 memory: 25.33 GB (reserved: 46.70 GB)
[Step 5121] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 5121] Student model device: cuda:1
[Step 5121] GPU 0 memory before teacher forward: 16.39 GB
[Step 5121] GPU 0 memory after moving inputs: 16.39 GB
[Step 5121] GPU 0 memory after teacher forward: 17.01 GB
[Step 5121] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 5121] Teacher logits device before move: cuda:0
[Step 5121] Target device (student_logits.device): cuda:1
[Step 5121] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 5121] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 5121] GPU 0 memory after del: 16.39 GB
[Step 5121] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 5121] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 29.58 GB
[Step 5121] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 5121] Sequence length: 1024, Batch size: 2
[Step 5121] After KL computation - GPU 1: 32.07 GB
[Step 5121] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(

[Step 5131] ========== MEMORY DEBUG ==========
[Step 5131] Model device: cuda:1
[Step 5131] Input device: cuda:1
[Step 5131] Teacher model device: cuda:0
[Step 5131] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 5131] GPU 1 memory: 33.76 GB (reserved: 47.73 GB)
[Step 5131] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 5131] Student model device: cuda:1
[Step 5131] GPU 0 memory before teacher forward: 16.39 GB
[Step 5131] GPU 0 memory after moving inputs: 16.39 GB
[Step 5131] GPU 0 memory after teacher forward: 17.01 GB
[Step 5131] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 5131] Teacher logits device before move: cuda:0
[Step 5131] Target device (student_logits.device): cuda:1
[Step 5131] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 5131] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 5131] GPU 0 memory after del: 16.39 GB
[Step 5131] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 5131] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 5131] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 5131] Sequence length: 1024, Batch size: 2
[Step 5131] After KL computation - GPU 1: 40.50 GB
[Step 5131] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  3%|                                                                                  | 321/10000 [1:53:25<56:52:57, 21.16s/it]

[Step 5141] ========== MEMORY DEBUG ==========
[Step 5141] Model device: cuda:1
[Step 5141] Input device: cuda:1
[Step 5141] Teacher model device: cuda:0
[Step 5141] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 5141] GPU 1 memory: 33.76 GB (reserved: 47.03 GB)
[Step 5141] Student logits device: cuda:1, shape: torch.Size([2, 331, 151936]), dtype: torch.float32
[Step 5141] Student model device: cuda:1
[Step 5141] GPU 0 memory before teacher forward: 16.39 GB
[Step 5141] GPU 0 memory after moving inputs: 16.39 GB
[Step 5141] GPU 0 memory after teacher forward: 16.59 GB
[Step 5141] Teacher logits shape: torch.Size([2, 331, 151936]), dtype: torch.float16
[Step 5141] Teacher logits device before move: cuda:0
[Step 5141] Target device (student_logits.device): cuda:1
[Step 5141] GPU 0 memory after moving logits to GPU 1: 16.59 GB
[Step 5141] Teacher logits device after move: cuda:1, shape: torch.Size([2, 331, 151936])
[Step 5141] GPU 0 memory after del: 16.39 GB
[Step 5141] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 5141] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 35.56 GB
[Step 5141] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 5141] Sequence length: 331, Batch size: 2
[Step 5141] After KL computation - GPU 1: 36.37 GB
[Step 5141] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 5151] ========== MEMORY DEBUG ==========
[Step 5151] Model device: cuda:1
[Step 5151] Input device: cuda:1
[Step 5151] Teacher model device: cuda:0
[Step 5151] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 5151] GPU 1 memory: 33.76 GB (reserved: 42.86 GB)
[Step 5151] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 5151] Student model device: cuda:1
[Step 5151] GPU 0 memory before teacher forward: 16.39 GB
[Step 5151] GPU 0 memory after moving inputs: 16.39 GB
[Step 5151] GPU 0 memory after teacher forward: 17.01 GB
[Step 5151] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 5151] Teacher logits device before move: cuda:0
[Step 5151] Target device (student_logits.device): cuda:1
[Step 5151] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 5151] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 5151] GPU 0 memory after del: 16.39 GB
[Step 5151] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 5151] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 5151] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 5151] Sequence length: 1024, Batch size: 2
[Step 5151] After KL computation - GPU 1: 40.50 GB
[Step 5151] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(

[Step 5161] ========== MEMORY DEBUG ==========
[Step 5161] Model device: cuda:1
[Step 5161] Input device: cuda:1
[Step 5161] Teacher model device: cuda:0
[Step 5161] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 5161] GPU 1 memory: 33.76 GB (reserved: 42.00 GB)
[Step 5161] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 5161] Student model device: cuda:1
[Step 5161] GPU 0 memory before teacher forward: 16.39 GB
[Step 5161] GPU 0 memory after moving inputs: 16.39 GB
[Step 5161] GPU 0 memory after teacher forward: 17.01 GB
[Step 5161] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 5161] Teacher logits device before move: cuda:0
[Step 5161] Target device (student_logits.device): cuda:1
[Step 5161] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 5161] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 5161] GPU 0 memory after del: 16.39 GB
[Step 5161] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 5161] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 5161] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 5161] Sequence length: 1024, Batch size: 2
[Step 5161] After KL computation - GPU 1: 40.50 GB
[Step 5161] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  3%|                                                                                  | 323/10000 [1:54:06<55:59:02, 20.83s/it]

[Step 5171] ========== MEMORY DEBUG ==========
[Step 5171] Model device: cuda:1
[Step 5171] Input device: cuda:1
[Step 5171] Teacher model device: cuda:0
[Step 5171] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 5171] GPU 1 memory: 33.76 GB (reserved: 41.20 GB)
[Step 5171] Student logits device: cuda:1, shape: torch.Size([2, 962, 151936]), dtype: torch.float32
[Step 5171] Student model device: cuda:1
[Step 5171] GPU 0 memory before teacher forward: 16.39 GB
[Step 5171] GPU 0 memory after moving inputs: 16.39 GB
[Step 5171] GPU 0 memory after teacher forward: 16.98 GB
[Step 5171] Teacher logits shape: torch.Size([2, 962, 151936]), dtype: torch.float16
[Step 5171] Teacher logits device before move: cuda:0
[Step 5171] Target device (student_logits.device): cuda:1
[Step 5171] GPU 0 memory after moving logits to GPU 1: 16.98 GB
[Step 5171] Teacher logits device after move: cuda:1, shape: torch.Size([2, 962, 151936])
[Step 5171] GPU 0 memory after del: 16.39 GB
[Step 5171] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 5171] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 37.80 GB
[Step 5171] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 5171] Sequence length: 962, Batch size: 2
[Step 5171] After KL computation - GPU 1: 40.14 GB
[Step 5171] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 5181] ========== MEMORY DEBUG ==========
[Step 5181] Model device: cuda:1
[Step 5181] Input device: cuda:1
[Step 5181] Teacher model device: cuda:0
[Step 5181] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 5181] GPU 1 memory: 33.76 GB (reserved: 47.44 GB)
[Step 5181] Student logits device: cuda:1, shape: torch.Size([2, 611, 151936]), dtype: torch.float32
[Step 5181] Student model device: cuda:1
[Step 5181] GPU 0 memory before teacher forward: 16.39 GB
[Step 5181] GPU 0 memory after moving inputs: 16.39 GB
[Step 5181] GPU 0 memory after teacher forward: 16.76 GB
[Step 5181] Teacher logits shape: torch.Size([2, 611, 151936]), dtype: torch.float16
[Step 5181] Teacher logits device before move: cuda:0
[Step 5181] Target device (student_logits.device): cuda:1
[Step 5181] GPU 0 memory after moving logits to GPU 1: 16.76 GB
[Step 5181] Teacher logits device after move: cuda:1, shape: torch.Size([2, 611, 151936])
[Step 5181] GPU 0 memory after del: 16.39 GB
[Step 5181] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 5181] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 36.55 GB
[Step 5181] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 5181] Sequence length: 611, Batch size: 2
[Step 5181] After KL computation - GPU 1: 38.04 GB
[Step 5181] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 5191] ========== MEMORY DEBUG ==========
[Step 5191] Model device: cuda:1
[Step 5191] Input device: cuda:1
[Step 5191] Teacher model device: cuda:0
[Step 5191] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 5191] GPU 1 memory: 33.76 GB (reserved: 47.75 GB)
[Step 5191] Student logits device: cuda:1, shape: torch.Size([2, 582, 151936]), dtype: torch.float32
[Step 5191] Student model device: cuda:1
[Step 5191] GPU 0 memory before teacher forward: 16.39 GB
[Step 5191] GPU 0 memory after moving inputs: 16.39 GB
[Step 5191] GPU 0 memory after teacher forward: 16.75 GB
[Step 5191] Teacher logits shape: torch.Size([2, 582, 151936]), dtype: torch.float16
[Step 5191] Teacher logits device before move: cuda:0
[Step 5191] Target device (student_logits.device): cuda:1
[Step 5191] GPU 0 memory after moving logits to GPU 1: 16.75 GB
[Step 5191] Teacher logits device after move: cuda:1, shape: torch.Size([2, 582, 151936])
[Step 5191] GPU 0 memory after del: 16.39 GB
[Step 5191] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 5191] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 36.45 GB
[Step 5191] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 5191] Sequence length: 582, Batch size: 2
[Step 5191] After KL computation - GPU 1: 37.86 GB
[Step 5191] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(
  3%|                                                                                  | 325/10000 [1:54:47<54:53:58, 20.43s/it]

[Step 5201] ========== MEMORY DEBUG ==========
[Step 5201] Model device: cuda:1
[Step 5201] Input device: cuda:1
[Step 5201] Teacher model device: cuda:0
[Step 5201] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 5201] GPU 1 memory: 25.33 GB (reserved: 47.26 GB)
[Step 5201] Student logits device: cuda:1, shape: torch.Size([2, 1016, 151936]), dtype: torch.float32
[Step 5201] Student model device: cuda:1
[Step 5201] GPU 0 memory before teacher forward: 16.39 GB
[Step 5201] GPU 0 memory after moving inputs: 16.39 GB
[Step 5201] GPU 0 memory after teacher forward: 17.01 GB
[Step 5201] Teacher logits shape: torch.Size([2, 1016, 151936]), dtype: torch.float16
[Step 5201] Teacher logits device before move: cuda:0
[Step 5201] Target device (student_logits.device): cuda:1
[Step 5201] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 5201] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1016, 151936])
[Step 5201] GPU 0 memory after del: 16.39 GB
[Step 5201] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 5201] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 29.55 GB
[Step 5201] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 5201] Sequence length: 1016, Batch size: 2
[Step 5201] After KL computation - GPU 1: 32.02 GB
[Step 5201] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 5211] ========== MEMORY DEBUG ==========
[Step 5211] Model device: cuda:1
[Step 5211] Input device: cuda:1
[Step 5211] Teacher model device: cuda:0
[Step 5211] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 5211] GPU 1 memory: 33.77 GB (reserved: 48.18 GB)
[Step 5211] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 5211] Student model device: cuda:1
[Step 5211] GPU 0 memory before teacher forward: 16.39 GB
[Step 5211] GPU 0 memory after moving inputs: 16.39 GB
[Step 5211] GPU 0 memory after teacher forward: 17.01 GB
[Step 5211] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 5211] Teacher logits device before move: cuda:0
[Step 5211] Target device (student_logits.device): cuda:1
[Step 5211] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 5211] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 5211] GPU 0 memory after del: 16.39 GB
[Step 5211] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 5211] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.02 GB
[Step 5211] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 5211] Sequence length: 1024, Batch size: 2
[Step 5211] After KL computation - GPU 1: 40.51 GB
[Step 5211] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(
  3%|                                                                                  | 326/10000 [1:55:07<55:20:46, 20.60s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 5221] ========== MEMORY DEBUG ==========
[Step 5221] Model device: cuda:1
[Step 5221] Input device: cuda:1
[Step 5221] Teacher model device: cuda:0
[Step 5221] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 5221] GPU 1 memory: 33.76 GB (reserved: 46.73 GB)
[Step 5221] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 5221] Student model device: cuda:1
[Step 5221] GPU 0 memory before teacher forward: 16.39 GB
[Step 5221] GPU 0 memory after moving inputs: 16.39 GB
[Step 5221] GPU 0 memory after teacher forward: 17.01 GB
[Step 5221] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 5221] Teacher logits device before move: cuda:0
[Step 5221] Target device (student_logits.device): cuda:1
[Step 5221] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 5221] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 5221] GPU 0 memory after del: 16.39 GB
[Step 5221] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 5221] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 5221] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 5221] Sequence length: 1024, Batch size: 2
[Step 5221] After KL computation - GPU 1: 40.50 GB
[Step 5221] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 5231] ========== MEMORY DEBUG ==========
[Step 5231] Model device: cuda:1
[Step 5231] Input device: cuda:1
[Step 5231] Teacher model device: cuda:0
[Step 5231] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 5231] GPU 1 memory: 33.76 GB (reserved: 47.77 GB)
[Step 5231] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 5231] Student model device: cuda:1
[Step 5231] GPU 0 memory before teacher forward: 16.39 GB
[Step 5231] GPU 0 memory after moving inputs: 16.39 GB
[Step 5231] GPU 0 memory after teacher forward: 17.01 GB
[Step 5231] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 5231] Teacher logits device before move: cuda:0
[Step 5231] Target device (student_logits.device): cuda:1
[Step 5231] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 5231] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 5231] GPU 0 memory after del: 16.39 GB
[Step 5231] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 5231] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 5231] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 5231] Sequence length: 1024, Batch size: 2
[Step 5231] After KL computation - GPU 1: 40.50 GB
[Step 5231] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  3%|                                                                                  | 327/10000 [1:55:28<55:19:56, 20.59s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 5241] ========== MEMORY DEBUG ==========
[Step 5241] Model device: cuda:1
[Step 5241] Input device: cuda:1
[Step 5241] Teacher model device: cuda:0
[Step 5241] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 5241] GPU 1 memory: 33.76 GB (reserved: 46.02 GB)
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
[Step 5241] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 5241] Student model device: cuda:1
[Step 5241] GPU 0 memory before teacher forward: 16.39 GB
[Step 5241] GPU 0 memory after moving inputs: 16.39 GB
[Step 5241] GPU 0 memory after teacher forward: 17.01 GB
[Step 5241] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 5241] Teacher logits device before move: cuda:0
[Step 5241] Target device (student_logits.device): cuda:1
[Step 5241] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 5241] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 5241] GPU 0 memory after del: 16.39 GB
[Step 5241] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 5241] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 5241] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 5241] Sequence length: 1024, Batch size: 2
[Step 5241] After KL computation - GPU 1: 40.50 GB
[Step 5241] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  3%|                                                                                  | 328/10000 [1:55:49<55:46:35, 20.76s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 5251] ========== MEMORY DEBUG ==========
[Step 5251] Model device: cuda:1
[Step 5251] Input device: cuda:1
[Step 5251] Teacher model device: cuda:0
[Step 5251] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 5251] GPU 1 memory: 33.76 GB (reserved: 41.88 GB)
[Step 5251] Student logits device: cuda:1, shape: torch.Size([2, 931, 151936]), dtype: torch.float32
[Step 5251] Student model device: cuda:1
[Step 5251] GPU 0 memory before teacher forward: 16.39 GB
[Step 5251] GPU 0 memory after moving inputs: 16.39 GB
[Step 5251] GPU 0 memory after teacher forward: 16.96 GB
[Step 5251] Teacher logits shape: torch.Size([2, 931, 151936]), dtype: torch.float16
[Step 5251] Teacher logits device before move: cuda:0
[Step 5251] Target device (student_logits.device): cuda:1
[Step 5251] GPU 0 memory after moving logits to GPU 1: 16.96 GB
[Step 5251] Teacher logits device after move: cuda:1, shape: torch.Size([2, 931, 151936])
[Step 5251] GPU 0 memory after del: 16.39 GB
[Step 5251] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 5251] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 37.69 GB
[Step 5251] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 5251] Sequence length: 931, Batch size: 2
[Step 5251] After KL computation - GPU 1: 39.95 GB
[Step 5251] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 5261] ========== MEMORY DEBUG ==========
[Step 5261] Model device: cuda:1
[Step 5261] Input device: cuda:1
[Step 5261] Teacher model device: cuda:0
[Step 5261] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 5261] GPU 1 memory: 33.76 GB (reserved: 45.54 GB)
[Step 5261] Student logits device: cuda:1, shape: torch.Size([2, 625, 151936]), dtype: torch.float32
[Step 5261] Student model device: cuda:1
[Step 5261] GPU 0 memory before teacher forward: 16.39 GB
[Step 5261] GPU 0 memory after moving inputs: 16.39 GB
[Step 5261] GPU 0 memory after teacher forward: 16.77 GB
[Step 5261] Teacher logits shape: torch.Size([2, 625, 151936]), dtype: torch.float16
[Step 5261] Teacher logits device before move: cuda:0
[Step 5261] Target device (student_logits.device): cuda:1
[Step 5261] GPU 0 memory after moving logits to GPU 1: 16.77 GB
[Step 5261] Teacher logits device after move: cuda:1, shape: torch.Size([2, 625, 151936])
[Step 5261] GPU 0 memory after del: 16.39 GB
[Step 5261] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 5261] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 36.60 GB
[Step 5261] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 5261] Sequence length: 625, Batch size: 2
[Step 5261] After KL computation - GPU 1: 38.12 GB
[Step 5261] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  3%|                                                                                  | 329/10000 [1:56:09<55:16:13, 20.57s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None

[Step 5271] ========== MEMORY DEBUG ==========
[Step 5271] Model device: cuda:1
[Step 5271] Input device: cuda:1
[Step 5271] Teacher model device: cuda:0
[Step 5271] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 5271] GPU 1 memory: 33.77 GB (reserved: 47.49 GB)
[Step 5271] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 5271] Student model device: cuda:1
[Step 5271] GPU 0 memory before teacher forward: 16.39 GB
[Step 5271] GPU 0 memory after moving inputs: 16.39 GB
[Step 5271] GPU 0 memory after teacher forward: 17.01 GB
[Step 5271] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 5271] Teacher logits device before move: cuda:0
[Step 5271] Target device (student_logits.device): cuda:1
[Step 5271] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 5271] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 5271] GPU 0 memory after del: 16.39 GB
[Step 5271] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 5271] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.02 GB
[Step 5271] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 5271] Sequence length: 1024, Batch size: 2
[Step 5271] After KL computation - GPU 1: 40.51 GB
[Step 5271] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  3%|                                                                                  | 330/10000 [1:56:38<62:01:28, 23.09s/it]
{'loss': 359.3222, 'grad_norm': nan, 'learning_rate': 4.884343434343435e-05, 'epoch': 0.03}

[Step 5281] ========== MEMORY DEBUG ==========
[Step 5281] Model device: cuda:1
[Step 5281] Input device: cuda:1
[Step 5281] Teacher model device: cuda:0
[Step 5281] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 5281] GPU 1 memory: 25.33 GB (reserved: 43.70 GB)
[Step 5281] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 5281] Student model device: cuda:1
[Step 5281] GPU 0 memory before teacher forward: 16.39 GB
[Step 5281] GPU 0 memory after moving inputs: 16.39 GB
[Step 5281] GPU 0 memory after teacher forward: 17.01 GB
[Step 5281] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 5281] Teacher logits device before move: cuda:0
[Step 5281] Target device (student_logits.device): cuda:1
[Step 5281] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 5281] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 5281] GPU 0 memory after del: 16.39 GB
[Step 5281] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 5281] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 29.58 GB
[Step 5281] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 5281] Sequence length: 1024, Batch size: 2
[Step 5281] After KL computation - GPU 1: 32.07 GB
[Step 5281] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 5291] ========== MEMORY DEBUG ==========
[Step 5291] Model device: cuda:1
[Step 5291] Input device: cuda:1
[Step 5291] Teacher model device: cuda:0
[Step 5291] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 5291] GPU 1 memory: 33.76 GB (reserved: 44.95 GB)
[Step 5291] Student logits device: cuda:1, shape: torch.Size([2, 336, 151936]), dtype: torch.float32
[Step 5291] Student model device: cuda:1
[Step 5291] GPU 0 memory before teacher forward: 16.39 GB
[Step 5291] GPU 0 memory after moving inputs: 16.39 GB
[Step 5291] GPU 0 memory after teacher forward: 16.60 GB
[Step 5291] Teacher logits shape: torch.Size([2, 336, 151936]), dtype: torch.float16
[Step 5291] Teacher logits device before move: cuda:0
[Step 5291] Target device (student_logits.device): cuda:1
[Step 5291] GPU 0 memory after moving logits to GPU 1: 16.60 GB
[Step 5291] Teacher logits device after move: cuda:1, shape: torch.Size([2, 336, 151936])
[Step 5291] GPU 0 memory after del: 16.39 GB
[Step 5291] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 5291] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 35.58 GB
[Step 5291] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 5291] Sequence length: 336, Batch size: 2
[Step 5291] After KL computation - GPU 1: 36.40 GB
[Step 5291] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 5301] ========== MEMORY DEBUG ==========
[Step 5301] Model device: cuda:1
[Step 5301] Input device: cuda:1
[Step 5301] Teacher model device: cuda:0
[Step 5301] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 5301] GPU 1 memory: 33.76 GB (reserved: 47.43 GB)
[Step 5301] Student logits device: cuda:1, shape: torch.Size([2, 857, 151936]), dtype: torch.float32
[Step 5301] Student model device: cuda:1
[Step 5301] GPU 0 memory before teacher forward: 16.39 GB
[Step 5301] GPU 0 memory after moving inputs: 16.39 GB
[Step 5301] GPU 0 memory after teacher forward: 16.91 GB
[Step 5301] Teacher logits shape: torch.Size([2, 857, 151936]), dtype: torch.float16
[Step 5301] Teacher logits device before move: cuda:0
[Step 5301] Target device (student_logits.device): cuda:1
[Step 5301] GPU 0 memory after moving logits to GPU 1: 16.91 GB
[Step 5301] Teacher logits device after move: cuda:1, shape: torch.Size([2, 857, 151936])
[Step 5301] GPU 0 memory after del: 16.39 GB
[Step 5301] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 5301] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 37.42 GB
[Step 5301] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 5301] Sequence length: 857, Batch size: 2
[Step 5301] After KL computation - GPU 1: 39.51 GB
[Step 5301] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 5311] ========== MEMORY DEBUG ==========
[Step 5311] Model device: cuda:1
[Step 5311] Input device: cuda:1
[Step 5311] Teacher model device: cuda:0
[Step 5311] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 5311] GPU 1 memory: 33.76 GB (reserved: 47.60 GB)
[Step 5311] Student logits device: cuda:1, shape: torch.Size([2, 813, 151936]), dtype: torch.float32
[Step 5311] Student model device: cuda:1
[Step 5311] GPU 0 memory before teacher forward: 16.39 GB
[Step 5311] GPU 0 memory after moving inputs: 16.39 GB
[Step 5311] GPU 0 memory after teacher forward: 16.89 GB
[Step 5311] Teacher logits shape: torch.Size([2, 813, 151936]), dtype: torch.float16
[Step 5311] Teacher logits device before move: cuda:0
[Step 5311] Target device (student_logits.device): cuda:1
[Step 5311] GPU 0 memory after moving logits to GPU 1: 16.89 GB
[Step 5311] Teacher logits device after move: cuda:1, shape: torch.Size([2, 813, 151936])
[Step 5311] GPU 0 memory after del: 16.39 GB
[Step 5311] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 5311] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 37.26 GB
[Step 5311] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 5311] Sequence length: 813, Batch size: 2
[Step 5311] After KL computation - GPU 1: 39.24 GB
[Step 5311] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(

[Step 5321] ========== MEMORY DEBUG ==========
[Step 5321] Model device: cuda:1
[Step 5321] Input device: cuda:1
[Step 5321] Teacher model device: cuda:0
[Step 5321] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 5321] GPU 1 memory: 33.76 GB (reserved: 47.53 GB)
[Step 5321] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 5321] Student model device: cuda:1
[Step 5321] GPU 0 memory before teacher forward: 16.39 GB
[Step 5321] GPU 0 memory after moving inputs: 16.39 GB
[Step 5321] GPU 0 memory after teacher forward: 17.01 GB
[Step 5321] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 5321] Teacher logits device before move: cuda:0
[Step 5321] Target device (student_logits.device): cuda:1
[Step 5321] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 5321] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 5321] GPU 0 memory after del: 16.39 GB
[Step 5321] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 5321] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 5321] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 5321] Sequence length: 1024, Batch size: 2
[Step 5321] After KL computation - GPU 1: 40.50 GB
[Step 5321] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  3%|                                                                                  | 333/10000 [1:57:39<57:45:50, 21.51s/it]

[Step 5331] ========== MEMORY DEBUG ==========
[Step 5331] Model device: cuda:1
[Step 5331] Input device: cuda:1
[Step 5331] Teacher model device: cuda:0
[Step 5331] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 5331] GPU 1 memory: 33.76 GB (reserved: 47.73 GB)
[Step 5331] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 5331] Student model device: cuda:1
[Step 5331] GPU 0 memory before teacher forward: 16.39 GB
[Step 5331] GPU 0 memory after moving inputs: 16.39 GB
[Step 5331] GPU 0 memory after teacher forward: 17.01 GB
[Step 5331] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 5331] Teacher logits device before move: cuda:0
[Step 5331] Target device (student_logits.device): cuda:1
[Step 5331] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 5331] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 5331] GPU 0 memory after del: 16.39 GB
[Step 5331] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 5331] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 5331] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 5331] Sequence length: 1024, Batch size: 2
[Step 5331] After KL computation - GPU 1: 40.50 GB
[Step 5331] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 5341] ========== MEMORY DEBUG ==========
[Step 5341] Model device: cuda:1
[Step 5341] Input device: cuda:1
[Step 5341] Teacher model device: cuda:0
[Step 5341] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 5341] GPU 1 memory: 33.76 GB (reserved: 47.77 GB)
[Step 5341] Student logits device: cuda:1, shape: torch.Size([2, 585, 151936]), dtype: torch.float32
[Step 5341] Student model device: cuda:1
[Step 5341] GPU 0 memory before teacher forward: 16.39 GB
[Step 5341] GPU 0 memory after moving inputs: 16.39 GB
[Step 5341] GPU 0 memory after teacher forward: 16.75 GB
[Step 5341] Teacher logits shape: torch.Size([2, 585, 151936]), dtype: torch.float16
[Step 5341] Teacher logits device before move: cuda:0
[Step 5341] Target device (student_logits.device): cuda:1
[Step 5341] GPU 0 memory after moving logits to GPU 1: 16.75 GB
[Step 5341] Teacher logits device after move: cuda:1, shape: torch.Size([2, 585, 151936])
[Step 5341] GPU 0 memory after del: 16.39 GB
[Step 5341] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 5341] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 36.46 GB
[Step 5341] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 5341] Sequence length: 585, Batch size: 2
[Step 5341] After KL computation - GPU 1: 37.88 GB
[Step 5341] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 5351] ========== MEMORY DEBUG ==========
[Step 5351] Model device: cuda:1
[Step 5351] Input device: cuda:1
[Step 5351] Teacher model device: cuda:0
[Step 5351] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 5351] GPU 1 memory: 33.77 GB (reserved: 47.83 GB)
[Step 5351] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 5351] Student model device: cuda:1
[Step 5351] GPU 0 memory before teacher forward: 16.39 GB
[Step 5351] GPU 0 memory after moving inputs: 16.39 GB
[Step 5351] GPU 0 memory after teacher forward: 17.01 GB
[Step 5351] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 5351] Teacher logits device before move: cuda:0
[Step 5351] Target device (student_logits.device): cuda:1
[Step 5351] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 5351] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 5351] GPU 0 memory after del: 16.39 GB
[Step 5351] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 5351] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.02 GB
[Step 5351] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 5351] Sequence length: 1024, Batch size: 2
[Step 5351] After KL computation - GPU 1: 40.51 GB
[Step 5351] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(
  3%|                                                                                  | 335/10000 [1:58:20<55:59:23, 20.85s/it]

[Step 5361] ========== MEMORY DEBUG ==========
[Step 5361] Model device: cuda:1
[Step 5361] Input device: cuda:1
[Step 5361] Teacher model device: cuda:0
[Step 5361] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 5361] GPU 1 memory: 25.33 GB (reserved: 47.89 GB)
[Step 5361] Student logits device: cuda:1, shape: torch.Size([2, 622, 151936]), dtype: torch.float32
[Step 5361] Student model device: cuda:1
[Step 5361] GPU 0 memory before teacher forward: 16.39 GB
[Step 5361] GPU 0 memory after moving inputs: 16.39 GB
[Step 5361] GPU 0 memory after teacher forward: 16.77 GB
[Step 5361] Teacher logits shape: torch.Size([2, 622, 151936]), dtype: torch.float16
[Step 5361] Teacher logits device before move: cuda:0
[Step 5361] Target device (student_logits.device): cuda:1
[Step 5361] GPU 0 memory after moving logits to GPU 1: 16.77 GB
[Step 5361] Teacher logits device after move: cuda:1, shape: torch.Size([2, 622, 151936])
[Step 5361] GPU 0 memory after del: 16.39 GB
[Step 5361] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 5361] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 28.15 GB
[Step 5361] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 5361] Sequence length: 622, Batch size: 2
[Step 5361] After KL computation - GPU 1: 29.66 GB
[Step 5361] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 5371] ========== MEMORY DEBUG ==========
[Step 5371] Model device: cuda:1
[Step 5371] Input device: cuda:1
[Step 5371] Teacher model device: cuda:0
[Step 5371] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 5371] GPU 1 memory: 33.77 GB (reserved: 48.02 GB)
[Step 5371] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 5371] Student model device: cuda:1
[Step 5371] GPU 0 memory before teacher forward: 16.39 GB
[Step 5371] GPU 0 memory after moving inputs: 16.39 GB
[Step 5371] GPU 0 memory after teacher forward: 17.01 GB
[Step 5371] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 5371] Teacher logits device before move: cuda:0
[Step 5371] Target device (student_logits.device): cuda:1
[Step 5371] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 5371] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 5371] GPU 0 memory after del: 16.39 GB
[Step 5371] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 5371] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.02 GB
[Step 5371] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 5371] Sequence length: 1024, Batch size: 2
[Step 5371] After KL computation - GPU 1: 40.51 GB
[Step 5371] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 5381] ========== MEMORY DEBUG ==========
[Step 5381] Model device: cuda:1
[Step 5381] Input device: cuda:1
[Step 5381] Teacher model device: cuda:0
[Step 5381] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 5381] GPU 1 memory: 33.76 GB (reserved: 47.84 GB)
[Step 5381] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 5381] Student model device: cuda:1
[Step 5381] GPU 0 memory before teacher forward: 16.39 GB
[Step 5381] GPU 0 memory after moving inputs: 16.39 GB
[Step 5381] GPU 0 memory after teacher forward: 17.01 GB
[Step 5381] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 5381] Teacher logits device before move: cuda:0
[Step 5381] Target device (student_logits.device): cuda:1
[Step 5381] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 5381] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 5381] GPU 0 memory after del: 16.39 GB
[Step 5381] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 5381] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 5381] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 5381] Sequence length: 1024, Batch size: 2
[Step 5381] After KL computation - GPU 1: 40.50 GB
[Step 5381] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 5391] ========== MEMORY DEBUG ==========
[Step 5391] Model device: cuda:1
[Step 5391] Input device: cuda:1
[Step 5391] Teacher model device: cuda:0
[Step 5391] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 5391] GPU 1 memory: 33.76 GB (reserved: 43.70 GB)
[Step 5391] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 5391] Student model device: cuda:1
[Step 5391] GPU 0 memory before teacher forward: 16.39 GB
[Step 5391] GPU 0 memory after moving inputs: 16.39 GB
[Step 5391] GPU 0 memory after teacher forward: 17.01 GB
[Step 5391] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 5391] Teacher logits device before move: cuda:0
[Step 5391] Target device (student_logits.device): cuda:1
[Step 5391] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 5391] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 5391] GPU 0 memory after del: 16.39 GB
[Step 5391] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 5391] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 5391] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 5391] Sequence length: 1024, Batch size: 2
[Step 5391] After KL computation - GPU 1: 40.50 GB
[Step 5391] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 5401] ========== MEMORY DEBUG ==========
[Step 5401] Model device: cuda:1
[Step 5401] Input device: cuda:1
[Step 5401] Teacher model device: cuda:0
[Step 5401] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 5401] GPU 1 memory: 33.76 GB (reserved: 47.68 GB)
[Step 5401] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 5401] Student model device: cuda:1
[Step 5401] GPU 0 memory before teacher forward: 16.39 GB
[Step 5401] GPU 0 memory after moving inputs: 16.39 GB
[Step 5401] GPU 0 memory after teacher forward: 17.01 GB
[Step 5401] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 5401] Teacher logits device before move: cuda:0
[Step 5401] Target device (student_logits.device): cuda:1
[Step 5401] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 5401] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 5401] GPU 0 memory after del: 16.39 GB
[Step 5401] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 5401] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 5401] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 5401] Sequence length: 1024, Batch size: 2
[Step 5401] After KL computation - GPU 1: 40.50 GB
[Step 5401] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(
  3%|                                                                                  | 338/10000 [1:59:22<55:54:58, 20.83s/it]

[Step 5411] ========== MEMORY DEBUG ==========
[Step 5411] Model device: cuda:1
[Step 5411] Input device: cuda:1
[Step 5411] Teacher model device: cuda:0
[Step 5411] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 5411] GPU 1 memory: 33.76 GB (reserved: 47.72 GB)
[Step 5411] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 5411] Student model device: cuda:1
[Step 5411] GPU 0 memory before teacher forward: 16.39 GB
[Step 5411] GPU 0 memory after moving inputs: 16.39 GB
[Step 5411] GPU 0 memory after teacher forward: 17.01 GB
[Step 5411] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 5411] Teacher logits device before move: cuda:0
[Step 5411] Target device (student_logits.device): cuda:1
[Step 5411] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 5411] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 5411] GPU 0 memory after del: 16.39 GB
[Step 5411] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 5411] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 5411] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 5411] Sequence length: 1024, Batch size: 2
[Step 5411] After KL computation - GPU 1: 40.50 GB
[Step 5411] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 5421] ========== MEMORY DEBUG ==========
[Step 5421] Model device: cuda:1
[Step 5421] Input device: cuda:1
[Step 5421] Teacher model device: cuda:0
[Step 5421] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 5421] GPU 1 memory: 33.76 GB (reserved: 47.34 GB)
[Step 5421] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 5421] Student model device: cuda:1
[Step 5421] GPU 0 memory before teacher forward: 16.39 GB
[Step 5421] GPU 0 memory after moving inputs: 16.39 GB
[Step 5421] GPU 0 memory after teacher forward: 17.01 GB
[Step 5421] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 5421] Teacher logits device before move: cuda:0
[Step 5421] Target device (student_logits.device): cuda:1
[Step 5421] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 5421] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 5421] GPU 0 memory after del: 16.39 GB
[Step 5421] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 5421] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 5421] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 5421] Sequence length: 1024, Batch size: 2
[Step 5421] After KL computation - GPU 1: 40.50 GB
[Step 5421] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(

[Step 5431] ========== MEMORY DEBUG ==========
[Step 5431] Model device: cuda:1
[Step 5431] Input device: cuda:1
[Step 5431] Teacher model device: cuda:0
[Step 5431] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 5431] GPU 1 memory: 33.76 GB (reserved: 47.75 GB)
[Step 5431] Student logits device: cuda:1, shape: torch.Size([2, 535, 151936]), dtype: torch.float32
[Step 5431] Student model device: cuda:1
[Step 5431] GPU 0 memory before teacher forward: 16.39 GB
[Step 5431] GPU 0 memory after moving inputs: 16.39 GB
[Step 5431] GPU 0 memory after teacher forward: 16.72 GB
[Step 5431] Teacher logits shape: torch.Size([2, 535, 151936]), dtype: torch.float16
[Step 5431] Teacher logits device before move: cuda:0
[Step 5431] Target device (student_logits.device): cuda:1
[Step 5431] GPU 0 memory after moving logits to GPU 1: 16.72 GB
[Step 5431] Teacher logits device after move: cuda:1, shape: torch.Size([2, 535, 151936])
[Step 5431] GPU 0 memory after del: 16.39 GB
[Step 5431] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 5431] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 36.28 GB
[Step 5431] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 5431] Sequence length: 535, Batch size: 2
[Step 5431] After KL computation - GPU 1: 37.58 GB
[Step 5431] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  3%|                                                                                  | 340/10000 [2:00:02<54:44:51, 20.40s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 4.879292929292929e-05, 'epoch': 0.03}

[Step 5441] ========== MEMORY DEBUG ==========
[Step 5441] Model device: cuda:1
[Step 5441] Input device: cuda:1
[Step 5441] Teacher model device: cuda:0
[Step 5441] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 5441] GPU 1 memory: 25.33 GB (reserved: 40.97 GB)
  warnings.warn(
[Step 5441] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 5441] Student model device: cuda:1
[Step 5441] GPU 0 memory before teacher forward: 16.39 GB
[Step 5441] GPU 0 memory after moving inputs: 16.39 GB
[Step 5441] GPU 0 memory after teacher forward: 17.01 GB
[Step 5441] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 5441] Teacher logits device before move: cuda:0
[Step 5441] Target device (student_logits.device): cuda:1
[Step 5441] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 5441] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 5441] GPU 0 memory after del: 16.39 GB
[Step 5441] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 5441] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 29.58 GB
[Step 5441] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 5441] Sequence length: 1024, Batch size: 2
[Step 5441] After KL computation - GPU 1: 32.07 GB
[Step 5441] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 5451] ========== MEMORY DEBUG ==========
[Step 5451] Model device: cuda:1
[Step 5451] Input device: cuda:1
[Step 5451] Teacher model device: cuda:0
[Step 5451] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 5451] GPU 1 memory: 33.76 GB (reserved: 47.71 GB)
[Step 5451] Student logits device: cuda:1, shape: torch.Size([2, 302, 151936]), dtype: torch.float32
[Step 5451] Student model device: cuda:1
[Step 5451] GPU 0 memory before teacher forward: 16.39 GB
[Step 5451] GPU 0 memory after moving inputs: 16.39 GB
[Step 5451] GPU 0 memory after teacher forward: 16.58 GB
[Step 5451] Teacher logits shape: torch.Size([2, 302, 151936]), dtype: torch.float16
[Step 5451] Teacher logits device before move: cuda:0
[Step 5451] Target device (student_logits.device): cuda:1
[Step 5451] GPU 0 memory after moving logits to GPU 1: 16.58 GB
[Step 5451] Teacher logits device after move: cuda:1, shape: torch.Size([2, 302, 151936])
[Step 5451] GPU 0 memory after del: 16.39 GB
[Step 5451] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 5451] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 35.46 GB
[Step 5451] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 5451] Sequence length: 302, Batch size: 2
[Step 5451] After KL computation - GPU 1: 36.19 GB
[Step 5451] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  3%|                                                                                  | 341/10000 [2:00:23<55:00:55, 20.50s/it]

[Step 5461] ========== MEMORY DEBUG ==========
[Step 5461] Model device: cuda:1
[Step 5461] Input device: cuda:1
[Step 5461] Teacher model device: cuda:0
[Step 5461] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 5461] GPU 1 memory: 33.76 GB (reserved: 43.46 GB)
[Step 5461] Student logits device: cuda:1, shape: torch.Size([2, 592, 151936]), dtype: torch.float32
[Step 5461] Student model device: cuda:1
[Step 5461] GPU 0 memory before teacher forward: 16.39 GB
[Step 5461] GPU 0 memory after moving inputs: 16.39 GB
[Step 5461] GPU 0 memory after teacher forward: 16.75 GB
[Step 5461] Teacher logits shape: torch.Size([2, 592, 151936]), dtype: torch.float16
[Step 5461] Teacher logits device before move: cuda:0
[Step 5461] Target device (student_logits.device): cuda:1
[Step 5461] GPU 0 memory after moving logits to GPU 1: 16.75 GB
[Step 5461] Teacher logits device after move: cuda:1, shape: torch.Size([2, 592, 151936])
[Step 5461] GPU 0 memory after del: 16.39 GB
[Step 5461] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 5461] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 36.48 GB
[Step 5461] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 5461] Sequence length: 592, Batch size: 2
[Step 5461] After KL computation - GPU 1: 37.92 GB
[Step 5461] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 5471] ========== MEMORY DEBUG ==========
[Step 5471] Model device: cuda:1
[Step 5471] Input device: cuda:1
[Step 5471] Teacher model device: cuda:0
[Step 5471] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 5471] GPU 1 memory: 33.76 GB (reserved: 45.64 GB)
[Step 5471] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 5471] Student model device: cuda:1
[Step 5471] GPU 0 memory before teacher forward: 16.39 GB
[Step 5471] GPU 0 memory after moving inputs: 16.39 GB
[Step 5471] GPU 0 memory after teacher forward: 17.01 GB
[Step 5471] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 5471] Teacher logits device before move: cuda:0
[Step 5471] Target device (student_logits.device): cuda:1
[Step 5471] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 5471] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 5471] GPU 0 memory after del: 16.39 GB
[Step 5471] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 5471] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 5471] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 5471] Sequence length: 1024, Batch size: 2
[Step 5471] After KL computation - GPU 1: 40.50 GB
[Step 5471] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(

[Step 5481] ========== MEMORY DEBUG ==========
[Step 5481] Model device: cuda:1
[Step 5481] Input device: cuda:1
[Step 5481] Teacher model device: cuda:0
[Step 5481] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 5481] GPU 1 memory: 33.76 GB (reserved: 47.46 GB)
[Step 5481] Student logits device: cuda:1, shape: torch.Size([2, 840, 151936]), dtype: torch.float32
[Step 5481] Student model device: cuda:1
[Step 5481] GPU 0 memory before teacher forward: 16.39 GB
[Step 5481] GPU 0 memory after moving inputs: 16.39 GB
[Step 5481] GPU 0 memory after teacher forward: 16.90 GB
[Step 5481] Teacher logits shape: torch.Size([2, 840, 151936]), dtype: torch.float16
[Step 5481] Teacher logits device before move: cuda:0
[Step 5481] Target device (student_logits.device): cuda:1
[Step 5481] GPU 0 memory after moving logits to GPU 1: 16.90 GB
[Step 5481] Teacher logits device after move: cuda:1, shape: torch.Size([2, 840, 151936])
[Step 5481] GPU 0 memory after del: 16.39 GB
[Step 5481] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 5481] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 37.36 GB
[Step 5481] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 5481] Sequence length: 840, Batch size: 2
[Step 5481] After KL computation - GPU 1: 39.40 GB
[Step 5481] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  3%|                                                                                  | 343/10000 [2:01:03<54:49:38, 20.44s/it]

[Step 5491] ========== MEMORY DEBUG ==========
[Step 5491] Model device: cuda:1
[Step 5491] Input device: cuda:1
[Step 5491] Teacher model device: cuda:0
[Step 5491] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 5491] GPU 1 memory: 33.76 GB (reserved: 47.20 GB)
[Step 5491] Student logits device: cuda:1, shape: torch.Size([2, 612, 151936]), dtype: torch.float32
[Step 5491] Student model device: cuda:1
[Step 5491] GPU 0 memory before teacher forward: 16.39 GB
[Step 5491] GPU 0 memory after moving inputs: 16.39 GB
[Step 5491] GPU 0 memory after teacher forward: 16.76 GB
[Step 5491] Teacher logits shape: torch.Size([2, 612, 151936]), dtype: torch.float16
[Step 5491] Teacher logits device before move: cuda:0
[Step 5491] Target device (student_logits.device): cuda:1
[Step 5491] GPU 0 memory after moving logits to GPU 1: 16.76 GB
[Step 5491] Teacher logits device after move: cuda:1, shape: torch.Size([2, 612, 151936])
[Step 5491] GPU 0 memory after del: 16.39 GB
[Step 5491] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 5491] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 36.55 GB
[Step 5491] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 5491] Sequence length: 612, Batch size: 2
[Step 5491] After KL computation - GPU 1: 38.04 GB
[Step 5491] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 5501] ========== MEMORY DEBUG ==========
[Step 5501] Model device: cuda:1
[Step 5501] Input device: cuda:1
[Step 5501] Teacher model device: cuda:0
[Step 5501] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 5501] GPU 1 memory: 33.76 GB (reserved: 44.29 GB)
[Step 5501] Student logits device: cuda:1, shape: torch.Size([2, 977, 151936]), dtype: torch.float32
[Step 5501] Student model device: cuda:1
[Step 5501] GPU 0 memory before teacher forward: 16.39 GB
[Step 5501] GPU 0 memory after moving inputs: 16.39 GB
[Step 5501] GPU 0 memory after teacher forward: 16.99 GB
[Step 5501] Teacher logits shape: torch.Size([2, 977, 151936]), dtype: torch.float16
[Step 5501] Teacher logits device before move: cuda:0
[Step 5501] Target device (student_logits.device): cuda:1
[Step 5501] GPU 0 memory after moving logits to GPU 1: 16.99 GB
[Step 5501] Teacher logits device after move: cuda:1, shape: torch.Size([2, 977, 151936])
[Step 5501] GPU 0 memory after del: 16.39 GB
[Step 5501] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 5501] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 37.85 GB
[Step 5501] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 5501] Sequence length: 977, Batch size: 2
[Step 5501] After KL computation - GPU 1: 40.22 GB
[Step 5501] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 5511] ========== MEMORY DEBUG ==========
[Step 5511] Model device: cuda:1
[Step 5511] Input device: cuda:1
[Step 5511] Teacher model device: cuda:0
[Step 5511] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 5511] GPU 1 memory: 33.77 GB (reserved: 48.71 GB)
[Step 5511] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 5511] Student model device: cuda:1
[Step 5511] GPU 0 memory before teacher forward: 16.39 GB
[Step 5511] GPU 0 memory after moving inputs: 16.39 GB
[Step 5511] GPU 0 memory after teacher forward: 17.01 GB
[Step 5511] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 5511] Teacher logits device before move: cuda:0
[Step 5511] Target device (student_logits.device): cuda:1
[Step 5511] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 5511] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 5511] GPU 0 memory after del: 16.39 GB
[Step 5511] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 5511] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.02 GB
[Step 5511] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 5511] Sequence length: 1024, Batch size: 2
[Step 5511] After KL computation - GPU 1: 40.51 GB
[Step 5511] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(
  3%|                                                                                  | 345/10000 [2:01:46<55:53:14, 20.84s/it]

[Step 5521] ========== MEMORY DEBUG ==========
[Step 5521] Model device: cuda:1
[Step 5521] Input device: cuda:1
[Step 5521] Teacher model device: cuda:0
[Step 5521] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 5521] GPU 1 memory: 25.33 GB (reserved: 47.94 GB)
[Step 5521] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 5521] Student model device: cuda:1
[Step 5521] GPU 0 memory before teacher forward: 16.39 GB
[Step 5521] GPU 0 memory after moving inputs: 16.39 GB
[Step 5521] GPU 0 memory after teacher forward: 17.01 GB
[Step 5521] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 5521] Teacher logits device before move: cuda:0
[Step 5521] Target device (student_logits.device): cuda:1
[Step 5521] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 5521] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 5521] GPU 0 memory after del: 16.39 GB
[Step 5521] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 5521] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 29.58 GB
[Step 5521] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 5521] Sequence length: 1024, Batch size: 2
[Step 5521] After KL computation - GPU 1: 32.07 GB
[Step 5521] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 5531] ========== MEMORY DEBUG ==========
[Step 5531] Model device: cuda:1
[Step 5531] Input device: cuda:1
[Step 5531] Teacher model device: cuda:0
[Step 5531] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 5531] GPU 1 memory: 33.76 GB (reserved: 47.51 GB)
[Step 5531] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 5531] Student model device: cuda:1
[Step 5531] GPU 0 memory before teacher forward: 16.39 GB
[Step 5531] GPU 0 memory after moving inputs: 16.39 GB
[Step 5531] GPU 0 memory after teacher forward: 17.01 GB
[Step 5531] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 5531] Teacher logits device before move: cuda:0
[Step 5531] Target device (student_logits.device): cuda:1
[Step 5531] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 5531] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 5531] GPU 0 memory after del: 16.39 GB
[Step 5531] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 5531] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 5531] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 5531] Sequence length: 1024, Batch size: 2
[Step 5531] After KL computation - GPU 1: 40.50 GB
[Step 5531] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(

[Step 5541] ========== MEMORY DEBUG ==========
[Step 5541] Model device: cuda:1
[Step 5541] Input device: cuda:1
[Step 5541] Teacher model device: cuda:0
[Step 5541] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 5541] GPU 1 memory: 33.77 GB (reserved: 48.07 GB)
[Step 5541] Student logits device: cuda:1, shape: torch.Size([2, 755, 151936]), dtype: torch.float32
[Step 5541] Student model device: cuda:1
[Step 5541] GPU 0 memory before teacher forward: 16.39 GB
[Step 5541] GPU 0 memory after moving inputs: 16.39 GB
[Step 5541] GPU 0 memory after teacher forward: 16.85 GB
[Step 5541] Teacher logits shape: torch.Size([2, 755, 151936]), dtype: torch.float16
[Step 5541] Teacher logits device before move: cuda:0
[Step 5541] Target device (student_logits.device): cuda:1
[Step 5541] GPU 0 memory after moving logits to GPU 1: 16.85 GB
[Step 5541] Teacher logits device after move: cuda:1, shape: torch.Size([2, 755, 151936])
[Step 5541] GPU 0 memory after del: 16.39 GB
[Step 5541] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 5541] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 37.06 GB
[Step 5541] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 5541] Sequence length: 755, Batch size: 2
[Step 5541] After KL computation - GPU 1: 38.90 GB
[Step 5541] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 5551] ========== MEMORY DEBUG ==========
[Step 5551] Model device: cuda:1
[Step 5551] Input device: cuda:1
[Step 5551] Teacher model device: cuda:0
[Step 5551] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 5551] GPU 1 memory: 33.77 GB (reserved: 47.84 GB)
[Step 5551] Student logits device: cuda:1, shape: torch.Size([2, 468, 151936]), dtype: torch.float32
[Step 5551] Student model device: cuda:1
[Step 5551] GPU 0 memory before teacher forward: 16.39 GB
[Step 5551] GPU 0 memory after moving inputs: 16.39 GB
[Step 5551] GPU 0 memory after teacher forward: 16.68 GB
[Step 5551] Teacher logits shape: torch.Size([2, 468, 151936]), dtype: torch.float16
[Step 5551] Teacher logits device before move: cuda:0
[Step 5551] Target device (student_logits.device): cuda:1
[Step 5551] GPU 0 memory after moving logits to GPU 1: 16.68 GB
[Step 5551] Teacher logits device after move: cuda:1, shape: torch.Size([2, 468, 151936])
[Step 5551] GPU 0 memory after del: 16.39 GB
[Step 5551] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 5551] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 36.05 GB
[Step 5551] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 5551] Sequence length: 468, Batch size: 2
[Step 5551] After KL computation - GPU 1: 37.19 GB
[Step 5551] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  3%|                                                                                  | 348/10000 [2:02:47<55:47:00, 20.81s/it]

[Step 5561] ========== MEMORY DEBUG ==========
[Step 5561] Model device: cuda:1
[Step 5561] Input device: cuda:1
[Step 5561] Teacher model device: cuda:0
[Step 5561] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 5561] GPU 1 memory: 33.76 GB (reserved: 47.61 GB)
[Step 5561] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 5561] Student model device: cuda:1
[Step 5561] GPU 0 memory before teacher forward: 16.39 GB
[Step 5561] GPU 0 memory after moving inputs: 16.39 GB
[Step 5561] GPU 0 memory after teacher forward: 17.01 GB
[Step 5561] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 5561] Teacher logits device before move: cuda:0
[Step 5561] Target device (student_logits.device): cuda:1
[Step 5561] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 5561] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 5561] GPU 0 memory after del: 16.39 GB
[Step 5561] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 5561] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 5561] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 5561] Sequence length: 1024, Batch size: 2
[Step 5561] After KL computation - GPU 1: 40.50 GB
[Step 5561] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 5571] ========== MEMORY DEBUG ==========
[Step 5571] Model device: cuda:1
[Step 5571] Input device: cuda:1
[Step 5571] Teacher model device: cuda:0
[Step 5571] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 5571] GPU 1 memory: 33.76 GB (reserved: 40.58 GB)
[Step 5571] Student logits device: cuda:1, shape: torch.Size([2, 286, 151936]), dtype: torch.float32
[Step 5571] Student model device: cuda:1
[Step 5571] GPU 0 memory before teacher forward: 16.39 GB
[Step 5571] GPU 0 memory after moving inputs: 16.39 GB
[Step 5571] GPU 0 memory after teacher forward: 16.57 GB
[Step 5571] Teacher logits shape: torch.Size([2, 286, 151936]), dtype: torch.float16
[Step 5571] Teacher logits device before move: cuda:0
[Step 5571] Target device (student_logits.device): cuda:1
[Step 5571] GPU 0 memory after moving logits to GPU 1: 16.57 GB
[Step 5571] Teacher logits device after move: cuda:1, shape: torch.Size([2, 286, 151936])
[Step 5571] GPU 0 memory after del: 16.39 GB
[Step 5571] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 5571] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 35.40 GB
[Step 5571] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 5571] Sequence length: 286, Batch size: 2
[Step 5571] After KL computation - GPU 1: 36.10 GB
[Step 5571] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(

[Step 5581] ========== MEMORY DEBUG ==========
[Step 5581] Model device: cuda:1
[Step 5581] Input device: cuda:1
[Step 5581] Teacher model device: cuda:0
[Step 5581] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 5581] GPU 1 memory: 33.76 GB (reserved: 47.65 GB)
[Step 5581] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 5581] Student model device: cuda:1
[Step 5581] GPU 0 memory before teacher forward: 16.39 GB
[Step 5581] GPU 0 memory after moving inputs: 16.39 GB
[Step 5581] GPU 0 memory after teacher forward: 17.01 GB
[Step 5581] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 5581] Teacher logits device before move: cuda:0
[Step 5581] Target device (student_logits.device): cuda:1
[Step 5581] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 5581] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 5581] GPU 0 memory after del: 16.39 GB
[Step 5581] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 5581] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 5581] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 5581] Sequence length: 1024, Batch size: 2
[Step 5581] After KL computation - GPU 1: 40.50 GB
[Step 5581] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  4%|                                                                                  | 350/10000 [2:03:27<55:01:28, 20.53s/it]

[Step 5591] ========== MEMORY DEBUG ==========
[Step 5591] Model device: cuda:1
[Step 5591] Input device: cuda:1
[Step 5591] Teacher model device: cuda:0
[Step 5591] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 5591] GPU 1 memory: 33.76 GB (reserved: 47.49 GB)
[Step 5591] Student logits device: cuda:1, shape: torch.Size([2, 576, 151936]), dtype: torch.float32
[Step 5591] Student model device: cuda:1
[Step 5591] GPU 0 memory before teacher forward: 16.39 GB
[Step 5591] GPU 0 memory after moving inputs: 16.39 GB
[Step 5591] GPU 0 memory after teacher forward: 16.74 GB
[Step 5591] Teacher logits shape: torch.Size([2, 576, 151936]), dtype: torch.float16
[Step 5591] Teacher logits device before move: cuda:0
[Step 5591] Target device (student_logits.device): cuda:1
[Step 5591] GPU 0 memory after moving logits to GPU 1: 16.74 GB
[Step 5591] Teacher logits device after move: cuda:1, shape: torch.Size([2, 576, 151936])
[Step 5591] GPU 0 memory after del: 16.39 GB
[Step 5591] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 5591] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 36.43 GB
[Step 5591] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 5591] Sequence length: 576, Batch size: 2
[Step 5591] After KL computation - GPU 1: 37.83 GB
[Step 5591] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 4.8742424242424246e-05, 'epoch': 0.04}

[Step 5601] ========== MEMORY DEBUG ==========
[Step 5601] Model device: cuda:1
[Step 5601] Input device: cuda:1
[Step 5601] Teacher model device: cuda:0
[Step 5601] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 5601] GPU 1 memory: 25.33 GB (reserved: 47.78 GB)
[Step 5601] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 5601] Student model device: cuda:1
[Step 5601] GPU 0 memory before teacher forward: 16.39 GB
[Step 5601] GPU 0 memory after moving inputs: 16.39 GB
[Step 5601] GPU 0 memory after teacher forward: 17.01 GB
[Step 5601] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 5601] Teacher logits device before move: cuda:0
[Step 5601] Target device (student_logits.device): cuda:1
[Step 5601] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 5601] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 5601] GPU 0 memory after del: 16.39 GB
[Step 5601] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 5601] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 29.58 GB
[Step 5601] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 5601] Sequence length: 1024, Batch size: 2
[Step 5601] After KL computation - GPU 1: 32.06 GB
[Step 5601] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 5611] ========== MEMORY DEBUG ==========
[Step 5611] Model device: cuda:1
[Step 5611] Input device: cuda:1
[Step 5611] Teacher model device: cuda:0
[Step 5611] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 5611] GPU 1 memory: 33.76 GB (reserved: 47.56 GB)
[Step 5611] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 5611] Student model device: cuda:1
[Step 5611] GPU 0 memory before teacher forward: 16.39 GB
[Step 5611] GPU 0 memory after moving inputs: 16.39 GB
[Step 5611] GPU 0 memory after teacher forward: 17.01 GB
[Step 5611] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 5611] Teacher logits device before move: cuda:0
[Step 5611] Target device (student_logits.device): cuda:1
[Step 5611] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 5611] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 5611] GPU 0 memory after del: 16.39 GB
[Step 5611] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 5611] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 5611] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 5611] Sequence length: 1024, Batch size: 2
[Step 5611] After KL computation - GPU 1: 40.50 GB
[Step 5611] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 5621] ========== MEMORY DEBUG ==========
[Step 5621] Model device: cuda:1
[Step 5621] Input device: cuda:1
[Step 5621] Teacher model device: cuda:0
[Step 5621] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 5621] GPU 1 memory: 33.76 GB (reserved: 47.70 GB)
[Step 5621] Student logits device: cuda:1, shape: torch.Size([2, 496, 151936]), dtype: torch.float32
[Step 5621] Student model device: cuda:1
[Step 5621] GPU 0 memory before teacher forward: 16.39 GB
[Step 5621] GPU 0 memory after moving inputs: 16.39 GB
[Step 5621] GPU 0 memory after teacher forward: 16.69 GB
[Step 5621] Teacher logits shape: torch.Size([2, 496, 151936]), dtype: torch.float16
[Step 5621] Teacher logits device before move: cuda:0
[Step 5621] Target device (student_logits.device): cuda:1
[Step 5621] GPU 0 memory after moving logits to GPU 1: 16.69 GB
[Step 5621] Teacher logits device after move: cuda:1, shape: torch.Size([2, 496, 151936])
[Step 5621] GPU 0 memory after del: 16.39 GB
[Step 5621] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 5621] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 36.14 GB
[Step 5621] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 5621] Sequence length: 496, Batch size: 2
[Step 5621] After KL computation - GPU 1: 37.35 GB
[Step 5621] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(

[Step 5631] ========== MEMORY DEBUG ==========
[Step 5631] Model device: cuda:1
[Step 5631] Input device: cuda:1
[Step 5631] Teacher model device: cuda:0
[Step 5631] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 5631] GPU 1 memory: 33.76 GB (reserved: 47.76 GB)
[Step 5631] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 5631] Student model device: cuda:1
[Step 5631] GPU 0 memory before teacher forward: 16.39 GB
[Step 5631] GPU 0 memory after moving inputs: 16.39 GB
[Step 5631] GPU 0 memory after teacher forward: 17.01 GB
[Step 5631] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 5631] Teacher logits device before move: cuda:0
[Step 5631] Target device (student_logits.device): cuda:1
[Step 5631] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 5631] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 5631] GPU 0 memory after del: 16.39 GB
[Step 5631] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 5631] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 5631] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 5631] Sequence length: 1024, Batch size: 2
[Step 5631] After KL computation - GPU 1: 40.50 GB
[Step 5631] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  4%|                                                                                  | 353/10000 [2:04:32<56:42:05, 21.16s/it]

[Step 5641] ========== MEMORY DEBUG ==========
[Step 5641] Model device: cuda:1
[Step 5641] Input device: cuda:1
[Step 5641] Teacher model device: cuda:0
[Step 5641] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 5641] GPU 1 memory: 33.76 GB (reserved: 44.09 GB)
[Step 5641] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 5641] Student model device: cuda:1
[Step 5641] GPU 0 memory before teacher forward: 16.39 GB
[Step 5641] GPU 0 memory after moving inputs: 16.39 GB
[Step 5641] GPU 0 memory after teacher forward: 17.01 GB
[Step 5641] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 5641] Teacher logits device before move: cuda:0
[Step 5641] Target device (student_logits.device): cuda:1
[Step 5641] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 5641] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 5641] GPU 0 memory after del: 16.39 GB
[Step 5641] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 5641] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 5641] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 5641] Sequence length: 1024, Batch size: 2
[Step 5641] After KL computation - GPU 1: 40.50 GB
[Step 5641] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 5651] ========== MEMORY DEBUG ==========
[Step 5651] Model device: cuda:1
[Step 5651] Input device: cuda:1
[Step 5651] Teacher model device: cuda:0
[Step 5651] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 5651] GPU 1 memory: 33.76 GB (reserved: 47.77 GB)
[Step 5651] Student logits device: cuda:1, shape: torch.Size([2, 744, 151936]), dtype: torch.float32
[Step 5651] Student model device: cuda:1
[Step 5651] GPU 0 memory before teacher forward: 16.39 GB
[Step 5651] GPU 0 memory after moving inputs: 16.39 GB
[Step 5651] GPU 0 memory after teacher forward: 16.85 GB
[Step 5651] Teacher logits shape: torch.Size([2, 744, 151936]), dtype: torch.float16
[Step 5651] Teacher logits device before move: cuda:0
[Step 5651] Target device (student_logits.device): cuda:1
[Step 5651] GPU 0 memory after moving logits to GPU 1: 16.85 GB
[Step 5651] Teacher logits device after move: cuda:1, shape: torch.Size([2, 744, 151936])
[Step 5651] GPU 0 memory after del: 16.39 GB
[Step 5651] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 5651] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 37.02 GB
[Step 5651] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 5651] Sequence length: 744, Batch size: 2
[Step 5651] After KL computation - GPU 1: 38.83 GB
[Step 5651] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 5661] ========== MEMORY DEBUG ==========
[Step 5661] Model device: cuda:1
[Step 5661] Input device: cuda:1
[Step 5661] Teacher model device: cuda:0
[Step 5661] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 5661] GPU 1 memory: 33.76 GB (reserved: 46.50 GB)
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
[Step 5661] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 5661] Student model device: cuda:1
[Step 5661] GPU 0 memory before teacher forward: 16.39 GB
[Step 5661] GPU 0 memory after moving inputs: 16.39 GB
[Step 5661] GPU 0 memory after teacher forward: 17.01 GB
[Step 5661] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 5661] Teacher logits device before move: cuda:0
[Step 5661] Target device (student_logits.device): cuda:1
[Step 5661] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 5661] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 5661] GPU 0 memory after del: 16.39 GB
[Step 5661] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 5661] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 5661] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 5661] Sequence length: 1024, Batch size: 2
[Step 5661] After KL computation - GPU 1: 40.50 GB
[Step 5661] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  4%|                                                                                  | 355/10000 [2:05:15<56:56:16, 21.25s/it]

[Step 5671] ========== MEMORY DEBUG ==========
[Step 5671] Model device: cuda:1
[Step 5671] Input device: cuda:1
[Step 5671] Teacher model device: cuda:0
[Step 5671] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 5671] GPU 1 memory: 33.76 GB (reserved: 45.99 GB)
[Step 5671] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 5671] Student model device: cuda:1
[Step 5671] GPU 0 memory before teacher forward: 16.39 GB
[Step 5671] GPU 0 memory after moving inputs: 16.39 GB
[Step 5671] GPU 0 memory after teacher forward: 17.01 GB
[Step 5671] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 5671] Teacher logits device before move: cuda:0
[Step 5671] Target device (student_logits.device): cuda:1
[Step 5671] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 5671] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 5671] GPU 0 memory after del: 16.39 GB
[Step 5671] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 5671] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 5671] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 5671] Sequence length: 1024, Batch size: 2
[Step 5671] After KL computation - GPU 1: 40.50 GB
[Step 5671] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 5681] ========== MEMORY DEBUG ==========
[Step 5681] Model device: cuda:1
[Step 5681] Input device: cuda:1
[Step 5681] Teacher model device: cuda:0
[Step 5681] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 5681] GPU 1 memory: 25.33 GB (reserved: 45.89 GB)
[Step 5681] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 5681] Student model device: cuda:1
[Step 5681] GPU 0 memory before teacher forward: 16.39 GB
[Step 5681] GPU 0 memory after moving inputs: 16.39 GB
[Step 5681] GPU 0 memory after teacher forward: 17.01 GB
[Step 5681] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 5681] Teacher logits device before move: cuda:0
[Step 5681] Target device (student_logits.device): cuda:1
[Step 5681] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 5681] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 5681] GPU 0 memory after del: 16.39 GB
[Step 5681] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 5681] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 29.58 GB
[Step 5681] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 5681] Sequence length: 1024, Batch size: 2
[Step 5681] After KL computation - GPU 1: 32.07 GB
[Step 5681] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 5691] ========== MEMORY DEBUG ==========
[Step 5691] Model device: cuda:1
[Step 5691] Input device: cuda:1
[Step 5691] Teacher model device: cuda:0
[Step 5691] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 5691] GPU 1 memory: 33.76 GB (reserved: 47.39 GB)
[Step 5691] Student logits device: cuda:1, shape: torch.Size([2, 541, 151936]), dtype: torch.float32
[Step 5691] Student model device: cuda:1
[Step 5691] GPU 0 memory before teacher forward: 16.39 GB
[Step 5691] GPU 0 memory after moving inputs: 16.39 GB
[Step 5691] GPU 0 memory after teacher forward: 16.72 GB
[Step 5691] Teacher logits shape: torch.Size([2, 541, 151936]), dtype: torch.float16
[Step 5691] Teacher logits device before move: cuda:0
[Step 5691] Target device (student_logits.device): cuda:1
[Step 5691] GPU 0 memory after moving logits to GPU 1: 16.72 GB
[Step 5691] Teacher logits device after move: cuda:1, shape: torch.Size([2, 541, 151936])
[Step 5691] GPU 0 memory after del: 16.39 GB
[Step 5691] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 5691] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 36.30 GB
[Step 5691] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 5691] Sequence length: 541, Batch size: 2
[Step 5691] After KL computation - GPU 1: 37.62 GB
[Step 5691] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  4%|                                                                                  | 356/10000 [2:05:36<56:43:36, 21.18s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 5701] ========== MEMORY DEBUG ==========
[Step 5701] Model device: cuda:1
[Step 5701] Input device: cuda:1
[Step 5701] Teacher model device: cuda:0
[Step 5701] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 5701] GPU 1 memory: 33.76 GB (reserved: 47.19 GB)
[Step 5701] Student logits device: cuda:1, shape: torch.Size([2, 342, 151936]), dtype: torch.float32
[Step 5701] Student model device: cuda:1
[Step 5701] GPU 0 memory before teacher forward: 16.39 GB
[Step 5701] GPU 0 memory after moving inputs: 16.39 GB
[Step 5701] GPU 0 memory after teacher forward: 16.60 GB
[Step 5701] Teacher logits shape: torch.Size([2, 342, 151936]), dtype: torch.float16
[Step 5701] Teacher logits device before move: cuda:0
[Step 5701] Target device (student_logits.device): cuda:1
[Step 5701] GPU 0 memory after moving logits to GPU 1: 16.60 GB
[Step 5701] Teacher logits device after move: cuda:1, shape: torch.Size([2, 342, 151936])
[Step 5701] GPU 0 memory after del: 16.39 GB
[Step 5701] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 5701] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 35.60 GB
[Step 5701] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 5701] Sequence length: 342, Batch size: 2
[Step 5701] After KL computation - GPU 1: 36.43 GB
[Step 5701] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 5711] ========== MEMORY DEBUG ==========
[Step 5711] Model device: cuda:1
[Step 5711] Input device: cuda:1
[Step 5711] Teacher model device: cuda:0
[Step 5711] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 5711] GPU 1 memory: 33.76 GB (reserved: 47.40 GB)
[Step 5711] Student logits device: cuda:1, shape: torch.Size([2, 407, 151936]), dtype: torch.float32
[Step 5711] Student model device: cuda:1
[Step 5711] GPU 0 memory before teacher forward: 16.39 GB
[Step 5711] GPU 0 memory after moving inputs: 16.39 GB
[Step 5711] GPU 0 memory after teacher forward: 16.64 GB
[Step 5711] Teacher logits shape: torch.Size([2, 407, 151936]), dtype: torch.float16
[Step 5711] Teacher logits device before move: cuda:0
[Step 5711] Target device (student_logits.device): cuda:1
[Step 5711] GPU 0 memory after moving logits to GPU 1: 16.64 GB
[Step 5711] Teacher logits device after move: cuda:1, shape: torch.Size([2, 407, 151936])
[Step 5711] GPU 0 memory after del: 16.39 GB
[Step 5711] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 5711] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 35.83 GB
[Step 5711] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 5711] Sequence length: 407, Batch size: 2
[Step 5711] After KL computation - GPU 1: 36.82 GB
[Step 5711] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  4%|                                                                                  | 358/10000 [2:06:19<57:55:55, 21.63s/it]

[Step 5721] ========== MEMORY DEBUG ==========
[Step 5721] Model device: cuda:1
[Step 5721] Input device: cuda:1
[Step 5721] Teacher model device: cuda:0
[Step 5721] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 5721] GPU 1 memory: 33.76 GB (reserved: 47.62 GB)
[Step 5721] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 5721] Student model device: cuda:1
[Step 5721] GPU 0 memory before teacher forward: 16.39 GB
[Step 5721] GPU 0 memory after moving inputs: 16.39 GB
[Step 5721] GPU 0 memory after teacher forward: 17.01 GB
[Step 5721] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 5721] Teacher logits device before move: cuda:0
[Step 5721] Target device (student_logits.device): cuda:1
[Step 5721] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 5721] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 5721] GPU 0 memory after del: 16.39 GB
[Step 5721] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 5721] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 5721] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 5721] Sequence length: 1024, Batch size: 2
[Step 5721] After KL computation - GPU 1: 40.50 GB
[Step 5721] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 5731] ========== MEMORY DEBUG ==========
[Step 5731] Model device: cuda:1
[Step 5731] Input device: cuda:1
[Step 5731] Teacher model device: cuda:0
[Step 5731] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 5731] GPU 1 memory: 33.76 GB (reserved: 44.79 GB)
[Step 5731] Student logits device: cuda:1, shape: torch.Size([2, 917, 151936]), dtype: torch.float32
[Step 5731] Student model device: cuda:1
[Step 5731] GPU 0 memory before teacher forward: 16.39 GB
[Step 5731] GPU 0 memory after moving inputs: 16.39 GB
[Step 5731] GPU 0 memory after teacher forward: 16.95 GB
[Step 5731] Teacher logits shape: torch.Size([2, 917, 151936]), dtype: torch.float16
[Step 5731] Teacher logits device before move: cuda:0
[Step 5731] Target device (student_logits.device): cuda:1
[Step 5731] GPU 0 memory after moving logits to GPU 1: 16.95 GB
[Step 5731] Teacher logits device after move: cuda:1, shape: torch.Size([2, 917, 151936])
[Step 5731] GPU 0 memory after del: 16.39 GB
[Step 5731] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 5731] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 37.63 GB
[Step 5731] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 5731] Sequence length: 917, Batch size: 2
[Step 5731] After KL computation - GPU 1: 39.86 GB
[Step 5731] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 5741] ========== MEMORY DEBUG ==========
[Step 5741] Model device: cuda:1
[Step 5741] Input device: cuda:1
[Step 5741] Teacher model device: cuda:0
[Step 5741] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 5741] GPU 1 memory: 33.76 GB (reserved: 47.53 GB)
[Step 5741] Student logits device: cuda:1, shape: torch.Size([2, 477, 151936]), dtype: torch.float32
[Step 5741] Student model device: cuda:1
[Step 5741] GPU 0 memory before teacher forward: 16.39 GB
[Step 5741] GPU 0 memory after moving inputs: 16.39 GB
[Step 5741] GPU 0 memory after teacher forward: 16.68 GB
[Step 5741] Teacher logits shape: torch.Size([2, 477, 151936]), dtype: torch.float16
[Step 5741] Teacher logits device before move: cuda:0
[Step 5741] Target device (student_logits.device): cuda:1
[Step 5741] GPU 0 memory after moving logits to GPU 1: 16.68 GB
[Step 5741] Teacher logits device after move: cuda:1, shape: torch.Size([2, 477, 151936])
[Step 5741] GPU 0 memory after del: 16.39 GB
[Step 5741] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 5741] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 36.07 GB
[Step 5741] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 5741] Sequence length: 477, Batch size: 2
[Step 5741] After KL computation - GPU 1: 37.23 GB
[Step 5741] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  4%|                                                                                  | 360/10000 [2:07:00<56:06:44, 20.95s/it]

[Step 5751] ========== MEMORY DEBUG ==========
[Step 5751] Model device: cuda:1
[Step 5751] Input device: cuda:1
[Step 5751] Teacher model device: cuda:0
[Step 5751] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 5751] GPU 1 memory: 33.76 GB (reserved: 43.94 GB)
[Step 5751] Student logits device: cuda:1, shape: torch.Size([2, 284, 151936]), dtype: torch.float32
[Step 5751] Student model device: cuda:1
[Step 5751] GPU 0 memory before teacher forward: 16.39 GB
[Step 5751] GPU 0 memory after moving inputs: 16.39 GB
[Step 5751] GPU 0 memory after teacher forward: 16.56 GB
[Step 5751] Teacher logits shape: torch.Size([2, 284, 151936]), dtype: torch.float16
[Step 5751] Teacher logits device before move: cuda:0
[Step 5751] Target device (student_logits.device): cuda:1
[Step 5751] GPU 0 memory after moving logits to GPU 1: 16.56 GB
[Step 5751] Teacher logits device after move: cuda:1, shape: torch.Size([2, 284, 151936])
[Step 5751] GPU 0 memory after del: 16.39 GB
[Step 5751] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 5751] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 35.39 GB
[Step 5751] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 5751] Sequence length: 284, Batch size: 2
[Step 5751] After KL computation - GPU 1: 36.08 GB
[Step 5751] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
{'loss': 677122.8, 'grad_norm': nan, 'learning_rate': 4.869191919191919e-05, 'epoch': 0.04}

[Step 5761] ========== MEMORY DEBUG ==========
[Step 5761] Model device: cuda:1
[Step 5761] Input device: cuda:1
[Step 5761] Teacher model device: cuda:0
[Step 5761] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 5761] GPU 1 memory: 25.33 GB (reserved: 44.66 GB)
[Step 5761] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 5761] Student model device: cuda:1
[Step 5761] GPU 0 memory before teacher forward: 16.39 GB
[Step 5761] GPU 0 memory after moving inputs: 16.39 GB
[Step 5761] GPU 0 memory after teacher forward: 17.01 GB
[Step 5761] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 5761] Teacher logits device before move: cuda:0
[Step 5761] Target device (student_logits.device): cuda:1
[Step 5761] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 5761] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 5761] GPU 0 memory after del: 16.39 GB
[Step 5761] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 5761] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 29.58 GB
[Step 5761] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 5761] Sequence length: 1024, Batch size: 2
[Step 5761] After KL computation - GPU 1: 32.07 GB
[Step 5761] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 5771] ========== MEMORY DEBUG ==========
[Step 5771] Model device: cuda:1
[Step 5771] Input device: cuda:1
[Step 5771] Teacher model device: cuda:0
[Step 5771] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 5771] GPU 1 memory: 33.76 GB (reserved: 47.43 GB)
[Step 5771] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 5771] Student model device: cuda:1
[Step 5771] GPU 0 memory before teacher forward: 16.39 GB
[Step 5771] GPU 0 memory after moving inputs: 16.39 GB
[Step 5771] GPU 0 memory after teacher forward: 17.01 GB
[Step 5771] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 5771] Teacher logits device before move: cuda:0
[Step 5771] Target device (student_logits.device): cuda:1
[Step 5771] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 5771] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 5771] GPU 0 memory after del: 16.39 GB
[Step 5771] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 5771] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 5771] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 5771] Sequence length: 1024, Batch size: 2
[Step 5771] After KL computation - GPU 1: 40.50 GB
[Step 5771] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  4%|                                                                                  | 361/10000 [2:07:22<57:06:33, 21.33s/it]

[Step 5781] ========== MEMORY DEBUG ==========
[Step 5781] Model device: cuda:1
[Step 5781] Input device: cuda:1
[Step 5781] Teacher model device: cuda:0
[Step 5781] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 5781] GPU 1 memory: 33.77 GB (reserved: 47.45 GB)
[Step 5781] Student logits device: cuda:1, shape: torch.Size([2, 490, 151936]), dtype: torch.float32
[Step 5781] Student model device: cuda:1
[Step 5781] GPU 0 memory before teacher forward: 16.39 GB
[Step 5781] GPU 0 memory after moving inputs: 16.39 GB
[Step 5781] GPU 0 memory after teacher forward: 16.69 GB
[Step 5781] Teacher logits shape: torch.Size([2, 490, 151936]), dtype: torch.float16
[Step 5781] Teacher logits device before move: cuda:0
[Step 5781] Target device (student_logits.device): cuda:1
[Step 5781] GPU 0 memory after moving logits to GPU 1: 16.69 GB
[Step 5781] Teacher logits device after move: cuda:1, shape: torch.Size([2, 490, 151936])
[Step 5781] GPU 0 memory after del: 16.39 GB
[Step 5781] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 5781] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 36.12 GB
[Step 5781] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 5781] Sequence length: 490, Batch size: 2
[Step 5781] After KL computation - GPU 1: 37.32 GB
[Step 5781] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 5791] ========== MEMORY DEBUG ==========
[Step 5791] Model device: cuda:1
[Step 5791] Input device: cuda:1
[Step 5791] Teacher model device: cuda:0
[Step 5791] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 5791] GPU 1 memory: 33.77 GB (reserved: 46.04 GB)
[Step 5791] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 5791] Student model device: cuda:1
[Step 5791] GPU 0 memory before teacher forward: 16.39 GB
[Step 5791] GPU 0 memory after moving inputs: 16.39 GB
[Step 5791] GPU 0 memory after teacher forward: 17.01 GB
[Step 5791] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 5791] Teacher logits device before move: cuda:0
[Step 5791] Target device (student_logits.device): cuda:1
[Step 5791] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 5791] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 5791] GPU 0 memory after del: 16.39 GB
[Step 5791] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 5791] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.02 GB
[Step 5791] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 5791] Sequence length: 1024, Batch size: 2
[Step 5791] After KL computation - GPU 1: 40.51 GB
[Step 5791] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 5801] ========== MEMORY DEBUG ==========
[Step 5801] Model device: cuda:1
[Step 5801] Input device: cuda:1
[Step 5801] Teacher model device: cuda:0
[Step 5801] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 5801] GPU 1 memory: 33.77 GB (reserved: 47.43 GB)
[Step 5801] Student logits device: cuda:1, shape: torch.Size([2, 362, 151936]), dtype: torch.float32
[Step 5801] Student model device: cuda:1
[Step 5801] GPU 0 memory before teacher forward: 16.39 GB
[Step 5801] GPU 0 memory after moving inputs: 16.39 GB
[Step 5801] GPU 0 memory after teacher forward: 16.61 GB
[Step 5801] Teacher logits shape: torch.Size([2, 362, 151936]), dtype: torch.float16
[Step 5801] Teacher logits device before move: cuda:0
[Step 5801] Target device (student_logits.device): cuda:1
[Step 5801] GPU 0 memory after moving logits to GPU 1: 16.61 GB
[Step 5801] Teacher logits device after move: cuda:1, shape: torch.Size([2, 362, 151936])
[Step 5801] GPU 0 memory after del: 16.39 GB
[Step 5801] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 5801] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 35.67 GB
[Step 5801] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 5801] Sequence length: 362, Batch size: 2
[Step 5801] After KL computation - GPU 1: 36.55 GB
[Step 5801] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 5811] ========== MEMORY DEBUG ==========
[Step 5811] Model device: cuda:1
[Step 5811] Input device: cuda:1
[Step 5811] Teacher model device: cuda:0
[Step 5811] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 5811] GPU 1 memory: 33.76 GB (reserved: 46.77 GB)
[Step 5811] Student logits device: cuda:1, shape: torch.Size([2, 462, 151936]), dtype: torch.float32
[Step 5811] Student model device: cuda:1
[Step 5811] GPU 0 memory before teacher forward: 16.39 GB
[Step 5811] GPU 0 memory after moving inputs: 16.39 GB
[Step 5811] GPU 0 memory after teacher forward: 16.67 GB
[Step 5811] Teacher logits shape: torch.Size([2, 462, 151936]), dtype: torch.float16
[Step 5811] Teacher logits device before move: cuda:0
[Step 5811] Target device (student_logits.device): cuda:1
[Step 5811] GPU 0 memory after moving logits to GPU 1: 16.67 GB
[Step 5811] Teacher logits device after move: cuda:1, shape: torch.Size([2, 462, 151936])
[Step 5811] GPU 0 memory after del: 16.39 GB
[Step 5811] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 5811] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 36.02 GB
[Step 5811] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 5811] Sequence length: 462, Batch size: 2
[Step 5811] After KL computation - GPU 1: 37.15 GB
[Step 5811] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 5821] ========== MEMORY DEBUG ==========
[Step 5821] Model device: cuda:1
[Step 5821] Input device: cuda:1
[Step 5821] Teacher model device: cuda:0
[Step 5821] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 5821] GPU 1 memory: 33.76 GB (reserved: 44.01 GB)
[Step 5821] Student logits device: cuda:1, shape: torch.Size([2, 975, 151936]), dtype: torch.float32
[Step 5821] Student model device: cuda:1
[Step 5821] GPU 0 memory before teacher forward: 16.39 GB
[Step 5821] GPU 0 memory after moving inputs: 16.39 GB
[Step 5821] GPU 0 memory after teacher forward: 16.99 GB
[Step 5821] Teacher logits shape: torch.Size([2, 975, 151936]), dtype: torch.float16
[Step 5821] Teacher logits device before move: cuda:0
[Step 5821] Target device (student_logits.device): cuda:1
[Step 5821] GPU 0 memory after moving logits to GPU 1: 16.99 GB
[Step 5821] Teacher logits device after move: cuda:1, shape: torch.Size([2, 975, 151936])
[Step 5821] GPU 0 memory after del: 16.39 GB
[Step 5821] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 5821] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 37.84 GB
[Step 5821] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 5821] Sequence length: 975, Batch size: 2
[Step 5821] After KL computation - GPU 1: 40.21 GB
[Step 5821] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 5831] ========== MEMORY DEBUG ==========
[Step 5831] Model device: cuda:1
[Step 5831] Input device: cuda:1
[Step 5831] Teacher model device: cuda:0
[Step 5831] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 5831] GPU 1 memory: 33.76 GB (reserved: 46.68 GB)
[Step 5831] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 5831] Student model device: cuda:1
[Step 5831] GPU 0 memory before teacher forward: 16.39 GB
[Step 5831] GPU 0 memory after moving inputs: 16.39 GB
[Step 5831] GPU 0 memory after teacher forward: 17.01 GB
[Step 5831] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 5831] Teacher logits device before move: cuda:0
[Step 5831] Target device (student_logits.device): cuda:1
[Step 5831] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 5831] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 5831] GPU 0 memory after del: 16.39 GB
[Step 5831] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 5831] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.02 GB
[Step 5831] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 5831] Sequence length: 1024, Batch size: 2
[Step 5831] After KL computation - GPU 1: 40.51 GB
[Step 5831] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 5841] ========== MEMORY DEBUG ==========
[Step 5841] Model device: cuda:1
[Step 5841] Input device: cuda:1
[Step 5841] Teacher model device: cuda:0
[Step 5841] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 5841] GPU 1 memory: 25.33 GB (reserved: 42.61 GB)
[Step 5841] Student logits device: cuda:1, shape: torch.Size([2, 851, 151936]), dtype: torch.float32
[Step 5841] Student model device: cuda:1
[Step 5841] GPU 0 memory before teacher forward: 16.39 GB
[Step 5841] GPU 0 memory after moving inputs: 16.39 GB
[Step 5841] GPU 0 memory after teacher forward: 16.91 GB
[Step 5841] Teacher logits shape: torch.Size([2, 851, 151936]), dtype: torch.float16
[Step 5841] Teacher logits device before move: cuda:0
[Step 5841] Target device (student_logits.device): cuda:1
[Step 5841] GPU 0 memory after moving logits to GPU 1: 16.91 GB
[Step 5841] Teacher logits device after move: cuda:1, shape: torch.Size([2, 851, 151936])
[Step 5841] GPU 0 memory after del: 16.39 GB
[Step 5841] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 5841] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 28.96 GB
[Step 5841] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 5841] Sequence length: 851, Batch size: 2
[Step 5841] After KL computation - GPU 1: 31.03 GB
[Step 5841] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 5851] ========== MEMORY DEBUG ==========
[Step 5851] Model device: cuda:1
[Step 5851] Input device: cuda:1
[Step 5851] Teacher model device: cuda:0
[Step 5851] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 5851] GPU 1 memory: 33.77 GB (reserved: 39.08 GB)
  warnings.warn(
[Step 5851] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 5851] Student model device: cuda:1
[Step 5851] GPU 0 memory before teacher forward: 16.39 GB
[Step 5851] GPU 0 memory after moving inputs: 16.39 GB
[Step 5851] GPU 0 memory after teacher forward: 17.01 GB
[Step 5851] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 5851] Teacher logits device before move: cuda:0
[Step 5851] Target device (student_logits.device): cuda:1
[Step 5851] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 5851] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 5851] GPU 0 memory after del: 16.39 GB
[Step 5851] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 5851] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.02 GB
[Step 5851] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 5851] Sequence length: 1024, Batch size: 2
[Step 5851] After KL computation - GPU 1: 40.51 GB
[Step 5851] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  4%|                                                                                  | 366/10000 [2:09:01<53:37:16, 20.04s/it]

[Step 5861] ========== MEMORY DEBUG ==========
[Step 5861] Model device: cuda:1
[Step 5861] Input device: cuda:1
[Step 5861] Teacher model device: cuda:0
[Step 5861] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 5861] GPU 1 memory: 33.76 GB (reserved: 47.60 GB)
[Step 5861] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 5861] Student model device: cuda:1
[Step 5861] GPU 0 memory before teacher forward: 16.39 GB
[Step 5861] GPU 0 memory after moving inputs: 16.39 GB
[Step 5861] GPU 0 memory after teacher forward: 17.01 GB
[Step 5861] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 5861] Teacher logits device before move: cuda:0
[Step 5861] Target device (student_logits.device): cuda:1
[Step 5861] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 5861] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 5861] GPU 0 memory after del: 16.39 GB
[Step 5861] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 5861] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 5861] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 5861] Sequence length: 1024, Batch size: 2
[Step 5861] After KL computation - GPU 1: 40.50 GB
[Step 5861] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 5871] ========== MEMORY DEBUG ==========
[Step 5871] Model device: cuda:1
[Step 5871] Input device: cuda:1
[Step 5871] Teacher model device: cuda:0
[Step 5871] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 5871] GPU 1 memory: 33.76 GB (reserved: 40.47 GB)
[Step 5871] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 5871] Student model device: cuda:1
[Step 5871] GPU 0 memory before teacher forward: 16.39 GB
[Step 5871] GPU 0 memory after moving inputs: 16.39 GB
[Step 5871] GPU 0 memory after teacher forward: 17.01 GB
[Step 5871] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 5871] Teacher logits device before move: cuda:0
[Step 5871] Target device (student_logits.device): cuda:1
[Step 5871] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 5871] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 5871] GPU 0 memory after del: 16.39 GB
[Step 5871] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 5871] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 5871] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 5871] Sequence length: 1024, Batch size: 2
[Step 5871] After KL computation - GPU 1: 40.50 GB
[Step 5871] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(

[Step 5881] ========== MEMORY DEBUG ==========
[Step 5881] Model device: cuda:1
[Step 5881] Input device: cuda:1
[Step 5881] Teacher model device: cuda:0
[Step 5881] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 5881] GPU 1 memory: 33.77 GB (reserved: 48.06 GB)
[Step 5881] Student logits device: cuda:1, shape: torch.Size([2, 582, 151936]), dtype: torch.float32
[Step 5881] Student model device: cuda:1
[Step 5881] GPU 0 memory before teacher forward: 16.39 GB
[Step 5881] GPU 0 memory after moving inputs: 16.39 GB
[Step 5881] GPU 0 memory after teacher forward: 16.75 GB
[Step 5881] Teacher logits shape: torch.Size([2, 582, 151936]), dtype: torch.float16
[Step 5881] Teacher logits device before move: cuda:0
[Step 5881] Target device (student_logits.device): cuda:1
[Step 5881] GPU 0 memory after moving logits to GPU 1: 16.75 GB
[Step 5881] Teacher logits device after move: cuda:1, shape: torch.Size([2, 582, 151936])
[Step 5881] GPU 0 memory after del: 16.39 GB
[Step 5881] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 5881] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 36.46 GB
[Step 5881] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 5881] Sequence length: 582, Batch size: 2
[Step 5881] After KL computation - GPU 1: 37.87 GB
[Step 5881] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  4%|                                                                                 | 368/10000 [2:09:42<54:19:09, 20.30s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None

[Step 5891] ========== MEMORY DEBUG ==========
[Step 5891] Model device: cuda:1
[Step 5891] Input device: cuda:1
[Step 5891] Teacher model device: cuda:0
[Step 5891] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 5891] GPU 1 memory: 33.78 GB (reserved: 40.58 GB)
[Step 5891] Student logits device: cuda:1, shape: torch.Size([2, 654, 151936]), dtype: torch.float32
[Step 5891] Student model device: cuda:1
[Step 5891] GPU 0 memory before teacher forward: 16.39 GB
[Step 5891] GPU 0 memory after moving inputs: 16.39 GB
[Step 5891] GPU 0 memory after teacher forward: 16.79 GB
[Step 5891] Teacher logits shape: torch.Size([2, 654, 151936]), dtype: torch.float16
[Step 5891] Teacher logits device before move: cuda:0
[Step 5891] Target device (student_logits.device): cuda:1
[Step 5891] GPU 0 memory after moving logits to GPU 1: 16.79 GB
[Step 5891] Teacher logits device after move: cuda:1, shape: torch.Size([2, 654, 151936])
[Step 5891] GPU 0 memory after del: 16.39 GB
[Step 5891] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 5891] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 36.72 GB
[Step 5891] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 5891] Sequence length: 654, Batch size: 2
[Step 5891] After KL computation - GPU 1: 38.31 GB
[Step 5891] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(

[Step 5901] ========== MEMORY DEBUG ==========
[Step 5901] Model device: cuda:1
[Step 5901] Input device: cuda:1
[Step 5901] Teacher model device: cuda:0
[Step 5901] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 5901] GPU 1 memory: 33.78 GB (reserved: 47.70 GB)
[Step 5901] Student logits device: cuda:1, shape: torch.Size([2, 675, 151936]), dtype: torch.float32
[Step 5901] Student model device: cuda:1
[Step 5901] GPU 0 memory before teacher forward: 16.39 GB
[Step 5901] GPU 0 memory after moving inputs: 16.39 GB
[Step 5901] GPU 0 memory after teacher forward: 16.80 GB
[Step 5901] Teacher logits shape: torch.Size([2, 675, 151936]), dtype: torch.float16
[Step 5901] Teacher logits device before move: cuda:0
[Step 5901] Target device (student_logits.device): cuda:1
[Step 5901] GPU 0 memory after moving logits to GPU 1: 16.80 GB
[Step 5901] Teacher logits device after move: cuda:1, shape: torch.Size([2, 675, 151936])
[Step 5901] GPU 0 memory after del: 16.39 GB
[Step 5901] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 5901] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 36.79 GB
[Step 5901] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 5901] Sequence length: 675, Batch size: 2
[Step 5901] After KL computation - GPU 1: 38.43 GB
[Step 5901] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  4%|                                                                                 | 369/10000 [2:10:02<53:53:26, 20.14s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 5911] ========== MEMORY DEBUG ==========
[Step 5911] Model device: cuda:1
[Step 5911] Input device: cuda:1
[Step 5911] Teacher model device: cuda:0
[Step 5911] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 5911] GPU 1 memory: 33.76 GB (reserved: 47.92 GB)
[Step 5911] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 5911] Student model device: cuda:1
[Step 5911] GPU 0 memory before teacher forward: 16.39 GB
[Step 5911] GPU 0 memory after moving inputs: 16.39 GB
[Step 5911] GPU 0 memory after teacher forward: 17.01 GB
[Step 5911] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 5911] Teacher logits device before move: cuda:0
[Step 5911] Target device (student_logits.device): cuda:1
[Step 5911] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 5911] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 5911] GPU 0 memory after del: 16.39 GB
[Step 5911] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 5911] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 5911] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 5911] Sequence length: 1024, Batch size: 2
[Step 5911] After KL computation - GPU 1: 40.50 GB
[Step 5911] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  4%|                                                                                 | 370/10000 [2:10:23<54:59:42, 20.56s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
{'loss': 1539637971936870.5, 'grad_norm': nan, 'learning_rate': 4.8641414141414146e-05, 'epoch': 0.04}

[Step 5921] ========== MEMORY DEBUG ==========
[Step 5921] Model device: cuda:1
[Step 5921] Input device: cuda:1
[Step 5921] Teacher model device: cuda:0
[Step 5921] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 5921] GPU 1 memory: 25.33 GB (reserved: 46.75 GB)
[Step 5921] Student logits device: cuda:1, shape: torch.Size([2, 755, 151936]), dtype: torch.float32
[Step 5921] Student model device: cuda:1
[Step 5921] GPU 0 memory before teacher forward: 16.39 GB
[Step 5921] GPU 0 memory after moving inputs: 16.39 GB
[Step 5921] GPU 0 memory after teacher forward: 16.85 GB
[Step 5921] Teacher logits shape: torch.Size([2, 755, 151936]), dtype: torch.float16
[Step 5921] Teacher logits device before move: cuda:0
[Step 5921] Target device (student_logits.device): cuda:1
[Step 5921] GPU 0 memory after moving logits to GPU 1: 16.85 GB
[Step 5921] Teacher logits device after move: cuda:1, shape: torch.Size([2, 755, 151936])
[Step 5921] GPU 0 memory after del: 16.39 GB
[Step 5921] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 5921] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 28.62 GB
[Step 5921] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 5921] Sequence length: 755, Batch size: 2
[Step 5921] After KL computation - GPU 1: 30.46 GB
[Step 5921] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(

[Step 5931] ========== MEMORY DEBUG ==========
[Step 5931] Model device: cuda:1
[Step 5931] Input device: cuda:1
[Step 5931] Teacher model device: cuda:0
[Step 5931] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 5931] GPU 1 memory: 33.76 GB (reserved: 47.66 GB)
[Step 5931] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 5931] Student model device: cuda:1
[Step 5931] GPU 0 memory before teacher forward: 16.39 GB
[Step 5931] GPU 0 memory after moving inputs: 16.39 GB
[Step 5931] GPU 0 memory after teacher forward: 17.01 GB
[Step 5931] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 5931] Teacher logits device before move: cuda:0
[Step 5931] Target device (student_logits.device): cuda:1
[Step 5931] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 5931] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 5931] GPU 0 memory after del: 16.39 GB
[Step 5931] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 5931] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.02 GB
[Step 5931] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 5931] Sequence length: 1024, Batch size: 2
[Step 5931] After KL computation - GPU 1: 40.51 GB
[Step 5931] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  4%|                                                                                 | 371/10000 [2:10:45<55:48:02, 20.86s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None

[Step 5941] ========== MEMORY DEBUG ==========
[Step 5941] Model device: cuda:1
[Step 5941] Input device: cuda:1
[Step 5941] Teacher model device: cuda:0
[Step 5941] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 5941] GPU 1 memory: 33.77 GB (reserved: 47.59 GB)
[Step 5941] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 5941] Student model device: cuda:1
[Step 5941] GPU 0 memory before teacher forward: 16.39 GB
[Step 5941] GPU 0 memory after moving inputs: 16.39 GB
[Step 5941] GPU 0 memory after teacher forward: 17.01 GB
[Step 5941] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 5941] Teacher logits device before move: cuda:0
[Step 5941] Target device (student_logits.device): cuda:1
[Step 5941] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 5941] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 5941] GPU 0 memory after del: 16.39 GB
[Step 5941] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 5941] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.02 GB
[Step 5941] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 5941] Sequence length: 1024, Batch size: 2
[Step 5941] After KL computation - GPU 1: 40.51 GB
[Step 5941] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(

[Step 5951] ========== MEMORY DEBUG ==========
[Step 5951] Model device: cuda:1
[Step 5951] Input device: cuda:1
[Step 5951] Teacher model device: cuda:0
[Step 5951] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 5951] GPU 1 memory: 33.77 GB (reserved: 46.36 GB)
[Step 5951] Student logits device: cuda:1, shape: torch.Size([2, 823, 151936]), dtype: torch.float32
[Step 5951] Student model device: cuda:1
[Step 5951] GPU 0 memory before teacher forward: 16.39 GB
[Step 5951] GPU 0 memory after moving inputs: 16.39 GB
[Step 5951] GPU 0 memory after teacher forward: 16.89 GB
[Step 5951] Teacher logits shape: torch.Size([2, 823, 151936]), dtype: torch.float16
[Step 5951] Teacher logits device before move: cuda:0
[Step 5951] Target device (student_logits.device): cuda:1
[Step 5951] GPU 0 memory after moving logits to GPU 1: 16.89 GB
[Step 5951] Teacher logits device after move: cuda:1, shape: torch.Size([2, 823, 151936])
[Step 5951] GPU 0 memory after del: 16.39 GB
[Step 5951] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 5951] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 37.30 GB
[Step 5951] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 5951] Sequence length: 823, Batch size: 2
[Step 5951] After KL computation - GPU 1: 39.31 GB
[Step 5951] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  4%|                                                                                 | 372/10000 [2:11:05<54:54:37, 20.53s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 5961] ========== MEMORY DEBUG ==========
[Step 5961] Model device: cuda:1
[Step 5961] Input device: cuda:1
[Step 5961] Teacher model device: cuda:0
[Step 5961] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 5961] GPU 1 memory: 33.76 GB (reserved: 47.63 GB)
[Step 5961] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 5961] Student model device: cuda:1
[Step 5961] GPU 0 memory before teacher forward: 16.39 GB
[Step 5961] GPU 0 memory after moving inputs: 16.39 GB
[Step 5961] GPU 0 memory after teacher forward: 17.01 GB
[Step 5961] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 5961] Teacher logits device before move: cuda:0
[Step 5961] Target device (student_logits.device): cuda:1
[Step 5961] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 5961] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 5961] GPU 0 memory after del: 16.39 GB
[Step 5961] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 5961] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 5961] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 5961] Sequence length: 1024, Batch size: 2
[Step 5961] After KL computation - GPU 1: 40.50 GB
[Step 5961] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  4%|                                                                                 | 373/10000 [2:11:27<56:09:33, 21.00s/it]

[Step 5971] ========== MEMORY DEBUG ==========
[Step 5971] Model device: cuda:1
[Step 5971] Input device: cuda:1
[Step 5971] Teacher model device: cuda:0
[Step 5971] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 5971] GPU 1 memory: 33.76 GB (reserved: 47.69 GB)
[Step 5971] Student logits device: cuda:1, shape: torch.Size([2, 900, 151936]), dtype: torch.float32
[Step 5971] Student model device: cuda:1
[Step 5971] GPU 0 memory before teacher forward: 16.39 GB
[Step 5971] GPU 0 memory after moving inputs: 16.39 GB
[Step 5971] GPU 0 memory after teacher forward: 16.94 GB
[Step 5971] Teacher logits shape: torch.Size([2, 900, 151936]), dtype: torch.float16
[Step 5971] Teacher logits device before move: cuda:0
[Step 5971] Target device (student_logits.device): cuda:1
[Step 5971] GPU 0 memory after moving logits to GPU 1: 16.94 GB
[Step 5971] Teacher logits device after move: cuda:1, shape: torch.Size([2, 900, 151936])
[Step 5971] GPU 0 memory after del: 16.39 GB
[Step 5971] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 5971] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 37.57 GB
[Step 5971] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 5971] Sequence length: 900, Batch size: 2
[Step 5971] After KL computation - GPU 1: 39.76 GB
[Step 5971] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 5981] ========== MEMORY DEBUG ==========
[Step 5981] Model device: cuda:1
[Step 5981] Input device: cuda:1
[Step 5981] Teacher model device: cuda:0
[Step 5981] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 5981] GPU 1 memory: 33.76 GB (reserved: 47.69 GB)
[Step 5981] Student logits device: cuda:1, shape: torch.Size([2, 938, 151936]), dtype: torch.float32
[Step 5981] Student model device: cuda:1
[Step 5981] GPU 0 memory before teacher forward: 16.39 GB
[Step 5981] GPU 0 memory after moving inputs: 16.39 GB
[Step 5981] GPU 0 memory after teacher forward: 16.96 GB
[Step 5981] Teacher logits shape: torch.Size([2, 938, 151936]), dtype: torch.float16
[Step 5981] Teacher logits device before move: cuda:0
[Step 5981] Target device (student_logits.device): cuda:1
[Step 5981] GPU 0 memory after moving logits to GPU 1: 16.96 GB
[Step 5981] Teacher logits device after move: cuda:1, shape: torch.Size([2, 938, 151936])
[Step 5981] GPU 0 memory after del: 16.39 GB
[Step 5981] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 5981] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 37.71 GB
[Step 5981] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 5981] Sequence length: 938, Batch size: 2
[Step 5981] After KL computation - GPU 1: 39.99 GB
[Step 5981] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 5991] ========== MEMORY DEBUG ==========
[Step 5991] Model device: cuda:1
[Step 5991] Input device: cuda:1
[Step 5991] Teacher model device: cuda:0
[Step 5991] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 5991] GPU 1 memory: 33.76 GB (reserved: 42.82 GB)
[Step 5991] Student logits device: cuda:1, shape: torch.Size([2, 157, 151936]), dtype: torch.float32
[Step 5991] Student model device: cuda:1
[Step 5991] GPU 0 memory before teacher forward: 16.39 GB
[Step 5991] GPU 0 memory after moving inputs: 16.39 GB
[Step 5991] GPU 0 memory after teacher forward: 16.49 GB
[Step 5991] Teacher logits shape: torch.Size([2, 157, 151936]), dtype: torch.float16
[Step 5991] Teacher logits device before move: cuda:0
[Step 5991] Target device (student_logits.device): cuda:1
[Step 5991] GPU 0 memory after moving logits to GPU 1: 16.49 GB
[Step 5991] Teacher logits device after move: cuda:1, shape: torch.Size([2, 157, 151936])
[Step 5991] GPU 0 memory after del: 16.39 GB
[Step 5991] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 5991] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 34.94 GB
[Step 5991] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 5991] Sequence length: 157, Batch size: 2
[Step 5991] After KL computation - GPU 1: 35.33 GB
[Step 5991] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
  4%|                                                                                 | 375/10000 [2:12:08<55:44:16, 20.85s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None

[Step 6001] ========== MEMORY DEBUG ==========
[Step 6001] Model device: cuda:1
[Step 6001] Input device: cuda:1
[Step 6001] Teacher model device: cuda:0
[Step 6001] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 6001] GPU 1 memory: 25.33 GB (reserved: 47.80 GB)
[Step 6001] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 6001] Student model device: cuda:1
[Step 6001] GPU 0 memory before teacher forward: 16.39 GB
[Step 6001] GPU 0 memory after moving inputs: 16.39 GB
[Step 6001] GPU 0 memory after teacher forward: 17.01 GB
[Step 6001] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 6001] Teacher logits device before move: cuda:0
[Step 6001] Target device (student_logits.device): cuda:1
[Step 6001] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 6001] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 6001] GPU 0 memory after del: 16.39 GB
[Step 6001] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 6001] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 29.58 GB
[Step 6001] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 6001] Sequence length: 1024, Batch size: 2
[Step 6001] After KL computation - GPU 1: 32.07 GB
[Step 6001] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(

[Step 6011] ========== MEMORY DEBUG ==========
[Step 6011] Model device: cuda:1
[Step 6011] Input device: cuda:1
[Step 6011] Teacher model device: cuda:0
[Step 6011] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 6011] GPU 1 memory: 33.76 GB (reserved: 47.60 GB)
[Step 6011] Student logits device: cuda:1, shape: torch.Size([2, 598, 151936]), dtype: torch.float32
[Step 6011] Student model device: cuda:1
[Step 6011] GPU 0 memory before teacher forward: 16.39 GB
[Step 6011] GPU 0 memory after moving inputs: 16.39 GB
[Step 6011] GPU 0 memory after teacher forward: 16.76 GB
[Step 6011] Teacher logits shape: torch.Size([2, 598, 151936]), dtype: torch.float16
[Step 6011] Teacher logits device before move: cuda:0
[Step 6011] Target device (student_logits.device): cuda:1
[Step 6011] GPU 0 memory after moving logits to GPU 1: 16.76 GB
[Step 6011] Teacher logits device after move: cuda:1, shape: torch.Size([2, 598, 151936])
[Step 6011] GPU 0 memory after del: 16.39 GB
[Step 6011] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 6011] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 36.51 GB
[Step 6011] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 6011] Sequence length: 598, Batch size: 2
[Step 6011] After KL computation - GPU 1: 37.96 GB
[Step 6011] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  4%|                                                                                 | 376/10000 [2:12:31<56:46:08, 21.24s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None

[Step 6021] ========== MEMORY DEBUG ==========
[Step 6021] Model device: cuda:1
[Step 6021] Input device: cuda:1
[Step 6021] Teacher model device: cuda:0
[Step 6021] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 6021] GPU 1 memory: 33.76 GB (reserved: 47.64 GB)
[Step 6021] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 6021] Student model device: cuda:1
[Step 6021] GPU 0 memory before teacher forward: 16.39 GB
[Step 6021] GPU 0 memory after moving inputs: 16.39 GB
[Step 6021] GPU 0 memory after teacher forward: 17.01 GB
[Step 6021] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 6021] Teacher logits device before move: cuda:0
[Step 6021] Target device (student_logits.device): cuda:1
[Step 6021] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 6021] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 6021] GPU 0 memory after del: 16.39 GB
[Step 6021] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 6021] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 6021] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 6021] Sequence length: 1024, Batch size: 2
[Step 6021] After KL computation - GPU 1: 40.50 GB
[Step 6021] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(

[Step 6031] ========== MEMORY DEBUG ==========
[Step 6031] Model device: cuda:1
[Step 6031] Input device: cuda:1
[Step 6031] Teacher model device: cuda:0
[Step 6031] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 6031] GPU 1 memory: 33.76 GB (reserved: 42.61 GB)
[Step 6031] Student logits device: cuda:1, shape: torch.Size([2, 1020, 151936]), dtype: torch.float32
[Step 6031] Student model device: cuda:1
[Step 6031] GPU 0 memory before teacher forward: 16.39 GB
[Step 6031] GPU 0 memory after moving inputs: 16.39 GB
[Step 6031] GPU 0 memory after teacher forward: 17.01 GB
[Step 6031] Teacher logits shape: torch.Size([2, 1020, 151936]), dtype: torch.float16
[Step 6031] Teacher logits device before move: cuda:0
[Step 6031] Target device (student_logits.device): cuda:1
[Step 6031] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 6031] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1020, 151936])
[Step 6031] GPU 0 memory after del: 16.39 GB
[Step 6031] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 6031] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.00 GB
[Step 6031] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 6031] Sequence length: 1020, Batch size: 2
[Step 6031] After KL computation - GPU 1: 40.48 GB
[Step 6031] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  4%|                                                                                 | 377/10000 [2:12:51<56:05:13, 20.98s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None

[Step 6041] ========== MEMORY DEBUG ==========
[Step 6041] Model device: cuda:1
[Step 6041] Input device: cuda:1
[Step 6041] Teacher model device: cuda:0
[Step 6041] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 6041] GPU 1 memory: 33.76 GB (reserved: 47.09 GB)
[Step 6041] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 6041] Student model device: cuda:1
[Step 6041] GPU 0 memory before teacher forward: 16.39 GB
[Step 6041] GPU 0 memory after moving inputs: 16.39 GB
[Step 6041] GPU 0 memory after teacher forward: 17.01 GB
[Step 6041] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 6041] Teacher logits device before move: cuda:0
[Step 6041] Target device (student_logits.device): cuda:1
[Step 6041] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 6041] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 6041] GPU 0 memory after del: 16.39 GB
[Step 6041] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 6041] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 6041] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 6041] Sequence length: 1024, Batch size: 2
[Step 6041] After KL computation - GPU 1: 40.50 GB
[Step 6041] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(
  4%|                                                                                 | 378/10000 [2:13:13<56:45:23, 21.24s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None

[Step 6051] ========== MEMORY DEBUG ==========
[Step 6051] Model device: cuda:1
[Step 6051] Input device: cuda:1
[Step 6051] Teacher model device: cuda:0
[Step 6051] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 6051] GPU 1 memory: 33.76 GB (reserved: 47.62 GB)
[Step 6051] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 6051] Student model device: cuda:1
[Step 6051] GPU 0 memory before teacher forward: 16.39 GB
[Step 6051] GPU 0 memory after moving inputs: 16.39 GB
[Step 6051] GPU 0 memory after teacher forward: 17.01 GB
[Step 6051] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 6051] Teacher logits device before move: cuda:0
[Step 6051] Target device (student_logits.device): cuda:1
[Step 6051] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 6051] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 6051] GPU 0 memory after del: 16.39 GB
[Step 6051] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 6051] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 6051] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 6051] Sequence length: 1024, Batch size: 2
[Step 6051] After KL computation - GPU 1: 40.50 GB
[Step 6051] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(

[Step 6061] ========== MEMORY DEBUG ==========
[Step 6061] Model device: cuda:1
[Step 6061] Input device: cuda:1
[Step 6061] Teacher model device: cuda:0
[Step 6061] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 6061] GPU 1 memory: 33.76 GB (reserved: 48.02 GB)
[Step 6061] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 6061] Student model device: cuda:1
[Step 6061] GPU 0 memory before teacher forward: 16.39 GB
[Step 6061] GPU 0 memory after moving inputs: 16.39 GB
[Step 6061] GPU 0 memory after teacher forward: 17.01 GB
[Step 6061] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 6061] Teacher logits device before move: cuda:0
[Step 6061] Target device (student_logits.device): cuda:1
[Step 6061] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 6061] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 6061] GPU 0 memory after del: 16.39 GB
[Step 6061] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 6061] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 6061] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 6061] Sequence length: 1024, Batch size: 2
[Step 6061] After KL computation - GPU 1: 40.50 GB
[Step 6061] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  4%|                                                                                 | 380/10000 [2:13:55<56:16:32, 21.06s/it]

[Step 6071] ========== MEMORY DEBUG ==========
[Step 6071] Model device: cuda:1
[Step 6071] Input device: cuda:1
[Step 6071] Teacher model device: cuda:0
[Step 6071] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 6071] GPU 1 memory: 33.76 GB (reserved: 48.19 GB)
[Step 6071] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 6071] Student model device: cuda:1
[Step 6071] GPU 0 memory before teacher forward: 16.39 GB
[Step 6071] GPU 0 memory after moving inputs: 16.39 GB
[Step 6071] GPU 0 memory after teacher forward: 17.01 GB
[Step 6071] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 6071] Teacher logits device before move: cuda:0
[Step 6071] Target device (student_logits.device): cuda:1
[Step 6071] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 6071] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 6071] GPU 0 memory after del: 16.39 GB
[Step 6071] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 6071] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 6071] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 6071] Sequence length: 1024, Batch size: 2
[Step 6071] After KL computation - GPU 1: 40.50 GB
[Step 6071] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 4.859090909090909e-05, 'epoch': 0.04}

[Step 6081] ========== MEMORY DEBUG ==========
[Step 6081] Model device: cuda:1
[Step 6081] Input device: cuda:1
[Step 6081] Teacher model device: cuda:0
[Step 6081] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 6081] GPU 1 memory: 25.33 GB (reserved: 48.00 GB)
[Step 6081] Student logits device: cuda:1, shape: torch.Size([2, 678, 151936]), dtype: torch.float32
[Step 6081] Student model device: cuda:1
[Step 6081] GPU 0 memory before teacher forward: 16.39 GB
[Step 6081] GPU 0 memory after moving inputs: 16.39 GB
[Step 6081] GPU 0 memory after teacher forward: 16.80 GB
[Step 6081] Teacher logits shape: torch.Size([2, 678, 151936]), dtype: torch.float16
[Step 6081] Teacher logits device before move: cuda:0
[Step 6081] Target device (student_logits.device): cuda:1
[Step 6081] GPU 0 memory after moving logits to GPU 1: 16.80 GB
[Step 6081] Teacher logits device after move: cuda:1, shape: torch.Size([2, 678, 151936])
[Step 6081] GPU 0 memory after del: 16.39 GB
[Step 6081] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 6081] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 28.35 GB
[Step 6081] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 6081] Sequence length: 678, Batch size: 2
[Step 6081] After KL computation - GPU 1: 30.00 GB
[Step 6081] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 6091] ========== MEMORY DEBUG ==========
[Step 6091] Model device: cuda:1
[Step 6091] Input device: cuda:1
[Step 6091] Teacher model device: cuda:0
[Step 6091] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 6091] GPU 1 memory: 33.76 GB (reserved: 46.37 GB)
[Step 6091] Student logits device: cuda:1, shape: torch.Size([2, 209, 151936]), dtype: torch.float32
[Step 6091] Student model device: cuda:1
[Step 6091] GPU 0 memory before teacher forward: 16.39 GB
[Step 6091] GPU 0 memory after moving inputs: 16.39 GB
[Step 6091] GPU 0 memory after teacher forward: 16.52 GB
[Step 6091] Teacher logits shape: torch.Size([2, 209, 151936]), dtype: torch.float16
[Step 6091] Teacher logits device before move: cuda:0
[Step 6091] Target device (student_logits.device): cuda:1
[Step 6091] GPU 0 memory after moving logits to GPU 1: 16.52 GB
[Step 6091] Teacher logits device after move: cuda:1, shape: torch.Size([2, 209, 151936])
[Step 6091] GPU 0 memory after del: 16.39 GB
[Step 6091] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 6091] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 35.14 GB
[Step 6091] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 6091] Sequence length: 209, Batch size: 2
[Step 6091] After KL computation - GPU 1: 35.65 GB
[Step 6091] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(

[Step 6101] ========== MEMORY DEBUG ==========
[Step 6101] Model device: cuda:1
[Step 6101] Input device: cuda:1
[Step 6101] Teacher model device: cuda:0
[Step 6101] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 6101] GPU 1 memory: 33.76 GB (reserved: 42.49 GB)
[Step 6101] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 6101] Student model device: cuda:1
[Step 6101] GPU 0 memory before teacher forward: 16.39 GB
[Step 6101] GPU 0 memory after moving inputs: 16.39 GB
[Step 6101] GPU 0 memory after teacher forward: 17.01 GB
[Step 6101] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 6101] Teacher logits device before move: cuda:0
[Step 6101] Target device (student_logits.device): cuda:1
[Step 6101] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 6101] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 6101] GPU 0 memory after del: 16.39 GB
[Step 6101] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 6101] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 6101] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 6101] Sequence length: 1024, Batch size: 2
[Step 6101] After KL computation - GPU 1: 40.50 GB
[Step 6101] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 6111] ========== MEMORY DEBUG ==========
[Step 6111] Model device: cuda:1
[Step 6111] Input device: cuda:1
[Step 6111] Teacher model device: cuda:0
[Step 6111] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 6111] GPU 1 memory: 33.76 GB (reserved: 47.42 GB)
[Step 6111] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 6111] Student model device: cuda:1
[Step 6111] GPU 0 memory before teacher forward: 16.39 GB
[Step 6111] GPU 0 memory after moving inputs: 16.39 GB
[Step 6111] GPU 0 memory after teacher forward: 17.01 GB
[Step 6111] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 6111] Teacher logits device before move: cuda:0
[Step 6111] Target device (student_logits.device): cuda:1
[Step 6111] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 6111] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 6111] GPU 0 memory after del: 16.39 GB
[Step 6111] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 6111] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 6111] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 6111] Sequence length: 1024, Batch size: 2
[Step 6111] After KL computation - GPU 1: 40.50 GB
[Step 6111] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  4%|                                                                                 | 382/10000 [2:14:37<55:57:59, 20.95s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(

[Step 6121] ========== MEMORY DEBUG ==========
[Step 6121] Model device: cuda:1
[Step 6121] Input device: cuda:1
[Step 6121] Teacher model device: cuda:0
[Step 6121] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 6121] GPU 1 memory: 33.76 GB (reserved: 47.51 GB)
[Step 6121] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 6121] Student model device: cuda:1
[Step 6121] GPU 0 memory before teacher forward: 16.39 GB
[Step 6121] GPU 0 memory after moving inputs: 16.39 GB
[Step 6121] GPU 0 memory after teacher forward: 17.01 GB
[Step 6121] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 6121] Teacher logits device before move: cuda:0
[Step 6121] Target device (student_logits.device): cuda:1
[Step 6121] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 6121] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 6121] GPU 0 memory after del: 16.39 GB
[Step 6121] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 6121] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 6121] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 6121] Sequence length: 1024, Batch size: 2
[Step 6121] After KL computation - GPU 1: 40.50 GB
[Step 6121] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  4%|                                                                                 | 383/10000 [2:14:57<55:32:57, 20.79s/it]

[Step 6131] ========== MEMORY DEBUG ==========
[Step 6131] Model device: cuda:1
[Step 6131] Input device: cuda:1
[Step 6131] Teacher model device: cuda:0
[Step 6131] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 6131] GPU 1 memory: 33.76 GB (reserved: 46.43 GB)
[Step 6131] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 6131] Student model device: cuda:1
[Step 6131] GPU 0 memory before teacher forward: 16.39 GB
[Step 6131] GPU 0 memory after moving inputs: 16.39 GB
[Step 6131] GPU 0 memory after teacher forward: 17.01 GB
[Step 6131] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 6131] Teacher logits device before move: cuda:0
[Step 6131] Target device (student_logits.device): cuda:1
[Step 6131] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 6131] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 6131] GPU 0 memory after del: 16.39 GB
[Step 6131] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 6131] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 6131] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 6131] Sequence length: 1024, Batch size: 2
[Step 6131] After KL computation - GPU 1: 40.50 GB
[Step 6131] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 6141] ========== MEMORY DEBUG ==========
[Step 6141] Model device: cuda:1
[Step 6141] Input device: cuda:1
[Step 6141] Teacher model device: cuda:0
[Step 6141] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 6141] GPU 1 memory: 33.76 GB (reserved: 47.12 GB)
[Step 6141] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 6141] Student model device: cuda:1
[Step 6141] GPU 0 memory before teacher forward: 16.39 GB
[Step 6141] GPU 0 memory after moving inputs: 16.39 GB
[Step 6141] GPU 0 memory after teacher forward: 17.01 GB
[Step 6141] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 6141] Teacher logits device before move: cuda:0
[Step 6141] Target device (student_logits.device): cuda:1
[Step 6141] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 6141] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 6141] GPU 0 memory after del: 16.39 GB
[Step 6141] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 6141] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 6141] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 6141] Sequence length: 1024, Batch size: 2
[Step 6141] After KL computation - GPU 1: 40.50 GB
[Step 6141] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 6151] ========== MEMORY DEBUG ==========
[Step 6151] Model device: cuda:1
[Step 6151] Input device: cuda:1
[Step 6151] Teacher model device: cuda:0
[Step 6151] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 6151] GPU 1 memory: 33.76 GB (reserved: 44.56 GB)
  warnings.warn(
[Step 6151] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 6151] Student model device: cuda:1
[Step 6151] GPU 0 memory before teacher forward: 16.39 GB
[Step 6151] GPU 0 memory after moving inputs: 16.39 GB
[Step 6151] GPU 0 memory after teacher forward: 17.01 GB
[Step 6151] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 6151] Teacher logits device before move: cuda:0
[Step 6151] Target device (student_logits.device): cuda:1
[Step 6151] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 6151] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 6151] GPU 0 memory after del: 16.39 GB
[Step 6151] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 6151] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 6151] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 6151] Sequence length: 1024, Batch size: 2
[Step 6151] After KL computation - GPU 1: 40.50 GB
[Step 6151] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  4%|                                                                                 | 385/10000 [2:15:39<56:01:30, 20.98s/it]

[Step 6161] ========== MEMORY DEBUG ==========
[Step 6161] Model device: cuda:1
[Step 6161] Input device: cuda:1
[Step 6161] Teacher model device: cuda:0
[Step 6161] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 6161] GPU 1 memory: 25.33 GB (reserved: 44.87 GB)
[Step 6161] Student logits device: cuda:1, shape: torch.Size([2, 609, 151936]), dtype: torch.float32
[Step 6161] Student model device: cuda:1
[Step 6161] GPU 0 memory before teacher forward: 16.39 GB
[Step 6161] GPU 0 memory after moving inputs: 16.39 GB
[Step 6161] GPU 0 memory after teacher forward: 16.76 GB
[Step 6161] Teacher logits shape: torch.Size([2, 609, 151936]), dtype: torch.float16
[Step 6161] Teacher logits device before move: cuda:0
[Step 6161] Target device (student_logits.device): cuda:1
[Step 6161] GPU 0 memory after moving logits to GPU 1: 16.76 GB
[Step 6161] Teacher logits device after move: cuda:1, shape: torch.Size([2, 609, 151936])
[Step 6161] GPU 0 memory after del: 16.39 GB
[Step 6161] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 6161] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 28.11 GB
[Step 6161] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 6161] Sequence length: 609, Batch size: 2
[Step 6161] After KL computation - GPU 1: 29.59 GB
[Step 6161] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 6171] ========== MEMORY DEBUG ==========
[Step 6171] Model device: cuda:1
[Step 6171] Input device: cuda:1
[Step 6171] Teacher model device: cuda:0
[Step 6171] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 6171] GPU 1 memory: 33.76 GB (reserved: 41.83 GB)
[Step 6171] Student logits device: cuda:1, shape: torch.Size([2, 407, 151936]), dtype: torch.float32
[Step 6171] Student model device: cuda:1
[Step 6171] GPU 0 memory before teacher forward: 16.39 GB
[Step 6171] GPU 0 memory after moving inputs: 16.39 GB
[Step 6171] GPU 0 memory after teacher forward: 16.64 GB
[Step 6171] Teacher logits shape: torch.Size([2, 407, 151936]), dtype: torch.float16
[Step 6171] Teacher logits device before move: cuda:0
[Step 6171] Target device (student_logits.device): cuda:1
[Step 6171] GPU 0 memory after moving logits to GPU 1: 16.64 GB
[Step 6171] Teacher logits device after move: cuda:1, shape: torch.Size([2, 407, 151936])
[Step 6171] GPU 0 memory after del: 16.39 GB
[Step 6171] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 6171] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 35.83 GB
[Step 6171] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 6171] Sequence length: 407, Batch size: 2
[Step 6171] After KL computation - GPU 1: 36.82 GB
[Step 6171] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(

[Step 6181] ========== MEMORY DEBUG ==========
[Step 6181] Model device: cuda:1
[Step 6181] Input device: cuda:1
[Step 6181] Teacher model device: cuda:0
[Step 6181] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 6181] GPU 1 memory: 33.77 GB (reserved: 41.43 GB)
[Step 6181] Student logits device: cuda:1, shape: torch.Size([2, 733, 151936]), dtype: torch.float32
[Step 6181] Student model device: cuda:1
[Step 6181] GPU 0 memory before teacher forward: 16.39 GB
[Step 6181] GPU 0 memory after moving inputs: 16.39 GB
[Step 6181] GPU 0 memory after teacher forward: 16.84 GB
[Step 6181] Teacher logits shape: torch.Size([2, 733, 151936]), dtype: torch.float16
[Step 6181] Teacher logits device before move: cuda:0
[Step 6181] Target device (student_logits.device): cuda:1
[Step 6181] GPU 0 memory after moving logits to GPU 1: 16.84 GB
[Step 6181] Teacher logits device after move: cuda:1, shape: torch.Size([2, 733, 151936])
[Step 6181] GPU 0 memory after del: 16.39 GB
[Step 6181] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 6181] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 36.99 GB
[Step 6181] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 6181] Sequence length: 733, Batch size: 2
[Step 6181] After KL computation - GPU 1: 38.77 GB
[Step 6181] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 6191] ========== MEMORY DEBUG ==========
[Step 6191] Model device: cuda:1
[Step 6191] Input device: cuda:1
[Step 6191] Teacher model device: cuda:0
[Step 6191] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 6191] GPU 1 memory: 33.77 GB (reserved: 47.92 GB)
[Step 6191] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 6191] Student model device: cuda:1
[Step 6191] GPU 0 memory before teacher forward: 16.39 GB
[Step 6191] GPU 0 memory after moving inputs: 16.39 GB
[Step 6191] GPU 0 memory after teacher forward: 17.01 GB
[Step 6191] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 6191] Teacher logits device before move: cuda:0
[Step 6191] Target device (student_logits.device): cuda:1
[Step 6191] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 6191] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 6191] GPU 0 memory after del: 16.39 GB
[Step 6191] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 6191] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.02 GB
[Step 6191] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 6191] Sequence length: 1024, Batch size: 2
[Step 6191] After KL computation - GPU 1: 40.51 GB
[Step 6191] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  4%|                                                                                 | 388/10000 [2:16:38<54:07:02, 20.27s/it]

[Step 6201] ========== MEMORY DEBUG ==========
[Step 6201] Model device: cuda:1
[Step 6201] Input device: cuda:1
[Step 6201] Teacher model device: cuda:0
[Step 6201] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 6201] GPU 1 memory: 33.76 GB (reserved: 47.55 GB)
[Step 6201] Student logits device: cuda:1, shape: torch.Size([2, 642, 151936]), dtype: torch.float32
[Step 6201] Student model device: cuda:1
[Step 6201] GPU 0 memory before teacher forward: 16.39 GB
[Step 6201] GPU 0 memory after moving inputs: 16.39 GB
[Step 6201] GPU 0 memory after teacher forward: 16.78 GB
[Step 6201] Teacher logits shape: torch.Size([2, 642, 151936]), dtype: torch.float16
[Step 6201] Teacher logits device before move: cuda:0
[Step 6201] Target device (student_logits.device): cuda:1
[Step 6201] GPU 0 memory after moving logits to GPU 1: 16.78 GB
[Step 6201] Teacher logits device after move: cuda:1, shape: torch.Size([2, 642, 151936])
[Step 6201] GPU 0 memory after del: 16.39 GB
[Step 6201] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 6201] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 36.66 GB
[Step 6201] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 6201] Sequence length: 642, Batch size: 2
[Step 6201] After KL computation - GPU 1: 38.22 GB
[Step 6201] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 6211] ========== MEMORY DEBUG ==========
[Step 6211] Model device: cuda:1
[Step 6211] Input device: cuda:1
[Step 6211] Teacher model device: cuda:0
[Step 6211] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 6211] GPU 1 memory: 33.76 GB (reserved: 47.66 GB)
[Step 6211] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 6211] Student model device: cuda:1
[Step 6211] GPU 0 memory before teacher forward: 16.39 GB
[Step 6211] GPU 0 memory after moving inputs: 16.39 GB
[Step 6211] GPU 0 memory after teacher forward: 17.01 GB
[Step 6211] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 6211] Teacher logits device before move: cuda:0
[Step 6211] Target device (student_logits.device): cuda:1
[Step 6211] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 6211] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 6211] GPU 0 memory after del: 16.39 GB
[Step 6211] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 6211] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 6211] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 6211] Sequence length: 1024, Batch size: 2
[Step 6211] After KL computation - GPU 1: 40.50 GB
[Step 6211] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 6221] ========== MEMORY DEBUG ==========
[Step 6221] Model device: cuda:1
[Step 6221] Input device: cuda:1
[Step 6221] Teacher model device: cuda:0
[Step 6221] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 6221] GPU 1 memory: 33.76 GB (reserved: 47.49 GB)
[Step 6221] Student logits device: cuda:1, shape: torch.Size([2, 650, 151936]), dtype: torch.float32
[Step 6221] Student model device: cuda:1
[Step 6221] GPU 0 memory before teacher forward: 16.39 GB
[Step 6221] GPU 0 memory after moving inputs: 16.39 GB
[Step 6221] GPU 0 memory after teacher forward: 16.79 GB
[Step 6221] Teacher logits shape: torch.Size([2, 650, 151936]), dtype: torch.float16
[Step 6221] Teacher logits device before move: cuda:0
[Step 6221] Target device (student_logits.device): cuda:1
[Step 6221] GPU 0 memory after moving logits to GPU 1: 16.79 GB
[Step 6221] Teacher logits device after move: cuda:1, shape: torch.Size([2, 650, 151936])
[Step 6221] GPU 0 memory after del: 16.39 GB
[Step 6221] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 6221] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 36.69 GB
[Step 6221] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 6221] Sequence length: 650, Batch size: 2
[Step 6221] After KL computation - GPU 1: 38.27 GB
[Step 6221] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 6231] ========== MEMORY DEBUG ==========
[Step 6231] Model device: cuda:1
[Step 6231] Input device: cuda:1
[Step 6231] Teacher model device: cuda:0
[Step 6231] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 6231] GPU 1 memory: 33.76 GB (reserved: 44.87 GB)
[Step 6231] Student logits device: cuda:1, shape: torch.Size([2, 174, 151936]), dtype: torch.float32
[Step 6231] Student model device: cuda:1
[Step 6231] GPU 0 memory before teacher forward: 16.39 GB
[Step 6231] GPU 0 memory after moving inputs: 16.39 GB
[Step 6231] GPU 0 memory after teacher forward: 16.50 GB
[Step 6231] Teacher logits shape: torch.Size([2, 174, 151936]), dtype: torch.float16
[Step 6231] Teacher logits device before move: cuda:0
[Step 6231] Target device (student_logits.device): cuda:1
[Step 6231] GPU 0 memory after moving logits to GPU 1: 16.50 GB
[Step 6231] Teacher logits device after move: cuda:1, shape: torch.Size([2, 174, 151936])
[Step 6231] GPU 0 memory after del: 16.39 GB
[Step 6231] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 6231] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 35.00 GB
[Step 6231] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 6231] Sequence length: 174, Batch size: 2
[Step 6231] After KL computation - GPU 1: 35.43 GB
[Step 6231] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
{'loss': 0.0, 'grad_norm': nan, 'learning_rate': 4.854040404040404e-05, 'epoch': 0.04}

[Step 6241] ========== MEMORY DEBUG ==========
[Step 6241] Model device: cuda:1
[Step 6241] Input device: cuda:1
[Step 6241] Teacher model device: cuda:0
[Step 6241] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 6241] GPU 1 memory: 25.33 GB (reserved: 44.69 GB)
[Step 6241] Student logits device: cuda:1, shape: torch.Size([2, 918, 151936]), dtype: torch.float32
[Step 6241] Student model device: cuda:1
[Step 6241] GPU 0 memory before teacher forward: 16.39 GB
[Step 6241] GPU 0 memory after moving inputs: 16.39 GB
[Step 6241] GPU 0 memory after teacher forward: 16.95 GB
[Step 6241] Teacher logits shape: torch.Size([2, 918, 151936]), dtype: torch.float16
[Step 6241] Teacher logits device before move: cuda:0
[Step 6241] Target device (student_logits.device): cuda:1
[Step 6241] GPU 0 memory after moving logits to GPU 1: 16.95 GB
[Step 6241] Teacher logits device after move: cuda:1, shape: torch.Size([2, 918, 151936])
[Step 6241] GPU 0 memory after del: 16.39 GB
[Step 6241] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 6241] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 29.20 GB
[Step 6241] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 6241] Sequence length: 918, Batch size: 2
[Step 6241] After KL computation - GPU 1: 31.43 GB
[Step 6241] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(

[Step 6251] ========== MEMORY DEBUG ==========
[Step 6251] Model device: cuda:1
[Step 6251] Input device: cuda:1
[Step 6251] Teacher model device: cuda:0
[Step 6251] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 6251] GPU 1 memory: 33.77 GB (reserved: 45.40 GB)
[Step 6251] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 6251] Student model device: cuda:1
[Step 6251] GPU 0 memory before teacher forward: 16.39 GB
[Step 6251] GPU 0 memory after moving inputs: 16.39 GB
[Step 6251] GPU 0 memory after teacher forward: 17.01 GB
[Step 6251] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 6251] Teacher logits device before move: cuda:0
[Step 6251] Target device (student_logits.device): cuda:1
[Step 6251] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 6251] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 6251] GPU 0 memory after del: 16.39 GB
[Step 6251] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 6251] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.02 GB
[Step 6251] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 6251] Sequence length: 1024, Batch size: 2
[Step 6251] After KL computation - GPU 1: 40.51 GB
[Step 6251] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  4%|                                                                                 | 391/10000 [2:17:38<53:05:17, 19.89s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None

[Step 6261] ========== MEMORY DEBUG ==========
[Step 6261] Model device: cuda:1
[Step 6261] Input device: cuda:1
[Step 6261] Teacher model device: cuda:0
[Step 6261] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 6261] GPU 1 memory: 33.76 GB (reserved: 43.81 GB)
  warnings.warn(
[Step 6261] Student logits device: cuda:1, shape: torch.Size([2, 754, 151936]), dtype: torch.float32
[Step 6261] Student model device: cuda:1
[Step 6261] GPU 0 memory before teacher forward: 16.39 GB
[Step 6261] GPU 0 memory after moving inputs: 16.39 GB
[Step 6261] GPU 0 memory after teacher forward: 16.85 GB
[Step 6261] Teacher logits shape: torch.Size([2, 754, 151936]), dtype: torch.float16
[Step 6261] Teacher logits device before move: cuda:0
[Step 6261] Target device (student_logits.device): cuda:1
[Step 6261] GPU 0 memory after moving logits to GPU 1: 16.85 GB
[Step 6261] Teacher logits device after move: cuda:1, shape: torch.Size([2, 754, 151936])
[Step 6261] GPU 0 memory after del: 16.39 GB
[Step 6261] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 6261] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 37.06 GB
[Step 6261] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 6261] Sequence length: 754, Batch size: 2
[Step 6261] After KL computation - GPU 1: 38.89 GB
[Step 6261] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 6271] ========== MEMORY DEBUG ==========
[Step 6271] Model device: cuda:1
[Step 6271] Input device: cuda:1
[Step 6271] Teacher model device: cuda:0
[Step 6271] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 6271] GPU 1 memory: 33.76 GB (reserved: 44.86 GB)
[Step 6271] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 6271] Student model device: cuda:1
[Step 6271] GPU 0 memory before teacher forward: 16.39 GB
[Step 6271] GPU 0 memory after moving inputs: 16.39 GB
[Step 6271] GPU 0 memory after teacher forward: 17.01 GB
[Step 6271] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 6271] Teacher logits device before move: cuda:0
[Step 6271] Target device (student_logits.device): cuda:1
[Step 6271] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 6271] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 6271] GPU 0 memory after del: 16.39 GB
[Step 6271] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 6271] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 6271] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 6271] Sequence length: 1024, Batch size: 2
[Step 6271] After KL computation - GPU 1: 40.50 GB
[Step 6271] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  4%|                                                                                 | 392/10000 [2:17:59<53:38:02, 20.10s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None

[Step 6281] ========== MEMORY DEBUG ==========
[Step 6281] Model device: cuda:1
[Step 6281] Input device: cuda:1
[Step 6281] Teacher model device: cuda:0
[Step 6281] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 6281] GPU 1 memory: 33.77 GB (reserved: 39.07 GB)
  warnings.warn(
[Step 6281] Student logits device: cuda:1, shape: torch.Size([2, 462, 151936]), dtype: torch.float32
[Step 6281] Student model device: cuda:1
[Step 6281] GPU 0 memory before teacher forward: 16.39 GB
[Step 6281] GPU 0 memory after moving inputs: 16.39 GB
[Step 6281] GPU 0 memory after teacher forward: 16.67 GB
[Step 6281] Teacher logits shape: torch.Size([2, 462, 151936]), dtype: torch.float16
[Step 6281] Teacher logits device before move: cuda:0
[Step 6281] Target device (student_logits.device): cuda:1
[Step 6281] GPU 0 memory after moving logits to GPU 1: 16.67 GB
[Step 6281] Teacher logits device after move: cuda:1, shape: torch.Size([2, 462, 151936])
[Step 6281] GPU 0 memory after del: 16.39 GB
[Step 6281] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 6281] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 36.03 GB
[Step 6281] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 6281] Sequence length: 462, Batch size: 2
[Step 6281] After KL computation - GPU 1: 37.16 GB
[Step 6281] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  4%|                                                                                 | 393/10000 [2:18:19<53:59:22, 20.23s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None

[Step 6291] ========== MEMORY DEBUG ==========
[Step 6291] Model device: cuda:1
[Step 6291] Input device: cuda:1
[Step 6291] Teacher model device: cuda:0
[Step 6291] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 6291] GPU 1 memory: 33.77 GB (reserved: 47.33 GB)
[Step 6291] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 6291] Student model device: cuda:1
[Step 6291] GPU 0 memory before teacher forward: 16.39 GB
[Step 6291] GPU 0 memory after moving inputs: 16.39 GB
[Step 6291] GPU 0 memory after teacher forward: 17.01 GB
[Step 6291] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 6291] Teacher logits device before move: cuda:0
[Step 6291] Target device (student_logits.device): cuda:1
[Step 6291] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 6291] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 6291] GPU 0 memory after del: 16.39 GB
[Step 6291] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 6291] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.02 GB
[Step 6291] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 6291] Sequence length: 1024, Batch size: 2
[Step 6291] After KL computation - GPU 1: 40.51 GB
[Step 6291] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(

[Step 6301] ========== MEMORY DEBUG ==========
[Step 6301] Model device: cuda:1
[Step 6301] Input device: cuda:1
[Step 6301] Teacher model device: cuda:0
[Step 6301] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 6301] GPU 1 memory: 33.77 GB (reserved: 41.23 GB)
[Step 6301] Student logits device: cuda:1, shape: torch.Size([2, 580, 151936]), dtype: torch.float32
[Step 6301] Student model device: cuda:1
[Step 6301] GPU 0 memory before teacher forward: 16.39 GB
[Step 6301] GPU 0 memory after moving inputs: 16.39 GB
[Step 6301] GPU 0 memory after teacher forward: 16.74 GB
[Step 6301] Teacher logits shape: torch.Size([2, 580, 151936]), dtype: torch.float16
[Step 6301] Teacher logits device before move: cuda:0
[Step 6301] Target device (student_logits.device): cuda:1
[Step 6301] GPU 0 memory after moving logits to GPU 1: 16.74 GB
[Step 6301] Teacher logits device after move: cuda:1, shape: torch.Size([2, 580, 151936])
[Step 6301] GPU 0 memory after del: 16.39 GB
[Step 6301] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 6301] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 36.45 GB
[Step 6301] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 6301] Sequence length: 580, Batch size: 2
[Step 6301] After KL computation - GPU 1: 37.86 GB
[Step 6301] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  4%|                                                                                 | 395/10000 [2:18:59<53:01:47, 19.88s/it]

[Step 6311] ========== MEMORY DEBUG ==========
[Step 6311] Model device: cuda:1
[Step 6311] Input device: cuda:1
[Step 6311] Teacher model device: cuda:0
[Step 6311] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 6311] GPU 1 memory: 33.76 GB (reserved: 47.60 GB)
[Step 6311] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 6311] Student model device: cuda:1
[Step 6311] GPU 0 memory before teacher forward: 16.39 GB
[Step 6311] GPU 0 memory after moving inputs: 16.39 GB
[Step 6311] GPU 0 memory after teacher forward: 17.01 GB
[Step 6311] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 6311] Teacher logits device before move: cuda:0
[Step 6311] Target device (student_logits.device): cuda:1
[Step 6311] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 6311] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 6311] GPU 0 memory after del: 16.39 GB
[Step 6311] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 6311] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 6311] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 6311] Sequence length: 1024, Batch size: 2
[Step 6311] After KL computation - GPU 1: 40.50 GB
[Step 6311] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 6321] ========== MEMORY DEBUG ==========
[Step 6321] Model device: cuda:1
[Step 6321] Input device: cuda:1
[Step 6321] Teacher model device: cuda:0
[Step 6321] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 6321] GPU 1 memory: 25.33 GB (reserved: 44.36 GB)
[Step 6321] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 6321] Student model device: cuda:1
[Step 6321] GPU 0 memory before teacher forward: 16.39 GB
[Step 6321] GPU 0 memory after moving inputs: 16.39 GB
[Step 6321] GPU 0 memory after teacher forward: 17.01 GB
[Step 6321] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 6321] Teacher logits device before move: cuda:0
[Step 6321] Target device (student_logits.device): cuda:1
[Step 6321] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 6321] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 6321] GPU 0 memory after del: 16.39 GB
[Step 6321] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 6321] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 29.58 GB
[Step 6321] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 6321] Sequence length: 1024, Batch size: 2
[Step 6321] After KL computation - GPU 1: 32.07 GB
[Step 6321] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(

[Step 6331] ========== MEMORY DEBUG ==========
[Step 6331] Model device: cuda:1
[Step 6331] Input device: cuda:1
[Step 6331] Teacher model device: cuda:0
[Step 6331] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 6331] GPU 1 memory: 33.76 GB (reserved: 47.79 GB)
[Step 6331] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 6331] Student model device: cuda:1
[Step 6331] GPU 0 memory before teacher forward: 16.39 GB
[Step 6331] GPU 0 memory after moving inputs: 16.39 GB
[Step 6331] GPU 0 memory after teacher forward: 17.01 GB
[Step 6331] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 6331] Teacher logits device before move: cuda:0
[Step 6331] Target device (student_logits.device): cuda:1
[Step 6331] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 6331] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 6331] GPU 0 memory after del: 16.39 GB
[Step 6331] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 6331] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.01 GB
[Step 6331] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 6331] Sequence length: 1024, Batch size: 2
[Step 6331] After KL computation - GPU 1: 40.50 GB
[Step 6331] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  4%|                                                                                 | 396/10000 [2:19:18<52:45:55, 19.78s/it]/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None

[Step 6341] ========== MEMORY DEBUG ==========
[Step 6341] Model device: cuda:1
[Step 6341] Input device: cuda:1
[Step 6341] Teacher model device: cuda:0
[Step 6341] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 6341] GPU 1 memory: 33.76 GB (reserved: 47.77 GB)
[Step 6341] Student logits device: cuda:1, shape: torch.Size([2, 978, 151936]), dtype: torch.float32
[Step 6341] Student model device: cuda:1
[Step 6341] GPU 0 memory before teacher forward: 16.39 GB
[Step 6341] GPU 0 memory after moving inputs: 16.39 GB
[Step 6341] GPU 0 memory after teacher forward: 16.99 GB
[Step 6341] Teacher logits shape: torch.Size([2, 978, 151936]), dtype: torch.float16
[Step 6341] Teacher logits device before move: cuda:0
[Step 6341] Target device (student_logits.device): cuda:1
[Step 6341] GPU 0 memory after moving logits to GPU 1: 16.99 GB
[Step 6341] Teacher logits device after move: cuda:1, shape: torch.Size([2, 978, 151936])
[Step 6341] GPU 0 memory after del: 16.39 GB
[Step 6341] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 6341] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 37.85 GB
[Step 6341] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 6341] Sequence length: 978, Batch size: 2
[Step 6341] After KL computation - GPU 1: 40.23 GB
[Step 6341] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  warnings.warn(

[Step 6351] ========== MEMORY DEBUG ==========
[Step 6351] Model device: cuda:1
[Step 6351] Input device: cuda:1
[Step 6351] Teacher model device: cuda:0
[Step 6351] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 6351] GPU 1 memory: 33.76 GB (reserved: 47.78 GB)
[Step 6351] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 6351] Student model device: cuda:1
[Step 6351] GPU 0 memory before teacher forward: 16.39 GB
[Step 6351] GPU 0 memory after moving inputs: 16.39 GB
[Step 6351] GPU 0 memory after teacher forward: 17.01 GB
[Step 6351] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 6351] Teacher logits device before move: cuda:0
[Step 6351] Target device (student_logits.device): cuda:1
[Step 6351] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 6351] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 6351] GPU 0 memory after del: 16.39 GB
[Step 6351] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 6351] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.02 GB
[Step 6351] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 6351] Sequence length: 1024, Batch size: 2
[Step 6351] After KL computation - GPU 1: 40.51 GB
[Step 6351] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
  4%|                                                                                 | 398/10000 [2:19:59<53:34:29, 20.09s/it]

[Step 6361] ========== MEMORY DEBUG ==========
[Step 6361] Model device: cuda:1
[Step 6361] Input device: cuda:1
[Step 6361] Teacher model device: cuda:0
[Step 6361] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 6361] GPU 1 memory: 33.76 GB (reserved: 47.83 GB)
[Step 6361] Student logits device: cuda:1, shape: torch.Size([2, 544, 151936]), dtype: torch.float32
[Step 6361] Student model device: cuda:1
[Step 6361] GPU 0 memory before teacher forward: 16.39 GB
[Step 6361] GPU 0 memory after moving inputs: 16.39 GB
[Step 6361] GPU 0 memory after teacher forward: 16.72 GB
[Step 6361] Teacher logits shape: torch.Size([2, 544, 151936]), dtype: torch.float16
[Step 6361] Teacher logits device before move: cuda:0
[Step 6361] Target device (student_logits.device): cuda:1
[Step 6361] GPU 0 memory after moving logits to GPU 1: 16.72 GB
[Step 6361] Teacher logits device after move: cuda:1, shape: torch.Size([2, 544, 151936])
[Step 6361] GPU 0 memory after del: 16.39 GB
[Step 6361] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 6361] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 36.31 GB
[Step 6361] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 6361] Sequence length: 544, Batch size: 2
[Step 6361] After KL computation - GPU 1: 37.63 GB
[Step 6361] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 6371] ========== MEMORY DEBUG ==========
[Step 6371] Model device: cuda:1
[Step 6371] Input device: cuda:1
[Step 6371] Teacher model device: cuda:0
[Step 6371] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 6371] GPU 1 memory: 33.76 GB (reserved: 47.35 GB)
[Step 6371] Student logits device: cuda:1, shape: torch.Size([2, 357, 151936]), dtype: torch.float32
[Step 6371] Student model device: cuda:1
[Step 6371] GPU 0 memory before teacher forward: 16.39 GB
[Step 6371] GPU 0 memory after moving inputs: 16.39 GB
[Step 6371] GPU 0 memory after teacher forward: 16.61 GB
[Step 6371] Teacher logits shape: torch.Size([2, 357, 151936]), dtype: torch.float16
[Step 6371] Teacher logits device before move: cuda:0
[Step 6371] Target device (student_logits.device): cuda:1
[Step 6371] GPU 0 memory after moving logits to GPU 1: 16.61 GB
[Step 6371] Teacher logits device after move: cuda:1, shape: torch.Size([2, 357, 151936])
[Step 6371] GPU 0 memory after del: 16.39 GB
[Step 6371] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 6371] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 35.65 GB
[Step 6371] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 6371] Sequence length: 357, Batch size: 2
[Step 6371] After KL computation - GPU 1: 36.52 GB
[Step 6371] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 6381] ========== MEMORY DEBUG ==========
[Step 6381] Model device: cuda:1
[Step 6381] Input device: cuda:1
[Step 6381] Teacher model device: cuda:0
[Step 6381] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 6381] GPU 1 memory: 33.76 GB (reserved: 46.81 GB)
[Step 6381] Student logits device: cuda:1, shape: torch.Size([2, 718, 151936]), dtype: torch.float32
[Step 6381] Student model device: cuda:1
[Step 6381] GPU 0 memory before teacher forward: 16.39 GB
[Step 6381] GPU 0 memory after moving inputs: 16.39 GB
[Step 6381] GPU 0 memory after teacher forward: 16.83 GB
[Step 6381] Teacher logits shape: torch.Size([2, 718, 151936]), dtype: torch.float16
[Step 6381] Teacher logits device before move: cuda:0
[Step 6381] Target device (student_logits.device): cuda:1
[Step 6381] GPU 0 memory after moving logits to GPU 1: 16.83 GB
[Step 6381] Teacher logits device after move: cuda:1, shape: torch.Size([2, 718, 151936])
[Step 6381] GPU 0 memory after del: 16.39 GB
[Step 6381] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 6381] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 36.93 GB
[Step 6381] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 6381] Sequence length: 718, Batch size: 2
[Step 6381] After KL computation - GPU 1: 38.67 GB
[Step 6381] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1

[Step 6391] ========== MEMORY DEBUG ==========
[Step 6391] Model device: cuda:1
[Step 6391] Input device: cuda:1
[Step 6391] Teacher model device: cuda:0
[Step 6391] GPU 0 memory: 16.39 GB (reserved: 16.56 GB)
[Step 6391] GPU 1 memory: 33.77 GB (reserved: 44.60 GB)
[Step 6391] Student logits device: cuda:1, shape: torch.Size([2, 1024, 151936]), dtype: torch.float32
[Step 6391] Student model device: cuda:1
[Step 6391] GPU 0 memory before teacher forward: 16.39 GB
[Step 6391] GPU 0 memory after moving inputs: 16.39 GB
[Step 6391] GPU 0 memory after teacher forward: 17.01 GB
[Step 6391] Teacher logits shape: torch.Size([2, 1024, 151936]), dtype: torch.float16
[Step 6391] Teacher logits device before move: cuda:0
[Step 6391] Target device (student_logits.device): cuda:1
[Step 6391] GPU 0 memory after moving logits to GPU 1: 17.01 GB
[Step 6391] Teacher logits device after move: cuda:1, shape: torch.Size([2, 1024, 151936])
[Step 6391] GPU 0 memory after del: 16.39 GB
[Step 6391] GPU 0 memory after cache clear: 16.39 GB (reserved: 16.56 GB)
[Step 6391] Before log_softmax - GPU 0: 16.39 GB, GPU 1: 38.02 GB
[Step 6391] student_logits device: cuda:1, teacher_logits device: cuda:1
[Step 6391] Sequence length: 1024, Batch size: 2
[Step 6391] After KL computation - GPU 1: 40.51 GB
[Step 6391] Loss device: cuda:0, args.device: cuda:0, model device: cuda:1
{'loss': 75223436.8, 'grad_norm': nan, 'learning_rate': 4.848989898989899e-05, 'epoch': 0.04}
  File "/workspace/compute-aware-arch-search/distill_videet.py", line 410, in <module>
    trainer.train()
  File "/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/transformers/trainer.py", line 2325, in train
    return inner_training_loop(
           ^^^^^^^^^^^^^^^^^^^^
  File "/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/transformers/trainer.py", line 2756, in _inner_training_loop
    self._maybe_log_save_evaluate(
  File "/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/transformers/trainer.py", line 3228, in _maybe_log_save_evaluate
    self._save_checkpoint(model, trial)
  File "/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/transformers/trainer.py", line 3325, in _save_checkpoint
    self.save_model(output_dir, _internal_call=True)
  File "/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/transformers/trainer.py", line 4227, in save_model
    self._save(output_dir)
  File "/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/transformers/trainer.py", line 4331, in _save
    self.model.save_pretrained(
  File "/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/transformers/modeling_utils.py", line 4173, in save_pretrained
    safe_save_file(shard, os.path.join(save_directory, shard_file), metadata=metadata)
  File "/workspace/compute-aware-arch-search/.venv/lib/python3.12/site-packages/safetensors/torch.py", line 352, in save_file
    serialize_file(_flatten(tensors), filename, metadata=metadata)
safetensors_rust.SafetensorError: Error while serializing: I/O error: No space left on device (os error 28)
